var tw=e=>{throw TypeError(e)};var jy=(e,t,s)=>t.has(e)||tw("Cannot "+s);var pe=(e,t,s)=>(jy(e,t,"read from private field"),s?s.call(e):t.get(e)),bt=(e,t,s)=>t.has(e)?tw("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),at=(e,t,s,l)=>(jy(e,t,"write to private field"),l?l.call(e,s):t.set(e,s),s),Ht=(e,t,s)=>(jy(e,t,"access private method"),s);var Ip=(e,t,s,l)=>({set _(p){at(e,t,p,s)},get _(){return pe(e,t,l)}});function mI(e,t){for(var s=0;s<t.length;s++){const l=t[s];if(typeof l!="string"&&!Array.isArray(l)){for(const p in l)if(p!=="default"&&!(p in e)){const v=Object.getOwnPropertyDescriptor(l,p);v&&Object.defineProperty(e,p,v.get?v:{enumerable:!0,get:()=>l[p]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))l(p);new MutationObserver(p=>{for(const v of p)if(v.type==="childList")for(const y of v.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&l(y)}).observe(document,{childList:!0,subtree:!0});function s(p){const v={};return p.integrity&&(v.integrity=p.integrity),p.referrerPolicy&&(v.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?v.credentials="include":p.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function l(p){if(p.ep)return;p.ep=!0;const v=s(p);fetch(p.href,v)}})();var gI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function L2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var R2={exports:{}},rg={},F2={exports:{}},Ut={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pf=Symbol.for("react.element"),yI=Symbol.for("react.portal"),_I=Symbol.for("react.fragment"),vI=Symbol.for("react.strict_mode"),xI=Symbol.for("react.profiler"),wI=Symbol.for("react.provider"),bI=Symbol.for("react.context"),SI=Symbol.for("react.forward_ref"),kI=Symbol.for("react.suspense"),TI=Symbol.for("react.memo"),CI=Symbol.for("react.lazy"),rw=Symbol.iterator;function MI(e){return e===null||typeof e!="object"?null:(e=rw&&e[rw]||e["@@iterator"],typeof e=="function"?e:null)}var O2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N2=Object.assign,B2={};function Gc(e,t,s){this.props=e,this.context=t,this.refs=B2,this.updater=s||O2}Gc.prototype.isReactComponent={};Gc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Gc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function j2(){}j2.prototype=Gc.prototype;function Y0(e,t,s){this.props=e,this.context=t,this.refs=B2,this.updater=s||O2}var Q0=Y0.prototype=new j2;Q0.constructor=Y0;N2(Q0,Gc.prototype);Q0.isPureReactComponent=!0;var nw=Array.isArray,U2=Object.prototype.hasOwnProperty,J0={current:null},V2={key:!0,ref:!0,__self:!0,__source:!0};function $2(e,t,s){var l,p={},v=null,y=null;if(t!=null)for(l in t.ref!==void 0&&(y=t.ref),t.key!==void 0&&(v=""+t.key),t)U2.call(t,l)&&!V2.hasOwnProperty(l)&&(p[l]=t[l]);var c=arguments.length-2;if(c===1)p.children=s;else if(1<c){for(var M=Array(c),I=0;I<c;I++)M[I]=arguments[I+2];p.children=M}if(e&&e.defaultProps)for(l in c=e.defaultProps,c)p[l]===void 0&&(p[l]=c[l]);return{$$typeof:pf,type:e,key:v,ref:y,props:p,_owner:J0.current}}function II(e,t){return{$$typeof:pf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ev(e){return typeof e=="object"&&e!==null&&e.$$typeof===pf}function EI(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return t[s]})}var iw=/\/+/g;function Uy(e,t){return typeof e=="object"&&e!==null&&e.key!=null?EI(""+e.key):t.toString(36)}function Qp(e,t,s,l,p){var v=typeof e;(v==="undefined"||v==="boolean")&&(e=null);var y=!1;if(e===null)y=!0;else switch(v){case"string":case"number":y=!0;break;case"object":switch(e.$$typeof){case pf:case yI:y=!0}}if(y)return y=e,p=p(y),e=l===""?"."+Uy(y,0):l,nw(p)?(s="",e!=null&&(s=e.replace(iw,"$&/")+"/"),Qp(p,t,s,"",function(I){return I})):p!=null&&(ev(p)&&(p=II(p,s+(!p.key||y&&y.key===p.key?"":(""+p.key).replace(iw,"$&/")+"/")+e)),t.push(p)),1;if(y=0,l=l===""?".":l+":",nw(e))for(var c=0;c<e.length;c++){v=e[c];var M=l+Uy(v,c);y+=Qp(v,t,s,M,p)}else if(M=MI(e),typeof M=="function")for(e=M.call(e),c=0;!(v=e.next()).done;)v=v.value,M=l+Uy(v,c++),y+=Qp(v,t,s,M,p);else if(v==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return y}function Ep(e,t,s){if(e==null)return e;var l=[],p=0;return Qp(e,l,"","",function(v){return t.call(s,v,p++)}),l}function PI(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ri={current:null},Jp={transition:null},AI={ReactCurrentDispatcher:ri,ReactCurrentBatchConfig:Jp,ReactCurrentOwner:J0};function q2(){throw Error("act(...) is not supported in production builds of React.")}Ut.Children={map:Ep,forEach:function(e,t,s){Ep(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return Ep(e,function(){t++}),t},toArray:function(e){return Ep(e,function(t){return t})||[]},only:function(e){if(!ev(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ut.Component=Gc;Ut.Fragment=_I;Ut.Profiler=xI;Ut.PureComponent=Y0;Ut.StrictMode=vI;Ut.Suspense=kI;Ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AI;Ut.act=q2;Ut.cloneElement=function(e,t,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var l=N2({},e.props),p=e.key,v=e.ref,y=e._owner;if(t!=null){if(t.ref!==void 0&&(v=t.ref,y=J0.current),t.key!==void 0&&(p=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(M in t)U2.call(t,M)&&!V2.hasOwnProperty(M)&&(l[M]=t[M]===void 0&&c!==void 0?c[M]:t[M])}var M=arguments.length-2;if(M===1)l.children=s;else if(1<M){c=Array(M);for(var I=0;I<M;I++)c[I]=arguments[I+2];l.children=c}return{$$typeof:pf,type:e.type,key:p,ref:v,props:l,_owner:y}};Ut.createContext=function(e){return e={$$typeof:bI,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:wI,_context:e},e.Consumer=e};Ut.createElement=$2;Ut.createFactory=function(e){var t=$2.bind(null,e);return t.type=e,t};Ut.createRef=function(){return{current:null}};Ut.forwardRef=function(e){return{$$typeof:SI,render:e}};Ut.isValidElement=ev;Ut.lazy=function(e){return{$$typeof:CI,_payload:{_status:-1,_result:e},_init:PI}};Ut.memo=function(e,t){return{$$typeof:TI,type:e,compare:t===void 0?null:t}};Ut.startTransition=function(e){var t=Jp.transition;Jp.transition={};try{e()}finally{Jp.transition=t}};Ut.unstable_act=q2;Ut.useCallback=function(e,t){return ri.current.useCallback(e,t)};Ut.useContext=function(e){return ri.current.useContext(e)};Ut.useDebugValue=function(){};Ut.useDeferredValue=function(e){return ri.current.useDeferredValue(e)};Ut.useEffect=function(e,t){return ri.current.useEffect(e,t)};Ut.useId=function(){return ri.current.useId()};Ut.useImperativeHandle=function(e,t,s){return ri.current.useImperativeHandle(e,t,s)};Ut.useInsertionEffect=function(e,t){return ri.current.useInsertionEffect(e,t)};Ut.useLayoutEffect=function(e,t){return ri.current.useLayoutEffect(e,t)};Ut.useMemo=function(e,t){return ri.current.useMemo(e,t)};Ut.useReducer=function(e,t,s){return ri.current.useReducer(e,t,s)};Ut.useRef=function(e){return ri.current.useRef(e)};Ut.useState=function(e){return ri.current.useState(e)};Ut.useSyncExternalStore=function(e,t,s){return ri.current.useSyncExternalStore(e,t,s)};Ut.useTransition=function(){return ri.current.useTransition()};Ut.version="18.3.1";F2.exports=Ut;var Pe=F2.exports;const _d=L2(Pe),zI=mI({__proto__:null,default:_d},[Pe]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DI=Pe,LI=Symbol.for("react.element"),RI=Symbol.for("react.fragment"),FI=Object.prototype.hasOwnProperty,OI=DI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,NI={key:!0,ref:!0,__self:!0,__source:!0};function Z2(e,t,s){var l,p={},v=null,y=null;s!==void 0&&(v=""+s),t.key!==void 0&&(v=""+t.key),t.ref!==void 0&&(y=t.ref);for(l in t)FI.call(t,l)&&!NI.hasOwnProperty(l)&&(p[l]=t[l]);if(e&&e.defaultProps)for(l in t=e.defaultProps,t)p[l]===void 0&&(p[l]=t[l]);return{$$typeof:LI,type:e,key:v,ref:y,props:p,_owner:OI.current}}rg.Fragment=RI;rg.jsx=Z2;rg.jsxs=Z2;R2.exports=rg;var G=R2.exports,H2={exports:{}},ji={},G2={exports:{}},W2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Ke,yt){var ft=Ke.length;Ke.push(yt);e:for(;0<ft;){var Lt=ft-1>>>1,Wt=Ke[Lt];if(0<p(Wt,yt))Ke[Lt]=yt,Ke[ft]=Wt,ft=Lt;else break e}}function s(Ke){return Ke.length===0?null:Ke[0]}function l(Ke){if(Ke.length===0)return null;var yt=Ke[0],ft=Ke.pop();if(ft!==yt){Ke[0]=ft;e:for(var Lt=0,Wt=Ke.length,$n=Wt>>>1;Lt<$n;){var Vr=2*(Lt+1)-1,tn=Ke[Vr],rn=Vr+1,Dr=Ke[rn];if(0>p(tn,ft))rn<Wt&&0>p(Dr,tn)?(Ke[Lt]=Dr,Ke[rn]=ft,Lt=rn):(Ke[Lt]=tn,Ke[Vr]=ft,Lt=Vr);else if(rn<Wt&&0>p(Dr,ft))Ke[Lt]=Dr,Ke[rn]=ft,Lt=rn;else break e}}return yt}function p(Ke,yt){var ft=Ke.sortIndex-yt.sortIndex;return ft!==0?ft:Ke.id-yt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var v=performance;e.unstable_now=function(){return v.now()}}else{var y=Date,c=y.now();e.unstable_now=function(){return y.now()-c}}var M=[],I=[],j=1,z=null,R=3,X=!1,me=!1,he=!1,ge=typeof setTimeout=="function"?setTimeout:null,W=typeof clearTimeout=="function"?clearTimeout:null,Q=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function te(Ke){for(var yt=s(I);yt!==null;){if(yt.callback===null)l(I);else if(yt.startTime<=Ke)l(I),yt.sortIndex=yt.expirationTime,t(M,yt);else break;yt=s(I)}}function oe(Ke){if(he=!1,te(Ke),!me)if(s(M)!==null)me=!0,yn(Me);else{var yt=s(I);yt!==null&&Mr(oe,yt.startTime-Ke)}}function Me(Ke,yt){me=!1,he&&(he=!1,W(Fe),Fe=-1),X=!0;var ft=R;try{for(te(yt),z=s(M);z!==null&&(!(z.expirationTime>yt)||Ke&&!ht());){var Lt=z.callback;if(typeof Lt=="function"){z.callback=null,R=z.priorityLevel;var Wt=Lt(z.expirationTime<=yt);yt=e.unstable_now(),typeof Wt=="function"?z.callback=Wt:z===s(M)&&l(M),te(yt)}else l(M);z=s(M)}if(z!==null)var $n=!0;else{var Vr=s(I);Vr!==null&&Mr(oe,Vr.startTime-yt),$n=!1}return $n}finally{z=null,R=ft,X=!1}}var Se=!1,ze=null,Fe=-1,ct=5,it=-1;function ht(){return!(e.unstable_now()-it<ct)}function dt(){if(ze!==null){var Ke=e.unstable_now();it=Ke;var yt=!0;try{yt=ze(!0,Ke)}finally{yt?Pt():(Se=!1,ze=null)}}else Se=!1}var Pt;if(typeof Q=="function")Pt=function(){Q(dt)};else if(typeof MessageChannel<"u"){var Dt=new MessageChannel,pr=Dt.port2;Dt.port1.onmessage=dt,Pt=function(){pr.postMessage(null)}}else Pt=function(){ge(dt,0)};function yn(Ke){ze=Ke,Se||(Se=!0,Pt())}function Mr(Ke,yt){Fe=ge(function(){Ke(e.unstable_now())},yt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ke){Ke.callback=null},e.unstable_continueExecution=function(){me||X||(me=!0,yn(Me))},e.unstable_forceFrameRate=function(Ke){0>Ke||125<Ke?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ct=0<Ke?Math.floor(1e3/Ke):5},e.unstable_getCurrentPriorityLevel=function(){return R},e.unstable_getFirstCallbackNode=function(){return s(M)},e.unstable_next=function(Ke){switch(R){case 1:case 2:case 3:var yt=3;break;default:yt=R}var ft=R;R=yt;try{return Ke()}finally{R=ft}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Ke,yt){switch(Ke){case 1:case 2:case 3:case 4:case 5:break;default:Ke=3}var ft=R;R=Ke;try{return yt()}finally{R=ft}},e.unstable_scheduleCallback=function(Ke,yt,ft){var Lt=e.unstable_now();switch(typeof ft=="object"&&ft!==null?(ft=ft.delay,ft=typeof ft=="number"&&0<ft?Lt+ft:Lt):ft=Lt,Ke){case 1:var Wt=-1;break;case 2:Wt=250;break;case 5:Wt=1073741823;break;case 4:Wt=1e4;break;default:Wt=5e3}return Wt=ft+Wt,Ke={id:j++,callback:yt,priorityLevel:Ke,startTime:ft,expirationTime:Wt,sortIndex:-1},ft>Lt?(Ke.sortIndex=ft,t(I,Ke),s(M)===null&&Ke===s(I)&&(he?(W(Fe),Fe=-1):he=!0,Mr(oe,ft-Lt))):(Ke.sortIndex=Wt,t(M,Ke),me||X||(me=!0,yn(Me))),Ke},e.unstable_shouldYield=ht,e.unstable_wrapCallback=function(Ke){var yt=R;return function(){var ft=R;R=yt;try{return Ke.apply(this,arguments)}finally{R=ft}}}})(W2);G2.exports=W2;var BI=G2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jI=Pe,Ni=BI;function Ne(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var X2=new Set,Od={};function Jl(e,t){Rc(e,t),Rc(e+"Capture",t)}function Rc(e,t){for(Od[e]=t,e=0;e<t.length;e++)X2.add(t[e])}var ba=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),k_=Object.prototype.hasOwnProperty,UI=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,sw={},aw={};function VI(e){return k_.call(aw,e)?!0:k_.call(sw,e)?!1:UI.test(e)?aw[e]=!0:(sw[e]=!0,!1)}function $I(e,t,s,l){if(s!==null&&s.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return l?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qI(e,t,s,l){if(t===null||typeof t>"u"||$I(e,t,s,l))return!0;if(l)return!1;if(s!==null)switch(s.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ni(e,t,s,l,p,v,y){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=l,this.attributeNamespace=p,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=v,this.removeEmptyString=y}var In={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){In[e]=new ni(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];In[t]=new ni(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){In[e]=new ni(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){In[e]=new ni(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){In[e]=new ni(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){In[e]=new ni(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){In[e]=new ni(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){In[e]=new ni(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){In[e]=new ni(e,5,!1,e.toLowerCase(),null,!1,!1)});var tv=/[\-:]([a-z])/g;function rv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(tv,rv);In[t]=new ni(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(tv,rv);In[t]=new ni(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(tv,rv);In[t]=new ni(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){In[e]=new ni(e,1,!1,e.toLowerCase(),null,!1,!1)});In.xlinkHref=new ni("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){In[e]=new ni(e,1,!1,e.toLowerCase(),null,!0,!0)});function nv(e,t,s,l){var p=In.hasOwnProperty(t)?In[t]:null;(p!==null?p.type!==0:l||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(qI(t,s,p,l)&&(s=null),l||p===null?VI(t)&&(s===null?e.removeAttribute(t):e.setAttribute(t,""+s)):p.mustUseProperty?e[p.propertyName]=s===null?p.type===3?!1:"":s:(t=p.attributeName,l=p.attributeNamespace,s===null?e.removeAttribute(t):(p=p.type,s=p===3||p===4&&s===!0?"":""+s,l?e.setAttributeNS(l,t,s):e.setAttribute(t,s))))}var Ea=jI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Pp=Symbol.for("react.element"),rc=Symbol.for("react.portal"),nc=Symbol.for("react.fragment"),iv=Symbol.for("react.strict_mode"),T_=Symbol.for("react.profiler"),K2=Symbol.for("react.provider"),Y2=Symbol.for("react.context"),sv=Symbol.for("react.forward_ref"),C_=Symbol.for("react.suspense"),M_=Symbol.for("react.suspense_list"),av=Symbol.for("react.memo"),po=Symbol.for("react.lazy"),Q2=Symbol.for("react.offscreen"),ow=Symbol.iterator;function ad(e){return e===null||typeof e!="object"?null:(e=ow&&e[ow]||e["@@iterator"],typeof e=="function"?e:null)}var zr=Object.assign,Vy;function vd(e){if(Vy===void 0)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);Vy=t&&t[1]||""}return`
`+Vy+e}var $y=!1;function qy(e,t){if(!e||$y)return"";$y=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(I){var l=I}Reflect.construct(e,[],t)}else{try{t.call()}catch(I){l=I}e.call(t.prototype)}else{try{throw Error()}catch(I){l=I}e()}}catch(I){if(I&&l&&typeof I.stack=="string"){for(var p=I.stack.split(`
`),v=l.stack.split(`
`),y=p.length-1,c=v.length-1;1<=y&&0<=c&&p[y]!==v[c];)c--;for(;1<=y&&0<=c;y--,c--)if(p[y]!==v[c]){if(y!==1||c!==1)do if(y--,c--,0>c||p[y]!==v[c]){var M=`
`+p[y].replace(" at new "," at ");return e.displayName&&M.includes("<anonymous>")&&(M=M.replace("<anonymous>",e.displayName)),M}while(1<=y&&0<=c);break}}}finally{$y=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?vd(e):""}function ZI(e){switch(e.tag){case 5:return vd(e.type);case 16:return vd("Lazy");case 13:return vd("Suspense");case 19:return vd("SuspenseList");case 0:case 2:case 15:return e=qy(e.type,!1),e;case 11:return e=qy(e.type.render,!1),e;case 1:return e=qy(e.type,!0),e;default:return""}}function I_(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case nc:return"Fragment";case rc:return"Portal";case T_:return"Profiler";case iv:return"StrictMode";case C_:return"Suspense";case M_:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Y2:return(e.displayName||"Context")+".Consumer";case K2:return(e._context.displayName||"Context")+".Provider";case sv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case av:return t=e.displayName||null,t!==null?t:I_(e.type)||"Memo";case po:t=e._payload,e=e._init;try{return I_(e(t))}catch{}}return null}function HI(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return I_(t);case 8:return t===iv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Bo(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function J2(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function GI(e){var t=J2(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),l=""+e[t];if(!e.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var p=s.get,v=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return p.call(this)},set:function(y){l=""+y,v.call(this,y)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return l},setValue:function(y){l=""+y},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ap(e){e._valueTracker||(e._valueTracker=GI(e))}function eS(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),l="";return e&&(l=J2(e)?e.checked?"true":"false":e.value),e=l,e!==s?(t.setValue(e),!0):!1}function mm(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function E_(e,t){var s=t.checked;return zr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function lw(e,t){var s=t.defaultValue==null?"":t.defaultValue,l=t.checked!=null?t.checked:t.defaultChecked;s=Bo(t.value!=null?t.value:s),e._wrapperState={initialChecked:l,initialValue:s,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function tS(e,t){t=t.checked,t!=null&&nv(e,"checked",t,!1)}function P_(e,t){tS(e,t);var s=Bo(t.value),l=t.type;if(s!=null)l==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?A_(e,t.type,s):t.hasOwnProperty("defaultValue")&&A_(e,t.type,Bo(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function uw(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var l=t.type;if(!(l!=="submit"&&l!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function A_(e,t,s){(t!=="number"||mm(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var xd=Array.isArray;function gc(e,t,s,l){if(e=e.options,t){t={};for(var p=0;p<s.length;p++)t["$"+s[p]]=!0;for(s=0;s<e.length;s++)p=t.hasOwnProperty("$"+e[s].value),e[s].selected!==p&&(e[s].selected=p),p&&l&&(e[s].defaultSelected=!0)}else{for(s=""+Bo(s),t=null,p=0;p<e.length;p++){if(e[p].value===s){e[p].selected=!0,l&&(e[p].defaultSelected=!0);return}t!==null||e[p].disabled||(t=e[p])}t!==null&&(t.selected=!0)}}function z_(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ne(91));return zr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function cw(e,t){var s=t.value;if(s==null){if(s=t.children,t=t.defaultValue,s!=null){if(t!=null)throw Error(Ne(92));if(xd(s)){if(1<s.length)throw Error(Ne(93));s=s[0]}t=s}t==null&&(t=""),s=t}e._wrapperState={initialValue:Bo(s)}}function rS(e,t){var s=Bo(t.value),l=Bo(t.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),t.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),l!=null&&(e.defaultValue=""+l)}function hw(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function nS(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function D_(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?nS(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var zp,iS=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,s,l,p){MSApp.execUnsafeLocalFunction(function(){return e(t,s,l,p)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(zp=zp||document.createElement("div"),zp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=zp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Nd(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=t;return}}e.textContent=t}var Md={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},WI=["Webkit","ms","Moz","O"];Object.keys(Md).forEach(function(e){WI.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Md[t]=Md[e]})});function sS(e,t,s){return t==null||typeof t=="boolean"||t===""?"":s||typeof t!="number"||t===0||Md.hasOwnProperty(e)&&Md[e]?(""+t).trim():t+"px"}function aS(e,t){e=e.style;for(var s in t)if(t.hasOwnProperty(s)){var l=s.indexOf("--")===0,p=sS(s,t[s],l);s==="float"&&(s="cssFloat"),l?e.setProperty(s,p):e[s]=p}}var XI=zr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function L_(e,t){if(t){if(XI[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ne(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ne(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ne(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ne(62))}}function R_(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var F_=null;function ov(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var O_=null,yc=null,_c=null;function dw(e){if(e=yf(e)){if(typeof O_!="function")throw Error(Ne(280));var t=e.stateNode;t&&(t=og(t),O_(e.stateNode,e.type,t))}}function oS(e){yc?_c?_c.push(e):_c=[e]:yc=e}function lS(){if(yc){var e=yc,t=_c;if(_c=yc=null,dw(e),t)for(e=0;e<t.length;e++)dw(t[e])}}function uS(e,t){return e(t)}function cS(){}var Zy=!1;function hS(e,t,s){if(Zy)return e(t,s);Zy=!0;try{return uS(e,t,s)}finally{Zy=!1,(yc!==null||_c!==null)&&(cS(),lS())}}function Bd(e,t){var s=e.stateNode;if(s===null)return null;var l=og(s);if(l===null)return null;s=l[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(Ne(231,t,typeof s));return s}var N_=!1;if(ba)try{var od={};Object.defineProperty(od,"passive",{get:function(){N_=!0}}),window.addEventListener("test",od,od),window.removeEventListener("test",od,od)}catch{N_=!1}function KI(e,t,s,l,p,v,y,c,M){var I=Array.prototype.slice.call(arguments,3);try{t.apply(s,I)}catch(j){this.onError(j)}}var Id=!1,gm=null,ym=!1,B_=null,YI={onError:function(e){Id=!0,gm=e}};function QI(e,t,s,l,p,v,y,c,M){Id=!1,gm=null,KI.apply(YI,arguments)}function JI(e,t,s,l,p,v,y,c,M){if(QI.apply(this,arguments),Id){if(Id){var I=gm;Id=!1,gm=null}else throw Error(Ne(198));ym||(ym=!0,B_=I)}}function eu(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(s=t.return),e=t.return;while(e)}return t.tag===3?s:null}function dS(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function fw(e){if(eu(e)!==e)throw Error(Ne(188))}function eE(e){var t=e.alternate;if(!t){if(t=eu(e),t===null)throw Error(Ne(188));return t!==e?null:e}for(var s=e,l=t;;){var p=s.return;if(p===null)break;var v=p.alternate;if(v===null){if(l=p.return,l!==null){s=l;continue}break}if(p.child===v.child){for(v=p.child;v;){if(v===s)return fw(p),e;if(v===l)return fw(p),t;v=v.sibling}throw Error(Ne(188))}if(s.return!==l.return)s=p,l=v;else{for(var y=!1,c=p.child;c;){if(c===s){y=!0,s=p,l=v;break}if(c===l){y=!0,l=p,s=v;break}c=c.sibling}if(!y){for(c=v.child;c;){if(c===s){y=!0,s=v,l=p;break}if(c===l){y=!0,l=v,s=p;break}c=c.sibling}if(!y)throw Error(Ne(189))}}if(s.alternate!==l)throw Error(Ne(190))}if(s.tag!==3)throw Error(Ne(188));return s.stateNode.current===s?e:t}function fS(e){return e=eE(e),e!==null?pS(e):null}function pS(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=pS(e);if(t!==null)return t;e=e.sibling}return null}var mS=Ni.unstable_scheduleCallback,pw=Ni.unstable_cancelCallback,tE=Ni.unstable_shouldYield,rE=Ni.unstable_requestPaint,Ur=Ni.unstable_now,nE=Ni.unstable_getCurrentPriorityLevel,lv=Ni.unstable_ImmediatePriority,gS=Ni.unstable_UserBlockingPriority,_m=Ni.unstable_NormalPriority,iE=Ni.unstable_LowPriority,yS=Ni.unstable_IdlePriority,ng=null,qs=null;function sE(e){if(qs&&typeof qs.onCommitFiberRoot=="function")try{qs.onCommitFiberRoot(ng,e,void 0,(e.current.flags&128)===128)}catch{}}var bs=Math.clz32?Math.clz32:lE,aE=Math.log,oE=Math.LN2;function lE(e){return e>>>=0,e===0?32:31-(aE(e)/oE|0)|0}var Dp=64,Lp=4194304;function wd(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function vm(e,t){var s=e.pendingLanes;if(s===0)return 0;var l=0,p=e.suspendedLanes,v=e.pingedLanes,y=s&268435455;if(y!==0){var c=y&~p;c!==0?l=wd(c):(v&=y,v!==0&&(l=wd(v)))}else y=s&~p,y!==0?l=wd(y):v!==0&&(l=wd(v));if(l===0)return 0;if(t!==0&&t!==l&&!(t&p)&&(p=l&-l,v=t&-t,p>=v||p===16&&(v&4194240)!==0))return t;if(l&4&&(l|=s&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=l;0<t;)s=31-bs(t),p=1<<s,l|=e[s],t&=~p;return l}function uE(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cE(e,t){for(var s=e.suspendedLanes,l=e.pingedLanes,p=e.expirationTimes,v=e.pendingLanes;0<v;){var y=31-bs(v),c=1<<y,M=p[y];M===-1?(!(c&s)||c&l)&&(p[y]=uE(c,t)):M<=t&&(e.expiredLanes|=c),v&=~c}}function j_(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function _S(){var e=Dp;return Dp<<=1,!(Dp&4194240)&&(Dp=64),e}function Hy(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function mf(e,t,s){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-bs(t),e[t]=s}function hE(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<s;){var p=31-bs(s),v=1<<p;t[p]=0,l[p]=-1,e[p]=-1,s&=~v}}function uv(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var l=31-bs(s),p=1<<l;p&t|e[l]&t&&(e[l]|=t),s&=~p}}var lr=0;function vS(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var xS,cv,wS,bS,SS,U_=!1,Rp=[],Eo=null,Po=null,Ao=null,jd=new Map,Ud=new Map,go=[],dE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function mw(e,t){switch(e){case"focusin":case"focusout":Eo=null;break;case"dragenter":case"dragleave":Po=null;break;case"mouseover":case"mouseout":Ao=null;break;case"pointerover":case"pointerout":jd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ud.delete(t.pointerId)}}function ld(e,t,s,l,p,v){return e===null||e.nativeEvent!==v?(e={blockedOn:t,domEventName:s,eventSystemFlags:l,nativeEvent:v,targetContainers:[p]},t!==null&&(t=yf(t),t!==null&&cv(t)),e):(e.eventSystemFlags|=l,t=e.targetContainers,p!==null&&t.indexOf(p)===-1&&t.push(p),e)}function fE(e,t,s,l,p){switch(t){case"focusin":return Eo=ld(Eo,e,t,s,l,p),!0;case"dragenter":return Po=ld(Po,e,t,s,l,p),!0;case"mouseover":return Ao=ld(Ao,e,t,s,l,p),!0;case"pointerover":var v=p.pointerId;return jd.set(v,ld(jd.get(v)||null,e,t,s,l,p)),!0;case"gotpointercapture":return v=p.pointerId,Ud.set(v,ld(Ud.get(v)||null,e,t,s,l,p)),!0}return!1}function kS(e){var t=Tl(e.target);if(t!==null){var s=eu(t);if(s!==null){if(t=s.tag,t===13){if(t=dS(s),t!==null){e.blockedOn=t,SS(e.priority,function(){wS(s)});return}}else if(t===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function em(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var s=V_(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var l=new s.constructor(s.type,s);F_=l,s.target.dispatchEvent(l),F_=null}else return t=yf(s),t!==null&&cv(t),e.blockedOn=s,!1;t.shift()}return!0}function gw(e,t,s){em(e)&&s.delete(t)}function pE(){U_=!1,Eo!==null&&em(Eo)&&(Eo=null),Po!==null&&em(Po)&&(Po=null),Ao!==null&&em(Ao)&&(Ao=null),jd.forEach(gw),Ud.forEach(gw)}function ud(e,t){e.blockedOn===t&&(e.blockedOn=null,U_||(U_=!0,Ni.unstable_scheduleCallback(Ni.unstable_NormalPriority,pE)))}function Vd(e){function t(p){return ud(p,e)}if(0<Rp.length){ud(Rp[0],e);for(var s=1;s<Rp.length;s++){var l=Rp[s];l.blockedOn===e&&(l.blockedOn=null)}}for(Eo!==null&&ud(Eo,e),Po!==null&&ud(Po,e),Ao!==null&&ud(Ao,e),jd.forEach(t),Ud.forEach(t),s=0;s<go.length;s++)l=go[s],l.blockedOn===e&&(l.blockedOn=null);for(;0<go.length&&(s=go[0],s.blockedOn===null);)kS(s),s.blockedOn===null&&go.shift()}var vc=Ea.ReactCurrentBatchConfig,xm=!0;function mE(e,t,s,l){var p=lr,v=vc.transition;vc.transition=null;try{lr=1,hv(e,t,s,l)}finally{lr=p,vc.transition=v}}function gE(e,t,s,l){var p=lr,v=vc.transition;vc.transition=null;try{lr=4,hv(e,t,s,l)}finally{lr=p,vc.transition=v}}function hv(e,t,s,l){if(xm){var p=V_(e,t,s,l);if(p===null)r_(e,t,l,wm,s),mw(e,l);else if(fE(p,e,t,s,l))l.stopPropagation();else if(mw(e,l),t&4&&-1<dE.indexOf(e)){for(;p!==null;){var v=yf(p);if(v!==null&&xS(v),v=V_(e,t,s,l),v===null&&r_(e,t,l,wm,s),v===p)break;p=v}p!==null&&l.stopPropagation()}else r_(e,t,l,null,s)}}var wm=null;function V_(e,t,s,l){if(wm=null,e=ov(l),e=Tl(e),e!==null)if(t=eu(e),t===null)e=null;else if(s=t.tag,s===13){if(e=dS(t),e!==null)return e;e=null}else if(s===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return wm=e,null}function TS(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nE()){case lv:return 1;case gS:return 4;case _m:case iE:return 16;case yS:return 536870912;default:return 16}default:return 16}}var Co=null,dv=null,tm=null;function CS(){if(tm)return tm;var e,t=dv,s=t.length,l,p="value"in Co?Co.value:Co.textContent,v=p.length;for(e=0;e<s&&t[e]===p[e];e++);var y=s-e;for(l=1;l<=y&&t[s-l]===p[v-l];l++);return tm=p.slice(e,1<l?1-l:void 0)}function rm(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Fp(){return!0}function yw(){return!1}function Ui(e){function t(s,l,p,v,y){this._reactName=s,this._targetInst=p,this.type=l,this.nativeEvent=v,this.target=y,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(s=e[c],this[c]=s?s(v):v[c]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Fp:yw,this.isPropagationStopped=yw,this}return zr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=Fp)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=Fp)},persist:function(){},isPersistent:Fp}),t}var Wc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fv=Ui(Wc),gf=zr({},Wc,{view:0,detail:0}),yE=Ui(gf),Gy,Wy,cd,ig=zr({},gf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pv,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cd&&(cd&&e.type==="mousemove"?(Gy=e.screenX-cd.screenX,Wy=e.screenY-cd.screenY):Wy=Gy=0,cd=e),Gy)},movementY:function(e){return"movementY"in e?e.movementY:Wy}}),_w=Ui(ig),_E=zr({},ig,{dataTransfer:0}),vE=Ui(_E),xE=zr({},gf,{relatedTarget:0}),Xy=Ui(xE),wE=zr({},Wc,{animationName:0,elapsedTime:0,pseudoElement:0}),bE=Ui(wE),SE=zr({},Wc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),kE=Ui(SE),TE=zr({},Wc,{data:0}),vw=Ui(TE),CE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ME={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},IE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function EE(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=IE[e])?!!t[e]:!1}function pv(){return EE}var PE=zr({},gf,{key:function(e){if(e.key){var t=CE[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=rm(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ME[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pv,charCode:function(e){return e.type==="keypress"?rm(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?rm(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),AE=Ui(PE),zE=zr({},ig,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xw=Ui(zE),DE=zr({},gf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pv}),LE=Ui(DE),RE=zr({},Wc,{propertyName:0,elapsedTime:0,pseudoElement:0}),FE=Ui(RE),OE=zr({},ig,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),NE=Ui(OE),BE=[9,13,27,32],mv=ba&&"CompositionEvent"in window,Ed=null;ba&&"documentMode"in document&&(Ed=document.documentMode);var jE=ba&&"TextEvent"in window&&!Ed,MS=ba&&(!mv||Ed&&8<Ed&&11>=Ed),ww=" ",bw=!1;function IS(e,t){switch(e){case"keyup":return BE.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ES(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ic=!1;function UE(e,t){switch(e){case"compositionend":return ES(t);case"keypress":return t.which!==32?null:(bw=!0,ww);case"textInput":return e=t.data,e===ww&&bw?null:e;default:return null}}function VE(e,t){if(ic)return e==="compositionend"||!mv&&IS(e,t)?(e=CS(),tm=dv=Co=null,ic=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return MS&&t.locale!=="ko"?null:t.data;default:return null}}var $E={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sw(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!$E[e.type]:t==="textarea"}function PS(e,t,s,l){oS(l),t=bm(t,"onChange"),0<t.length&&(s=new fv("onChange","change",null,s,l),e.push({event:s,listeners:t}))}var Pd=null,$d=null;function qE(e){US(e,0)}function sg(e){var t=oc(e);if(eS(t))return e}function ZE(e,t){if(e==="change")return t}var AS=!1;if(ba){var Ky;if(ba){var Yy="oninput"in document;if(!Yy){var kw=document.createElement("div");kw.setAttribute("oninput","return;"),Yy=typeof kw.oninput=="function"}Ky=Yy}else Ky=!1;AS=Ky&&(!document.documentMode||9<document.documentMode)}function Tw(){Pd&&(Pd.detachEvent("onpropertychange",zS),$d=Pd=null)}function zS(e){if(e.propertyName==="value"&&sg($d)){var t=[];PS(t,$d,e,ov(e)),hS(qE,t)}}function HE(e,t,s){e==="focusin"?(Tw(),Pd=t,$d=s,Pd.attachEvent("onpropertychange",zS)):e==="focusout"&&Tw()}function GE(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return sg($d)}function WE(e,t){if(e==="click")return sg(t)}function XE(e,t){if(e==="input"||e==="change")return sg(t)}function KE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ks=typeof Object.is=="function"?Object.is:KE;function qd(e,t){if(ks(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var s=Object.keys(e),l=Object.keys(t);if(s.length!==l.length)return!1;for(l=0;l<s.length;l++){var p=s[l];if(!k_.call(t,p)||!ks(e[p],t[p]))return!1}return!0}function Cw(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Mw(e,t){var s=Cw(e);e=0;for(var l;s;){if(s.nodeType===3){if(l=e+s.textContent.length,e<=t&&l>=t)return{node:s,offset:t-e};e=l}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Cw(s)}}function DS(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?DS(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function LS(){for(var e=window,t=mm();t instanceof e.HTMLIFrameElement;){try{var s=typeof t.contentWindow.location.href=="string"}catch{s=!1}if(s)e=t.contentWindow;else break;t=mm(e.document)}return t}function gv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function YE(e){var t=LS(),s=e.focusedElem,l=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&DS(s.ownerDocument.documentElement,s)){if(l!==null&&gv(s)){if(t=l.start,e=l.end,e===void 0&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if(e=(t=s.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var p=s.textContent.length,v=Math.min(l.start,p);l=l.end===void 0?v:Math.min(l.end,p),!e.extend&&v>l&&(p=l,l=v,v=p),p=Mw(s,v);var y=Mw(s,l);p&&y&&(e.rangeCount!==1||e.anchorNode!==p.node||e.anchorOffset!==p.offset||e.focusNode!==y.node||e.focusOffset!==y.offset)&&(t=t.createRange(),t.setStart(p.node,p.offset),e.removeAllRanges(),v>l?(e.addRange(t),e.extend(y.node,y.offset)):(t.setEnd(y.node,y.offset),e.addRange(t)))}}for(t=[],e=s;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<t.length;s++)e=t[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var QE=ba&&"documentMode"in document&&11>=document.documentMode,sc=null,$_=null,Ad=null,q_=!1;function Iw(e,t,s){var l=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;q_||sc==null||sc!==mm(l)||(l=sc,"selectionStart"in l&&gv(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Ad&&qd(Ad,l)||(Ad=l,l=bm($_,"onSelect"),0<l.length&&(t=new fv("onSelect","select",null,t,s),e.push({event:t,listeners:l}),t.target=sc)))}function Op(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var ac={animationend:Op("Animation","AnimationEnd"),animationiteration:Op("Animation","AnimationIteration"),animationstart:Op("Animation","AnimationStart"),transitionend:Op("Transition","TransitionEnd")},Qy={},RS={};ba&&(RS=document.createElement("div").style,"AnimationEvent"in window||(delete ac.animationend.animation,delete ac.animationiteration.animation,delete ac.animationstart.animation),"TransitionEvent"in window||delete ac.transitionend.transition);function ag(e){if(Qy[e])return Qy[e];if(!ac[e])return e;var t=ac[e],s;for(s in t)if(t.hasOwnProperty(s)&&s in RS)return Qy[e]=t[s];return e}var FS=ag("animationend"),OS=ag("animationiteration"),NS=ag("animationstart"),BS=ag("transitionend"),jS=new Map,Ew="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Uo(e,t){jS.set(e,t),Jl(t,[e])}for(var Jy=0;Jy<Ew.length;Jy++){var e_=Ew[Jy],JE=e_.toLowerCase(),eP=e_[0].toUpperCase()+e_.slice(1);Uo(JE,"on"+eP)}Uo(FS,"onAnimationEnd");Uo(OS,"onAnimationIteration");Uo(NS,"onAnimationStart");Uo("dblclick","onDoubleClick");Uo("focusin","onFocus");Uo("focusout","onBlur");Uo(BS,"onTransitionEnd");Rc("onMouseEnter",["mouseout","mouseover"]);Rc("onMouseLeave",["mouseout","mouseover"]);Rc("onPointerEnter",["pointerout","pointerover"]);Rc("onPointerLeave",["pointerout","pointerover"]);Jl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Jl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Jl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Jl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Jl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Jl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tP=new Set("cancel close invalid load scroll toggle".split(" ").concat(bd));function Pw(e,t,s){var l=e.type||"unknown-event";e.currentTarget=s,JI(l,t,void 0,e),e.currentTarget=null}function US(e,t){t=(t&4)!==0;for(var s=0;s<e.length;s++){var l=e[s],p=l.event;l=l.listeners;e:{var v=void 0;if(t)for(var y=l.length-1;0<=y;y--){var c=l[y],M=c.instance,I=c.currentTarget;if(c=c.listener,M!==v&&p.isPropagationStopped())break e;Pw(p,c,I),v=M}else for(y=0;y<l.length;y++){if(c=l[y],M=c.instance,I=c.currentTarget,c=c.listener,M!==v&&p.isPropagationStopped())break e;Pw(p,c,I),v=M}}}if(ym)throw e=B_,ym=!1,B_=null,e}function wr(e,t){var s=t[X_];s===void 0&&(s=t[X_]=new Set);var l=e+"__bubble";s.has(l)||(VS(t,e,2,!1),s.add(l))}function t_(e,t,s){var l=0;t&&(l|=4),VS(s,e,l,t)}var Np="_reactListening"+Math.random().toString(36).slice(2);function Zd(e){if(!e[Np]){e[Np]=!0,X2.forEach(function(s){s!=="selectionchange"&&(tP.has(s)||t_(s,!1,e),t_(s,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Np]||(t[Np]=!0,t_("selectionchange",!1,t))}}function VS(e,t,s,l){switch(TS(t)){case 1:var p=mE;break;case 4:p=gE;break;default:p=hv}s=p.bind(null,t,s,e),p=void 0,!N_||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(p=!0),l?p!==void 0?e.addEventListener(t,s,{capture:!0,passive:p}):e.addEventListener(t,s,!0):p!==void 0?e.addEventListener(t,s,{passive:p}):e.addEventListener(t,s,!1)}function r_(e,t,s,l,p){var v=l;if(!(t&1)&&!(t&2)&&l!==null)e:for(;;){if(l===null)return;var y=l.tag;if(y===3||y===4){var c=l.stateNode.containerInfo;if(c===p||c.nodeType===8&&c.parentNode===p)break;if(y===4)for(y=l.return;y!==null;){var M=y.tag;if((M===3||M===4)&&(M=y.stateNode.containerInfo,M===p||M.nodeType===8&&M.parentNode===p))return;y=y.return}for(;c!==null;){if(y=Tl(c),y===null)return;if(M=y.tag,M===5||M===6){l=v=y;continue e}c=c.parentNode}}l=l.return}hS(function(){var I=v,j=ov(s),z=[];e:{var R=jS.get(e);if(R!==void 0){var X=fv,me=e;switch(e){case"keypress":if(rm(s)===0)break e;case"keydown":case"keyup":X=AE;break;case"focusin":me="focus",X=Xy;break;case"focusout":me="blur",X=Xy;break;case"beforeblur":case"afterblur":X=Xy;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":X=_w;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":X=vE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":X=LE;break;case FS:case OS:case NS:X=bE;break;case BS:X=FE;break;case"scroll":X=yE;break;case"wheel":X=NE;break;case"copy":case"cut":case"paste":X=kE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":X=xw}var he=(t&4)!==0,ge=!he&&e==="scroll",W=he?R!==null?R+"Capture":null:R;he=[];for(var Q=I,te;Q!==null;){te=Q;var oe=te.stateNode;if(te.tag===5&&oe!==null&&(te=oe,W!==null&&(oe=Bd(Q,W),oe!=null&&he.push(Hd(Q,oe,te)))),ge)break;Q=Q.return}0<he.length&&(R=new X(R,me,null,s,j),z.push({event:R,listeners:he}))}}if(!(t&7)){e:{if(R=e==="mouseover"||e==="pointerover",X=e==="mouseout"||e==="pointerout",R&&s!==F_&&(me=s.relatedTarget||s.fromElement)&&(Tl(me)||me[Sa]))break e;if((X||R)&&(R=j.window===j?j:(R=j.ownerDocument)?R.defaultView||R.parentWindow:window,X?(me=s.relatedTarget||s.toElement,X=I,me=me?Tl(me):null,me!==null&&(ge=eu(me),me!==ge||me.tag!==5&&me.tag!==6)&&(me=null)):(X=null,me=I),X!==me)){if(he=_w,oe="onMouseLeave",W="onMouseEnter",Q="mouse",(e==="pointerout"||e==="pointerover")&&(he=xw,oe="onPointerLeave",W="onPointerEnter",Q="pointer"),ge=X==null?R:oc(X),te=me==null?R:oc(me),R=new he(oe,Q+"leave",X,s,j),R.target=ge,R.relatedTarget=te,oe=null,Tl(j)===I&&(he=new he(W,Q+"enter",me,s,j),he.target=te,he.relatedTarget=ge,oe=he),ge=oe,X&&me)t:{for(he=X,W=me,Q=0,te=he;te;te=Ju(te))Q++;for(te=0,oe=W;oe;oe=Ju(oe))te++;for(;0<Q-te;)he=Ju(he),Q--;for(;0<te-Q;)W=Ju(W),te--;for(;Q--;){if(he===W||W!==null&&he===W.alternate)break t;he=Ju(he),W=Ju(W)}he=null}else he=null;X!==null&&Aw(z,R,X,he,!1),me!==null&&ge!==null&&Aw(z,ge,me,he,!0)}}e:{if(R=I?oc(I):window,X=R.nodeName&&R.nodeName.toLowerCase(),X==="select"||X==="input"&&R.type==="file")var Me=ZE;else if(Sw(R))if(AS)Me=XE;else{Me=GE;var Se=HE}else(X=R.nodeName)&&X.toLowerCase()==="input"&&(R.type==="checkbox"||R.type==="radio")&&(Me=WE);if(Me&&(Me=Me(e,I))){PS(z,Me,s,j);break e}Se&&Se(e,R,I),e==="focusout"&&(Se=R._wrapperState)&&Se.controlled&&R.type==="number"&&A_(R,"number",R.value)}switch(Se=I?oc(I):window,e){case"focusin":(Sw(Se)||Se.contentEditable==="true")&&(sc=Se,$_=I,Ad=null);break;case"focusout":Ad=$_=sc=null;break;case"mousedown":q_=!0;break;case"contextmenu":case"mouseup":case"dragend":q_=!1,Iw(z,s,j);break;case"selectionchange":if(QE)break;case"keydown":case"keyup":Iw(z,s,j)}var ze;if(mv)e:{switch(e){case"compositionstart":var Fe="onCompositionStart";break e;case"compositionend":Fe="onCompositionEnd";break e;case"compositionupdate":Fe="onCompositionUpdate";break e}Fe=void 0}else ic?IS(e,s)&&(Fe="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(Fe="onCompositionStart");Fe&&(MS&&s.locale!=="ko"&&(ic||Fe!=="onCompositionStart"?Fe==="onCompositionEnd"&&ic&&(ze=CS()):(Co=j,dv="value"in Co?Co.value:Co.textContent,ic=!0)),Se=bm(I,Fe),0<Se.length&&(Fe=new vw(Fe,e,null,s,j),z.push({event:Fe,listeners:Se}),ze?Fe.data=ze:(ze=ES(s),ze!==null&&(Fe.data=ze)))),(ze=jE?UE(e,s):VE(e,s))&&(I=bm(I,"onBeforeInput"),0<I.length&&(j=new vw("onBeforeInput","beforeinput",null,s,j),z.push({event:j,listeners:I}),j.data=ze))}US(z,t)})}function Hd(e,t,s){return{instance:e,listener:t,currentTarget:s}}function bm(e,t){for(var s=t+"Capture",l=[];e!==null;){var p=e,v=p.stateNode;p.tag===5&&v!==null&&(p=v,v=Bd(e,s),v!=null&&l.unshift(Hd(e,v,p)),v=Bd(e,t),v!=null&&l.push(Hd(e,v,p))),e=e.return}return l}function Ju(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Aw(e,t,s,l,p){for(var v=t._reactName,y=[];s!==null&&s!==l;){var c=s,M=c.alternate,I=c.stateNode;if(M!==null&&M===l)break;c.tag===5&&I!==null&&(c=I,p?(M=Bd(s,v),M!=null&&y.unshift(Hd(s,M,c))):p||(M=Bd(s,v),M!=null&&y.push(Hd(s,M,c)))),s=s.return}y.length!==0&&e.push({event:t,listeners:y})}var rP=/\r\n?/g,nP=/\u0000|\uFFFD/g;function zw(e){return(typeof e=="string"?e:""+e).replace(rP,`
`).replace(nP,"")}function Bp(e,t,s){if(t=zw(t),zw(e)!==t&&s)throw Error(Ne(425))}function Sm(){}var Z_=null,H_=null;function G_(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var W_=typeof setTimeout=="function"?setTimeout:void 0,iP=typeof clearTimeout=="function"?clearTimeout:void 0,Dw=typeof Promise=="function"?Promise:void 0,sP=typeof queueMicrotask=="function"?queueMicrotask:typeof Dw<"u"?function(e){return Dw.resolve(null).then(e).catch(aP)}:W_;function aP(e){setTimeout(function(){throw e})}function n_(e,t){var s=t,l=0;do{var p=s.nextSibling;if(e.removeChild(s),p&&p.nodeType===8)if(s=p.data,s==="/$"){if(l===0){e.removeChild(p),Vd(t);return}l--}else s!=="$"&&s!=="$?"&&s!=="$!"||l++;s=p}while(s);Vd(t)}function zo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Lw(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(t===0)return e;t--}else s==="/$"&&t++}e=e.previousSibling}return null}var Xc=Math.random().toString(36).slice(2),$s="__reactFiber$"+Xc,Gd="__reactProps$"+Xc,Sa="__reactContainer$"+Xc,X_="__reactEvents$"+Xc,oP="__reactListeners$"+Xc,lP="__reactHandles$"+Xc;function Tl(e){var t=e[$s];if(t)return t;for(var s=e.parentNode;s;){if(t=s[Sa]||s[$s]){if(s=t.alternate,t.child!==null||s!==null&&s.child!==null)for(e=Lw(e);e!==null;){if(s=e[$s])return s;e=Lw(e)}return t}e=s,s=e.parentNode}return null}function yf(e){return e=e[$s]||e[Sa],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function oc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ne(33))}function og(e){return e[Gd]||null}var K_=[],lc=-1;function Vo(e){return{current:e}}function br(e){0>lc||(e.current=K_[lc],K_[lc]=null,lc--)}function gr(e,t){lc++,K_[lc]=e.current,e.current=t}var jo={},Vn=Vo(jo),_i=Vo(!1),ql=jo;function Fc(e,t){var s=e.type.contextTypes;if(!s)return jo;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===t)return l.__reactInternalMemoizedMaskedChildContext;var p={},v;for(v in s)p[v]=t[v];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=p),p}function vi(e){return e=e.childContextTypes,e!=null}function km(){br(_i),br(Vn)}function Rw(e,t,s){if(Vn.current!==jo)throw Error(Ne(168));gr(Vn,t),gr(_i,s)}function $S(e,t,s){var l=e.stateNode;if(t=t.childContextTypes,typeof l.getChildContext!="function")return s;l=l.getChildContext();for(var p in l)if(!(p in t))throw Error(Ne(108,HI(e)||"Unknown",p));return zr({},s,l)}function Tm(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||jo,ql=Vn.current,gr(Vn,e),gr(_i,_i.current),!0}function Fw(e,t,s){var l=e.stateNode;if(!l)throw Error(Ne(169));s?(e=$S(e,t,ql),l.__reactInternalMemoizedMergedChildContext=e,br(_i),br(Vn),gr(Vn,e)):br(_i),gr(_i,s)}var pa=null,lg=!1,i_=!1;function qS(e){pa===null?pa=[e]:pa.push(e)}function uP(e){lg=!0,qS(e)}function $o(){if(!i_&&pa!==null){i_=!0;var e=0,t=lr;try{var s=pa;for(lr=1;e<s.length;e++){var l=s[e];do l=l(!0);while(l!==null)}pa=null,lg=!1}catch(p){throw pa!==null&&(pa=pa.slice(e+1)),mS(lv,$o),p}finally{lr=t,i_=!1}}return null}var uc=[],cc=0,Cm=null,Mm=0,es=[],ts=0,Zl=null,ya=1,_a="";function bl(e,t){uc[cc++]=Mm,uc[cc++]=Cm,Cm=e,Mm=t}function ZS(e,t,s){es[ts++]=ya,es[ts++]=_a,es[ts++]=Zl,Zl=e;var l=ya;e=_a;var p=32-bs(l)-1;l&=~(1<<p),s+=1;var v=32-bs(t)+p;if(30<v){var y=p-p%5;v=(l&(1<<y)-1).toString(32),l>>=y,p-=y,ya=1<<32-bs(t)+p|s<<p|l,_a=v+e}else ya=1<<v|s<<p|l,_a=e}function yv(e){e.return!==null&&(bl(e,1),ZS(e,1,0))}function _v(e){for(;e===Cm;)Cm=uc[--cc],uc[cc]=null,Mm=uc[--cc],uc[cc]=null;for(;e===Zl;)Zl=es[--ts],es[ts]=null,_a=es[--ts],es[ts]=null,ya=es[--ts],es[ts]=null}var Oi=null,Fi=null,Cr=!1,vs=null;function HS(e,t){var s=rs(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,t=e.deletions,t===null?(e.deletions=[s],e.flags|=16):t.push(s)}function Ow(e,t){switch(e.tag){case 5:var s=e.type;return t=t.nodeType!==1||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Oi=e,Fi=zo(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Oi=e,Fi=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(s=Zl!==null?{id:ya,overflow:_a}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},s=rs(18,null,null,0),s.stateNode=t,s.return=e,e.child=s,Oi=e,Fi=null,!0):!1;default:return!1}}function Y_(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Q_(e){if(Cr){var t=Fi;if(t){var s=t;if(!Ow(e,t)){if(Y_(e))throw Error(Ne(418));t=zo(s.nextSibling);var l=Oi;t&&Ow(e,t)?HS(l,s):(e.flags=e.flags&-4097|2,Cr=!1,Oi=e)}}else{if(Y_(e))throw Error(Ne(418));e.flags=e.flags&-4097|2,Cr=!1,Oi=e}}}function Nw(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Oi=e}function jp(e){if(e!==Oi)return!1;if(!Cr)return Nw(e),Cr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!G_(e.type,e.memoizedProps)),t&&(t=Fi)){if(Y_(e))throw GS(),Error(Ne(418));for(;t;)HS(e,t),t=zo(t.nextSibling)}if(Nw(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ne(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(t===0){Fi=zo(e.nextSibling);break e}t--}else s!=="$"&&s!=="$!"&&s!=="$?"||t++}e=e.nextSibling}Fi=null}}else Fi=Oi?zo(e.stateNode.nextSibling):null;return!0}function GS(){for(var e=Fi;e;)e=zo(e.nextSibling)}function Oc(){Fi=Oi=null,Cr=!1}function vv(e){vs===null?vs=[e]:vs.push(e)}var cP=Ea.ReactCurrentBatchConfig;function hd(e,t,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(Ne(309));var l=s.stateNode}if(!l)throw Error(Ne(147,e));var p=l,v=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===v?t.ref:(t=function(y){var c=p.refs;y===null?delete c[v]:c[v]=y},t._stringRef=v,t)}if(typeof e!="string")throw Error(Ne(284));if(!s._owner)throw Error(Ne(290,e))}return e}function Up(e,t){throw e=Object.prototype.toString.call(t),Error(Ne(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Bw(e){var t=e._init;return t(e._payload)}function WS(e){function t(W,Q){if(e){var te=W.deletions;te===null?(W.deletions=[Q],W.flags|=16):te.push(Q)}}function s(W,Q){if(!e)return null;for(;Q!==null;)t(W,Q),Q=Q.sibling;return null}function l(W,Q){for(W=new Map;Q!==null;)Q.key!==null?W.set(Q.key,Q):W.set(Q.index,Q),Q=Q.sibling;return W}function p(W,Q){return W=Fo(W,Q),W.index=0,W.sibling=null,W}function v(W,Q,te){return W.index=te,e?(te=W.alternate,te!==null?(te=te.index,te<Q?(W.flags|=2,Q):te):(W.flags|=2,Q)):(W.flags|=1048576,Q)}function y(W){return e&&W.alternate===null&&(W.flags|=2),W}function c(W,Q,te,oe){return Q===null||Q.tag!==6?(Q=h_(te,W.mode,oe),Q.return=W,Q):(Q=p(Q,te),Q.return=W,Q)}function M(W,Q,te,oe){var Me=te.type;return Me===nc?j(W,Q,te.props.children,oe,te.key):Q!==null&&(Q.elementType===Me||typeof Me=="object"&&Me!==null&&Me.$$typeof===po&&Bw(Me)===Q.type)?(oe=p(Q,te.props),oe.ref=hd(W,Q,te),oe.return=W,oe):(oe=um(te.type,te.key,te.props,null,W.mode,oe),oe.ref=hd(W,Q,te),oe.return=W,oe)}function I(W,Q,te,oe){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==te.containerInfo||Q.stateNode.implementation!==te.implementation?(Q=d_(te,W.mode,oe),Q.return=W,Q):(Q=p(Q,te.children||[]),Q.return=W,Q)}function j(W,Q,te,oe,Me){return Q===null||Q.tag!==7?(Q=Ul(te,W.mode,oe,Me),Q.return=W,Q):(Q=p(Q,te),Q.return=W,Q)}function z(W,Q,te){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Q=h_(""+Q,W.mode,te),Q.return=W,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case Pp:return te=um(Q.type,Q.key,Q.props,null,W.mode,te),te.ref=hd(W,null,Q),te.return=W,te;case rc:return Q=d_(Q,W.mode,te),Q.return=W,Q;case po:var oe=Q._init;return z(W,oe(Q._payload),te)}if(xd(Q)||ad(Q))return Q=Ul(Q,W.mode,te,null),Q.return=W,Q;Up(W,Q)}return null}function R(W,Q,te,oe){var Me=Q!==null?Q.key:null;if(typeof te=="string"&&te!==""||typeof te=="number")return Me!==null?null:c(W,Q,""+te,oe);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case Pp:return te.key===Me?M(W,Q,te,oe):null;case rc:return te.key===Me?I(W,Q,te,oe):null;case po:return Me=te._init,R(W,Q,Me(te._payload),oe)}if(xd(te)||ad(te))return Me!==null?null:j(W,Q,te,oe,null);Up(W,te)}return null}function X(W,Q,te,oe,Me){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return W=W.get(te)||null,c(Q,W,""+oe,Me);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case Pp:return W=W.get(oe.key===null?te:oe.key)||null,M(Q,W,oe,Me);case rc:return W=W.get(oe.key===null?te:oe.key)||null,I(Q,W,oe,Me);case po:var Se=oe._init;return X(W,Q,te,Se(oe._payload),Me)}if(xd(oe)||ad(oe))return W=W.get(te)||null,j(Q,W,oe,Me,null);Up(Q,oe)}return null}function me(W,Q,te,oe){for(var Me=null,Se=null,ze=Q,Fe=Q=0,ct=null;ze!==null&&Fe<te.length;Fe++){ze.index>Fe?(ct=ze,ze=null):ct=ze.sibling;var it=R(W,ze,te[Fe],oe);if(it===null){ze===null&&(ze=ct);break}e&&ze&&it.alternate===null&&t(W,ze),Q=v(it,Q,Fe),Se===null?Me=it:Se.sibling=it,Se=it,ze=ct}if(Fe===te.length)return s(W,ze),Cr&&bl(W,Fe),Me;if(ze===null){for(;Fe<te.length;Fe++)ze=z(W,te[Fe],oe),ze!==null&&(Q=v(ze,Q,Fe),Se===null?Me=ze:Se.sibling=ze,Se=ze);return Cr&&bl(W,Fe),Me}for(ze=l(W,ze);Fe<te.length;Fe++)ct=X(ze,W,Fe,te[Fe],oe),ct!==null&&(e&&ct.alternate!==null&&ze.delete(ct.key===null?Fe:ct.key),Q=v(ct,Q,Fe),Se===null?Me=ct:Se.sibling=ct,Se=ct);return e&&ze.forEach(function(ht){return t(W,ht)}),Cr&&bl(W,Fe),Me}function he(W,Q,te,oe){var Me=ad(te);if(typeof Me!="function")throw Error(Ne(150));if(te=Me.call(te),te==null)throw Error(Ne(151));for(var Se=Me=null,ze=Q,Fe=Q=0,ct=null,it=te.next();ze!==null&&!it.done;Fe++,it=te.next()){ze.index>Fe?(ct=ze,ze=null):ct=ze.sibling;var ht=R(W,ze,it.value,oe);if(ht===null){ze===null&&(ze=ct);break}e&&ze&&ht.alternate===null&&t(W,ze),Q=v(ht,Q,Fe),Se===null?Me=ht:Se.sibling=ht,Se=ht,ze=ct}if(it.done)return s(W,ze),Cr&&bl(W,Fe),Me;if(ze===null){for(;!it.done;Fe++,it=te.next())it=z(W,it.value,oe),it!==null&&(Q=v(it,Q,Fe),Se===null?Me=it:Se.sibling=it,Se=it);return Cr&&bl(W,Fe),Me}for(ze=l(W,ze);!it.done;Fe++,it=te.next())it=X(ze,W,Fe,it.value,oe),it!==null&&(e&&it.alternate!==null&&ze.delete(it.key===null?Fe:it.key),Q=v(it,Q,Fe),Se===null?Me=it:Se.sibling=it,Se=it);return e&&ze.forEach(function(dt){return t(W,dt)}),Cr&&bl(W,Fe),Me}function ge(W,Q,te,oe){if(typeof te=="object"&&te!==null&&te.type===nc&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case Pp:e:{for(var Me=te.key,Se=Q;Se!==null;){if(Se.key===Me){if(Me=te.type,Me===nc){if(Se.tag===7){s(W,Se.sibling),Q=p(Se,te.props.children),Q.return=W,W=Q;break e}}else if(Se.elementType===Me||typeof Me=="object"&&Me!==null&&Me.$$typeof===po&&Bw(Me)===Se.type){s(W,Se.sibling),Q=p(Se,te.props),Q.ref=hd(W,Se,te),Q.return=W,W=Q;break e}s(W,Se);break}else t(W,Se);Se=Se.sibling}te.type===nc?(Q=Ul(te.props.children,W.mode,oe,te.key),Q.return=W,W=Q):(oe=um(te.type,te.key,te.props,null,W.mode,oe),oe.ref=hd(W,Q,te),oe.return=W,W=oe)}return y(W);case rc:e:{for(Se=te.key;Q!==null;){if(Q.key===Se)if(Q.tag===4&&Q.stateNode.containerInfo===te.containerInfo&&Q.stateNode.implementation===te.implementation){s(W,Q.sibling),Q=p(Q,te.children||[]),Q.return=W,W=Q;break e}else{s(W,Q);break}else t(W,Q);Q=Q.sibling}Q=d_(te,W.mode,oe),Q.return=W,W=Q}return y(W);case po:return Se=te._init,ge(W,Q,Se(te._payload),oe)}if(xd(te))return me(W,Q,te,oe);if(ad(te))return he(W,Q,te,oe);Up(W,te)}return typeof te=="string"&&te!==""||typeof te=="number"?(te=""+te,Q!==null&&Q.tag===6?(s(W,Q.sibling),Q=p(Q,te),Q.return=W,W=Q):(s(W,Q),Q=h_(te,W.mode,oe),Q.return=W,W=Q),y(W)):s(W,Q)}return ge}var Nc=WS(!0),XS=WS(!1),Im=Vo(null),Em=null,hc=null,xv=null;function wv(){xv=hc=Em=null}function bv(e){var t=Im.current;br(Im),e._currentValue=t}function J_(e,t,s){for(;e!==null;){var l=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,l!==null&&(l.childLanes|=t)):l!==null&&(l.childLanes&t)!==t&&(l.childLanes|=t),e===s)break;e=e.return}}function xc(e,t){Em=e,xv=hc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(gi=!0),e.firstContext=null)}function ss(e){var t=e._currentValue;if(xv!==e)if(e={context:e,memoizedValue:t,next:null},hc===null){if(Em===null)throw Error(Ne(308));hc=e,Em.dependencies={lanes:0,firstContext:e}}else hc=hc.next=e;return t}var Cl=null;function Sv(e){Cl===null?Cl=[e]:Cl.push(e)}function KS(e,t,s,l){var p=t.interleaved;return p===null?(s.next=s,Sv(t)):(s.next=p.next,p.next=s),t.interleaved=s,ka(e,l)}function ka(e,t){e.lanes|=t;var s=e.alternate;for(s!==null&&(s.lanes|=t),s=e,e=e.return;e!==null;)e.childLanes|=t,s=e.alternate,s!==null&&(s.childLanes|=t),s=e,e=e.return;return s.tag===3?s.stateNode:null}var mo=!1;function kv(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function YS(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function wa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Do(e,t,s){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,Kt&2){var p=l.pending;return p===null?t.next=t:(t.next=p.next,p.next=t),l.pending=t,ka(e,s)}return p=l.interleaved,p===null?(t.next=t,Sv(l)):(t.next=p.next,p.next=t),l.interleaved=t,ka(e,s)}function nm(e,t,s){if(t=t.updateQueue,t!==null&&(t=t.shared,(s&4194240)!==0)){var l=t.lanes;l&=e.pendingLanes,s|=l,t.lanes=s,uv(e,s)}}function jw(e,t){var s=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,s===l)){var p=null,v=null;if(s=s.firstBaseUpdate,s!==null){do{var y={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};v===null?p=v=y:v=v.next=y,s=s.next}while(s!==null);v===null?p=v=t:v=v.next=t}else p=v=t;s={baseState:l.baseState,firstBaseUpdate:p,lastBaseUpdate:v,shared:l.shared,effects:l.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function Pm(e,t,s,l){var p=e.updateQueue;mo=!1;var v=p.firstBaseUpdate,y=p.lastBaseUpdate,c=p.shared.pending;if(c!==null){p.shared.pending=null;var M=c,I=M.next;M.next=null,y===null?v=I:y.next=I,y=M;var j=e.alternate;j!==null&&(j=j.updateQueue,c=j.lastBaseUpdate,c!==y&&(c===null?j.firstBaseUpdate=I:c.next=I,j.lastBaseUpdate=M))}if(v!==null){var z=p.baseState;y=0,j=I=M=null,c=v;do{var R=c.lane,X=c.eventTime;if((l&R)===R){j!==null&&(j=j.next={eventTime:X,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var me=e,he=c;switch(R=t,X=s,he.tag){case 1:if(me=he.payload,typeof me=="function"){z=me.call(X,z,R);break e}z=me;break e;case 3:me.flags=me.flags&-65537|128;case 0:if(me=he.payload,R=typeof me=="function"?me.call(X,z,R):me,R==null)break e;z=zr({},z,R);break e;case 2:mo=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,R=p.effects,R===null?p.effects=[c]:R.push(c))}else X={eventTime:X,lane:R,tag:c.tag,payload:c.payload,callback:c.callback,next:null},j===null?(I=j=X,M=z):j=j.next=X,y|=R;if(c=c.next,c===null){if(c=p.shared.pending,c===null)break;R=c,c=R.next,R.next=null,p.lastBaseUpdate=R,p.shared.pending=null}}while(!0);if(j===null&&(M=z),p.baseState=M,p.firstBaseUpdate=I,p.lastBaseUpdate=j,t=p.shared.interleaved,t!==null){p=t;do y|=p.lane,p=p.next;while(p!==t)}else v===null&&(p.shared.lanes=0);Gl|=y,e.lanes=y,e.memoizedState=z}}function Uw(e,t,s){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var l=e[t],p=l.callback;if(p!==null){if(l.callback=null,l=s,typeof p!="function")throw Error(Ne(191,p));p.call(l)}}}var _f={},Zs=Vo(_f),Wd=Vo(_f),Xd=Vo(_f);function Ml(e){if(e===_f)throw Error(Ne(174));return e}function Tv(e,t){switch(gr(Xd,t),gr(Wd,e),gr(Zs,_f),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:D_(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=D_(t,e)}br(Zs),gr(Zs,t)}function Bc(){br(Zs),br(Wd),br(Xd)}function QS(e){Ml(Xd.current);var t=Ml(Zs.current),s=D_(t,e.type);t!==s&&(gr(Wd,e),gr(Zs,s))}function Cv(e){Wd.current===e&&(br(Zs),br(Wd))}var Pr=Vo(0);function Am(e){for(var t=e;t!==null;){if(t.tag===13){var s=t.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var s_=[];function Mv(){for(var e=0;e<s_.length;e++)s_[e]._workInProgressVersionPrimary=null;s_.length=0}var im=Ea.ReactCurrentDispatcher,a_=Ea.ReactCurrentBatchConfig,Hl=0,Ar=null,Qr=null,pn=null,zm=!1,zd=!1,Kd=0,hP=0;function Nn(){throw Error(Ne(321))}function Iv(e,t){if(t===null)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!ks(e[s],t[s]))return!1;return!0}function Ev(e,t,s,l,p,v){if(Hl=v,Ar=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,im.current=e===null||e.memoizedState===null?mP:gP,e=s(l,p),zd){v=0;do{if(zd=!1,Kd=0,25<=v)throw Error(Ne(301));v+=1,pn=Qr=null,t.updateQueue=null,im.current=yP,e=s(l,p)}while(zd)}if(im.current=Dm,t=Qr!==null&&Qr.next!==null,Hl=0,pn=Qr=Ar=null,zm=!1,t)throw Error(Ne(300));return e}function Pv(){var e=Kd!==0;return Kd=0,e}function Bs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?Ar.memoizedState=pn=e:pn=pn.next=e,pn}function as(){if(Qr===null){var e=Ar.alternate;e=e!==null?e.memoizedState:null}else e=Qr.next;var t=pn===null?Ar.memoizedState:pn.next;if(t!==null)pn=t,Qr=e;else{if(e===null)throw Error(Ne(310));Qr=e,e={memoizedState:Qr.memoizedState,baseState:Qr.baseState,baseQueue:Qr.baseQueue,queue:Qr.queue,next:null},pn===null?Ar.memoizedState=pn=e:pn=pn.next=e}return pn}function Yd(e,t){return typeof t=="function"?t(e):t}function o_(e){var t=as(),s=t.queue;if(s===null)throw Error(Ne(311));s.lastRenderedReducer=e;var l=Qr,p=l.baseQueue,v=s.pending;if(v!==null){if(p!==null){var y=p.next;p.next=v.next,v.next=y}l.baseQueue=p=v,s.pending=null}if(p!==null){v=p.next,l=l.baseState;var c=y=null,M=null,I=v;do{var j=I.lane;if((Hl&j)===j)M!==null&&(M=M.next={lane:0,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null}),l=I.hasEagerState?I.eagerState:e(l,I.action);else{var z={lane:j,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null};M===null?(c=M=z,y=l):M=M.next=z,Ar.lanes|=j,Gl|=j}I=I.next}while(I!==null&&I!==v);M===null?y=l:M.next=c,ks(l,t.memoizedState)||(gi=!0),t.memoizedState=l,t.baseState=y,t.baseQueue=M,s.lastRenderedState=l}if(e=s.interleaved,e!==null){p=e;do v=p.lane,Ar.lanes|=v,Gl|=v,p=p.next;while(p!==e)}else p===null&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function l_(e){var t=as(),s=t.queue;if(s===null)throw Error(Ne(311));s.lastRenderedReducer=e;var l=s.dispatch,p=s.pending,v=t.memoizedState;if(p!==null){s.pending=null;var y=p=p.next;do v=e(v,y.action),y=y.next;while(y!==p);ks(v,t.memoizedState)||(gi=!0),t.memoizedState=v,t.baseQueue===null&&(t.baseState=v),s.lastRenderedState=v}return[v,l]}function JS(){}function ek(e,t){var s=Ar,l=as(),p=t(),v=!ks(l.memoizedState,p);if(v&&(l.memoizedState=p,gi=!0),l=l.queue,Av(nk.bind(null,s,l,e),[e]),l.getSnapshot!==t||v||pn!==null&&pn.memoizedState.tag&1){if(s.flags|=2048,Qd(9,rk.bind(null,s,l,p,t),void 0,null),mn===null)throw Error(Ne(349));Hl&30||tk(s,t,p)}return p}function tk(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},t=Ar.updateQueue,t===null?(t={lastEffect:null,stores:null},Ar.updateQueue=t,t.stores=[e]):(s=t.stores,s===null?t.stores=[e]:s.push(e))}function rk(e,t,s,l){t.value=s,t.getSnapshot=l,ik(t)&&sk(e)}function nk(e,t,s){return s(function(){ik(t)&&sk(e)})}function ik(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!ks(e,s)}catch{return!0}}function sk(e){var t=ka(e,1);t!==null&&Ss(t,e,1,-1)}function Vw(e){var t=Bs();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yd,lastRenderedState:e},t.queue=e,e=e.dispatch=pP.bind(null,Ar,e),[t.memoizedState,e]}function Qd(e,t,s,l){return e={tag:e,create:t,destroy:s,deps:l,next:null},t=Ar.updateQueue,t===null?(t={lastEffect:null,stores:null},Ar.updateQueue=t,t.lastEffect=e.next=e):(s=t.lastEffect,s===null?t.lastEffect=e.next=e:(l=s.next,s.next=e,e.next=l,t.lastEffect=e)),e}function ak(){return as().memoizedState}function sm(e,t,s,l){var p=Bs();Ar.flags|=e,p.memoizedState=Qd(1|t,s,void 0,l===void 0?null:l)}function ug(e,t,s,l){var p=as();l=l===void 0?null:l;var v=void 0;if(Qr!==null){var y=Qr.memoizedState;if(v=y.destroy,l!==null&&Iv(l,y.deps)){p.memoizedState=Qd(t,s,v,l);return}}Ar.flags|=e,p.memoizedState=Qd(1|t,s,v,l)}function $w(e,t){return sm(8390656,8,e,t)}function Av(e,t){return ug(2048,8,e,t)}function ok(e,t){return ug(4,2,e,t)}function lk(e,t){return ug(4,4,e,t)}function uk(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ck(e,t,s){return s=s!=null?s.concat([e]):null,ug(4,4,uk.bind(null,t,e),s)}function zv(){}function hk(e,t){var s=as();t=t===void 0?null:t;var l=s.memoizedState;return l!==null&&t!==null&&Iv(t,l[1])?l[0]:(s.memoizedState=[e,t],e)}function dk(e,t){var s=as();t=t===void 0?null:t;var l=s.memoizedState;return l!==null&&t!==null&&Iv(t,l[1])?l[0]:(e=e(),s.memoizedState=[e,t],e)}function fk(e,t,s){return Hl&21?(ks(s,t)||(s=_S(),Ar.lanes|=s,Gl|=s,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,gi=!0),e.memoizedState=s)}function dP(e,t){var s=lr;lr=s!==0&&4>s?s:4,e(!0);var l=a_.transition;a_.transition={};try{e(!1),t()}finally{lr=s,a_.transition=l}}function pk(){return as().memoizedState}function fP(e,t,s){var l=Ro(e);if(s={lane:l,action:s,hasEagerState:!1,eagerState:null,next:null},mk(e))gk(t,s);else if(s=KS(e,t,s,l),s!==null){var p=ti();Ss(s,e,l,p),yk(s,t,l)}}function pP(e,t,s){var l=Ro(e),p={lane:l,action:s,hasEagerState:!1,eagerState:null,next:null};if(mk(e))gk(t,p);else{var v=e.alternate;if(e.lanes===0&&(v===null||v.lanes===0)&&(v=t.lastRenderedReducer,v!==null))try{var y=t.lastRenderedState,c=v(y,s);if(p.hasEagerState=!0,p.eagerState=c,ks(c,y)){var M=t.interleaved;M===null?(p.next=p,Sv(t)):(p.next=M.next,M.next=p),t.interleaved=p;return}}catch{}finally{}s=KS(e,t,p,l),s!==null&&(p=ti(),Ss(s,e,l,p),yk(s,t,l))}}function mk(e){var t=e.alternate;return e===Ar||t!==null&&t===Ar}function gk(e,t){zd=zm=!0;var s=e.pending;s===null?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function yk(e,t,s){if(s&4194240){var l=t.lanes;l&=e.pendingLanes,s|=l,t.lanes=s,uv(e,s)}}var Dm={readContext:ss,useCallback:Nn,useContext:Nn,useEffect:Nn,useImperativeHandle:Nn,useInsertionEffect:Nn,useLayoutEffect:Nn,useMemo:Nn,useReducer:Nn,useRef:Nn,useState:Nn,useDebugValue:Nn,useDeferredValue:Nn,useTransition:Nn,useMutableSource:Nn,useSyncExternalStore:Nn,useId:Nn,unstable_isNewReconciler:!1},mP={readContext:ss,useCallback:function(e,t){return Bs().memoizedState=[e,t===void 0?null:t],e},useContext:ss,useEffect:$w,useImperativeHandle:function(e,t,s){return s=s!=null?s.concat([e]):null,sm(4194308,4,uk.bind(null,t,e),s)},useLayoutEffect:function(e,t){return sm(4194308,4,e,t)},useInsertionEffect:function(e,t){return sm(4,2,e,t)},useMemo:function(e,t){var s=Bs();return t=t===void 0?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var l=Bs();return t=s!==void 0?s(t):t,l.memoizedState=l.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},l.queue=e,e=e.dispatch=fP.bind(null,Ar,e),[l.memoizedState,e]},useRef:function(e){var t=Bs();return e={current:e},t.memoizedState=e},useState:Vw,useDebugValue:zv,useDeferredValue:function(e){return Bs().memoizedState=e},useTransition:function(){var e=Vw(!1),t=e[0];return e=dP.bind(null,e[1]),Bs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var l=Ar,p=Bs();if(Cr){if(s===void 0)throw Error(Ne(407));s=s()}else{if(s=t(),mn===null)throw Error(Ne(349));Hl&30||tk(l,t,s)}p.memoizedState=s;var v={value:s,getSnapshot:t};return p.queue=v,$w(nk.bind(null,l,v,e),[e]),l.flags|=2048,Qd(9,rk.bind(null,l,v,s,t),void 0,null),s},useId:function(){var e=Bs(),t=mn.identifierPrefix;if(Cr){var s=_a,l=ya;s=(l&~(1<<32-bs(l)-1)).toString(32)+s,t=":"+t+"R"+s,s=Kd++,0<s&&(t+="H"+s.toString(32)),t+=":"}else s=hP++,t=":"+t+"r"+s.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},gP={readContext:ss,useCallback:hk,useContext:ss,useEffect:Av,useImperativeHandle:ck,useInsertionEffect:ok,useLayoutEffect:lk,useMemo:dk,useReducer:o_,useRef:ak,useState:function(){return o_(Yd)},useDebugValue:zv,useDeferredValue:function(e){var t=as();return fk(t,Qr.memoizedState,e)},useTransition:function(){var e=o_(Yd)[0],t=as().memoizedState;return[e,t]},useMutableSource:JS,useSyncExternalStore:ek,useId:pk,unstable_isNewReconciler:!1},yP={readContext:ss,useCallback:hk,useContext:ss,useEffect:Av,useImperativeHandle:ck,useInsertionEffect:ok,useLayoutEffect:lk,useMemo:dk,useReducer:l_,useRef:ak,useState:function(){return l_(Yd)},useDebugValue:zv,useDeferredValue:function(e){var t=as();return Qr===null?t.memoizedState=e:fk(t,Qr.memoizedState,e)},useTransition:function(){var e=l_(Yd)[0],t=as().memoizedState;return[e,t]},useMutableSource:JS,useSyncExternalStore:ek,useId:pk,unstable_isNewReconciler:!1};function ms(e,t){if(e&&e.defaultProps){t=zr({},t),e=e.defaultProps;for(var s in e)t[s]===void 0&&(t[s]=e[s]);return t}return t}function e0(e,t,s,l){t=e.memoizedState,s=s(l,t),s=s==null?t:zr({},t,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var cg={isMounted:function(e){return(e=e._reactInternals)?eu(e)===e:!1},enqueueSetState:function(e,t,s){e=e._reactInternals;var l=ti(),p=Ro(e),v=wa(l,p);v.payload=t,s!=null&&(v.callback=s),t=Do(e,v,p),t!==null&&(Ss(t,e,p,l),nm(t,e,p))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var l=ti(),p=Ro(e),v=wa(l,p);v.tag=1,v.payload=t,s!=null&&(v.callback=s),t=Do(e,v,p),t!==null&&(Ss(t,e,p,l),nm(t,e,p))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=ti(),l=Ro(e),p=wa(s,l);p.tag=2,t!=null&&(p.callback=t),t=Do(e,p,l),t!==null&&(Ss(t,e,l,s),nm(t,e,l))}};function qw(e,t,s,l,p,v,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,v,y):t.prototype&&t.prototype.isPureReactComponent?!qd(s,l)||!qd(p,v):!0}function _k(e,t,s){var l=!1,p=jo,v=t.contextType;return typeof v=="object"&&v!==null?v=ss(v):(p=vi(t)?ql:Vn.current,l=t.contextTypes,v=(l=l!=null)?Fc(e,p):jo),t=new t(s,v),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=cg,e.stateNode=t,t._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=p,e.__reactInternalMemoizedMaskedChildContext=v),t}function Zw(e,t,s,l){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(s,l),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(s,l),t.state!==e&&cg.enqueueReplaceState(t,t.state,null)}function t0(e,t,s,l){var p=e.stateNode;p.props=s,p.state=e.memoizedState,p.refs={},kv(e);var v=t.contextType;typeof v=="object"&&v!==null?p.context=ss(v):(v=vi(t)?ql:Vn.current,p.context=Fc(e,v)),p.state=e.memoizedState,v=t.getDerivedStateFromProps,typeof v=="function"&&(e0(e,t,v,s),p.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(t=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),t!==p.state&&cg.enqueueReplaceState(p,p.state,null),Pm(e,s,p,l),p.state=e.memoizedState),typeof p.componentDidMount=="function"&&(e.flags|=4194308)}function jc(e,t){try{var s="",l=t;do s+=ZI(l),l=l.return;while(l);var p=s}catch(v){p=`
Error generating stack: `+v.message+`
`+v.stack}return{value:e,source:t,stack:p,digest:null}}function u_(e,t,s){return{value:e,source:null,stack:s??null,digest:t??null}}function r0(e,t){try{console.error(t.value)}catch(s){setTimeout(function(){throw s})}}var _P=typeof WeakMap=="function"?WeakMap:Map;function vk(e,t,s){s=wa(-1,s),s.tag=3,s.payload={element:null};var l=t.value;return s.callback=function(){Rm||(Rm=!0,d0=l),r0(e,t)},s}function xk(e,t,s){s=wa(-1,s),s.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var p=t.value;s.payload=function(){return l(p)},s.callback=function(){r0(e,t)}}var v=e.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(s.callback=function(){r0(e,t),typeof l!="function"&&(Lo===null?Lo=new Set([this]):Lo.add(this));var y=t.stack;this.componentDidCatch(t.value,{componentStack:y!==null?y:""})}),s}function Hw(e,t,s){var l=e.pingCache;if(l===null){l=e.pingCache=new _P;var p=new Set;l.set(t,p)}else p=l.get(t),p===void 0&&(p=new Set,l.set(t,p));p.has(s)||(p.add(s),e=zP.bind(null,e,t,s),t.then(e,e))}function Gw(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Ww(e,t,s,l,p){return e.mode&1?(e.flags|=65536,e.lanes=p,e):(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(t=wa(-1,1),t.tag=2,Do(s,t,1))),s.lanes|=1),e)}var vP=Ea.ReactCurrentOwner,gi=!1;function ei(e,t,s,l){t.child=e===null?XS(t,null,s,l):Nc(t,e.child,s,l)}function Xw(e,t,s,l,p){s=s.render;var v=t.ref;return xc(t,p),l=Ev(e,t,s,l,v,p),s=Pv(),e!==null&&!gi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~p,Ta(e,t,p)):(Cr&&s&&yv(t),t.flags|=1,ei(e,t,l,p),t.child)}function Kw(e,t,s,l,p){if(e===null){var v=s.type;return typeof v=="function"&&!jv(v)&&v.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(t.tag=15,t.type=v,wk(e,t,v,l,p)):(e=um(s.type,null,l,t,t.mode,p),e.ref=t.ref,e.return=t,t.child=e)}if(v=e.child,!(e.lanes&p)){var y=v.memoizedProps;if(s=s.compare,s=s!==null?s:qd,s(y,l)&&e.ref===t.ref)return Ta(e,t,p)}return t.flags|=1,e=Fo(v,l),e.ref=t.ref,e.return=t,t.child=e}function wk(e,t,s,l,p){if(e!==null){var v=e.memoizedProps;if(qd(v,l)&&e.ref===t.ref)if(gi=!1,t.pendingProps=l=v,(e.lanes&p)!==0)e.flags&131072&&(gi=!0);else return t.lanes=e.lanes,Ta(e,t,p)}return n0(e,t,s,l,p)}function bk(e,t,s){var l=t.pendingProps,p=l.children,v=e!==null?e.memoizedState:null;if(l.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},gr(fc,Li),Li|=s;else{if(!(s&1073741824))return e=v!==null?v.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,gr(fc,Li),Li|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=v!==null?v.baseLanes:s,gr(fc,Li),Li|=l}else v!==null?(l=v.baseLanes|s,t.memoizedState=null):l=s,gr(fc,Li),Li|=l;return ei(e,t,p,s),t.child}function Sk(e,t){var s=t.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function n0(e,t,s,l,p){var v=vi(s)?ql:Vn.current;return v=Fc(t,v),xc(t,p),s=Ev(e,t,s,l,v,p),l=Pv(),e!==null&&!gi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~p,Ta(e,t,p)):(Cr&&l&&yv(t),t.flags|=1,ei(e,t,s,p),t.child)}function Yw(e,t,s,l,p){if(vi(s)){var v=!0;Tm(t)}else v=!1;if(xc(t,p),t.stateNode===null)am(e,t),_k(t,s,l),t0(t,s,l,p),l=!0;else if(e===null){var y=t.stateNode,c=t.memoizedProps;y.props=c;var M=y.context,I=s.contextType;typeof I=="object"&&I!==null?I=ss(I):(I=vi(s)?ql:Vn.current,I=Fc(t,I));var j=s.getDerivedStateFromProps,z=typeof j=="function"||typeof y.getSnapshotBeforeUpdate=="function";z||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(c!==l||M!==I)&&Zw(t,y,l,I),mo=!1;var R=t.memoizedState;y.state=R,Pm(t,l,y,p),M=t.memoizedState,c!==l||R!==M||_i.current||mo?(typeof j=="function"&&(e0(t,s,j,l),M=t.memoizedState),(c=mo||qw(t,s,c,l,R,M,I))?(z||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(t.flags|=4194308)):(typeof y.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=l,t.memoizedState=M),y.props=l,y.state=M,y.context=I,l=c):(typeof y.componentDidMount=="function"&&(t.flags|=4194308),l=!1)}else{y=t.stateNode,YS(e,t),c=t.memoizedProps,I=t.type===t.elementType?c:ms(t.type,c),y.props=I,z=t.pendingProps,R=y.context,M=s.contextType,typeof M=="object"&&M!==null?M=ss(M):(M=vi(s)?ql:Vn.current,M=Fc(t,M));var X=s.getDerivedStateFromProps;(j=typeof X=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(c!==z||R!==M)&&Zw(t,y,l,M),mo=!1,R=t.memoizedState,y.state=R,Pm(t,l,y,p);var me=t.memoizedState;c!==z||R!==me||_i.current||mo?(typeof X=="function"&&(e0(t,s,X,l),me=t.memoizedState),(I=mo||qw(t,s,I,l,R,me,M)||!1)?(j||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(l,me,M),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(l,me,M)),typeof y.componentDidUpdate=="function"&&(t.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof y.componentDidUpdate!="function"||c===e.memoizedProps&&R===e.memoizedState||(t.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&R===e.memoizedState||(t.flags|=1024),t.memoizedProps=l,t.memoizedState=me),y.props=l,y.state=me,y.context=M,l=I):(typeof y.componentDidUpdate!="function"||c===e.memoizedProps&&R===e.memoizedState||(t.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&R===e.memoizedState||(t.flags|=1024),l=!1)}return i0(e,t,s,l,v,p)}function i0(e,t,s,l,p,v){Sk(e,t);var y=(t.flags&128)!==0;if(!l&&!y)return p&&Fw(t,s,!1),Ta(e,t,v);l=t.stateNode,vP.current=t;var c=y&&typeof s.getDerivedStateFromError!="function"?null:l.render();return t.flags|=1,e!==null&&y?(t.child=Nc(t,e.child,null,v),t.child=Nc(t,null,c,v)):ei(e,t,c,v),t.memoizedState=l.state,p&&Fw(t,s,!0),t.child}function kk(e){var t=e.stateNode;t.pendingContext?Rw(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Rw(e,t.context,!1),Tv(e,t.containerInfo)}function Qw(e,t,s,l,p){return Oc(),vv(p),t.flags|=256,ei(e,t,s,l),t.child}var s0={dehydrated:null,treeContext:null,retryLane:0};function a0(e){return{baseLanes:e,cachePool:null,transitions:null}}function Tk(e,t,s){var l=t.pendingProps,p=Pr.current,v=!1,y=(t.flags&128)!==0,c;if((c=y)||(c=e!==null&&e.memoizedState===null?!1:(p&2)!==0),c?(v=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(p|=1),gr(Pr,p&1),e===null)return Q_(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(y=l.children,e=l.fallback,v?(l=t.mode,v=t.child,y={mode:"hidden",children:y},!(l&1)&&v!==null?(v.childLanes=0,v.pendingProps=y):v=fg(y,l,0,null),e=Ul(e,l,s,null),v.return=t,e.return=t,v.sibling=e,t.child=v,t.child.memoizedState=a0(s),t.memoizedState=s0,e):Dv(t,y));if(p=e.memoizedState,p!==null&&(c=p.dehydrated,c!==null))return xP(e,t,y,l,c,p,s);if(v){v=l.fallback,y=t.mode,p=e.child,c=p.sibling;var M={mode:"hidden",children:l.children};return!(y&1)&&t.child!==p?(l=t.child,l.childLanes=0,l.pendingProps=M,t.deletions=null):(l=Fo(p,M),l.subtreeFlags=p.subtreeFlags&14680064),c!==null?v=Fo(c,v):(v=Ul(v,y,s,null),v.flags|=2),v.return=t,l.return=t,l.sibling=v,t.child=l,l=v,v=t.child,y=e.child.memoizedState,y=y===null?a0(s):{baseLanes:y.baseLanes|s,cachePool:null,transitions:y.transitions},v.memoizedState=y,v.childLanes=e.childLanes&~s,t.memoizedState=s0,l}return v=e.child,e=v.sibling,l=Fo(v,{mode:"visible",children:l.children}),!(t.mode&1)&&(l.lanes=s),l.return=t,l.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=l,t.memoizedState=null,l}function Dv(e,t){return t=fg({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Vp(e,t,s,l){return l!==null&&vv(l),Nc(t,e.child,null,s),e=Dv(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function xP(e,t,s,l,p,v,y){if(s)return t.flags&256?(t.flags&=-257,l=u_(Error(Ne(422))),Vp(e,t,y,l)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(v=l.fallback,p=t.mode,l=fg({mode:"visible",children:l.children},p,0,null),v=Ul(v,p,y,null),v.flags|=2,l.return=t,v.return=t,l.sibling=v,t.child=l,t.mode&1&&Nc(t,e.child,null,y),t.child.memoizedState=a0(y),t.memoizedState=s0,v);if(!(t.mode&1))return Vp(e,t,y,null);if(p.data==="$!"){if(l=p.nextSibling&&p.nextSibling.dataset,l)var c=l.dgst;return l=c,v=Error(Ne(419)),l=u_(v,l,void 0),Vp(e,t,y,l)}if(c=(y&e.childLanes)!==0,gi||c){if(l=mn,l!==null){switch(y&-y){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=p&(l.suspendedLanes|y)?0:p,p!==0&&p!==v.retryLane&&(v.retryLane=p,ka(e,p),Ss(l,e,p,-1))}return Bv(),l=u_(Error(Ne(421))),Vp(e,t,y,l)}return p.data==="$?"?(t.flags|=128,t.child=e.child,t=DP.bind(null,e),p._reactRetry=t,null):(e=v.treeContext,Fi=zo(p.nextSibling),Oi=t,Cr=!0,vs=null,e!==null&&(es[ts++]=ya,es[ts++]=_a,es[ts++]=Zl,ya=e.id,_a=e.overflow,Zl=t),t=Dv(t,l.children),t.flags|=4096,t)}function Jw(e,t,s){e.lanes|=t;var l=e.alternate;l!==null&&(l.lanes|=t),J_(e.return,t,s)}function c_(e,t,s,l,p){var v=e.memoizedState;v===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:l,tail:s,tailMode:p}:(v.isBackwards=t,v.rendering=null,v.renderingStartTime=0,v.last=l,v.tail=s,v.tailMode=p)}function Ck(e,t,s){var l=t.pendingProps,p=l.revealOrder,v=l.tail;if(ei(e,t,l.children,s),l=Pr.current,l&2)l=l&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Jw(e,s,t);else if(e.tag===19)Jw(e,s,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(gr(Pr,l),!(t.mode&1))t.memoizedState=null;else switch(p){case"forwards":for(s=t.child,p=null;s!==null;)e=s.alternate,e!==null&&Am(e)===null&&(p=s),s=s.sibling;s=p,s===null?(p=t.child,t.child=null):(p=s.sibling,s.sibling=null),c_(t,!1,p,s,v);break;case"backwards":for(s=null,p=t.child,t.child=null;p!==null;){if(e=p.alternate,e!==null&&Am(e)===null){t.child=p;break}e=p.sibling,p.sibling=s,s=p,p=e}c_(t,!0,s,null,v);break;case"together":c_(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function am(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ta(e,t,s){if(e!==null&&(t.dependencies=e.dependencies),Gl|=t.lanes,!(s&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ne(153));if(t.child!==null){for(e=t.child,s=Fo(e,e.pendingProps),t.child=s,s.return=t;e.sibling!==null;)e=e.sibling,s=s.sibling=Fo(e,e.pendingProps),s.return=t;s.sibling=null}return t.child}function wP(e,t,s){switch(t.tag){case 3:kk(t),Oc();break;case 5:QS(t);break;case 1:vi(t.type)&&Tm(t);break;case 4:Tv(t,t.stateNode.containerInfo);break;case 10:var l=t.type._context,p=t.memoizedProps.value;gr(Im,l._currentValue),l._currentValue=p;break;case 13:if(l=t.memoizedState,l!==null)return l.dehydrated!==null?(gr(Pr,Pr.current&1),t.flags|=128,null):s&t.child.childLanes?Tk(e,t,s):(gr(Pr,Pr.current&1),e=Ta(e,t,s),e!==null?e.sibling:null);gr(Pr,Pr.current&1);break;case 19:if(l=(s&t.childLanes)!==0,e.flags&128){if(l)return Ck(e,t,s);t.flags|=128}if(p=t.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),gr(Pr,Pr.current),l)break;return null;case 22:case 23:return t.lanes=0,bk(e,t,s)}return Ta(e,t,s)}var Mk,o0,Ik,Ek;Mk=function(e,t){for(var s=t.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};o0=function(){};Ik=function(e,t,s,l){var p=e.memoizedProps;if(p!==l){e=t.stateNode,Ml(Zs.current);var v=null;switch(s){case"input":p=E_(e,p),l=E_(e,l),v=[];break;case"select":p=zr({},p,{value:void 0}),l=zr({},l,{value:void 0}),v=[];break;case"textarea":p=z_(e,p),l=z_(e,l),v=[];break;default:typeof p.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=Sm)}L_(s,l);var y;s=null;for(I in p)if(!l.hasOwnProperty(I)&&p.hasOwnProperty(I)&&p[I]!=null)if(I==="style"){var c=p[I];for(y in c)c.hasOwnProperty(y)&&(s||(s={}),s[y]="")}else I!=="dangerouslySetInnerHTML"&&I!=="children"&&I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&I!=="autoFocus"&&(Od.hasOwnProperty(I)?v||(v=[]):(v=v||[]).push(I,null));for(I in l){var M=l[I];if(c=p!=null?p[I]:void 0,l.hasOwnProperty(I)&&M!==c&&(M!=null||c!=null))if(I==="style")if(c){for(y in c)!c.hasOwnProperty(y)||M&&M.hasOwnProperty(y)||(s||(s={}),s[y]="");for(y in M)M.hasOwnProperty(y)&&c[y]!==M[y]&&(s||(s={}),s[y]=M[y])}else s||(v||(v=[]),v.push(I,s)),s=M;else I==="dangerouslySetInnerHTML"?(M=M?M.__html:void 0,c=c?c.__html:void 0,M!=null&&c!==M&&(v=v||[]).push(I,M)):I==="children"?typeof M!="string"&&typeof M!="number"||(v=v||[]).push(I,""+M):I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&(Od.hasOwnProperty(I)?(M!=null&&I==="onScroll"&&wr("scroll",e),v||c===M||(v=[])):(v=v||[]).push(I,M))}s&&(v=v||[]).push("style",s);var I=v;(t.updateQueue=I)&&(t.flags|=4)}};Ek=function(e,t,s,l){s!==l&&(t.flags|=4)};function dd(e,t){if(!Cr)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function Bn(e){var t=e.alternate!==null&&e.alternate.child===e.child,s=0,l=0;if(t)for(var p=e.child;p!==null;)s|=p.lanes|p.childLanes,l|=p.subtreeFlags&14680064,l|=p.flags&14680064,p.return=e,p=p.sibling;else for(p=e.child;p!==null;)s|=p.lanes|p.childLanes,l|=p.subtreeFlags,l|=p.flags,p.return=e,p=p.sibling;return e.subtreeFlags|=l,e.childLanes=s,t}function bP(e,t,s){var l=t.pendingProps;switch(_v(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bn(t),null;case 1:return vi(t.type)&&km(),Bn(t),null;case 3:return l=t.stateNode,Bc(),br(_i),br(Vn),Mv(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(jp(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,vs!==null&&(m0(vs),vs=null))),o0(e,t),Bn(t),null;case 5:Cv(t);var p=Ml(Xd.current);if(s=t.type,e!==null&&t.stateNode!=null)Ik(e,t,s,l,p),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!l){if(t.stateNode===null)throw Error(Ne(166));return Bn(t),null}if(e=Ml(Zs.current),jp(t)){l=t.stateNode,s=t.type;var v=t.memoizedProps;switch(l[$s]=t,l[Gd]=v,e=(t.mode&1)!==0,s){case"dialog":wr("cancel",l),wr("close",l);break;case"iframe":case"object":case"embed":wr("load",l);break;case"video":case"audio":for(p=0;p<bd.length;p++)wr(bd[p],l);break;case"source":wr("error",l);break;case"img":case"image":case"link":wr("error",l),wr("load",l);break;case"details":wr("toggle",l);break;case"input":lw(l,v),wr("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!v.multiple},wr("invalid",l);break;case"textarea":cw(l,v),wr("invalid",l)}L_(s,v),p=null;for(var y in v)if(v.hasOwnProperty(y)){var c=v[y];y==="children"?typeof c=="string"?l.textContent!==c&&(v.suppressHydrationWarning!==!0&&Bp(l.textContent,c,e),p=["children",c]):typeof c=="number"&&l.textContent!==""+c&&(v.suppressHydrationWarning!==!0&&Bp(l.textContent,c,e),p=["children",""+c]):Od.hasOwnProperty(y)&&c!=null&&y==="onScroll"&&wr("scroll",l)}switch(s){case"input":Ap(l),uw(l,v,!0);break;case"textarea":Ap(l),hw(l);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(l.onclick=Sm)}l=p,t.updateQueue=l,l!==null&&(t.flags|=4)}else{y=p.nodeType===9?p:p.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=nS(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=y.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=y.createElement(s,{is:l.is}):(e=y.createElement(s),s==="select"&&(y=e,l.multiple?y.multiple=!0:l.size&&(y.size=l.size))):e=y.createElementNS(e,s),e[$s]=t,e[Gd]=l,Mk(e,t,!1,!1),t.stateNode=e;e:{switch(y=R_(s,l),s){case"dialog":wr("cancel",e),wr("close",e),p=l;break;case"iframe":case"object":case"embed":wr("load",e),p=l;break;case"video":case"audio":for(p=0;p<bd.length;p++)wr(bd[p],e);p=l;break;case"source":wr("error",e),p=l;break;case"img":case"image":case"link":wr("error",e),wr("load",e),p=l;break;case"details":wr("toggle",e),p=l;break;case"input":lw(e,l),p=E_(e,l),wr("invalid",e);break;case"option":p=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},p=zr({},l,{value:void 0}),wr("invalid",e);break;case"textarea":cw(e,l),p=z_(e,l),wr("invalid",e);break;default:p=l}L_(s,p),c=p;for(v in c)if(c.hasOwnProperty(v)){var M=c[v];v==="style"?aS(e,M):v==="dangerouslySetInnerHTML"?(M=M?M.__html:void 0,M!=null&&iS(e,M)):v==="children"?typeof M=="string"?(s!=="textarea"||M!=="")&&Nd(e,M):typeof M=="number"&&Nd(e,""+M):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(Od.hasOwnProperty(v)?M!=null&&v==="onScroll"&&wr("scroll",e):M!=null&&nv(e,v,M,y))}switch(s){case"input":Ap(e),uw(e,l,!1);break;case"textarea":Ap(e),hw(e);break;case"option":l.value!=null&&e.setAttribute("value",""+Bo(l.value));break;case"select":e.multiple=!!l.multiple,v=l.value,v!=null?gc(e,!!l.multiple,v,!1):l.defaultValue!=null&&gc(e,!!l.multiple,l.defaultValue,!0);break;default:typeof p.onClick=="function"&&(e.onclick=Sm)}switch(s){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Bn(t),null;case 6:if(e&&t.stateNode!=null)Ek(e,t,e.memoizedProps,l);else{if(typeof l!="string"&&t.stateNode===null)throw Error(Ne(166));if(s=Ml(Xd.current),Ml(Zs.current),jp(t)){if(l=t.stateNode,s=t.memoizedProps,l[$s]=t,(v=l.nodeValue!==s)&&(e=Oi,e!==null))switch(e.tag){case 3:Bp(l.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Bp(l.nodeValue,s,(e.mode&1)!==0)}v&&(t.flags|=4)}else l=(s.nodeType===9?s:s.ownerDocument).createTextNode(l),l[$s]=t,t.stateNode=l}return Bn(t),null;case 13:if(br(Pr),l=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Cr&&Fi!==null&&t.mode&1&&!(t.flags&128))GS(),Oc(),t.flags|=98560,v=!1;else if(v=jp(t),l!==null&&l.dehydrated!==null){if(e===null){if(!v)throw Error(Ne(318));if(v=t.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(Ne(317));v[$s]=t}else Oc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Bn(t),v=!1}else vs!==null&&(m0(vs),vs=null),v=!0;if(!v)return t.flags&65536?t:null}return t.flags&128?(t.lanes=s,t):(l=l!==null,l!==(e!==null&&e.memoizedState!==null)&&l&&(t.child.flags|=8192,t.mode&1&&(e===null||Pr.current&1?Jr===0&&(Jr=3):Bv())),t.updateQueue!==null&&(t.flags|=4),Bn(t),null);case 4:return Bc(),o0(e,t),e===null&&Zd(t.stateNode.containerInfo),Bn(t),null;case 10:return bv(t.type._context),Bn(t),null;case 17:return vi(t.type)&&km(),Bn(t),null;case 19:if(br(Pr),v=t.memoizedState,v===null)return Bn(t),null;if(l=(t.flags&128)!==0,y=v.rendering,y===null)if(l)dd(v,!1);else{if(Jr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(y=Am(e),y!==null){for(t.flags|=128,dd(v,!1),l=y.updateQueue,l!==null&&(t.updateQueue=l,t.flags|=4),t.subtreeFlags=0,l=s,s=t.child;s!==null;)v=s,e=l,v.flags&=14680066,y=v.alternate,y===null?(v.childLanes=0,v.lanes=e,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=y.childLanes,v.lanes=y.lanes,v.child=y.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=y.memoizedProps,v.memoizedState=y.memoizedState,v.updateQueue=y.updateQueue,v.type=y.type,e=y.dependencies,v.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return gr(Pr,Pr.current&1|2),t.child}e=e.sibling}v.tail!==null&&Ur()>Uc&&(t.flags|=128,l=!0,dd(v,!1),t.lanes=4194304)}else{if(!l)if(e=Am(y),e!==null){if(t.flags|=128,l=!0,s=e.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),dd(v,!0),v.tail===null&&v.tailMode==="hidden"&&!y.alternate&&!Cr)return Bn(t),null}else 2*Ur()-v.renderingStartTime>Uc&&s!==1073741824&&(t.flags|=128,l=!0,dd(v,!1),t.lanes=4194304);v.isBackwards?(y.sibling=t.child,t.child=y):(s=v.last,s!==null?s.sibling=y:t.child=y,v.last=y)}return v.tail!==null?(t=v.tail,v.rendering=t,v.tail=t.sibling,v.renderingStartTime=Ur(),t.sibling=null,s=Pr.current,gr(Pr,l?s&1|2:s&1),t):(Bn(t),null);case 22:case 23:return Nv(),l=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(t.flags|=8192),l&&t.mode&1?Li&1073741824&&(Bn(t),t.subtreeFlags&6&&(t.flags|=8192)):Bn(t),null;case 24:return null;case 25:return null}throw Error(Ne(156,t.tag))}function SP(e,t){switch(_v(t),t.tag){case 1:return vi(t.type)&&km(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Bc(),br(_i),br(Vn),Mv(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Cv(t),null;case 13:if(br(Pr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ne(340));Oc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return br(Pr),null;case 4:return Bc(),null;case 10:return bv(t.type._context),null;case 22:case 23:return Nv(),null;case 24:return null;default:return null}}var $p=!1,Un=!1,kP=typeof WeakSet=="function"?WeakSet:Set,ut=null;function dc(e,t){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(l){Br(e,t,l)}else s.current=null}function l0(e,t,s){try{s()}catch(l){Br(e,t,l)}}var eb=!1;function TP(e,t){if(Z_=xm,e=LS(),gv(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var l=s.getSelection&&s.getSelection();if(l&&l.rangeCount!==0){s=l.anchorNode;var p=l.anchorOffset,v=l.focusNode;l=l.focusOffset;try{s.nodeType,v.nodeType}catch{s=null;break e}var y=0,c=-1,M=-1,I=0,j=0,z=e,R=null;t:for(;;){for(var X;z!==s||p!==0&&z.nodeType!==3||(c=y+p),z!==v||l!==0&&z.nodeType!==3||(M=y+l),z.nodeType===3&&(y+=z.nodeValue.length),(X=z.firstChild)!==null;)R=z,z=X;for(;;){if(z===e)break t;if(R===s&&++I===p&&(c=y),R===v&&++j===l&&(M=y),(X=z.nextSibling)!==null)break;z=R,R=z.parentNode}z=X}s=c===-1||M===-1?null:{start:c,end:M}}else s=null}s=s||{start:0,end:0}}else s=null;for(H_={focusedElem:e,selectionRange:s},xm=!1,ut=t;ut!==null;)if(t=ut,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ut=e;else for(;ut!==null;){t=ut;try{var me=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(me!==null){var he=me.memoizedProps,ge=me.memoizedState,W=t.stateNode,Q=W.getSnapshotBeforeUpdate(t.elementType===t.type?he:ms(t.type,he),ge);W.__reactInternalSnapshotBeforeUpdate=Q}break;case 3:var te=t.stateNode.containerInfo;te.nodeType===1?te.textContent="":te.nodeType===9&&te.documentElement&&te.removeChild(te.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ne(163))}}catch(oe){Br(t,t.return,oe)}if(e=t.sibling,e!==null){e.return=t.return,ut=e;break}ut=t.return}return me=eb,eb=!1,me}function Dd(e,t,s){var l=t.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var p=l=l.next;do{if((p.tag&e)===e){var v=p.destroy;p.destroy=void 0,v!==void 0&&l0(t,s,v)}p=p.next}while(p!==l)}}function hg(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var s=t=t.next;do{if((s.tag&e)===e){var l=s.create;s.destroy=l()}s=s.next}while(s!==t)}}function u0(e){var t=e.ref;if(t!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof t=="function"?t(e):t.current=e}}function Pk(e){var t=e.alternate;t!==null&&(e.alternate=null,Pk(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[$s],delete t[Gd],delete t[X_],delete t[oP],delete t[lP])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ak(e){return e.tag===5||e.tag===3||e.tag===4}function tb(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ak(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function c0(e,t,s){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?s.nodeType===8?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(s.nodeType===8?(t=s.parentNode,t.insertBefore(e,s)):(t=s,t.appendChild(e)),s=s._reactRootContainer,s!=null||t.onclick!==null||(t.onclick=Sm));else if(l!==4&&(e=e.child,e!==null))for(c0(e,t,s),e=e.sibling;e!==null;)c0(e,t,s),e=e.sibling}function h0(e,t,s){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for(h0(e,t,s),e=e.sibling;e!==null;)h0(e,t,s),e=e.sibling}var Tn=null,_s=!1;function co(e,t,s){for(s=s.child;s!==null;)zk(e,t,s),s=s.sibling}function zk(e,t,s){if(qs&&typeof qs.onCommitFiberUnmount=="function")try{qs.onCommitFiberUnmount(ng,s)}catch{}switch(s.tag){case 5:Un||dc(s,t);case 6:var l=Tn,p=_s;Tn=null,co(e,t,s),Tn=l,_s=p,Tn!==null&&(_s?(e=Tn,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):Tn.removeChild(s.stateNode));break;case 18:Tn!==null&&(_s?(e=Tn,s=s.stateNode,e.nodeType===8?n_(e.parentNode,s):e.nodeType===1&&n_(e,s),Vd(e)):n_(Tn,s.stateNode));break;case 4:l=Tn,p=_s,Tn=s.stateNode.containerInfo,_s=!0,co(e,t,s),Tn=l,_s=p;break;case 0:case 11:case 14:case 15:if(!Un&&(l=s.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){p=l=l.next;do{var v=p,y=v.destroy;v=v.tag,y!==void 0&&(v&2||v&4)&&l0(s,t,y),p=p.next}while(p!==l)}co(e,t,s);break;case 1:if(!Un&&(dc(s,t),l=s.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=s.memoizedProps,l.state=s.memoizedState,l.componentWillUnmount()}catch(c){Br(s,t,c)}co(e,t,s);break;case 21:co(e,t,s);break;case 22:s.mode&1?(Un=(l=Un)||s.memoizedState!==null,co(e,t,s),Un=l):co(e,t,s);break;default:co(e,t,s)}}function rb(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new kP),t.forEach(function(l){var p=LP.bind(null,e,l);s.has(l)||(s.add(l),l.then(p,p))})}}function ps(e,t){var s=t.deletions;if(s!==null)for(var l=0;l<s.length;l++){var p=s[l];try{var v=e,y=t,c=y;e:for(;c!==null;){switch(c.tag){case 5:Tn=c.stateNode,_s=!1;break e;case 3:Tn=c.stateNode.containerInfo,_s=!0;break e;case 4:Tn=c.stateNode.containerInfo,_s=!0;break e}c=c.return}if(Tn===null)throw Error(Ne(160));zk(v,y,p),Tn=null,_s=!1;var M=p.alternate;M!==null&&(M.return=null),p.return=null}catch(I){Br(p,t,I)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Dk(t,e),t=t.sibling}function Dk(e,t){var s=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ps(t,e),Ns(e),l&4){try{Dd(3,e,e.return),hg(3,e)}catch(he){Br(e,e.return,he)}try{Dd(5,e,e.return)}catch(he){Br(e,e.return,he)}}break;case 1:ps(t,e),Ns(e),l&512&&s!==null&&dc(s,s.return);break;case 5:if(ps(t,e),Ns(e),l&512&&s!==null&&dc(s,s.return),e.flags&32){var p=e.stateNode;try{Nd(p,"")}catch(he){Br(e,e.return,he)}}if(l&4&&(p=e.stateNode,p!=null)){var v=e.memoizedProps,y=s!==null?s.memoizedProps:v,c=e.type,M=e.updateQueue;if(e.updateQueue=null,M!==null)try{c==="input"&&v.type==="radio"&&v.name!=null&&tS(p,v),R_(c,y);var I=R_(c,v);for(y=0;y<M.length;y+=2){var j=M[y],z=M[y+1];j==="style"?aS(p,z):j==="dangerouslySetInnerHTML"?iS(p,z):j==="children"?Nd(p,z):nv(p,j,z,I)}switch(c){case"input":P_(p,v);break;case"textarea":rS(p,v);break;case"select":var R=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!v.multiple;var X=v.value;X!=null?gc(p,!!v.multiple,X,!1):R!==!!v.multiple&&(v.defaultValue!=null?gc(p,!!v.multiple,v.defaultValue,!0):gc(p,!!v.multiple,v.multiple?[]:"",!1))}p[Gd]=v}catch(he){Br(e,e.return,he)}}break;case 6:if(ps(t,e),Ns(e),l&4){if(e.stateNode===null)throw Error(Ne(162));p=e.stateNode,v=e.memoizedProps;try{p.nodeValue=v}catch(he){Br(e,e.return,he)}}break;case 3:if(ps(t,e),Ns(e),l&4&&s!==null&&s.memoizedState.isDehydrated)try{Vd(t.containerInfo)}catch(he){Br(e,e.return,he)}break;case 4:ps(t,e),Ns(e);break;case 13:ps(t,e),Ns(e),p=e.child,p.flags&8192&&(v=p.memoizedState!==null,p.stateNode.isHidden=v,!v||p.alternate!==null&&p.alternate.memoizedState!==null||(Fv=Ur())),l&4&&rb(e);break;case 22:if(j=s!==null&&s.memoizedState!==null,e.mode&1?(Un=(I=Un)||j,ps(t,e),Un=I):ps(t,e),Ns(e),l&8192){if(I=e.memoizedState!==null,(e.stateNode.isHidden=I)&&!j&&e.mode&1)for(ut=e,j=e.child;j!==null;){for(z=ut=j;ut!==null;){switch(R=ut,X=R.child,R.tag){case 0:case 11:case 14:case 15:Dd(4,R,R.return);break;case 1:dc(R,R.return);var me=R.stateNode;if(typeof me.componentWillUnmount=="function"){l=R,s=R.return;try{t=l,me.props=t.memoizedProps,me.state=t.memoizedState,me.componentWillUnmount()}catch(he){Br(l,s,he)}}break;case 5:dc(R,R.return);break;case 22:if(R.memoizedState!==null){ib(z);continue}}X!==null?(X.return=R,ut=X):ib(z)}j=j.sibling}e:for(j=null,z=e;;){if(z.tag===5){if(j===null){j=z;try{p=z.stateNode,I?(v=p.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(c=z.stateNode,M=z.memoizedProps.style,y=M!=null&&M.hasOwnProperty("display")?M.display:null,c.style.display=sS("display",y))}catch(he){Br(e,e.return,he)}}}else if(z.tag===6){if(j===null)try{z.stateNode.nodeValue=I?"":z.memoizedProps}catch(he){Br(e,e.return,he)}}else if((z.tag!==22&&z.tag!==23||z.memoizedState===null||z===e)&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===e)break e;for(;z.sibling===null;){if(z.return===null||z.return===e)break e;j===z&&(j=null),z=z.return}j===z&&(j=null),z.sibling.return=z.return,z=z.sibling}}break;case 19:ps(t,e),Ns(e),l&4&&rb(e);break;case 21:break;default:ps(t,e),Ns(e)}}function Ns(e){var t=e.flags;if(t&2){try{e:{for(var s=e.return;s!==null;){if(Ak(s)){var l=s;break e}s=s.return}throw Error(Ne(160))}switch(l.tag){case 5:var p=l.stateNode;l.flags&32&&(Nd(p,""),l.flags&=-33);var v=tb(e);h0(e,v,p);break;case 3:case 4:var y=l.stateNode.containerInfo,c=tb(e);c0(e,c,y);break;default:throw Error(Ne(161))}}catch(M){Br(e,e.return,M)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function CP(e,t,s){ut=e,Lk(e)}function Lk(e,t,s){for(var l=(e.mode&1)!==0;ut!==null;){var p=ut,v=p.child;if(p.tag===22&&l){var y=p.memoizedState!==null||$p;if(!y){var c=p.alternate,M=c!==null&&c.memoizedState!==null||Un;c=$p;var I=Un;if($p=y,(Un=M)&&!I)for(ut=p;ut!==null;)y=ut,M=y.child,y.tag===22&&y.memoizedState!==null?sb(p):M!==null?(M.return=y,ut=M):sb(p);for(;v!==null;)ut=v,Lk(v),v=v.sibling;ut=p,$p=c,Un=I}nb(e)}else p.subtreeFlags&8772&&v!==null?(v.return=p,ut=v):nb(e)}}function nb(e){for(;ut!==null;){var t=ut;if(t.flags&8772){var s=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Un||hg(5,t);break;case 1:var l=t.stateNode;if(t.flags&4&&!Un)if(s===null)l.componentDidMount();else{var p=t.elementType===t.type?s.memoizedProps:ms(t.type,s.memoizedProps);l.componentDidUpdate(p,s.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var v=t.updateQueue;v!==null&&Uw(t,v,l);break;case 3:var y=t.updateQueue;if(y!==null){if(s=null,t.child!==null)switch(t.child.tag){case 5:s=t.child.stateNode;break;case 1:s=t.child.stateNode}Uw(t,y,s)}break;case 5:var c=t.stateNode;if(s===null&&t.flags&4){s=c;var M=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":M.autoFocus&&s.focus();break;case"img":M.src&&(s.src=M.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var I=t.alternate;if(I!==null){var j=I.memoizedState;if(j!==null){var z=j.dehydrated;z!==null&&Vd(z)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ne(163))}Un||t.flags&512&&u0(t)}catch(R){Br(t,t.return,R)}}if(t===e){ut=null;break}if(s=t.sibling,s!==null){s.return=t.return,ut=s;break}ut=t.return}}function ib(e){for(;ut!==null;){var t=ut;if(t===e){ut=null;break}var s=t.sibling;if(s!==null){s.return=t.return,ut=s;break}ut=t.return}}function sb(e){for(;ut!==null;){var t=ut;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{hg(4,t)}catch(M){Br(t,s,M)}break;case 1:var l=t.stateNode;if(typeof l.componentDidMount=="function"){var p=t.return;try{l.componentDidMount()}catch(M){Br(t,p,M)}}var v=t.return;try{u0(t)}catch(M){Br(t,v,M)}break;case 5:var y=t.return;try{u0(t)}catch(M){Br(t,y,M)}}}catch(M){Br(t,t.return,M)}if(t===e){ut=null;break}var c=t.sibling;if(c!==null){c.return=t.return,ut=c;break}ut=t.return}}var MP=Math.ceil,Lm=Ea.ReactCurrentDispatcher,Lv=Ea.ReactCurrentOwner,is=Ea.ReactCurrentBatchConfig,Kt=0,mn=null,Gr=null,Mn=0,Li=0,fc=Vo(0),Jr=0,Jd=null,Gl=0,dg=0,Rv=0,Ld=null,mi=null,Fv=0,Uc=1/0,fa=null,Rm=!1,d0=null,Lo=null,qp=!1,Mo=null,Fm=0,Rd=0,f0=null,om=-1,lm=0;function ti(){return Kt&6?Ur():om!==-1?om:om=Ur()}function Ro(e){return e.mode&1?Kt&2&&Mn!==0?Mn&-Mn:cP.transition!==null?(lm===0&&(lm=_S()),lm):(e=lr,e!==0||(e=window.event,e=e===void 0?16:TS(e.type)),e):1}function Ss(e,t,s,l){if(50<Rd)throw Rd=0,f0=null,Error(Ne(185));mf(e,s,l),(!(Kt&2)||e!==mn)&&(e===mn&&(!(Kt&2)&&(dg|=s),Jr===4&&yo(e,Mn)),xi(e,l),s===1&&Kt===0&&!(t.mode&1)&&(Uc=Ur()+500,lg&&$o()))}function xi(e,t){var s=e.callbackNode;cE(e,t);var l=vm(e,e===mn?Mn:0);if(l===0)s!==null&&pw(s),e.callbackNode=null,e.callbackPriority=0;else if(t=l&-l,e.callbackPriority!==t){if(s!=null&&pw(s),t===1)e.tag===0?uP(ab.bind(null,e)):qS(ab.bind(null,e)),sP(function(){!(Kt&6)&&$o()}),s=null;else{switch(vS(l)){case 1:s=lv;break;case 4:s=gS;break;case 16:s=_m;break;case 536870912:s=yS;break;default:s=_m}s=Vk(s,Rk.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function Rk(e,t){if(om=-1,lm=0,Kt&6)throw Error(Ne(327));var s=e.callbackNode;if(wc()&&e.callbackNode!==s)return null;var l=vm(e,e===mn?Mn:0);if(l===0)return null;if(l&30||l&e.expiredLanes||t)t=Om(e,l);else{t=l;var p=Kt;Kt|=2;var v=Ok();(mn!==e||Mn!==t)&&(fa=null,Uc=Ur()+500,jl(e,t));do try{PP();break}catch(c){Fk(e,c)}while(!0);wv(),Lm.current=v,Kt=p,Gr!==null?t=0:(mn=null,Mn=0,t=Jr)}if(t!==0){if(t===2&&(p=j_(e),p!==0&&(l=p,t=p0(e,p))),t===1)throw s=Jd,jl(e,0),yo(e,l),xi(e,Ur()),s;if(t===6)yo(e,l);else{if(p=e.current.alternate,!(l&30)&&!IP(p)&&(t=Om(e,l),t===2&&(v=j_(e),v!==0&&(l=v,t=p0(e,v))),t===1))throw s=Jd,jl(e,0),yo(e,l),xi(e,Ur()),s;switch(e.finishedWork=p,e.finishedLanes=l,t){case 0:case 1:throw Error(Ne(345));case 2:Sl(e,mi,fa);break;case 3:if(yo(e,l),(l&130023424)===l&&(t=Fv+500-Ur(),10<t)){if(vm(e,0)!==0)break;if(p=e.suspendedLanes,(p&l)!==l){ti(),e.pingedLanes|=e.suspendedLanes&p;break}e.timeoutHandle=W_(Sl.bind(null,e,mi,fa),t);break}Sl(e,mi,fa);break;case 4:if(yo(e,l),(l&4194240)===l)break;for(t=e.eventTimes,p=-1;0<l;){var y=31-bs(l);v=1<<y,y=t[y],y>p&&(p=y),l&=~v}if(l=p,l=Ur()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*MP(l/1960))-l,10<l){e.timeoutHandle=W_(Sl.bind(null,e,mi,fa),l);break}Sl(e,mi,fa);break;case 5:Sl(e,mi,fa);break;default:throw Error(Ne(329))}}}return xi(e,Ur()),e.callbackNode===s?Rk.bind(null,e):null}function p0(e,t){var s=Ld;return e.current.memoizedState.isDehydrated&&(jl(e,t).flags|=256),e=Om(e,t),e!==2&&(t=mi,mi=s,t!==null&&m0(t)),e}function m0(e){mi===null?mi=e:mi.push.apply(mi,e)}function IP(e){for(var t=e;;){if(t.flags&16384){var s=t.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var l=0;l<s.length;l++){var p=s[l],v=p.getSnapshot;p=p.value;try{if(!ks(v(),p))return!1}catch{return!1}}}if(s=t.child,t.subtreeFlags&16384&&s!==null)s.return=t,t=s;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function yo(e,t){for(t&=~Rv,t&=~dg,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-bs(t),l=1<<s;e[s]=-1,t&=~l}}function ab(e){if(Kt&6)throw Error(Ne(327));wc();var t=vm(e,0);if(!(t&1))return xi(e,Ur()),null;var s=Om(e,t);if(e.tag!==0&&s===2){var l=j_(e);l!==0&&(t=l,s=p0(e,l))}if(s===1)throw s=Jd,jl(e,0),yo(e,t),xi(e,Ur()),s;if(s===6)throw Error(Ne(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Sl(e,mi,fa),xi(e,Ur()),null}function Ov(e,t){var s=Kt;Kt|=1;try{return e(t)}finally{Kt=s,Kt===0&&(Uc=Ur()+500,lg&&$o())}}function Wl(e){Mo!==null&&Mo.tag===0&&!(Kt&6)&&wc();var t=Kt;Kt|=1;var s=is.transition,l=lr;try{if(is.transition=null,lr=1,e)return e()}finally{lr=l,is.transition=s,Kt=t,!(Kt&6)&&$o()}}function Nv(){Li=fc.current,br(fc)}function jl(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,iP(s)),Gr!==null)for(s=Gr.return;s!==null;){var l=s;switch(_v(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&km();break;case 3:Bc(),br(_i),br(Vn),Mv();break;case 5:Cv(l);break;case 4:Bc();break;case 13:br(Pr);break;case 19:br(Pr);break;case 10:bv(l.type._context);break;case 22:case 23:Nv()}s=s.return}if(mn=e,Gr=e=Fo(e.current,null),Mn=Li=t,Jr=0,Jd=null,Rv=dg=Gl=0,mi=Ld=null,Cl!==null){for(t=0;t<Cl.length;t++)if(s=Cl[t],l=s.interleaved,l!==null){s.interleaved=null;var p=l.next,v=s.pending;if(v!==null){var y=v.next;v.next=p,l.next=y}s.pending=l}Cl=null}return e}function Fk(e,t){do{var s=Gr;try{if(wv(),im.current=Dm,zm){for(var l=Ar.memoizedState;l!==null;){var p=l.queue;p!==null&&(p.pending=null),l=l.next}zm=!1}if(Hl=0,pn=Qr=Ar=null,zd=!1,Kd=0,Lv.current=null,s===null||s.return===null){Jr=1,Jd=t,Gr=null;break}e:{var v=e,y=s.return,c=s,M=t;if(t=Mn,c.flags|=32768,M!==null&&typeof M=="object"&&typeof M.then=="function"){var I=M,j=c,z=j.tag;if(!(j.mode&1)&&(z===0||z===11||z===15)){var R=j.alternate;R?(j.updateQueue=R.updateQueue,j.memoizedState=R.memoizedState,j.lanes=R.lanes):(j.updateQueue=null,j.memoizedState=null)}var X=Gw(y);if(X!==null){X.flags&=-257,Ww(X,y,c,v,t),X.mode&1&&Hw(v,I,t),t=X,M=I;var me=t.updateQueue;if(me===null){var he=new Set;he.add(M),t.updateQueue=he}else me.add(M);break e}else{if(!(t&1)){Hw(v,I,t),Bv();break e}M=Error(Ne(426))}}else if(Cr&&c.mode&1){var ge=Gw(y);if(ge!==null){!(ge.flags&65536)&&(ge.flags|=256),Ww(ge,y,c,v,t),vv(jc(M,c));break e}}v=M=jc(M,c),Jr!==4&&(Jr=2),Ld===null?Ld=[v]:Ld.push(v),v=y;do{switch(v.tag){case 3:v.flags|=65536,t&=-t,v.lanes|=t;var W=vk(v,M,t);jw(v,W);break e;case 1:c=M;var Q=v.type,te=v.stateNode;if(!(v.flags&128)&&(typeof Q.getDerivedStateFromError=="function"||te!==null&&typeof te.componentDidCatch=="function"&&(Lo===null||!Lo.has(te)))){v.flags|=65536,t&=-t,v.lanes|=t;var oe=xk(v,c,t);jw(v,oe);break e}}v=v.return}while(v!==null)}Bk(s)}catch(Me){t=Me,Gr===s&&s!==null&&(Gr=s=s.return);continue}break}while(!0)}function Ok(){var e=Lm.current;return Lm.current=Dm,e===null?Dm:e}function Bv(){(Jr===0||Jr===3||Jr===2)&&(Jr=4),mn===null||!(Gl&268435455)&&!(dg&268435455)||yo(mn,Mn)}function Om(e,t){var s=Kt;Kt|=2;var l=Ok();(mn!==e||Mn!==t)&&(fa=null,jl(e,t));do try{EP();break}catch(p){Fk(e,p)}while(!0);if(wv(),Kt=s,Lm.current=l,Gr!==null)throw Error(Ne(261));return mn=null,Mn=0,Jr}function EP(){for(;Gr!==null;)Nk(Gr)}function PP(){for(;Gr!==null&&!tE();)Nk(Gr)}function Nk(e){var t=Uk(e.alternate,e,Li);e.memoizedProps=e.pendingProps,t===null?Bk(e):Gr=t,Lv.current=null}function Bk(e){var t=e;do{var s=t.alternate;if(e=t.return,t.flags&32768){if(s=SP(s,t),s!==null){s.flags&=32767,Gr=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Jr=6,Gr=null;return}}else if(s=bP(s,t,Li),s!==null){Gr=s;return}if(t=t.sibling,t!==null){Gr=t;return}Gr=t=e}while(t!==null);Jr===0&&(Jr=5)}function Sl(e,t,s){var l=lr,p=is.transition;try{is.transition=null,lr=1,AP(e,t,s,l)}finally{is.transition=p,lr=l}return null}function AP(e,t,s,l){do wc();while(Mo!==null);if(Kt&6)throw Error(Ne(327));s=e.finishedWork;var p=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(Ne(177));e.callbackNode=null,e.callbackPriority=0;var v=s.lanes|s.childLanes;if(hE(e,v),e===mn&&(Gr=mn=null,Mn=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||qp||(qp=!0,Vk(_m,function(){return wc(),null})),v=(s.flags&15990)!==0,s.subtreeFlags&15990||v){v=is.transition,is.transition=null;var y=lr;lr=1;var c=Kt;Kt|=4,Lv.current=null,TP(e,s),Dk(s,e),YE(H_),xm=!!Z_,H_=Z_=null,e.current=s,CP(s),rE(),Kt=c,lr=y,is.transition=v}else e.current=s;if(qp&&(qp=!1,Mo=e,Fm=p),v=e.pendingLanes,v===0&&(Lo=null),sE(s.stateNode),xi(e,Ur()),t!==null)for(l=e.onRecoverableError,s=0;s<t.length;s++)p=t[s],l(p.value,{componentStack:p.stack,digest:p.digest});if(Rm)throw Rm=!1,e=d0,d0=null,e;return Fm&1&&e.tag!==0&&wc(),v=e.pendingLanes,v&1?e===f0?Rd++:(Rd=0,f0=e):Rd=0,$o(),null}function wc(){if(Mo!==null){var e=vS(Fm),t=is.transition,s=lr;try{if(is.transition=null,lr=16>e?16:e,Mo===null)var l=!1;else{if(e=Mo,Mo=null,Fm=0,Kt&6)throw Error(Ne(331));var p=Kt;for(Kt|=4,ut=e.current;ut!==null;){var v=ut,y=v.child;if(ut.flags&16){var c=v.deletions;if(c!==null){for(var M=0;M<c.length;M++){var I=c[M];for(ut=I;ut!==null;){var j=ut;switch(j.tag){case 0:case 11:case 15:Dd(8,j,v)}var z=j.child;if(z!==null)z.return=j,ut=z;else for(;ut!==null;){j=ut;var R=j.sibling,X=j.return;if(Pk(j),j===I){ut=null;break}if(R!==null){R.return=X,ut=R;break}ut=X}}}var me=v.alternate;if(me!==null){var he=me.child;if(he!==null){me.child=null;do{var ge=he.sibling;he.sibling=null,he=ge}while(he!==null)}}ut=v}}if(v.subtreeFlags&2064&&y!==null)y.return=v,ut=y;else e:for(;ut!==null;){if(v=ut,v.flags&2048)switch(v.tag){case 0:case 11:case 15:Dd(9,v,v.return)}var W=v.sibling;if(W!==null){W.return=v.return,ut=W;break e}ut=v.return}}var Q=e.current;for(ut=Q;ut!==null;){y=ut;var te=y.child;if(y.subtreeFlags&2064&&te!==null)te.return=y,ut=te;else e:for(y=Q;ut!==null;){if(c=ut,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:hg(9,c)}}catch(Me){Br(c,c.return,Me)}if(c===y){ut=null;break e}var oe=c.sibling;if(oe!==null){oe.return=c.return,ut=oe;break e}ut=c.return}}if(Kt=p,$o(),qs&&typeof qs.onPostCommitFiberRoot=="function")try{qs.onPostCommitFiberRoot(ng,e)}catch{}l=!0}return l}finally{lr=s,is.transition=t}}return!1}function ob(e,t,s){t=jc(s,t),t=vk(e,t,1),e=Do(e,t,1),t=ti(),e!==null&&(mf(e,1,t),xi(e,t))}function Br(e,t,s){if(e.tag===3)ob(e,e,s);else for(;t!==null;){if(t.tag===3){ob(t,e,s);break}else if(t.tag===1){var l=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Lo===null||!Lo.has(l))){e=jc(s,e),e=xk(t,e,1),t=Do(t,e,1),e=ti(),t!==null&&(mf(t,1,e),xi(t,e));break}}t=t.return}}function zP(e,t,s){var l=e.pingCache;l!==null&&l.delete(t),t=ti(),e.pingedLanes|=e.suspendedLanes&s,mn===e&&(Mn&s)===s&&(Jr===4||Jr===3&&(Mn&130023424)===Mn&&500>Ur()-Fv?jl(e,0):Rv|=s),xi(e,t)}function jk(e,t){t===0&&(e.mode&1?(t=Lp,Lp<<=1,!(Lp&130023424)&&(Lp=4194304)):t=1);var s=ti();e=ka(e,t),e!==null&&(mf(e,t,s),xi(e,s))}function DP(e){var t=e.memoizedState,s=0;t!==null&&(s=t.retryLane),jk(e,s)}function LP(e,t){var s=0;switch(e.tag){case 13:var l=e.stateNode,p=e.memoizedState;p!==null&&(s=p.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(Ne(314))}l!==null&&l.delete(t),jk(e,s)}var Uk;Uk=function(e,t,s){if(e!==null)if(e.memoizedProps!==t.pendingProps||_i.current)gi=!0;else{if(!(e.lanes&s)&&!(t.flags&128))return gi=!1,wP(e,t,s);gi=!!(e.flags&131072)}else gi=!1,Cr&&t.flags&1048576&&ZS(t,Mm,t.index);switch(t.lanes=0,t.tag){case 2:var l=t.type;am(e,t),e=t.pendingProps;var p=Fc(t,Vn.current);xc(t,s),p=Ev(null,t,l,e,p,s);var v=Pv();return t.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,vi(l)?(v=!0,Tm(t)):v=!1,t.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,kv(t),p.updater=cg,t.stateNode=p,p._reactInternals=t,t0(t,l,e,s),t=i0(null,t,l,!0,v,s)):(t.tag=0,Cr&&v&&yv(t),ei(null,t,p,s),t=t.child),t;case 16:l=t.elementType;e:{switch(am(e,t),e=t.pendingProps,p=l._init,l=p(l._payload),t.type=l,p=t.tag=FP(l),e=ms(l,e),p){case 0:t=n0(null,t,l,e,s);break e;case 1:t=Yw(null,t,l,e,s);break e;case 11:t=Xw(null,t,l,e,s);break e;case 14:t=Kw(null,t,l,ms(l.type,e),s);break e}throw Error(Ne(306,l,""))}return t;case 0:return l=t.type,p=t.pendingProps,p=t.elementType===l?p:ms(l,p),n0(e,t,l,p,s);case 1:return l=t.type,p=t.pendingProps,p=t.elementType===l?p:ms(l,p),Yw(e,t,l,p,s);case 3:e:{if(kk(t),e===null)throw Error(Ne(387));l=t.pendingProps,v=t.memoizedState,p=v.element,YS(e,t),Pm(t,l,null,s);var y=t.memoizedState;if(l=y.element,v.isDehydrated)if(v={element:l,isDehydrated:!1,cache:y.cache,pendingSuspenseBoundaries:y.pendingSuspenseBoundaries,transitions:y.transitions},t.updateQueue.baseState=v,t.memoizedState=v,t.flags&256){p=jc(Error(Ne(423)),t),t=Qw(e,t,l,s,p);break e}else if(l!==p){p=jc(Error(Ne(424)),t),t=Qw(e,t,l,s,p);break e}else for(Fi=zo(t.stateNode.containerInfo.firstChild),Oi=t,Cr=!0,vs=null,s=XS(t,null,l,s),t.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Oc(),l===p){t=Ta(e,t,s);break e}ei(e,t,l,s)}t=t.child}return t;case 5:return QS(t),e===null&&Q_(t),l=t.type,p=t.pendingProps,v=e!==null?e.memoizedProps:null,y=p.children,G_(l,p)?y=null:v!==null&&G_(l,v)&&(t.flags|=32),Sk(e,t),ei(e,t,y,s),t.child;case 6:return e===null&&Q_(t),null;case 13:return Tk(e,t,s);case 4:return Tv(t,t.stateNode.containerInfo),l=t.pendingProps,e===null?t.child=Nc(t,null,l,s):ei(e,t,l,s),t.child;case 11:return l=t.type,p=t.pendingProps,p=t.elementType===l?p:ms(l,p),Xw(e,t,l,p,s);case 7:return ei(e,t,t.pendingProps,s),t.child;case 8:return ei(e,t,t.pendingProps.children,s),t.child;case 12:return ei(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(l=t.type._context,p=t.pendingProps,v=t.memoizedProps,y=p.value,gr(Im,l._currentValue),l._currentValue=y,v!==null)if(ks(v.value,y)){if(v.children===p.children&&!_i.current){t=Ta(e,t,s);break e}}else for(v=t.child,v!==null&&(v.return=t);v!==null;){var c=v.dependencies;if(c!==null){y=v.child;for(var M=c.firstContext;M!==null;){if(M.context===l){if(v.tag===1){M=wa(-1,s&-s),M.tag=2;var I=v.updateQueue;if(I!==null){I=I.shared;var j=I.pending;j===null?M.next=M:(M.next=j.next,j.next=M),I.pending=M}}v.lanes|=s,M=v.alternate,M!==null&&(M.lanes|=s),J_(v.return,s,t),c.lanes|=s;break}M=M.next}}else if(v.tag===10)y=v.type===t.type?null:v.child;else if(v.tag===18){if(y=v.return,y===null)throw Error(Ne(341));y.lanes|=s,c=y.alternate,c!==null&&(c.lanes|=s),J_(y,s,t),y=v.sibling}else y=v.child;if(y!==null)y.return=v;else for(y=v;y!==null;){if(y===t){y=null;break}if(v=y.sibling,v!==null){v.return=y.return,y=v;break}y=y.return}v=y}ei(e,t,p.children,s),t=t.child}return t;case 9:return p=t.type,l=t.pendingProps.children,xc(t,s),p=ss(p),l=l(p),t.flags|=1,ei(e,t,l,s),t.child;case 14:return l=t.type,p=ms(l,t.pendingProps),p=ms(l.type,p),Kw(e,t,l,p,s);case 15:return wk(e,t,t.type,t.pendingProps,s);case 17:return l=t.type,p=t.pendingProps,p=t.elementType===l?p:ms(l,p),am(e,t),t.tag=1,vi(l)?(e=!0,Tm(t)):e=!1,xc(t,s),_k(t,l,p),t0(t,l,p,s),i0(null,t,l,!0,e,s);case 19:return Ck(e,t,s);case 22:return bk(e,t,s)}throw Error(Ne(156,t.tag))};function Vk(e,t){return mS(e,t)}function RP(e,t,s,l){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rs(e,t,s,l){return new RP(e,t,s,l)}function jv(e){return e=e.prototype,!(!e||!e.isReactComponent)}function FP(e){if(typeof e=="function")return jv(e)?1:0;if(e!=null){if(e=e.$$typeof,e===sv)return 11;if(e===av)return 14}return 2}function Fo(e,t){var s=e.alternate;return s===null?(s=rs(e.tag,t,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function um(e,t,s,l,p,v){var y=2;if(l=e,typeof e=="function")jv(e)&&(y=1);else if(typeof e=="string")y=5;else e:switch(e){case nc:return Ul(s.children,p,v,t);case iv:y=8,p|=8;break;case T_:return e=rs(12,s,t,p|2),e.elementType=T_,e.lanes=v,e;case C_:return e=rs(13,s,t,p),e.elementType=C_,e.lanes=v,e;case M_:return e=rs(19,s,t,p),e.elementType=M_,e.lanes=v,e;case Q2:return fg(s,p,v,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case K2:y=10;break e;case Y2:y=9;break e;case sv:y=11;break e;case av:y=14;break e;case po:y=16,l=null;break e}throw Error(Ne(130,e==null?e:typeof e,""))}return t=rs(y,s,t,p),t.elementType=e,t.type=l,t.lanes=v,t}function Ul(e,t,s,l){return e=rs(7,e,l,t),e.lanes=s,e}function fg(e,t,s,l){return e=rs(22,e,l,t),e.elementType=Q2,e.lanes=s,e.stateNode={isHidden:!1},e}function h_(e,t,s){return e=rs(6,e,null,t),e.lanes=s,e}function d_(e,t,s){return t=rs(4,e.children!==null?e.children:[],e.key,t),t.lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function OP(e,t,s,l,p){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hy(0),this.expirationTimes=Hy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hy(0),this.identifierPrefix=l,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function Uv(e,t,s,l,p,v,y,c,M){return e=new OP(e,t,s,c,M),t===1?(t=1,v===!0&&(t|=8)):t=0,v=rs(3,null,null,t),e.current=v,v.stateNode=e,v.memoizedState={element:l,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},kv(v),e}function NP(e,t,s){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:rc,key:l==null?null:""+l,children:e,containerInfo:t,implementation:s}}function $k(e){if(!e)return jo;e=e._reactInternals;e:{if(eu(e)!==e||e.tag!==1)throw Error(Ne(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(vi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ne(171))}if(e.tag===1){var s=e.type;if(vi(s))return $S(e,s,t)}return t}function qk(e,t,s,l,p,v,y,c,M){return e=Uv(s,l,!0,e,p,v,y,c,M),e.context=$k(null),s=e.current,l=ti(),p=Ro(s),v=wa(l,p),v.callback=t??null,Do(s,v,p),e.current.lanes=p,mf(e,p,l),xi(e,l),e}function pg(e,t,s,l){var p=t.current,v=ti(),y=Ro(p);return s=$k(s),t.context===null?t.context=s:t.pendingContext=s,t=wa(v,y),t.payload={element:e},l=l===void 0?null:l,l!==null&&(t.callback=l),e=Do(p,t,y),e!==null&&(Ss(e,p,y,v),nm(e,p,y)),y}function Nm(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function lb(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<t?s:t}}function Vv(e,t){lb(e,t),(e=e.alternate)&&lb(e,t)}function BP(){return null}var Zk=typeof reportError=="function"?reportError:function(e){console.error(e)};function $v(e){this._internalRoot=e}mg.prototype.render=$v.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ne(409));pg(e,t,null,null)};mg.prototype.unmount=$v.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Wl(function(){pg(null,e,null,null)}),t[Sa]=null}};function mg(e){this._internalRoot=e}mg.prototype.unstable_scheduleHydration=function(e){if(e){var t=bS();e={blockedOn:null,target:e,priority:t};for(var s=0;s<go.length&&t!==0&&t<go[s].priority;s++);go.splice(s,0,e),s===0&&kS(e)}};function qv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function gg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ub(){}function jP(e,t,s,l,p){if(p){if(typeof l=="function"){var v=l;l=function(){var I=Nm(y);v.call(I)}}var y=qk(t,l,e,0,null,!1,!1,"",ub);return e._reactRootContainer=y,e[Sa]=y.current,Zd(e.nodeType===8?e.parentNode:e),Wl(),y}for(;p=e.lastChild;)e.removeChild(p);if(typeof l=="function"){var c=l;l=function(){var I=Nm(M);c.call(I)}}var M=Uv(e,0,!1,null,null,!1,!1,"",ub);return e._reactRootContainer=M,e[Sa]=M.current,Zd(e.nodeType===8?e.parentNode:e),Wl(function(){pg(t,M,s,l)}),M}function yg(e,t,s,l,p){var v=s._reactRootContainer;if(v){var y=v;if(typeof p=="function"){var c=p;p=function(){var M=Nm(y);c.call(M)}}pg(t,y,e,p)}else y=jP(s,t,e,p,l);return Nm(y)}xS=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=wd(t.pendingLanes);s!==0&&(uv(t,s|1),xi(t,Ur()),!(Kt&6)&&(Uc=Ur()+500,$o()))}break;case 13:Wl(function(){var l=ka(e,1);if(l!==null){var p=ti();Ss(l,e,1,p)}}),Vv(e,1)}};cv=function(e){if(e.tag===13){var t=ka(e,134217728);if(t!==null){var s=ti();Ss(t,e,134217728,s)}Vv(e,134217728)}};wS=function(e){if(e.tag===13){var t=Ro(e),s=ka(e,t);if(s!==null){var l=ti();Ss(s,e,t,l)}Vv(e,t)}};bS=function(){return lr};SS=function(e,t){var s=lr;try{return lr=e,t()}finally{lr=s}};O_=function(e,t,s){switch(t){case"input":if(P_(e,s),t=s.name,s.type==="radio"&&t!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var l=s[t];if(l!==e&&l.form===e.form){var p=og(l);if(!p)throw Error(Ne(90));eS(l),P_(l,p)}}}break;case"textarea":rS(e,s);break;case"select":t=s.value,t!=null&&gc(e,!!s.multiple,t,!1)}};uS=Ov;cS=Wl;var UP={usingClientEntryPoint:!1,Events:[yf,oc,og,oS,lS,Ov]},fd={findFiberByHostInstance:Tl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},VP={bundleType:fd.bundleType,version:fd.version,rendererPackageName:fd.rendererPackageName,rendererConfig:fd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ea.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=fS(e),e===null?null:e.stateNode},findFiberByHostInstance:fd.findFiberByHostInstance||BP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zp.isDisabled&&Zp.supportsFiber)try{ng=Zp.inject(VP),qs=Zp}catch{}}ji.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UP;ji.createPortal=function(e,t){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!qv(t))throw Error(Ne(200));return NP(e,t,null,s)};ji.createRoot=function(e,t){if(!qv(e))throw Error(Ne(299));var s=!1,l="",p=Zk;return t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(l=t.identifierPrefix),t.onRecoverableError!==void 0&&(p=t.onRecoverableError)),t=Uv(e,1,!1,null,null,s,!1,l,p),e[Sa]=t.current,Zd(e.nodeType===8?e.parentNode:e),new $v(t)};ji.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ne(188)):(e=Object.keys(e).join(","),Error(Ne(268,e)));return e=fS(t),e=e===null?null:e.stateNode,e};ji.flushSync=function(e){return Wl(e)};ji.hydrate=function(e,t,s){if(!gg(t))throw Error(Ne(200));return yg(null,e,t,!0,s)};ji.hydrateRoot=function(e,t,s){if(!qv(e))throw Error(Ne(405));var l=s!=null&&s.hydratedSources||null,p=!1,v="",y=Zk;if(s!=null&&(s.unstable_strictMode===!0&&(p=!0),s.identifierPrefix!==void 0&&(v=s.identifierPrefix),s.onRecoverableError!==void 0&&(y=s.onRecoverableError)),t=qk(t,null,e,1,s??null,p,!1,v,y),e[Sa]=t.current,Zd(e),l)for(e=0;e<l.length;e++)s=l[e],p=s._getVersion,p=p(s._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[s,p]:t.mutableSourceEagerHydrationData.push(s,p);return new mg(t)};ji.render=function(e,t,s){if(!gg(t))throw Error(Ne(200));return yg(null,e,t,!1,s)};ji.unmountComponentAtNode=function(e){if(!gg(e))throw Error(Ne(40));return e._reactRootContainer?(Wl(function(){yg(null,null,e,!1,function(){e._reactRootContainer=null,e[Sa]=null})}),!0):!1};ji.unstable_batchedUpdates=Ov;ji.unstable_renderSubtreeIntoContainer=function(e,t,s,l){if(!gg(s))throw Error(Ne(200));if(e==null||e._reactInternals===void 0)throw Error(Ne(38));return yg(e,t,s,!1,l)};ji.version="18.3.1-next-f1338f8080-20240426";function Hk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Hk)}catch(e){console.error(e)}}Hk(),H2.exports=ji;var $P=H2.exports,Gk,cb=$P;Gk=cb.createRoot,cb.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ef(){return ef=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},ef.apply(this,arguments)}var Io;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Io||(Io={}));const hb="popstate";function qP(e){e===void 0&&(e={});function t(l,p){let{pathname:v,search:y,hash:c}=l.location;return g0("",{pathname:v,search:y,hash:c},p.state&&p.state.usr||null,p.state&&p.state.key||"default")}function s(l,p){return typeof p=="string"?p:Bm(p)}return HP(t,s,null,e)}function Wr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Zv(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function ZP(){return Math.random().toString(36).substr(2,8)}function db(e,t){return{usr:e.state,key:e.key,idx:t}}function g0(e,t,s,l){return s===void 0&&(s=null),ef({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Kc(t):t,{state:s,key:t&&t.key||l||ZP()})}function Bm(e){let{pathname:t="/",search:s="",hash:l=""}=e;return s&&s!=="?"&&(t+=s.charAt(0)==="?"?s:"?"+s),l&&l!=="#"&&(t+=l.charAt(0)==="#"?l:"#"+l),t}function Kc(e){let t={};if(e){let s=e.indexOf("#");s>=0&&(t.hash=e.substr(s),e=e.substr(0,s));let l=e.indexOf("?");l>=0&&(t.search=e.substr(l),e=e.substr(0,l)),e&&(t.pathname=e)}return t}function HP(e,t,s,l){l===void 0&&(l={});let{window:p=document.defaultView,v5Compat:v=!1}=l,y=p.history,c=Io.Pop,M=null,I=j();I==null&&(I=0,y.replaceState(ef({},y.state,{idx:I}),""));function j(){return(y.state||{idx:null}).idx}function z(){c=Io.Pop;let ge=j(),W=ge==null?null:ge-I;I=ge,M&&M({action:c,location:he.location,delta:W})}function R(ge,W){c=Io.Push;let Q=g0(he.location,ge,W);I=j()+1;let te=db(Q,I),oe=he.createHref(Q);try{y.pushState(te,"",oe)}catch(Me){if(Me instanceof DOMException&&Me.name==="DataCloneError")throw Me;p.location.assign(oe)}v&&M&&M({action:c,location:he.location,delta:1})}function X(ge,W){c=Io.Replace;let Q=g0(he.location,ge,W);I=j();let te=db(Q,I),oe=he.createHref(Q);y.replaceState(te,"",oe),v&&M&&M({action:c,location:he.location,delta:0})}function me(ge){let W=p.location.origin!=="null"?p.location.origin:p.location.href,Q=typeof ge=="string"?ge:Bm(ge);return Q=Q.replace(/ $/,"%20"),Wr(W,"No window.location.(origin|href) available to create URL for href: "+Q),new URL(Q,W)}let he={get action(){return c},get location(){return e(p,y)},listen(ge){if(M)throw new Error("A history only accepts one active listener");return p.addEventListener(hb,z),M=ge,()=>{p.removeEventListener(hb,z),M=null}},createHref(ge){return t(p,ge)},createURL:me,encodeLocation(ge){let W=me(ge);return{pathname:W.pathname,search:W.search,hash:W.hash}},push:R,replace:X,go(ge){return y.go(ge)}};return he}var fb;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(fb||(fb={}));function GP(e,t,s){return s===void 0&&(s="/"),WP(e,t,s)}function WP(e,t,s,l){let p=typeof t=="string"?Kc(t):t,v=Hv(p.pathname||"/",s);if(v==null)return null;let y=Wk(e);XP(y);let c=null;for(let M=0;c==null&&M<y.length;++M){let I=oA(v);c=iA(y[M],I)}return c}function Wk(e,t,s,l){t===void 0&&(t=[]),s===void 0&&(s=[]),l===void 0&&(l="");let p=(v,y,c)=>{let M={relativePath:c===void 0?v.path||"":c,caseSensitive:v.caseSensitive===!0,childrenIndex:y,route:v};M.relativePath.startsWith("/")&&(Wr(M.relativePath.startsWith(l),'Absolute route path "'+M.relativePath+'" nested under path '+('"'+l+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),M.relativePath=M.relativePath.slice(l.length));let I=Oo([l,M.relativePath]),j=s.concat(M);v.children&&v.children.length>0&&(Wr(v.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+I+'".')),Wk(v.children,t,j,I)),!(v.path==null&&!v.index)&&t.push({path:I,score:rA(I,v.index),routesMeta:j})};return e.forEach((v,y)=>{var c;if(v.path===""||!((c=v.path)!=null&&c.includes("?")))p(v,y);else for(let M of Xk(v.path))p(v,y,M)}),t}function Xk(e){let t=e.split("/");if(t.length===0)return[];let[s,...l]=t,p=s.endsWith("?"),v=s.replace(/\?$/,"");if(l.length===0)return p?[v,""]:[v];let y=Xk(l.join("/")),c=[];return c.push(...y.map(M=>M===""?v:[v,M].join("/"))),p&&c.push(...y),c.map(M=>e.startsWith("/")&&M===""?"/":M)}function XP(e){e.sort((t,s)=>t.score!==s.score?s.score-t.score:nA(t.routesMeta.map(l=>l.childrenIndex),s.routesMeta.map(l=>l.childrenIndex)))}const KP=/^:[\w-]+$/,YP=3,QP=2,JP=1,eA=10,tA=-2,pb=e=>e==="*";function rA(e,t){let s=e.split("/"),l=s.length;return s.some(pb)&&(l+=tA),t&&(l+=QP),s.filter(p=>!pb(p)).reduce((p,v)=>p+(KP.test(v)?YP:v===""?JP:eA),l)}function nA(e,t){return e.length===t.length&&e.slice(0,-1).every((l,p)=>l===t[p])?e[e.length-1]-t[t.length-1]:0}function iA(e,t,s){let{routesMeta:l}=e,p={},v="/",y=[];for(let c=0;c<l.length;++c){let M=l[c],I=c===l.length-1,j=v==="/"?t:t.slice(v.length)||"/",z=sA({path:M.relativePath,caseSensitive:M.caseSensitive,end:I},j),R=M.route;if(!z)return null;Object.assign(p,z.params),y.push({params:p,pathname:Oo([v,z.pathname]),pathnameBase:dA(Oo([v,z.pathnameBase])),route:R}),z.pathnameBase!=="/"&&(v=Oo([v,z.pathnameBase]))}return y}function sA(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[s,l]=aA(e.path,e.caseSensitive,e.end),p=t.match(s);if(!p)return null;let v=p[0],y=v.replace(/(.)\/+$/,"$1"),c=p.slice(1);return{params:l.reduce((I,j,z)=>{let{paramName:R,isOptional:X}=j;if(R==="*"){let he=c[z]||"";y=v.slice(0,v.length-he.length).replace(/(.)\/+$/,"$1")}const me=c[z];return X&&!me?I[R]=void 0:I[R]=(me||"").replace(/%2F/g,"/"),I},{}),pathname:v,pathnameBase:y,pattern:e}}function aA(e,t,s){t===void 0&&(t=!1),s===void 0&&(s=!0),Zv(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let l=[],p="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(y,c,M)=>(l.push({paramName:c,isOptional:M!=null}),M?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(l.push({paramName:"*"}),p+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?p+="\\/*$":e!==""&&e!=="/"&&(p+="(?:(?=\\/|$))"),[new RegExp(p,t?void 0:"i"),l]}function oA(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Zv(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Hv(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,l=e.charAt(s);return l&&l!=="/"?null:e.slice(s)||"/"}const lA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,uA=e=>lA.test(e);function cA(e,t){t===void 0&&(t="/");let{pathname:s,search:l="",hash:p=""}=typeof e=="string"?Kc(e):e,v;if(s)if(uA(s))v=s;else{if(s.includes("//")){let y=s;s=s.replace(/\/\/+/g,"/"),Zv(!1,"Pathnames cannot have embedded double slashes - normalizing "+(y+" -> "+s))}s.startsWith("/")?v=mb(s.substring(1),"/"):v=mb(s,t)}else v=t;return{pathname:v,search:fA(l),hash:pA(p)}}function mb(e,t){let s=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(p=>{p===".."?s.length>1&&s.pop():p!=="."&&s.push(p)}),s.length>1?s.join("/"):"/"}function f_(e,t,s,l){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(l)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function hA(e){return e.filter((t,s)=>s===0||t.route.path&&t.route.path.length>0)}function Kk(e,t){let s=hA(e);return t?s.map((l,p)=>p===s.length-1?l.pathname:l.pathnameBase):s.map(l=>l.pathnameBase)}function Yk(e,t,s,l){l===void 0&&(l=!1);let p;typeof e=="string"?p=Kc(e):(p=ef({},e),Wr(!p.pathname||!p.pathname.includes("?"),f_("?","pathname","search",p)),Wr(!p.pathname||!p.pathname.includes("#"),f_("#","pathname","hash",p)),Wr(!p.search||!p.search.includes("#"),f_("#","search","hash",p)));let v=e===""||p.pathname==="",y=v?"/":p.pathname,c;if(y==null)c=s;else{let z=t.length-1;if(!l&&y.startsWith("..")){let R=y.split("/");for(;R[0]==="..";)R.shift(),z-=1;p.pathname=R.join("/")}c=z>=0?t[z]:"/"}let M=cA(p,c),I=y&&y!=="/"&&y.endsWith("/"),j=(v||y===".")&&s.endsWith("/");return!M.pathname.endsWith("/")&&(I||j)&&(M.pathname+="/"),M}const Oo=e=>e.join("/").replace(/\/\/+/g,"/"),dA=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),fA=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,pA=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function mA(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Qk=["post","put","patch","delete"];new Set(Qk);const gA=["get",...Qk];new Set(gA);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tf(){return tf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},tf.apply(this,arguments)}const Gv=Pe.createContext(null),yA=Pe.createContext(null),tu=Pe.createContext(null),_g=Pe.createContext(null),ru=Pe.createContext({outlet:null,matches:[],isDataRoute:!1}),Jk=Pe.createContext(null);function _A(e,t){let{relative:s}=t===void 0?{}:t;vf()||Wr(!1);let{basename:l,navigator:p}=Pe.useContext(tu),{hash:v,pathname:y,search:c}=tT(e,{relative:s}),M=y;return l!=="/"&&(M=y==="/"?l:Oo([l,y])),p.createHref({pathname:M,search:c,hash:v})}function vf(){return Pe.useContext(_g)!=null}function xf(){return vf()||Wr(!1),Pe.useContext(_g).location}function eT(e){Pe.useContext(tu).static||Pe.useLayoutEffect(e)}function vA(){let{isDataRoute:e}=Pe.useContext(ru);return e?zA():xA()}function xA(){vf()||Wr(!1);let e=Pe.useContext(Gv),{basename:t,future:s,navigator:l}=Pe.useContext(tu),{matches:p}=Pe.useContext(ru),{pathname:v}=xf(),y=JSON.stringify(Kk(p,s.v7_relativeSplatPath)),c=Pe.useRef(!1);return eT(()=>{c.current=!0}),Pe.useCallback(function(I,j){if(j===void 0&&(j={}),!c.current)return;if(typeof I=="number"){l.go(I);return}let z=Yk(I,JSON.parse(y),v,j.relative==="path");e==null&&t!=="/"&&(z.pathname=z.pathname==="/"?t:Oo([t,z.pathname])),(j.replace?l.replace:l.push)(z,j.state,j)},[t,l,y,v,e])}function tT(e,t){let{relative:s}=t===void 0?{}:t,{future:l}=Pe.useContext(tu),{matches:p}=Pe.useContext(ru),{pathname:v}=xf(),y=JSON.stringify(Kk(p,l.v7_relativeSplatPath));return Pe.useMemo(()=>Yk(e,JSON.parse(y),v,s==="path"),[e,y,v,s])}function wA(e,t){return bA(e,t)}function bA(e,t,s,l){vf()||Wr(!1);let{navigator:p}=Pe.useContext(tu),{matches:v}=Pe.useContext(ru),y=v[v.length-1],c=y?y.params:{};y&&y.pathname;let M=y?y.pathnameBase:"/";y&&y.route;let I=xf(),j;if(t){var z;let ge=typeof t=="string"?Kc(t):t;M==="/"||(z=ge.pathname)!=null&&z.startsWith(M)||Wr(!1),j=ge}else j=I;let R=j.pathname||"/",X=R;if(M!=="/"){let ge=M.replace(/^\//,"").split("/");X="/"+R.replace(/^\//,"").split("/").slice(ge.length).join("/")}let me=GP(e,{pathname:X}),he=MA(me&&me.map(ge=>Object.assign({},ge,{params:Object.assign({},c,ge.params),pathname:Oo([M,p.encodeLocation?p.encodeLocation(ge.pathname).pathname:ge.pathname]),pathnameBase:ge.pathnameBase==="/"?M:Oo([M,p.encodeLocation?p.encodeLocation(ge.pathnameBase).pathname:ge.pathnameBase])})),v,s,l);return t&&he?Pe.createElement(_g.Provider,{value:{location:tf({pathname:"/",search:"",hash:"",state:null,key:"default"},j),navigationType:Io.Pop}},he):he}function SA(){let e=AA(),t=mA(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,p={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Pe.createElement(Pe.Fragment,null,Pe.createElement("h2",null,"Unexpected Application Error!"),Pe.createElement("h3",{style:{fontStyle:"italic"}},t),s?Pe.createElement("pre",{style:p},s):null,null)}const kA=Pe.createElement(SA,null);class TA extends Pe.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,s){return s.location!==t.location||s.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:s.error,location:s.location,revalidation:t.revalidation||s.revalidation}}componentDidCatch(t,s){console.error("React Router caught the following error during render",t,s)}render(){return this.state.error!==void 0?Pe.createElement(ru.Provider,{value:this.props.routeContext},Pe.createElement(Jk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function CA(e){let{routeContext:t,match:s,children:l}=e,p=Pe.useContext(Gv);return p&&p.static&&p.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(p.staticContext._deepestRenderedBoundaryId=s.route.id),Pe.createElement(ru.Provider,{value:t},l)}function MA(e,t,s,l){var p;if(t===void 0&&(t=[]),s===void 0&&(s=null),l===void 0&&(l=null),e==null){var v;if(!s)return null;if(s.errors)e=s.matches;else if((v=l)!=null&&v.v7_partialHydration&&t.length===0&&!s.initialized&&s.matches.length>0)e=s.matches;else return null}let y=e,c=(p=s)==null?void 0:p.errors;if(c!=null){let j=y.findIndex(z=>z.route.id&&(c==null?void 0:c[z.route.id])!==void 0);j>=0||Wr(!1),y=y.slice(0,Math.min(y.length,j+1))}let M=!1,I=-1;if(s&&l&&l.v7_partialHydration)for(let j=0;j<y.length;j++){let z=y[j];if((z.route.HydrateFallback||z.route.hydrateFallbackElement)&&(I=j),z.route.id){let{loaderData:R,errors:X}=s,me=z.route.loader&&R[z.route.id]===void 0&&(!X||X[z.route.id]===void 0);if(z.route.lazy||me){M=!0,I>=0?y=y.slice(0,I+1):y=[y[0]];break}}}return y.reduceRight((j,z,R)=>{let X,me=!1,he=null,ge=null;s&&(X=c&&z.route.id?c[z.route.id]:void 0,he=z.route.errorElement||kA,M&&(I<0&&R===0?(DA("route-fallback"),me=!0,ge=null):I===R&&(me=!0,ge=z.route.hydrateFallbackElement||null)));let W=t.concat(y.slice(0,R+1)),Q=()=>{let te;return X?te=he:me?te=ge:z.route.Component?te=Pe.createElement(z.route.Component,null):z.route.element?te=z.route.element:te=j,Pe.createElement(CA,{match:z,routeContext:{outlet:j,matches:W,isDataRoute:s!=null},children:te})};return s&&(z.route.ErrorBoundary||z.route.errorElement||R===0)?Pe.createElement(TA,{location:s.location,revalidation:s.revalidation,component:he,error:X,children:Q(),routeContext:{outlet:null,matches:W,isDataRoute:!0}}):Q()},null)}var rT=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(rT||{}),nT=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(nT||{});function IA(e){let t=Pe.useContext(Gv);return t||Wr(!1),t}function EA(e){let t=Pe.useContext(yA);return t||Wr(!1),t}function PA(e){let t=Pe.useContext(ru);return t||Wr(!1),t}function iT(e){let t=PA(),s=t.matches[t.matches.length-1];return s.route.id||Wr(!1),s.route.id}function AA(){var e;let t=Pe.useContext(Jk),s=EA(),l=iT();return t!==void 0?t:(e=s.errors)==null?void 0:e[l]}function zA(){let{router:e}=IA(rT.UseNavigateStable),t=iT(nT.UseNavigateStable),s=Pe.useRef(!1);return eT(()=>{s.current=!0}),Pe.useCallback(function(p,v){v===void 0&&(v={}),s.current&&(typeof p=="number"?e.navigate(p):e.navigate(p,tf({fromRouteId:t},v)))},[e,t])}const gb={};function DA(e,t,s){gb[e]||(gb[e]=!0)}function LA(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function cm(e){Wr(!1)}function RA(e){let{basename:t="/",children:s=null,location:l,navigationType:p=Io.Pop,navigator:v,static:y=!1,future:c}=e;vf()&&Wr(!1);let M=t.replace(/^\/*/,"/"),I=Pe.useMemo(()=>({basename:M,navigator:v,static:y,future:tf({v7_relativeSplatPath:!1},c)}),[M,c,v,y]);typeof l=="string"&&(l=Kc(l));let{pathname:j="/",search:z="",hash:R="",state:X=null,key:me="default"}=l,he=Pe.useMemo(()=>{let ge=Hv(j,M);return ge==null?null:{location:{pathname:ge,search:z,hash:R,state:X,key:me},navigationType:p}},[M,j,z,R,X,me,p]);return he==null?null:Pe.createElement(tu.Provider,{value:I},Pe.createElement(_g.Provider,{children:s,value:he}))}function FA(e){let{children:t,location:s}=e;return wA(y0(t),s)}new Promise(()=>{});function y0(e,t){t===void 0&&(t=[]);let s=[];return Pe.Children.forEach(e,(l,p)=>{if(!Pe.isValidElement(l))return;let v=[...t,p];if(l.type===Pe.Fragment){s.push.apply(s,y0(l.props.children,v));return}l.type!==cm&&Wr(!1),!l.props.index||!l.props.children||Wr(!1);let y={id:l.props.id||v.join("-"),caseSensitive:l.props.caseSensitive,element:l.props.element,Component:l.props.Component,index:l.props.index,path:l.props.path,loader:l.props.loader,action:l.props.action,errorElement:l.props.errorElement,ErrorBoundary:l.props.ErrorBoundary,hasErrorBoundary:l.props.ErrorBoundary!=null||l.props.errorElement!=null,shouldRevalidate:l.props.shouldRevalidate,handle:l.props.handle,lazy:l.props.lazy};l.props.children&&(y.children=y0(l.props.children,v)),s.push(y)}),s}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _0(){return _0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},_0.apply(this,arguments)}function OA(e,t){if(e==null)return{};var s={},l=Object.keys(e),p,v;for(v=0;v<l.length;v++)p=l[v],!(t.indexOf(p)>=0)&&(s[p]=e[p]);return s}function NA(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function BA(e,t){return e.button===0&&(!t||t==="_self")&&!NA(e)}const jA=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],UA="6";try{window.__reactRouterVersion=UA}catch{}const VA="startTransition",yb=zI[VA];function $A(e){let{basename:t,children:s,future:l,window:p}=e,v=Pe.useRef();v.current==null&&(v.current=qP({window:p,v5Compat:!0}));let y=v.current,[c,M]=Pe.useState({action:y.action,location:y.location}),{v7_startTransition:I}=l||{},j=Pe.useCallback(z=>{I&&yb?yb(()=>M(z)):M(z)},[M,I]);return Pe.useLayoutEffect(()=>y.listen(j),[y,j]),Pe.useEffect(()=>LA(l),[l]),Pe.createElement(RA,{basename:t,children:s,location:c.location,navigationType:c.action,navigator:y,future:l})}const qA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ZA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,HA=Pe.forwardRef(function(t,s){let{onClick:l,relative:p,reloadDocument:v,replace:y,state:c,target:M,to:I,preventScrollReset:j,viewTransition:z}=t,R=OA(t,jA),{basename:X}=Pe.useContext(tu),me,he=!1;if(typeof I=="string"&&ZA.test(I)&&(me=I,qA))try{let te=new URL(window.location.href),oe=I.startsWith("//")?new URL(te.protocol+I):new URL(I),Me=Hv(oe.pathname,X);oe.origin===te.origin&&Me!=null?I=Me+oe.search+oe.hash:he=!0}catch{}let ge=_A(I,{relative:p}),W=GA(I,{replace:y,state:c,target:M,preventScrollReset:j,relative:p,viewTransition:z});function Q(te){l&&l(te),te.defaultPrevented||W(te)}return Pe.createElement("a",_0({},R,{href:me||ge,onClick:he||v?l:Q,ref:s,target:M}))});var _b;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(_b||(_b={}));var vb;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(vb||(vb={}));function GA(e,t){let{target:s,replace:l,state:p,preventScrollReset:v,relative:y,viewTransition:c}=t===void 0?{}:t,M=vA(),I=xf(),j=tT(e,{relative:y});return Pe.useCallback(z=>{if(BA(z,s)){z.preventDefault();let R=l!==void 0?l:Bm(I)===Bm(j);M(e,{replace:R,state:p,preventScrollReset:v,relative:y,viewTransition:c})}},[I,M,j,l,p,s,e,v,y,c])}var wf=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},WA={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},_o,K0,k2,XA=(k2=class{constructor(){bt(this,_o,WA);bt(this,K0,!1)}setTimeoutProvider(e){at(this,_o,e)}setTimeout(e,t){return pe(this,_o).setTimeout(e,t)}clearTimeout(e){pe(this,_o).clearTimeout(e)}setInterval(e,t){return pe(this,_o).setInterval(e,t)}clearInterval(e){pe(this,_o).clearInterval(e)}},_o=new WeakMap,K0=new WeakMap,k2),Il=new XA;function KA(e){setTimeout(e,0)}var Xl=typeof window>"u"||"Deno"in globalThis;function pi(){}function YA(e,t){return typeof e=="function"?e(t):e}function v0(e){return typeof e=="number"&&e>=0&&e!==1/0}function sT(e,t){return Math.max(e+(t||0)-Date.now(),0)}function No(e,t){return typeof e=="function"?e(t):e}function Ji(e,t){return typeof e=="function"?e(t):e}function xb(e,t){const{type:s="all",exact:l,fetchStatus:p,predicate:v,queryKey:y,stale:c}=e;if(y){if(l){if(t.queryHash!==Wv(y,t.options))return!1}else if(!nf(t.queryKey,y))return!1}if(s!=="all"){const M=t.isActive();if(s==="active"&&!M||s==="inactive"&&M)return!1}return!(typeof c=="boolean"&&t.isStale()!==c||p&&p!==t.state.fetchStatus||v&&!v(t))}function wb(e,t){const{exact:s,status:l,predicate:p,mutationKey:v}=e;if(v){if(!t.options.mutationKey)return!1;if(s){if(rf(t.options.mutationKey)!==rf(v))return!1}else if(!nf(t.options.mutationKey,v))return!1}return!(l&&t.state.status!==l||p&&!p(t))}function Wv(e,t){return((t==null?void 0:t.queryKeyHashFn)||rf)(e)}function rf(e){return JSON.stringify(e,(t,s)=>w0(s)?Object.keys(s).sort().reduce((l,p)=>(l[p]=s[p],l),{}):s)}function nf(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(s=>nf(e[s],t[s])):!1}var QA=Object.prototype.hasOwnProperty;function aT(e,t,s=0){if(e===t)return e;if(s>500)return t;const l=bb(e)&&bb(t);if(!l&&!(w0(e)&&w0(t)))return t;const v=(l?e:Object.keys(e)).length,y=l?t:Object.keys(t),c=y.length,M=l?new Array(c):{};let I=0;for(let j=0;j<c;j++){const z=l?j:y[j],R=e[z],X=t[z];if(R===X){M[z]=R,(l?j<v:QA.call(e,z))&&I++;continue}if(R===null||X===null||typeof R!="object"||typeof X!="object"){M[z]=X;continue}const me=aT(R,X,s+1);M[z]=me,me===R&&I++}return v===c&&I===v?e:M}function x0(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}function bb(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function w0(e){if(!Sb(e))return!1;const t=e.constructor;if(t===void 0)return!0;const s=t.prototype;return!(!Sb(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Sb(e){return Object.prototype.toString.call(e)==="[object Object]"}function JA(e){return new Promise(t=>{Il.setTimeout(t,e)})}function b0(e,t,s){return typeof s.structuralSharing=="function"?s.structuralSharing(e,t):s.structuralSharing!==!1?aT(e,t):t}function ez(e,t,s=0){const l=[...e,t];return s&&l.length>s?l.slice(1):l}function tz(e,t,s=0){const l=[t,...e];return s&&l.length>s?l.slice(0,-1):l}var Xv=Symbol();function oT(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Xv?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function lT(e,t){return typeof e=="function"?e(...t):!!e}function rz(e,t,s){let l=!1,p;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(p??(p=t()),l||(l=!0,p.aborted?s():p.addEventListener("abort",s,{once:!0})),p)}),e}var Al,vo,Sc,T2,nz=(T2=class extends wf{constructor(){super();bt(this,Al);bt(this,vo);bt(this,Sc);at(this,Sc,t=>{if(!Xl&&window.addEventListener){const s=()=>t();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){pe(this,vo)||this.setEventListener(pe(this,Sc))}onUnsubscribe(){var t;this.hasListeners()||((t=pe(this,vo))==null||t.call(this),at(this,vo,void 0))}setEventListener(t){var s;at(this,Sc,t),(s=pe(this,vo))==null||s.call(this),at(this,vo,t(l=>{typeof l=="boolean"?this.setFocused(l):this.onFocus()}))}setFocused(t){pe(this,Al)!==t&&(at(this,Al,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(s=>{s(t)})}isFocused(){var t;return typeof pe(this,Al)=="boolean"?pe(this,Al):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Al=new WeakMap,vo=new WeakMap,Sc=new WeakMap,T2),Kv=new nz;function S0(){let e,t;const s=new Promise((p,v)=>{e=p,t=v});s.status="pending",s.catch(()=>{});function l(p){Object.assign(s,p),delete s.resolve,delete s.reject}return s.resolve=p=>{l({status:"fulfilled",value:p}),e(p)},s.reject=p=>{l({status:"rejected",reason:p}),t(p)},s}var iz=KA;function sz(){let e=[],t=0,s=c=>{c()},l=c=>{c()},p=iz;const v=c=>{t?e.push(c):p(()=>{s(c)})},y=()=>{const c=e;e=[],c.length&&p(()=>{l(()=>{c.forEach(M=>{s(M)})})})};return{batch:c=>{let M;t++;try{M=c()}finally{t--,t||y()}return M},batchCalls:c=>(...M)=>{v(()=>{c(...M)})},schedule:v,setNotifyFunction:c=>{s=c},setBatchNotifyFunction:c=>{l=c},setScheduler:c=>{p=c}}}var Cn=sz(),kc,xo,Tc,C2,az=(C2=class extends wf{constructor(){super();bt(this,kc,!0);bt(this,xo);bt(this,Tc);at(this,Tc,t=>{if(!Xl&&window.addEventListener){const s=()=>t(!0),l=()=>t(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",l,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",l)}}})}onSubscribe(){pe(this,xo)||this.setEventListener(pe(this,Tc))}onUnsubscribe(){var t;this.hasListeners()||((t=pe(this,xo))==null||t.call(this),at(this,xo,void 0))}setEventListener(t){var s;at(this,Tc,t),(s=pe(this,xo))==null||s.call(this),at(this,xo,t(this.setOnline.bind(this)))}setOnline(t){pe(this,kc)!==t&&(at(this,kc,t),this.listeners.forEach(l=>{l(t)}))}isOnline(){return pe(this,kc)}},kc=new WeakMap,xo=new WeakMap,Tc=new WeakMap,C2),jm=new az;function oz(e){return Math.min(1e3*2**e,3e4)}function uT(e){return(e??"online")==="online"?jm.isOnline():!0}var k0=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function cT(e){let t=!1,s=0,l;const p=S0(),v=()=>p.status!=="pending",y=he=>{var ge;if(!v()){const W=new k0(he);R(W),(ge=e.onCancel)==null||ge.call(e,W)}},c=()=>{t=!0},M=()=>{t=!1},I=()=>Kv.isFocused()&&(e.networkMode==="always"||jm.isOnline())&&e.canRun(),j=()=>uT(e.networkMode)&&e.canRun(),z=he=>{v()||(l==null||l(),p.resolve(he))},R=he=>{v()||(l==null||l(),p.reject(he))},X=()=>new Promise(he=>{var ge;l=W=>{(v()||I())&&he(W)},(ge=e.onPause)==null||ge.call(e)}).then(()=>{var he;l=void 0,v()||(he=e.onContinue)==null||he.call(e)}),me=()=>{if(v())return;let he;const ge=s===0?e.initialPromise:void 0;try{he=ge??e.fn()}catch(W){he=Promise.reject(W)}Promise.resolve(he).then(z).catch(W=>{var Se;if(v())return;const Q=e.retry??(Xl?0:3),te=e.retryDelay??oz,oe=typeof te=="function"?te(s,W):te,Me=Q===!0||typeof Q=="number"&&s<Q||typeof Q=="function"&&Q(s,W);if(t||!Me){R(W);return}s++,(Se=e.onFail)==null||Se.call(e,s,W),JA(oe).then(()=>I()?void 0:X()).then(()=>{t?R(W):me()})})};return{promise:p,status:()=>p.status,cancel:y,continue:()=>(l==null||l(),p),cancelRetry:c,continueRetry:M,canStart:j,start:()=>(j()?me():X().then(me),p)}}var zl,M2,hT=(M2=class{constructor(){bt(this,zl)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),v0(this.gcTime)&&at(this,zl,Il.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Xl?1/0:5*60*1e3))}clearGcTimeout(){pe(this,zl)&&(Il.clearTimeout(pe(this,zl)),at(this,zl,void 0))}},zl=new WeakMap,M2),Dl,Cc,Qi,Ll,dn,uf,Rl,gs,da,I2,lz=(I2=class extends hT{constructor(t){super();bt(this,gs);bt(this,Dl);bt(this,Cc);bt(this,Qi);bt(this,Ll);bt(this,dn);bt(this,uf);bt(this,Rl);at(this,Rl,!1),at(this,uf,t.defaultOptions),this.setOptions(t.options),this.observers=[],at(this,Ll,t.client),at(this,Qi,pe(this,Ll).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,at(this,Dl,Tb(this.options)),this.state=t.state??pe(this,Dl),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=pe(this,dn))==null?void 0:t.promise}setOptions(t){if(this.options={...pe(this,uf),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const s=Tb(this.options);s.data!==void 0&&(this.setState(kb(s.data,s.dataUpdatedAt)),at(this,Dl,s))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&pe(this,Qi).remove(this)}setData(t,s){const l=b0(this.state.data,t,this.options);return Ht(this,gs,da).call(this,{data:l,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),l}setState(t,s){Ht(this,gs,da).call(this,{type:"setState",state:t,setStateOptions:s})}cancel(t){var l,p;const s=(l=pe(this,dn))==null?void 0:l.promise;return(p=pe(this,dn))==null||p.cancel(t),s?s.then(pi).catch(pi):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(pe(this,Dl))}isActive(){return this.observers.some(t=>Ji(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Xv||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>No(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!sT(this.state.dataUpdatedAt,t)}onFocus(){var s;const t=this.observers.find(l=>l.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(s=pe(this,dn))==null||s.continue()}onOnline(){var s;const t=this.observers.find(l=>l.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(s=pe(this,dn))==null||s.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),pe(this,Qi).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(s=>s!==t),this.observers.length||(pe(this,dn)&&(pe(this,Rl)?pe(this,dn).cancel({revert:!0}):pe(this,dn).cancelRetry()),this.scheduleGc()),pe(this,Qi).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ht(this,gs,da).call(this,{type:"invalidate"})}async fetch(t,s){var M,I,j,z,R,X,me,he,ge,W,Q,te;if(this.state.fetchStatus!=="idle"&&((M=pe(this,dn))==null?void 0:M.status())!=="rejected"){if(this.state.data!==void 0&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(pe(this,dn))return pe(this,dn).continueRetry(),pe(this,dn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const oe=this.observers.find(Me=>Me.options.queryFn);oe&&this.setOptions(oe.options)}const l=new AbortController,p=oe=>{Object.defineProperty(oe,"signal",{enumerable:!0,get:()=>(at(this,Rl,!0),l.signal)})},v=()=>{const oe=oT(this.options,s),Se=(()=>{const ze={client:pe(this,Ll),queryKey:this.queryKey,meta:this.meta};return p(ze),ze})();return at(this,Rl,!1),this.options.persister?this.options.persister(oe,Se,this):oe(Se)},c=(()=>{const oe={fetchOptions:s,options:this.options,queryKey:this.queryKey,client:pe(this,Ll),state:this.state,fetchFn:v};return p(oe),oe})();(I=this.options.behavior)==null||I.onFetch(c,this),at(this,Cc,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((j=c.fetchOptions)==null?void 0:j.meta))&&Ht(this,gs,da).call(this,{type:"fetch",meta:(z=c.fetchOptions)==null?void 0:z.meta}),at(this,dn,cT({initialPromise:s==null?void 0:s.initialPromise,fn:c.fetchFn,onCancel:oe=>{oe instanceof k0&&oe.revert&&this.setState({...pe(this,Cc),fetchStatus:"idle"}),l.abort()},onFail:(oe,Me)=>{Ht(this,gs,da).call(this,{type:"failed",failureCount:oe,error:Me})},onPause:()=>{Ht(this,gs,da).call(this,{type:"pause"})},onContinue:()=>{Ht(this,gs,da).call(this,{type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0}));try{const oe=await pe(this,dn).start();if(oe===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(oe),(X=(R=pe(this,Qi).config).onSuccess)==null||X.call(R,oe,this),(he=(me=pe(this,Qi).config).onSettled)==null||he.call(me,oe,this.state.error,this),oe}catch(oe){if(oe instanceof k0){if(oe.silent)return pe(this,dn).promise;if(oe.revert){if(this.state.data===void 0)throw oe;return this.state.data}}throw Ht(this,gs,da).call(this,{type:"error",error:oe}),(W=(ge=pe(this,Qi).config).onError)==null||W.call(ge,oe,this),(te=(Q=pe(this,Qi).config).onSettled)==null||te.call(Q,this.state.data,oe,this),oe}finally{this.scheduleGc()}}},Dl=new WeakMap,Cc=new WeakMap,Qi=new WeakMap,Ll=new WeakMap,dn=new WeakMap,uf=new WeakMap,Rl=new WeakMap,gs=new WeakSet,da=function(t){const s=l=>{switch(t.type){case"failed":return{...l,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...l,fetchStatus:"paused"};case"continue":return{...l,fetchStatus:"fetching"};case"fetch":return{...l,...dT(l.data,this.options),fetchMeta:t.meta??null};case"success":const p={...l,...kb(t.data,t.dataUpdatedAt),dataUpdateCount:l.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return at(this,Cc,t.manual?p:void 0),p;case"error":const v=t.error;return{...l,error:v,errorUpdateCount:l.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:l.fetchFailureCount+1,fetchFailureReason:v,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...l,isInvalidated:!0};case"setState":return{...l,...t.state}}};this.state=s(this.state),Cn.batch(()=>{this.observers.forEach(l=>{l.onQueryUpdate()}),pe(this,Qi).notify({query:this,type:"updated",action:t})})},I2);function dT(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:uT(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function kb(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Tb(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,s=t!==void 0,l=s?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?l??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var fi,Gt,cf,Jn,Fl,Mc,ma,wo,hf,Ic,Ec,Ol,Nl,bo,Pc,sr,Sd,T0,C0,M0,I0,E0,P0,A0,fT,E2,uz=(E2=class extends wf{constructor(t,s){super();bt(this,sr);bt(this,fi);bt(this,Gt);bt(this,cf);bt(this,Jn);bt(this,Fl);bt(this,Mc);bt(this,ma);bt(this,wo);bt(this,hf);bt(this,Ic);bt(this,Ec);bt(this,Ol);bt(this,Nl);bt(this,bo);bt(this,Pc,new Set);this.options=s,at(this,fi,t),at(this,wo,null),at(this,ma,S0()),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(pe(this,Gt).addObserver(this),Cb(pe(this,Gt),this.options)?Ht(this,sr,Sd).call(this):this.updateResult(),Ht(this,sr,I0).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return z0(pe(this,Gt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return z0(pe(this,Gt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Ht(this,sr,E0).call(this),Ht(this,sr,P0).call(this),pe(this,Gt).removeObserver(this)}setOptions(t){const s=this.options,l=pe(this,Gt);if(this.options=pe(this,fi).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Ji(this.options.enabled,pe(this,Gt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Ht(this,sr,A0).call(this),pe(this,Gt).setOptions(this.options),s._defaulted&&!x0(this.options,s)&&pe(this,fi).getQueryCache().notify({type:"observerOptionsUpdated",query:pe(this,Gt),observer:this});const p=this.hasListeners();p&&Mb(pe(this,Gt),l,this.options,s)&&Ht(this,sr,Sd).call(this),this.updateResult(),p&&(pe(this,Gt)!==l||Ji(this.options.enabled,pe(this,Gt))!==Ji(s.enabled,pe(this,Gt))||No(this.options.staleTime,pe(this,Gt))!==No(s.staleTime,pe(this,Gt)))&&Ht(this,sr,T0).call(this);const v=Ht(this,sr,C0).call(this);p&&(pe(this,Gt)!==l||Ji(this.options.enabled,pe(this,Gt))!==Ji(s.enabled,pe(this,Gt))||v!==pe(this,bo))&&Ht(this,sr,M0).call(this,v)}getOptimisticResult(t){const s=pe(this,fi).getQueryCache().build(pe(this,fi),t),l=this.createResult(s,t);return hz(this,l)&&(at(this,Jn,l),at(this,Mc,this.options),at(this,Fl,pe(this,Gt).state)),l}getCurrentResult(){return pe(this,Jn)}trackResult(t,s){return new Proxy(t,{get:(l,p)=>(this.trackProp(p),s==null||s(p),p==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&pe(this,ma).status==="pending"&&pe(this,ma).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(l,p))})}trackProp(t){pe(this,Pc).add(t)}getCurrentQuery(){return pe(this,Gt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const s=pe(this,fi).defaultQueryOptions(t),l=pe(this,fi).getQueryCache().build(pe(this,fi),s);return l.fetch().then(()=>this.createResult(l,s))}fetch(t){return Ht(this,sr,Sd).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),pe(this,Jn)))}createResult(t,s){var ct;const l=pe(this,Gt),p=this.options,v=pe(this,Jn),y=pe(this,Fl),c=pe(this,Mc),I=t!==l?t.state:pe(this,cf),{state:j}=t;let z={...j},R=!1,X;if(s._optimisticResults){const it=this.hasListeners(),ht=!it&&Cb(t,s),dt=it&&Mb(t,l,s,p);(ht||dt)&&(z={...z,...dT(j.data,t.options)}),s._optimisticResults==="isRestoring"&&(z.fetchStatus="idle")}let{error:me,errorUpdatedAt:he,status:ge}=z;X=z.data;let W=!1;if(s.placeholderData!==void 0&&X===void 0&&ge==="pending"){let it;v!=null&&v.isPlaceholderData&&s.placeholderData===(c==null?void 0:c.placeholderData)?(it=v.data,W=!0):it=typeof s.placeholderData=="function"?s.placeholderData((ct=pe(this,Ec))==null?void 0:ct.state.data,pe(this,Ec)):s.placeholderData,it!==void 0&&(ge="success",X=b0(v==null?void 0:v.data,it,s),R=!0)}if(s.select&&X!==void 0&&!W)if(v&&X===(y==null?void 0:y.data)&&s.select===pe(this,hf))X=pe(this,Ic);else try{at(this,hf,s.select),X=s.select(X),X=b0(v==null?void 0:v.data,X,s),at(this,Ic,X),at(this,wo,null)}catch(it){at(this,wo,it)}pe(this,wo)&&(me=pe(this,wo),X=pe(this,Ic),he=Date.now(),ge="error");const Q=z.fetchStatus==="fetching",te=ge==="pending",oe=ge==="error",Me=te&&Q,Se=X!==void 0,Fe={status:ge,fetchStatus:z.fetchStatus,isPending:te,isSuccess:ge==="success",isError:oe,isInitialLoading:Me,isLoading:Me,data:X,dataUpdatedAt:z.dataUpdatedAt,error:me,errorUpdatedAt:he,failureCount:z.fetchFailureCount,failureReason:z.fetchFailureReason,errorUpdateCount:z.errorUpdateCount,isFetched:z.dataUpdateCount>0||z.errorUpdateCount>0,isFetchedAfterMount:z.dataUpdateCount>I.dataUpdateCount||z.errorUpdateCount>I.errorUpdateCount,isFetching:Q,isRefetching:Q&&!te,isLoadingError:oe&&!Se,isPaused:z.fetchStatus==="paused",isPlaceholderData:R,isRefetchError:oe&&Se,isStale:Yv(t,s),refetch:this.refetch,promise:pe(this,ma),isEnabled:Ji(s.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const it=Fe.data!==void 0,ht=Fe.status==="error"&&!it,dt=pr=>{ht?pr.reject(Fe.error):it&&pr.resolve(Fe.data)},Pt=()=>{const pr=at(this,ma,Fe.promise=S0());dt(pr)},Dt=pe(this,ma);switch(Dt.status){case"pending":t.queryHash===l.queryHash&&dt(Dt);break;case"fulfilled":(ht||Fe.data!==Dt.value)&&Pt();break;case"rejected":(!ht||Fe.error!==Dt.reason)&&Pt();break}}return Fe}updateResult(){const t=pe(this,Jn),s=this.createResult(pe(this,Gt),this.options);if(at(this,Fl,pe(this,Gt).state),at(this,Mc,this.options),pe(this,Fl).data!==void 0&&at(this,Ec,pe(this,Gt)),x0(s,t))return;at(this,Jn,s);const l=()=>{if(!t)return!0;const{notifyOnChangeProps:p}=this.options,v=typeof p=="function"?p():p;if(v==="all"||!v&&!pe(this,Pc).size)return!0;const y=new Set(v??pe(this,Pc));return this.options.throwOnError&&y.add("error"),Object.keys(pe(this,Jn)).some(c=>{const M=c;return pe(this,Jn)[M]!==t[M]&&y.has(M)})};Ht(this,sr,fT).call(this,{listeners:l()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Ht(this,sr,I0).call(this)}},fi=new WeakMap,Gt=new WeakMap,cf=new WeakMap,Jn=new WeakMap,Fl=new WeakMap,Mc=new WeakMap,ma=new WeakMap,wo=new WeakMap,hf=new WeakMap,Ic=new WeakMap,Ec=new WeakMap,Ol=new WeakMap,Nl=new WeakMap,bo=new WeakMap,Pc=new WeakMap,sr=new WeakSet,Sd=function(t){Ht(this,sr,A0).call(this);let s=pe(this,Gt).fetch(this.options,t);return t!=null&&t.throwOnError||(s=s.catch(pi)),s},T0=function(){Ht(this,sr,E0).call(this);const t=No(this.options.staleTime,pe(this,Gt));if(Xl||pe(this,Jn).isStale||!v0(t))return;const l=sT(pe(this,Jn).dataUpdatedAt,t)+1;at(this,Ol,Il.setTimeout(()=>{pe(this,Jn).isStale||this.updateResult()},l))},C0=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(pe(this,Gt)):this.options.refetchInterval)??!1},M0=function(t){Ht(this,sr,P0).call(this),at(this,bo,t),!(Xl||Ji(this.options.enabled,pe(this,Gt))===!1||!v0(pe(this,bo))||pe(this,bo)===0)&&at(this,Nl,Il.setInterval(()=>{(this.options.refetchIntervalInBackground||Kv.isFocused())&&Ht(this,sr,Sd).call(this)},pe(this,bo)))},I0=function(){Ht(this,sr,T0).call(this),Ht(this,sr,M0).call(this,Ht(this,sr,C0).call(this))},E0=function(){pe(this,Ol)&&(Il.clearTimeout(pe(this,Ol)),at(this,Ol,void 0))},P0=function(){pe(this,Nl)&&(Il.clearInterval(pe(this,Nl)),at(this,Nl,void 0))},A0=function(){const t=pe(this,fi).getQueryCache().build(pe(this,fi),this.options);if(t===pe(this,Gt))return;const s=pe(this,Gt);at(this,Gt,t),at(this,cf,t.state),this.hasListeners()&&(s==null||s.removeObserver(this),t.addObserver(this))},fT=function(t){Cn.batch(()=>{t.listeners&&this.listeners.forEach(s=>{s(pe(this,Jn))}),pe(this,fi).getQueryCache().notify({query:pe(this,Gt),type:"observerResultsUpdated"})})},E2);function cz(e,t){return Ji(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Cb(e,t){return cz(e,t)||e.state.data!==void 0&&z0(e,t,t.refetchOnMount)}function z0(e,t,s){if(Ji(t.enabled,e)!==!1&&No(t.staleTime,e)!=="static"){const l=typeof s=="function"?s(e):s;return l==="always"||l!==!1&&Yv(e,t)}return!1}function Mb(e,t,s,l){return(e!==t||Ji(l.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&Yv(e,s)}function Yv(e,t){return Ji(t.enabled,e)!==!1&&e.isStaleByTime(No(t.staleTime,e))}function hz(e,t){return!x0(e.getCurrentResult(),t)}function Ib(e){return{onFetch:(t,s)=>{var j,z,R,X,me;const l=t.options,p=(R=(z=(j=t.fetchOptions)==null?void 0:j.meta)==null?void 0:z.fetchMore)==null?void 0:R.direction,v=((X=t.state.data)==null?void 0:X.pages)||[],y=((me=t.state.data)==null?void 0:me.pageParams)||[];let c={pages:[],pageParams:[]},M=0;const I=async()=>{let he=!1;const ge=te=>{rz(te,()=>t.signal,()=>he=!0)},W=oT(t.options,t.fetchOptions),Q=async(te,oe,Me)=>{if(he)return Promise.reject();if(oe==null&&te.pages.length)return Promise.resolve(te);const ze=(()=>{const ht={client:t.client,queryKey:t.queryKey,pageParam:oe,direction:Me?"backward":"forward",meta:t.options.meta};return ge(ht),ht})(),Fe=await W(ze),{maxPages:ct}=t.options,it=Me?tz:ez;return{pages:it(te.pages,Fe,ct),pageParams:it(te.pageParams,oe,ct)}};if(p&&v.length){const te=p==="backward",oe=te?dz:Eb,Me={pages:v,pageParams:y},Se=oe(l,Me);c=await Q(Me,Se,te)}else{const te=e??v.length;do{const oe=M===0?y[0]??l.initialPageParam:Eb(l,c);if(M>0&&oe==null)break;c=await Q(c,oe),M++}while(M<te)}return c};t.options.persister?t.fetchFn=()=>{var he,ge;return(ge=(he=t.options).persister)==null?void 0:ge.call(he,I,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s)}:t.fetchFn=I}}}function Eb(e,{pages:t,pageParams:s}){const l=t.length-1;return t.length>0?e.getNextPageParam(t[l],t,s[l],s):void 0}function dz(e,{pages:t,pageParams:s}){var l;return t.length>0?(l=e.getPreviousPageParam)==null?void 0:l.call(e,t[0],t,s[0],s):void 0}var df,js,jn,Bl,Us,fo,P2,fz=(P2=class extends hT{constructor(t){super();bt(this,Us);bt(this,df);bt(this,js);bt(this,jn);bt(this,Bl);at(this,df,t.client),this.mutationId=t.mutationId,at(this,jn,t.mutationCache),at(this,js,[]),this.state=t.state||pz(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){pe(this,js).includes(t)||(pe(this,js).push(t),this.clearGcTimeout(),pe(this,jn).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){at(this,js,pe(this,js).filter(s=>s!==t)),this.scheduleGc(),pe(this,jn).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){pe(this,js).length||(this.state.status==="pending"?this.scheduleGc():pe(this,jn).remove(this))}continue(){var t;return((t=pe(this,Bl))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var y,c,M,I,j,z,R,X,me,he,ge,W,Q,te,oe,Me,Se,ze;const s=()=>{Ht(this,Us,fo).call(this,{type:"continue"})},l={client:pe(this,df),meta:this.options.meta,mutationKey:this.options.mutationKey};at(this,Bl,cT({fn:()=>this.options.mutationFn?this.options.mutationFn(t,l):Promise.reject(new Error("No mutationFn found")),onFail:(Fe,ct)=>{Ht(this,Us,fo).call(this,{type:"failed",failureCount:Fe,error:ct})},onPause:()=>{Ht(this,Us,fo).call(this,{type:"pause"})},onContinue:s,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>pe(this,jn).canRun(this)}));const p=this.state.status==="pending",v=!pe(this,Bl).canStart();try{if(p)s();else{Ht(this,Us,fo).call(this,{type:"pending",variables:t,isPaused:v}),pe(this,jn).config.onMutate&&await pe(this,jn).config.onMutate(t,this,l);const ct=await((c=(y=this.options).onMutate)==null?void 0:c.call(y,t,l));ct!==this.state.context&&Ht(this,Us,fo).call(this,{type:"pending",context:ct,variables:t,isPaused:v})}const Fe=await pe(this,Bl).start();return await((I=(M=pe(this,jn).config).onSuccess)==null?void 0:I.call(M,Fe,t,this.state.context,this,l)),await((z=(j=this.options).onSuccess)==null?void 0:z.call(j,Fe,t,this.state.context,l)),await((X=(R=pe(this,jn).config).onSettled)==null?void 0:X.call(R,Fe,null,this.state.variables,this.state.context,this,l)),await((he=(me=this.options).onSettled)==null?void 0:he.call(me,Fe,null,t,this.state.context,l)),Ht(this,Us,fo).call(this,{type:"success",data:Fe}),Fe}catch(Fe){try{await((W=(ge=pe(this,jn).config).onError)==null?void 0:W.call(ge,Fe,t,this.state.context,this,l))}catch(ct){Promise.reject(ct)}try{await((te=(Q=this.options).onError)==null?void 0:te.call(Q,Fe,t,this.state.context,l))}catch(ct){Promise.reject(ct)}try{await((Me=(oe=pe(this,jn).config).onSettled)==null?void 0:Me.call(oe,void 0,Fe,this.state.variables,this.state.context,this,l))}catch(ct){Promise.reject(ct)}try{await((ze=(Se=this.options).onSettled)==null?void 0:ze.call(Se,void 0,Fe,t,this.state.context,l))}catch(ct){Promise.reject(ct)}throw Ht(this,Us,fo).call(this,{type:"error",error:Fe}),Fe}finally{pe(this,jn).runNext(this)}}},df=new WeakMap,js=new WeakMap,jn=new WeakMap,Bl=new WeakMap,Us=new WeakSet,fo=function(t){const s=l=>{switch(t.type){case"failed":return{...l,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...l,isPaused:!0};case"continue":return{...l,isPaused:!1};case"pending":return{...l,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...l,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...l,data:void 0,error:t.error,failureCount:l.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=s(this.state),Cn.batch(()=>{pe(this,js).forEach(l=>{l.onMutationUpdate(t)}),pe(this,jn).notify({mutation:this,type:"updated",action:t})})},P2);function pz(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ga,ys,ff,A2,mz=(A2=class extends wf{constructor(t={}){super();bt(this,ga);bt(this,ys);bt(this,ff);this.config=t,at(this,ga,new Set),at(this,ys,new Map),at(this,ff,0)}build(t,s,l){const p=new fz({client:t,mutationCache:this,mutationId:++Ip(this,ff)._,options:t.defaultMutationOptions(s),state:l});return this.add(p),p}add(t){pe(this,ga).add(t);const s=Hp(t);if(typeof s=="string"){const l=pe(this,ys).get(s);l?l.push(t):pe(this,ys).set(s,[t])}this.notify({type:"added",mutation:t})}remove(t){if(pe(this,ga).delete(t)){const s=Hp(t);if(typeof s=="string"){const l=pe(this,ys).get(s);if(l)if(l.length>1){const p=l.indexOf(t);p!==-1&&l.splice(p,1)}else l[0]===t&&pe(this,ys).delete(s)}}this.notify({type:"removed",mutation:t})}canRun(t){const s=Hp(t);if(typeof s=="string"){const l=pe(this,ys).get(s),p=l==null?void 0:l.find(v=>v.state.status==="pending");return!p||p===t}else return!0}runNext(t){var l;const s=Hp(t);if(typeof s=="string"){const p=(l=pe(this,ys).get(s))==null?void 0:l.find(v=>v!==t&&v.state.isPaused);return(p==null?void 0:p.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Cn.batch(()=>{pe(this,ga).forEach(t=>{this.notify({type:"removed",mutation:t})}),pe(this,ga).clear(),pe(this,ys).clear()})}getAll(){return Array.from(pe(this,ga))}find(t){const s={exact:!0,...t};return this.getAll().find(l=>wb(s,l))}findAll(t={}){return this.getAll().filter(s=>wb(t,s))}notify(t){Cn.batch(()=>{this.listeners.forEach(s=>{s(t)})})}resumePausedMutations(){const t=this.getAll().filter(s=>s.state.isPaused);return Cn.batch(()=>Promise.all(t.map(s=>s.continue().catch(pi))))}},ga=new WeakMap,ys=new WeakMap,ff=new WeakMap,A2);function Hp(e){var t;return(t=e.options.scope)==null?void 0:t.id}var Vs,z2,gz=(z2=class extends wf{constructor(t={}){super();bt(this,Vs);this.config=t,at(this,Vs,new Map)}build(t,s,l){const p=s.queryKey,v=s.queryHash??Wv(p,s);let y=this.get(v);return y||(y=new lz({client:t,queryKey:p,queryHash:v,options:t.defaultQueryOptions(s),state:l,defaultOptions:t.getQueryDefaults(p)}),this.add(y)),y}add(t){pe(this,Vs).has(t.queryHash)||(pe(this,Vs).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const s=pe(this,Vs).get(t.queryHash);s&&(t.destroy(),s===t&&pe(this,Vs).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Cn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return pe(this,Vs).get(t)}getAll(){return[...pe(this,Vs).values()]}find(t){const s={exact:!0,...t};return this.getAll().find(l=>xb(s,l))}findAll(t={}){const s=this.getAll();return Object.keys(t).length>0?s.filter(l=>xb(t,l)):s}notify(t){Cn.batch(()=>{this.listeners.forEach(s=>{s(t)})})}onFocus(){Cn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Cn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Vs=new WeakMap,z2),Nr,So,ko,Ac,zc,To,Dc,Lc,D2,yz=(D2=class{constructor(e={}){bt(this,Nr);bt(this,So);bt(this,ko);bt(this,Ac);bt(this,zc);bt(this,To);bt(this,Dc);bt(this,Lc);at(this,Nr,e.queryCache||new gz),at(this,So,e.mutationCache||new mz),at(this,ko,e.defaultOptions||{}),at(this,Ac,new Map),at(this,zc,new Map),at(this,To,0)}mount(){Ip(this,To)._++,pe(this,To)===1&&(at(this,Dc,Kv.subscribe(async e=>{e&&(await this.resumePausedMutations(),pe(this,Nr).onFocus())})),at(this,Lc,jm.subscribe(async e=>{e&&(await this.resumePausedMutations(),pe(this,Nr).onOnline())})))}unmount(){var e,t;Ip(this,To)._--,pe(this,To)===0&&((e=pe(this,Dc))==null||e.call(this),at(this,Dc,void 0),(t=pe(this,Lc))==null||t.call(this),at(this,Lc,void 0))}isFetching(e){return pe(this,Nr).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return pe(this,So).findAll({...e,status:"pending"}).length}getQueryData(e){var s;const t=this.defaultQueryOptions({queryKey:e});return(s=pe(this,Nr).get(t.queryHash))==null?void 0:s.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),s=pe(this,Nr).build(this,t),l=s.state.data;return l===void 0?this.fetchQuery(e):(e.revalidateIfStale&&s.isStaleByTime(No(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(l))}getQueriesData(e){return pe(this,Nr).findAll(e).map(({queryKey:t,state:s})=>{const l=s.data;return[t,l]})}setQueryData(e,t,s){const l=this.defaultQueryOptions({queryKey:e}),p=pe(this,Nr).get(l.queryHash),v=p==null?void 0:p.state.data,y=YA(t,v);if(y!==void 0)return pe(this,Nr).build(this,l).setData(y,{...s,manual:!0})}setQueriesData(e,t,s){return Cn.batch(()=>pe(this,Nr).findAll(e).map(({queryKey:l})=>[l,this.setQueryData(l,t,s)]))}getQueryState(e){var s;const t=this.defaultQueryOptions({queryKey:e});return(s=pe(this,Nr).get(t.queryHash))==null?void 0:s.state}removeQueries(e){const t=pe(this,Nr);Cn.batch(()=>{t.findAll(e).forEach(s=>{t.remove(s)})})}resetQueries(e,t){const s=pe(this,Nr);return Cn.batch(()=>(s.findAll(e).forEach(l=>{l.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const s={revert:!0,...t},l=Cn.batch(()=>pe(this,Nr).findAll(e).map(p=>p.cancel(s)));return Promise.all(l).then(pi).catch(pi)}invalidateQueries(e,t={}){return Cn.batch(()=>(pe(this,Nr).findAll(e).forEach(s=>{s.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const s={...t,cancelRefetch:t.cancelRefetch??!0},l=Cn.batch(()=>pe(this,Nr).findAll(e).filter(p=>!p.isDisabled()&&!p.isStatic()).map(p=>{let v=p.fetch(void 0,s);return s.throwOnError||(v=v.catch(pi)),p.state.fetchStatus==="paused"?Promise.resolve():v}));return Promise.all(l).then(pi)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const s=pe(this,Nr).build(this,t);return s.isStaleByTime(No(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(pi).catch(pi)}fetchInfiniteQuery(e){return e.behavior=Ib(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(pi).catch(pi)}ensureInfiniteQueryData(e){return e.behavior=Ib(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return jm.isOnline()?pe(this,So).resumePausedMutations():Promise.resolve()}getQueryCache(){return pe(this,Nr)}getMutationCache(){return pe(this,So)}getDefaultOptions(){return pe(this,ko)}setDefaultOptions(e){at(this,ko,e)}setQueryDefaults(e,t){pe(this,Ac).set(rf(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...pe(this,Ac).values()],s={};return t.forEach(l=>{nf(e,l.queryKey)&&Object.assign(s,l.defaultOptions)}),s}setMutationDefaults(e,t){pe(this,zc).set(rf(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...pe(this,zc).values()],s={};return t.forEach(l=>{nf(e,l.mutationKey)&&Object.assign(s,l.defaultOptions)}),s}defaultQueryOptions(e){if(e._defaulted)return e;const t={...pe(this,ko).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Wv(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Xv&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...pe(this,ko).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){pe(this,Nr).clear(),pe(this,So).clear()}},Nr=new WeakMap,So=new WeakMap,ko=new WeakMap,Ac=new WeakMap,zc=new WeakMap,To=new WeakMap,Dc=new WeakMap,Lc=new WeakMap,D2),pT=Pe.createContext(void 0),mT=e=>{const t=Pe.useContext(pT);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},_z=({client:e,children:t})=>(Pe.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),G.jsx(pT.Provider,{value:e,children:t})),gT=Pe.createContext(!1),vz=()=>Pe.useContext(gT);gT.Provider;function xz(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var wz=Pe.createContext(xz()),bz=()=>Pe.useContext(wz),Sz=(e,t,s)=>{const l=s!=null&&s.state.error&&typeof e.throwOnError=="function"?lT(e.throwOnError,[s.state.error,s]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||l)&&(t.isReset()||(e.retryOnMount=!1))},kz=e=>{Pe.useEffect(()=>{e.clearReset()},[e])},Tz=({result:e,errorResetBoundary:t,throwOnError:s,query:l,suspense:p})=>e.isError&&!t.isReset()&&!e.isFetching&&l&&(p&&e.data===void 0||lT(s,[e.error,l])),Cz=e=>{if(e.suspense){const s=p=>p==="static"?p:Math.max(p??1e3,1e3),l=e.staleTime;e.staleTime=typeof l=="function"?(...p)=>s(l(...p)):s(l),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},Mz=(e,t)=>e.isLoading&&e.isFetching&&!t,Iz=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,Pb=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function Ez(e,t,s){var R,X,me,he;const l=vz(),p=bz(),v=mT(),y=v.defaultQueryOptions(e);(X=(R=v.getDefaultOptions().queries)==null?void 0:R._experimental_beforeQuery)==null||X.call(R,y);const c=v.getQueryCache().get(y.queryHash);y._optimisticResults=l?"isRestoring":"optimistic",Cz(y),Sz(y,p,c),kz(p);const M=!v.getQueryCache().get(y.queryHash),[I]=Pe.useState(()=>new t(v,y)),j=I.getOptimisticResult(y),z=!l&&e.subscribed!==!1;if(Pe.useSyncExternalStore(Pe.useCallback(ge=>{const W=z?I.subscribe(Cn.batchCalls(ge)):pi;return I.updateResult(),W},[I,z]),()=>I.getCurrentResult(),()=>I.getCurrentResult()),Pe.useEffect(()=>{I.setOptions(y)},[y,I]),Iz(y,j))throw Pb(y,I,p);if(Tz({result:j,errorResetBoundary:p,throwOnError:y.throwOnError,query:c,suspense:y.suspense}))throw j.error;if((he=(me=v.getDefaultOptions().queries)==null?void 0:me._experimental_afterQuery)==null||he.call(me,y,j),y.experimental_prefetchInRender&&!Xl&&Mz(j,l)){const ge=M?Pb(y,I,p):c==null?void 0:c.promise;ge==null||ge.catch(pi).finally(()=>{I.updateResult()})}return y.notifyOnChangeProps?j:I.trackResult(j)}function Qv(e,t){return Ez(e,uz)}/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pz=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),yT=(...e)=>e.filter((t,s,l)=>!!t&&t.trim()!==""&&l.indexOf(t)===s).join(" ").trim();/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Az={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zz=Pe.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:l,className:p="",children:v,iconNode:y,...c},M)=>Pe.createElement("svg",{ref:M,...Az,width:t,height:t,stroke:e,strokeWidth:l?Number(s)*24/Number(t):s,className:yT("lucide",p),...c},[...y.map(([I,j])=>Pe.createElement(I,j)),...Array.isArray(v)?v:[v]]));/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=(e,t)=>{const s=Pe.forwardRef(({className:l,...p},v)=>Pe.createElement(zz,{ref:v,iconNode:t,className:yT(`lucide-${Pz(e)}`,l),...p}));return s.displayName=`${e}`,s};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _T=Yt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dz=Yt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vT=Yt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lz=Yt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rz=Yt("CloudDrizzle",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 19v1",key:"1dk2by"}],["path",{d:"M8 14v1",key:"84yxot"}],["path",{d:"M16 19v1",key:"v220m7"}],["path",{d:"M16 14v1",key:"g12gj6"}],["path",{d:"M12 21v1",key:"q8vafk"}],["path",{d:"M12 16v1",key:"1mx6rx"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fz=Yt("CloudFog",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 17H7",key:"pygtm1"}],["path",{d:"M17 21H9",key:"1u2q02"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oz=Yt("CloudLightning",[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nz=Yt("CloudMoon",[["path",{d:"M10.188 8.5A6 6 0 0 1 16 4a1 1 0 0 0 6 6 6 6 0 0 1-3 5.197",key:"erj67n"}],["path",{d:"M13 16a3 3 0 1 1 0 6H7a5 5 0 1 1 4.9-6Z",key:"p44pc9"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bz=Yt("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ab=Yt("CloudSnow",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jz=Yt("CloudSun",[["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}],["path",{d:"M15.947 12.65a4 4 0 0 0-5.925-4.128",key:"dpwdj0"}],["path",{d:"M13 22H7a5 5 0 1 1 4.9-6H13a3 3 0 0 1 0 6Z",key:"s09mg5"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jv=Yt("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uz=Yt("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vz=Yt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $z=Yt("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D0=Yt("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qz=Yt("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zz=Yt("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L0=Yt("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hz=Yt("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gz=Yt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wz=Yt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xz=Yt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kz=Yt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yz=Yt("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xT=Yt("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qz=Yt("Sunrise",[["path",{d:"M12 2v8",key:"1q4o3n"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jz=Yt("Sunset",[["path",{d:"M12 10V2",key:"16sf7g"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m16 6-4 4-4-4",key:"6wukr"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eD=Yt("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tD=Yt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rD=Yt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wT=Yt("Wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bT=Yt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),zb=e=>{let t;const s=new Set,l=(I,j)=>{const z=typeof I=="function"?I(t):I;if(!Object.is(z,t)){const R=t;t=j??(typeof z!="object"||z===null)?z:Object.assign({},t,z),s.forEach(X=>X(t,R))}},p=()=>t,c={setState:l,getState:p,getInitialState:()=>M,subscribe:I=>(s.add(I),()=>s.delete(I))},M=t=e(l,p,c);return c},nD=e=>e?zb(e):zb,iD=e=>e;function sD(e,t=iD){const s=_d.useSyncExternalStore(e.subscribe,_d.useCallback(()=>t(e.getState()),[e,t]),_d.useCallback(()=>t(e.getInitialState()),[e,t]));return _d.useDebugValue(s),s}const aD=e=>{const t=nD(e),s=l=>sD(t,l);return Object.assign(s,t),s},ex=e=>aD;function oD(e,t){let s;try{s=e()}catch{return}return{getItem:p=>{var v;const y=M=>M===null?null:JSON.parse(M,void 0),c=(v=s.getItem(p))!=null?v:null;return c instanceof Promise?c.then(y):y(c)},setItem:(p,v)=>s.setItem(p,JSON.stringify(v,void 0)),removeItem:p=>s.removeItem(p)}}const R0=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then(l){return R0(l)(s)},catch(l){return this}}}catch(s){return{then(l){return this},catch(l){return R0(l)(s)}}}},lD=(e,t)=>(s,l,p)=>{let v={storage:oD(()=>localStorage),partialize:ge=>ge,version:0,merge:(ge,W)=>({...W,...ge}),...t},y=!1,c=0;const M=new Set,I=new Set;let j=v.storage;if(!j)return e((...ge)=>{console.warn(`[zustand persist middleware] Unable to update item '${v.name}', the given storage is currently unavailable.`),s(...ge)},l,p);const z=()=>{const ge=v.partialize({...l()});return j.setItem(v.name,{state:ge,version:v.version})},R=p.setState;p.setState=(ge,W)=>(R(ge,W),z());const X=e((...ge)=>(s(...ge),z()),l,p);p.getInitialState=()=>X;let me;const he=()=>{var ge,W;if(!j)return;const Q=++c;y=!1,M.forEach(oe=>{var Me;return oe((Me=l())!=null?Me:X)});const te=((W=v.onRehydrateStorage)==null?void 0:W.call(v,(ge=l())!=null?ge:X))||void 0;return R0(j.getItem.bind(j))(v.name).then(oe=>{if(oe)if(typeof oe.version=="number"&&oe.version!==v.version){if(v.migrate){const Me=v.migrate(oe.state,oe.version);return Me instanceof Promise?Me.then(Se=>[!0,Se]):[!0,Me]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,oe.state];return[!1,void 0]}).then(oe=>{var Me;if(Q!==c)return;const[Se,ze]=oe;if(me=v.merge(ze,(Me=l())!=null?Me:X),s(me,!0),Se)return z()}).then(()=>{Q===c&&(te==null||te(me,void 0),me=l(),y=!0,I.forEach(oe=>oe(me)))}).catch(oe=>{Q===c&&(te==null||te(void 0,oe))})};return p.persist={setOptions:ge=>{v={...v,...ge},ge.storage&&(j=ge.storage)},clearStorage:()=>{j==null||j.removeItem(v.name)},getOptions:()=>v,rehydrate:()=>he(),hasHydrated:()=>y,onHydrate:ge=>(M.add(ge),()=>{M.delete(ge)}),onFinishHydration:ge=>(I.add(ge),()=>{I.delete(ge)})},v.skipHydration||he(),me||X},ST=lD,Ri=ex()(ST((e,t)=>({locations:[],activeLocationId:null,addLocation:s=>{e(l=>l.locations.some(y=>y.id===s.id)?l:{locations:[...l.locations,s],activeLocationId:l.activeLocationId??s.id})},removeLocation:s=>{e(l=>{var y;const p=l.locations.filter(c=>c.id!==s);let v=l.activeLocationId;return l.activeLocationId===s&&(v=((y=p[0])==null?void 0:y.id)??null),{locations:p,activeLocationId:v}})},setActiveLocation:s=>{e({activeLocationId:s})},updateLocation:(s,l)=>{e(p=>({locations:p.locations.map(v=>v.id===s?{...v,...l}:v)}))},reorderLocations:(s,l)=>{e(p=>{const v=[...p.locations],[y]=v.splice(s,1);return v.splice(l,0,y),{locations:v}})},getActiveLocation:()=>{const s=t();return s.locations.find(l=>l.id===s.activeLocationId)??null}}),{name:"darthsky-locations",version:1})),uD={temperature:"fahrenheit",windSpeed:"mph",pressure:"inhg",visibility:"mi",precipitation:"in",timeFormat:"12h"},Db={units:uD,theme:"auto",notificationsEnabled:!1,alertsEnabled:!0,reducedMotion:!1},Yc=ex()(ST(e=>({...Db,setTemperatureUnit:t=>e(s=>({units:{...s.units,temperature:t}})),setWindSpeedUnit:t=>e(s=>({units:{...s.units,windSpeed:t}})),setPressureUnit:t=>e(s=>({units:{...s.units,pressure:t}})),setVisibilityUnit:t=>e(s=>({units:{...s.units,visibility:t}})),setPrecipitationUnit:t=>e(s=>({units:{...s.units,precipitation:t}})),setTimeFormat:t=>e(s=>({units:{...s.units,timeFormat:t}})),setTheme:t=>e({theme:t}),setNotificationsEnabled:t=>e({notificationsEnabled:t}),setAlertsEnabled:t=>e({alertsEnabled:t}),setReducedMotion:t=>e({reducedMotion:t}),resetToDefaults:()=>e(Db)}),{name:"darthsky-settings",version:1})),sf=ex()(e=>({activeTab:"weather",isLocationSearchOpen:!1,isRefreshing:!1,selectedAlertId:null,mapTimeIndex:0,isMapPlaying:!1,setActiveTab:t=>e({activeTab:t}),openLocationSearch:()=>e({isLocationSearchOpen:!0}),closeLocationSearch:()=>e({isLocationSearchOpen:!1}),setRefreshing:t=>e({isRefreshing:t}),setSelectedAlert:t=>e({selectedAlertId:t}),setMapTimeIndex:t=>e({mapTimeIndex:t}),setMapPlaying:t=>e({isMapPlaying:t}),incrementMapTime:()=>e(t=>({mapTimeIndex:t.mapTimeIndex+1}))}));function Gp({onRefresh:e,isRefreshing:t}){const s=Ri(p=>p.getActiveLocation()),l=sf(p=>p.openLocationSearch);return G.jsx("header",{className:"sticky top-0 z-10 bg-white/80 dark:bg-slate-900/80 backdrop-blur-lg border-b border-slate-200 dark:border-slate-700",children:G.jsxs("div",{className:"flex items-center justify-between px-4 py-3 pt-safe-top",children:[G.jsxs("button",{onClick:l,className:"flex items-center gap-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg px-2 py-1 -ml-2 transition-colors",children:[G.jsx(D0,{size:18,className:"text-sky-500"}),G.jsx("span",{className:"font-medium text-slate-900 dark:text-slate-100",children:(s==null?void 0:s.name)||"Select Location"}),G.jsx(_T,{size:16,className:"text-slate-400"})]}),e&&G.jsx("button",{onClick:e,disabled:t,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors disabled:opacity-50","aria-label":"Refresh weather data",children:G.jsx(Wz,{size:20,className:`text-slate-500 ${t?"animate-spin":""}`})})]})})}const cD=[{id:"weather",path:"/",icon:Jv,label:"Weather"},{id:"map",path:"/map",icon:qz,label:"Map"},{id:"settings",path:"/settings",icon:Kz,label:"Settings"}];function hD(){const e=xf();return G.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-20 bg-white/80 dark:bg-slate-900/80 backdrop-blur-lg border-t border-slate-200 dark:border-slate-700",children:G.jsx("div",{className:"flex items-center justify-around pb-safe-bottom",children:cD.map(t=>{const s=t.path==="/"?e.pathname==="/":e.pathname.startsWith(t.path),l=t.icon;return G.jsxs(HA,{to:t.path,className:`
                flex flex-col items-center justify-center py-2 px-6 min-w-[80px]
                transition-colors duration-150
                ${s?"text-sky-500":"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300"}
              `,"aria-current":s?"page":void 0,children:[G.jsx(l,{size:24,strokeWidth:s?2:1.5}),G.jsx("span",{className:"text-xs mt-1 font-medium",children:t.label})]},t.id)})})})}const El=Pe.forwardRef(({children:e,className:t="",variant:s="default",...l},p)=>{const v="rounded-2xl",y=s==="glass"?"glass border border-white/20 dark:border-slate-700/50":"bg-white dark:bg-slate-800 border border-slate-100 dark:border-slate-700 shadow-sm";return G.jsx("div",{ref:p,className:`${v} ${y} ${t}`,...l,children:e})});El.displayName="Card";const dD=Pe.forwardRef(({children:e,className:t="",...s},l)=>G.jsx("div",{ref:l,className:`px-4 py-3 border-b border-slate-100 dark:border-slate-700 ${t}`,...s,children:e}));dD.displayName="CardHeader";const fD=Pe.forwardRef(({children:e,className:t="",...s},l)=>G.jsx("div",{ref:l,className:`p-4 ${t}`,...s,children:e}));fD.displayName="CardBody";const Fd=Pe.forwardRef(({children:e,className:t="",variant:s="primary",size:l="md",isLoading:p=!1,disabled:v,...y},c)=>{const M="inline-flex items-center justify-center rounded-xl font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",I={primary:"bg-sky-500 text-white hover:bg-sky-600 active:bg-sky-700",secondary:"bg-slate-100 text-slate-900 hover:bg-slate-200 dark:bg-slate-700 dark:text-slate-100 dark:hover:bg-slate-600",ghost:"bg-transparent hover:bg-slate-100 dark:hover:bg-slate-800"},j={sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-sm",lg:"h-12 px-6 text-base"};return G.jsx("button",{ref:c,className:`${M} ${I[s]} ${j[l]} ${t}`,disabled:v||p,...y,children:p?G.jsxs(G.Fragment,{children:[G.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[G.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),G.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):e})});Fd.displayName="Button";const F0=Pe.forwardRef(({label:e,className:t="",checked:s,onChange:l,id:p,...v},y)=>{const c=p||`toggle-${Math.random().toString(36).slice(2)}`;return G.jsxs("label",{htmlFor:c,className:`inline-flex items-center cursor-pointer ${t}`,children:[G.jsxs("div",{className:"relative",children:[G.jsx("input",{ref:y,type:"checkbox",id:c,checked:s,onChange:l,className:"sr-only peer",...v}),G.jsx("div",{className:`
              w-11 h-6 rounded-full
              bg-slate-200 dark:bg-slate-700
              peer-checked:bg-sky-500
              peer-focus:ring-2 peer-focus:ring-sky-500 peer-focus:ring-offset-2
              transition-colors duration-200
            `}),G.jsx("div",{className:`
              absolute left-0.5 top-0.5
              w-5 h-5 rounded-full bg-white shadow-sm
              transition-transform duration-200
              peer-checked:translate-x-5
            `})]}),e&&G.jsx("span",{className:"ml-3 text-sm text-slate-700 dark:text-slate-300",children:e})]})});F0.displayName="Toggle";const pD={"clear-day":xT,"clear-night":Zz,"partly-cloudy-day":jz,"partly-cloudy-night":Nz,cloudy:Jv,fog:Fz,drizzle:Rz,rain:Bz,sleet:Ab,snow:Ab,thunderstorm:Oz,wind:wT},mD={"clear-day":"text-amber-400","clear-night":"text-indigo-400","partly-cloudy-day":"text-amber-400","partly-cloudy-night":"text-indigo-300",cloudy:"text-slate-400",fog:"text-slate-400",drizzle:"text-sky-400",rain:"text-blue-500",sleet:"text-cyan-400",snow:"text-cyan-200",thunderstorm:"text-indigo-500",wind:"text-slate-400"};function tx({icon:e,className:t="",size:s=24,...l}){const p=pD[e]||Jv,v=mD[e]||"text-slate-400";return G.jsx(p,{className:`${v} ${t}`,size:s,...l})}function xl({className:e="",variant:t="rectangular",width:s,height:l}){const p="animate-pulse bg-slate-200 dark:bg-slate-700",v={text:"rounded",circular:"rounded-full",rectangular:"rounded-lg"},y={};return s&&(y.width=typeof s=="number"?`${s}px`:s),l&&(y.height=typeof l=="number"?`${l}px`:l),G.jsx("div",{className:`${p} ${v[t]} ${e}`,style:y})}function Lb(){return G.jsxs("div",{className:"card p-4 space-y-4",children:[G.jsxs("div",{className:"flex items-center gap-4",children:[G.jsx(xl,{variant:"circular",width:64,height:64}),G.jsxs("div",{className:"flex-1 space-y-2",children:[G.jsx(xl,{height:40,width:100}),G.jsx(xl,{height:20,width:150})]})]}),G.jsx(xl,{height:100}),G.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[G.jsx(xl,{height:60}),G.jsx(xl,{height:60}),G.jsx(xl,{height:60})]})]})}const Vl={CURRENT_CONDITIONS:{staleTime:5*60*1e3,gcTime:10*60*1e3},RADAR_TILES:{staleTime:5*60*1e3,gcTime:10*60*1e3},GEOCODING:{staleTime:7*24*60*60*1e3,gcTime:14*24*60*60*1e3}},vg={weather:(e,t)=>["weather",e,t],geocode:e=>["geocode",e],reverseGeocode:(e,t)=>["reverseGeocode",e,t],radarTimestamps:()=>["radar","timestamps"]},gD={latitude:40.7128,longitude:-74.006},bf={OPEN_METEO:"https://api.open-meteo.com/v1/forecast",NOMINATIM_SEARCH:"https://nominatim.openstreetmap.org/search",NOMINATIM_REVERSE:"https://nominatim.openstreetmap.org/reverse",RAINVIEWER_MAPS:"https://api.rainviewer.com/public/weather-maps.json",CARTO_TILES:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png"},ec={defaultCenter:gD,defaultZoom:8,minZoom:3,maxZoom:12},yD=["temperature_2m","relative_humidity_2m","apparent_temperature","is_day","precipitation","rain","showers","snowfall","weather_code","cloud_cover","pressure_msl","surface_pressure","wind_speed_10m","wind_direction_10m","wind_gusts_10m"].join(","),_D=["temperature_2m","relative_humidity_2m","dew_point_2m","apparent_temperature","precipitation_probability","precipitation","rain","showers","snowfall","weather_code","cloud_cover","visibility","wind_speed_10m","wind_direction_10m","wind_gusts_10m","uv_index","is_day"].join(","),vD=["weather_code","temperature_2m_max","temperature_2m_min","apparent_temperature_max","apparent_temperature_min","sunrise","sunset","uv_index_max","precipitation_sum","rain_sum","showers_sum","snowfall_sum","precipitation_hours","precipitation_probability_max","wind_speed_10m_max","wind_gusts_10m_max","wind_direction_10m_dominant"].join(",");async function xD(e,t){const s=new URLSearchParams({latitude:e.toString(),longitude:t.toString(),current:yD,hourly:_D,daily:vD,timezone:"auto",forecast_days:"7",forecast_hours:"48"}),l=await fetch(`${bf.OPEN_METEO}?${s}`);if(!l.ok)throw new Error(`Open-Meteo API error: ${l.status}`);return l.json()}const kT={0:{summary:"Clear sky",icon:"clear-day",iconNight:"clear-night"},1:{summary:"Mainly clear",icon:"clear-day",iconNight:"clear-night"},2:{summary:"Partly cloudy",icon:"partly-cloudy-day",iconNight:"partly-cloudy-night"},3:{summary:"Overcast",icon:"cloudy"},45:{summary:"Fog",icon:"fog"},48:{summary:"Depositing rime fog",icon:"fog"},51:{summary:"Light drizzle",icon:"drizzle"},53:{summary:"Moderate drizzle",icon:"drizzle"},55:{summary:"Dense drizzle",icon:"drizzle"},56:{summary:"Light freezing drizzle",icon:"sleet"},57:{summary:"Dense freezing drizzle",icon:"sleet"},61:{summary:"Slight rain",icon:"rain"},63:{summary:"Moderate rain",icon:"rain"},65:{summary:"Heavy rain",icon:"rain"},66:{summary:"Light freezing rain",icon:"sleet"},67:{summary:"Heavy freezing rain",icon:"sleet"},71:{summary:"Slight snow",icon:"snow"},73:{summary:"Moderate snow",icon:"snow"},75:{summary:"Heavy snow",icon:"snow"},77:{summary:"Snow grains",icon:"snow"},80:{summary:"Slight rain showers",icon:"rain"},81:{summary:"Moderate rain showers",icon:"rain"},82:{summary:"Violent rain showers",icon:"rain"},85:{summary:"Slight snow showers",icon:"snow"},86:{summary:"Heavy snow showers",icon:"snow"},95:{summary:"Thunderstorm",icon:"thunderstorm"},96:{summary:"Thunderstorm with slight hail",icon:"thunderstorm"},99:{summary:"Thunderstorm with heavy hail",icon:"thunderstorm"}};function TT(e){var t;return((t=kT[e])==null?void 0:t.summary)??"Unknown"}function rx(e,t){const s=kT[e];return s?!t&&s.iconNight?s.iconNight:s.icon:"cloudy"}function wD(e){var l;if(!e||e.length===0)return null;const t=new Date;if(((l=e[0])==null?void 0:l.intensity)>0){const p=e.findIndex(c=>c.intensity===0);if(p===-1)return"Rain continuing for the next hour";const v=e[p].time;return`Rain stopping in ${Math.round((v.getTime()-t.getTime())/6e4)} min`}else{const p=e.findIndex(c=>c.intensity>0);if(p===-1)return"No rain expected in the next hour";const v=e[p].time;return`Rain starting in ${Math.round((v.getTime()-t.getTime())/6e4)} min`}}function bD(e){const t=e.current,s=e.hourly,l=t.weather_code,p=t.is_day===1;return{temperature:t.temperature_2m,feelsLike:t.apparent_temperature,humidity:t.relative_humidity_2m,dewPoint:s.dew_point_2m[0],pressure:t.pressure_msl,windSpeed:t.wind_speed_10m,windDirection:t.wind_direction_10m,windGust:t.wind_gusts_10m,visibility:s.visibility[0]/1e3,uvIndex:s.uv_index[0],cloudCover:t.cloud_cover,weatherCode:l,summary:TT(l),icon:rx(l,p),isDay:p,precipitationProbability:s.precipitation_probability[0],precipitation:t.precipitation}}function SD(e){const t=e.hourly;return t.time.map((s,l)=>{const p=t.weather_code[l],v=t.is_day[l]===1;return{time:new Date(s),temperature:t.temperature_2m[l],feelsLike:t.apparent_temperature[l],humidity:t.relative_humidity_2m[l],precipitationProbability:t.precipitation_probability[l],precipitation:t.precipitation[l],weatherCode:p,icon:rx(p,v),windSpeed:t.wind_speed_10m[l],windDirection:t.wind_direction_10m[l],isDay:v}})}function kD(e){const t=e.daily;return t.time.map((s,l)=>{const p=t.weather_code[l];return{date:new Date(s),temperatureMax:t.temperature_2m_max[l],temperatureMin:t.temperature_2m_min[l],sunrise:new Date(t.sunrise[l]),sunset:new Date(t.sunset[l]),precipitationProbability:t.precipitation_probability_max[l],precipitationSum:t.precipitation_sum[l],weatherCode:p,icon:rx(p,!0),summary:TT(p),uvIndexMax:t.uv_index_max[l],windSpeedMax:t.wind_speed_10m_max[l],windDirection:t.wind_direction_10m_dominant[l]}})}function TD(e,t){return{location:t,current:bD(e),hourly:SD(e),daily:kD(e),minutely:void 0,alerts:[],lastUpdated:new Date}}async function CD(e){const{latitude:t,longitude:s}=e.coordinates,l=await xD(t,s);return TD(l,e)}function MD(e){const s=Ri(l=>l.getActiveLocation());return Qv({queryKey:s?vg.weather(s.coordinates.latitude,s.coordinates.longitude):["weather","none"],queryFn:()=>CD(s),enabled:!!s,staleTime:Vl.CURRENT_CONDITIONS.staleTime,gcTime:Vl.CURRENT_CONDITIONS.gcTime,refetchOnWindowFocus:!0,retry:3})}function ID(e){return`${e.osm_type}-${e.osm_id}`}function CT(e){const t=e.address;return t?t.city||t.town||t.village||t.municipality||e.name||e.display_name.split(",")[0]:e.name||e.display_name.split(",")[0]}function ED(e){const t=e.address;if(!t)return e.display_name;const s=[],l=CT(e);return s.push(l),t.state&&t.state!==l&&s.push(t.state),t.country&&s.push(t.country),s.join(", ")}function MT(e){var t,s;return{id:ID(e),name:CT(e),displayName:ED(e),coordinates:{latitude:parseFloat(e.lat),longitude:parseFloat(e.lon)},country:(t=e.address)==null?void 0:t.country,state:(s=e.address)==null?void 0:s.state}}async function PD(e){if(!e.trim())return[];const t=new URLSearchParams({q:e,format:"json",addressdetails:"1",limit:"10"}),s=await fetch(`${bf.NOMINATIM_SEARCH}?${t}`,{headers:{"User-Agent":"DarthSky Weather App (https://github.com/darthsky)"}});if(!s.ok)throw new Error(`Nominatim API error: ${s.status}`);return(await s.json()).map(MT)}async function AD(e,t){const s=new URLSearchParams({lat:e.toString(),lon:t.toString(),format:"json",addressdetails:"1"}),l=await fetch(`${bf.NOMINATIM_REVERSE}?${s}`,{headers:{"User-Agent":"DarthSky Weather App (https://github.com/darthsky)"}});if(!l.ok){if(l.status===404)return null;throw new Error(`Nominatim API error: ${l.status}`)}const p=await l.json();return!p||!p.lat?null:{...MT(p),isCurrentLocation:!0}}function zD(){const[e,t]=Pe.useState({isLoading:!1,error:null,location:null}),s=Ri(y=>y.addLocation),l=Ri(y=>y.setActiveLocation),p=Pe.useCallback(()=>{t(y=>({...y,error:null}))},[]),v=Pe.useCallback(async()=>navigator.geolocation?(t(y=>({...y,isLoading:!0,error:null})),new Promise(y=>{navigator.geolocation.getCurrentPosition(async c=>{try{const{latitude:M,longitude:I}=c.coords,j=await AD(M,I);if(j){const z={...j,id:"current-location",isCurrentLocation:!0};t({isLoading:!1,error:null,location:z}),s(z),l(z.id),y(z)}else{const z={id:"current-location",name:"Current Location",displayName:`${M.toFixed(4)}, ${I.toFixed(4)}`,coordinates:{latitude:M,longitude:I},isCurrentLocation:!0};t({isLoading:!1,error:null,location:z}),s(z),l(z.id),y(z)}}catch{t({isLoading:!1,error:"Failed to get location details",location:null}),y(null)}},c=>{let M="Failed to get your location";switch(c.code){case c.PERMISSION_DENIED:M="Location permission denied";break;case c.POSITION_UNAVAILABLE:M="Location unavailable";break;case c.TIMEOUT:M="Location request timed out";break}t({isLoading:!1,error:M,location:null}),y(null)},{enableHighAccuracy:!1,timeout:1e4,maximumAge:3e5})})):(t(y=>({...y,error:"Geolocation is not supported by your browser"})),null),[s,l]);return{...e,requestLocation:v,clearError:p}}function DD(e,t){return t==="celsius"?e:e*9/5+32}function LD(e,t){switch(t){case"kmh":return e;case"mph":return e*.621371;case"ms":return e/3.6;case"knots":return e*.539957;default:return e}}function RD(e,t){switch(t){case"hpa":return e;case"inhg":return e*.02953;case"mmhg":return e*.75006;default:return e}}function FD(e,t){return t==="km"?e:e*.621371}function OD(e,t){return t==="mm"?e:e*.0393701}function ND(e){return e==="celsius"?"C":"F"}function Rb(e){switch(e){case"kmh":return"km/h";case"mph":return"mph";case"ms":return"m/s";case"knots":return"kn";default:return"km/h"}}function Fb(e){switch(e){case"hpa":return"hPa";case"inhg":return"inHg";case"mmhg":return"mmHg";default:return"hPa"}}function Ob(e){return e==="km"?"km":"mi"}function Nb(e){return e==="mm"?"mm":"in"}function BD(e,t=!0){const s=Math.round(e);return t?`${s}`:String(s)}function Bb(e,t){const s=e.getHours(),l=e.getMinutes();if(t==="24h")return`${s.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`;const p=s>=12?"PM":"AM";return`${s%12||12}:${l.toString().padStart(2,"0")} ${p}`}function jD(e,t){const s=e.getHours();if(t==="24h")return`${s.toString().padStart(2,"0")}:00`;const l=s>=12?"PM":"AM";return`${s%12||12}${l}`}function UD(e){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()]}function VD(e){const t=["N","NE","E","SE","S","SW","W","NW"],s=Math.round(e/45)%8;return t[s]}function $D(e){return`${Math.round(e)}%`}function qD(e){const t=new Date;return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function ZD(e){const t=new Date;return t.setDate(t.getDate()+1),e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function xg(){const e=Yc(y=>y.units),t=Pe.useCallback((y,c=!0)=>{const M=DD(y,e.temperature);return BD(M,c)},[e.temperature]),s=Pe.useCallback(y=>{const c=LD(y,e.windSpeed);return`${Math.round(c)} ${Rb(e.windSpeed)}`},[e.windSpeed]),l=Pe.useCallback(y=>{const c=RD(y,e.pressure),M=e.pressure==="hpa"?0:2;return`${c.toFixed(M)} ${Fb(e.pressure)}`},[e.pressure]),p=Pe.useCallback(y=>`${FD(y,e.visibility).toFixed(1)} ${Ob(e.visibility)}`,[e.visibility]),v=Pe.useCallback(y=>{const c=OD(y,e.precipitation),M=e.precipitation==="mm"?1:2;return`${c.toFixed(M)} ${Nb(e.precipitation)}`},[e.precipitation]);return{units:e,formatTemp:t,formatWind:s,formatPressure:l,formatVisibility:p,formatPrecipitation:v,temperatureLabel:ND(e.temperature),windSpeedLabel:Rb(e.windSpeed),pressureLabel:Fb(e.pressure),visibilityLabel:Ob(e.visibility),precipitationLabel:Nb(e.precipitation)}}function HD(e){return Qv({queryKey:vg.geocode(e),queryFn:()=>PD(e),enabled:e.length>=2,staleTime:Vl.GEOCODING.staleTime,gcTime:Vl.GEOCODING.gcTime})}function GD(){const[e,t]=Pe.useState(!1),[s,l]=Pe.useState(""),p=Ri(he=>he.locations),v=Ri(he=>he.activeLocationId),y=Ri(he=>he.addLocation),c=Ri(he=>he.removeLocation),M=Ri(he=>he.setActiveLocation),I=Ri(he=>he.reorderLocations),z=Ri(he=>he.getActiveLocation)(),R=Pe.useCallback(he=>{y(he),M(he.id),t(!1),l("")},[y,M]),X=Pe.useCallback(he=>{c(he)},[c]),me=Pe.useCallback(he=>{M(he)},[M]);return{locations:p,activeLocation:z,activeLocationId:v,isSearching:e,searchQuery:s,setIsSearching:t,setSearchQuery:l,handleSelectLocation:R,handleRemoveLocation:X,handleSwitchLocation:me,reorderLocations:I}}function WD(){const[e,t]=Pe.useState(""),s=Pe.useRef(null),l=sf(W=>W.isLocationSearchOpen),p=sf(W=>W.closeLocationSearch),{locations:v,activeLocationId:y,handleSelectLocation:c,handleRemoveLocation:M,handleSwitchLocation:I}=GD(),{data:j,isLoading:z}=HD(e),{requestLocation:R,isLoading:X}=zD();if(Pe.useEffect(()=>{l&&s.current&&s.current.focus()},[l]),Pe.useEffect(()=>{const W=Q=>{Q.key==="Escape"&&l&&p()};return document.addEventListener("keydown",W),()=>document.removeEventListener("keydown",W)},[l,p]),!l)return null;const me=W=>{c(W),p()},he=async()=>{await R()&&p()},ge=W=>{I(W),p()};return G.jsxs("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm animate-fade-in",children:[G.jsxs("div",{className:"fixed inset-x-0 top-0 bg-white dark:bg-slate-900 rounded-b-2xl shadow-xl max-h-[80vh] overflow-hidden animate-slide-down",children:[G.jsx("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700",children:G.jsxs("div",{className:"flex items-center gap-3",children:[G.jsxs("div",{className:"flex-1 relative",children:[G.jsx(Xz,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),G.jsx("input",{ref:s,type:"text",value:e,onChange:W=>t(W.target.value),placeholder:"Search for a city...",className:"input pl-10 pr-10",autoComplete:"off"}),e&&G.jsx("button",{onClick:()=>t(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",children:G.jsx(bT,{size:18})})]}),G.jsx(Fd,{variant:"ghost",size:"md",onClick:p,children:"Cancel"})]})}),G.jsxs("div",{className:"overflow-y-auto max-h-[60vh]",children:[!e&&G.jsxs(G.Fragment,{children:[G.jsxs("button",{onClick:he,disabled:X,className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors",children:[G.jsx("div",{className:"w-10 h-10 rounded-full bg-sky-100 dark:bg-sky-900 flex items-center justify-center",children:G.jsx(L0,{size:20,className:`text-sky-500 ${X?"animate-pulse":""}`})}),G.jsxs("div",{className:"flex-1 text-left",children:[G.jsx("p",{className:"font-medium text-slate-900 dark:text-slate-100",children:"Current Location"}),G.jsx("p",{className:"text-sm text-slate-500",children:"Use GPS"})]})]}),v.length>0&&G.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700",children:[G.jsx("p",{className:"px-4 py-2 text-xs font-semibold uppercase tracking-wider text-slate-500",children:"Saved Locations"}),v.map(W=>G.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors",children:[G.jsxs("button",{onClick:()=>ge(W.id),className:"flex-1 flex items-center gap-3 text-left",children:[G.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center",children:W.isCurrentLocation?G.jsx(L0,{size:20,className:"text-sky-500"}):G.jsx(D0,{size:20,className:"text-slate-400"})}),G.jsxs("div",{className:"flex-1 min-w-0",children:[G.jsx("p",{className:"font-medium text-slate-900 dark:text-slate-100 truncate",children:W.name}),G.jsx("p",{className:"text-sm text-slate-500 truncate",children:W.displayName})]}),W.id===y&&G.jsx(Yz,{size:16,className:"text-amber-500 fill-amber-500"})]}),!W.isCurrentLocation&&G.jsx("button",{onClick:()=>M(W.id),className:"p-2 text-slate-400 hover:text-red-500 transition-colors","aria-label":`Remove ${W.name}`,children:G.jsx(tD,{size:18})})]},W.id))]})]}),e&&G.jsx("div",{children:z?G.jsx("div",{className:"p-8 text-center text-slate-500",children:"Searching..."}):j&&j.length>0?j.map(W=>G.jsxs("button",{onClick:()=>me(W),className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors",children:[G.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center",children:G.jsx(D0,{size:20,className:"text-slate-400"})}),G.jsxs("div",{className:"flex-1 text-left min-w-0",children:[G.jsx("p",{className:"font-medium text-slate-900 dark:text-slate-100 truncate",children:W.name}),G.jsx("p",{className:"text-sm text-slate-500 truncate",children:W.displayName})]})]},W.id)):e.length>=2?G.jsx("div",{className:"p-8 text-center text-slate-500",children:"No locations found"}):null})]})]}),G.jsx("button",{onClick:p,className:"absolute inset-0 -z-10","aria-label":"Close location search"})]})}function XD({conditions:e,location:t,today:s}){const{formatTemp:l}=xg(),p=(s==null?void 0:s.temperatureMin)??e.temperature-5,v=(s==null?void 0:s.temperatureMax)??e.temperature+5;return G.jsxs("div",{className:"text-center py-8 px-4",children:[G.jsx("h1",{className:"text-lg font-medium text-slate-600 dark:text-slate-400 mb-1",children:t.name}),G.jsxs("div",{className:"flex items-center justify-center gap-4 mb-2",children:[G.jsx(tx,{icon:e.icon,size:64}),G.jsx("span",{className:"text-7xl font-light tracking-tight text-slate-900 dark:text-slate-100",children:l(e.temperature)})]}),G.jsx("p",{className:"text-xl text-slate-600 dark:text-slate-400 mb-1",children:e.summary}),G.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-500",children:["Feels like ",l(e.feelsLike)]}),G.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4 text-sm text-slate-500 dark:text-slate-400",children:[G.jsxs("div",{children:[G.jsx("span",{className:"text-blue-500",children:"L: "}),G.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:l(p)})]}),G.jsxs("div",{children:[G.jsx("span",{className:"text-red-500",children:"H: "}),G.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:l(v)})]})]})]})}function O0(e){return e<=0?"#818cf8":e<=10?"#60a5fa":e<=18?"#34d399":e<=25?"#fbbf24":e<=32?"#fb923c":"#ef4444"}function KD(e,t){const s=O0(e),l=O0(t);return`linear-gradient(to right, ${s}, ${l})`}function YD(e){return e<=2?"#22c55e":e<=5?"#eab308":e<=7?"#f97316":e<=10?"#ef4444":"#9333ea"}function QD(e){return e<=2?"Low":e<=5?"Moderate":e<=7?"High":e<=10?"Very High":"Extreme"}function JD(e){switch(e){case"minor":return"#3b82f6";case"moderate":return"#eab308";case"severe":return"#f97316";case"extreme":return"#ef4444";default:return"#6b7280"}}function eL({hourly:e}){const t=Pe.useRef(null),{formatTemp:s}=xg(),l=Yc(I=>I.units.timeFormat),p=e.slice(0,24),v=p.map(I=>I.temperature),y=Math.min(...v),M=Math.max(...v)-y||1;return G.jsxs("div",{className:"card overflow-hidden",children:[G.jsx("div",{className:"px-4 py-3 border-b border-slate-100 dark:border-slate-700",children:G.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wider text-slate-500 dark:text-slate-400",children:"Hourly Forecast"})}),G.jsx("div",{ref:t,className:"flex overflow-x-auto scrollbar-hide py-4 px-2 gap-1",children:p.map((I,j)=>{const z=j===0,R=(I.temperature-y)/M*40+20,X=O0(I.temperature);return G.jsxs("div",{className:"flex flex-col items-center min-w-[60px] px-2",children:[G.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400 mb-2",children:z?"Now":jD(I.time,l)}),G.jsx(tx,{icon:I.icon,size:24,className:"mb-2"}),I.precipitationProbability>0&&G.jsxs("span",{className:"text-xs text-blue-500 mb-1",children:[Math.round(I.precipitationProbability),"%"]}),G.jsx("div",{className:"flex-1 flex items-end mb-2",style:{height:"60px"},children:G.jsx("div",{className:"w-8 rounded-full transition-all duration-300",style:{height:`${R}px`,backgroundColor:X,opacity:.8}})}),G.jsx("span",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:s(I.temperature)})]},I.time.toISOString())})})]})}function tL({daily:e}){const{formatTemp:t}=xg(),s=e.map(c=>c.temperatureMin),l=e.map(c=>c.temperatureMax),p=Math.min(...s),y=Math.max(...l)-p||1;return G.jsxs("div",{className:"card overflow-hidden",children:[G.jsx("div",{className:"px-4 py-3 border-b border-slate-100 dark:border-slate-700",children:G.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wider text-slate-500 dark:text-slate-400",children:"7-Day Forecast"})}),G.jsx("div",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:e.map(c=>{const M=qD(c.date)?"Today":ZD(c.date)?"Tomorrow":UD(c.date),I=(c.temperatureMin-p)/y*100,j=(c.temperatureMax-c.temperatureMin)/y*100;return G.jsxs("div",{className:"flex items-center px-4 py-3 gap-3",children:[G.jsx("span",{className:"w-20 text-sm font-medium text-slate-900 dark:text-slate-100",children:M}),G.jsx(tx,{icon:c.icon,size:24,className:"shrink-0"}),c.precipitationProbability>0?G.jsxs("span",{className:"w-10 text-xs text-blue-500 text-right",children:[Math.round(c.precipitationProbability),"%"]}):G.jsx("span",{className:"w-10"}),G.jsx("span",{className:"w-10 text-sm text-slate-500 dark:text-slate-400 text-right",children:t(c.temperatureMin,!1)}),G.jsx("div",{className:"flex-1 h-1.5 bg-slate-100 dark:bg-slate-700 rounded-full relative mx-2",children:G.jsx("div",{className:"absolute h-full rounded-full",style:{left:`${I}%`,width:`${Math.max(j,5)}%`,background:KD(c.temperatureMin,c.temperatureMax)}})}),G.jsx("span",{className:"w-10 text-sm font-medium text-slate-900 dark:text-slate-100 text-right",children:t(c.temperatureMax,!1)})]},c.date.toISOString())})})]})}function ho({icon:e,label:t,value:s,subValue:l,color:p}){return G.jsx(El,{className:"p-4",children:G.jsxs("div",{className:"flex items-start gap-3",children:[G.jsx("div",{className:"text-slate-400 dark:text-slate-500",children:e}),G.jsxs("div",{className:"flex-1 min-w-0",children:[G.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wide mb-1",children:t}),G.jsx("p",{className:"text-lg font-medium text-slate-900 dark:text-slate-100 truncate",style:p?{color:p}:void 0,children:s}),l&&G.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:l})]})]})})}function rL({current:e,today:t}){const{formatTemp:s,formatWind:l,formatPressure:p,formatVisibility:v}=xg(),y=Yc(I=>I.units.timeFormat),c=YD(e.uvIndex),M=QD(e.uvIndex);return G.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[G.jsx(ho,{icon:G.jsx(Uz,{size:20}),label:"Humidity",value:$D(e.humidity),subValue:`Dew point: ${s(e.dewPoint)}`}),G.jsx(ho,{icon:G.jsx(wT,{size:20}),label:"Wind",value:l(e.windSpeed),subValue:G.jsxs(G.Fragment,{children:[G.jsx(L0,{size:12,className:"inline mr-1",style:{transform:`rotate(${e.windDirection+180}deg)`}}),VD(e.windDirection),e.windGust&&`, gusts ${l(e.windGust)}`]})}),G.jsx(ho,{icon:G.jsx($z,{size:20}),label:"Pressure",value:p(e.pressure)}),G.jsx(ho,{icon:G.jsx(xT,{size:20}),label:"UV Index",value:`${Math.round(e.uvIndex)} ${M}`,color:c}),G.jsx(ho,{icon:G.jsx(Vz,{size:20}),label:"Visibility",value:v(e.visibility)}),G.jsx(ho,{icon:G.jsx(eD,{size:20}),label:"Feels Like",value:s(e.feelsLike)}),t&&G.jsxs(G.Fragment,{children:[G.jsx(ho,{icon:G.jsx(Qz,{size:20}),label:"Sunrise",value:Bb(t.sunrise,y)}),G.jsx(ho,{icon:G.jsx(Jz,{size:20}),label:"Sunset",value:Bb(t.sunset,y)})]})]})}function hm(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function nL(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function nx(e){let t,s,l;e.length!==2?(t=hm,s=(c,M)=>hm(e(c),M),l=(c,M)=>e(c)-M):(t=e===hm||e===nL?e:iL,s=e,l=e);function p(c,M,I=0,j=c.length){if(I<j){if(t(M,M)!==0)return j;do{const z=I+j>>>1;s(c[z],M)<0?I=z+1:j=z}while(I<j)}return I}function v(c,M,I=0,j=c.length){if(I<j){if(t(M,M)!==0)return j;do{const z=I+j>>>1;s(c[z],M)<=0?I=z+1:j=z}while(I<j)}return I}function y(c,M,I=0,j=c.length){const z=p(c,M,I,j-1);return z>I&&l(c[z-1],M)>-l(c[z],M)?z-1:z}return{left:p,center:y,right:v}}function iL(){return 0}function sL(e){return e===null?NaN:+e}const aL=nx(hm),oL=aL.right;nx(sL).center;function lL(e,t){let s,l;if(t===void 0)for(const p of e)p!=null&&(s===void 0?p>=p&&(s=l=p):(s>p&&(s=p),l<p&&(l=p)));else{let p=-1;for(let v of e)(v=t(v,++p,e))!=null&&(s===void 0?v>=v&&(s=l=v):(s>v&&(s=v),l<v&&(l=v)))}return[s,l]}const uL=Math.sqrt(50),cL=Math.sqrt(10),hL=Math.sqrt(2);function Um(e,t,s){const l=(t-e)/Math.max(0,s),p=Math.floor(Math.log10(l)),v=l/Math.pow(10,p),y=v>=uL?10:v>=cL?5:v>=hL?2:1;let c,M,I;return p<0?(I=Math.pow(10,-p)/y,c=Math.round(e*I),M=Math.round(t*I),c/I<e&&++c,M/I>t&&--M,I=-I):(I=Math.pow(10,p)*y,c=Math.round(e/I),M=Math.round(t/I),c*I<e&&++c,M*I>t&&--M),M<c&&.5<=s&&s<2?Um(e,t,s*2):[c,M,I]}function dL(e,t,s){if(t=+t,e=+e,s=+s,!(s>0))return[];if(e===t)return[e];const l=t<e,[p,v,y]=l?Um(t,e,s):Um(e,t,s);if(!(v>=p))return[];const c=v-p+1,M=new Array(c);if(l)if(y<0)for(let I=0;I<c;++I)M[I]=(v-I)/-y;else for(let I=0;I<c;++I)M[I]=(v-I)*y;else if(y<0)for(let I=0;I<c;++I)M[I]=(p+I)/-y;else for(let I=0;I<c;++I)M[I]=(p+I)*y;return M}function N0(e,t,s){return t=+t,e=+e,s=+s,Um(e,t,s)[2]}function B0(e,t,s){t=+t,e=+e,s=+s;const l=t<e,p=l?N0(t,e,s):N0(e,t,s);return(l?-1:1)*(p<0?1/-p:p)}function fL(e){return e}var pL=3,jb=1e-6;function mL(e){return"translate("+e+",0)"}function gL(e){return t=>+e(t)}function yL(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),s=>+e(s)+t}function _L(){return!this.__axis}function vL(e,t){var s=[],l=null,p=null,v=6,y=6,c=3,M=typeof window<"u"&&window.devicePixelRatio>1?0:.5,I=1,j="y",z=mL;function R(X){var me=l??(t.ticks?t.ticks.apply(t,s):t.domain()),he=p??(t.tickFormat?t.tickFormat.apply(t,s):fL),ge=Math.max(v,0)+c,W=t.range(),Q=+W[0]+M,te=+W[W.length-1]+M,oe=(t.bandwidth?yL:gL)(t.copy(),M),Me=X.selection?X.selection():X,Se=Me.selectAll(".domain").data([null]),ze=Me.selectAll(".tick").data(me,t).order(),Fe=ze.exit(),ct=ze.enter().append("g").attr("class","tick"),it=ze.select("line"),ht=ze.select("text");Se=Se.merge(Se.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),ze=ze.merge(ct),it=it.merge(ct.append("line").attr("stroke","currentColor").attr(j+"2",I*v)),ht=ht.merge(ct.append("text").attr("fill","currentColor").attr(j,I*ge).attr("dy","0.71em")),X!==Me&&(Se=Se.transition(X),ze=ze.transition(X),it=it.transition(X),ht=ht.transition(X),Fe=Fe.transition(X).attr("opacity",jb).attr("transform",function(dt){return isFinite(dt=oe(dt))?z(dt+M):this.getAttribute("transform")}),ct.attr("opacity",jb).attr("transform",function(dt){var Pt=this.parentNode.__axis;return z((Pt&&isFinite(Pt=Pt(dt))?Pt:oe(dt))+M)})),Fe.remove(),Se.attr("d",y?"M"+Q+","+I*y+"V"+M+"H"+te+"V"+I*y:"M"+Q+","+M+"H"+te),ze.attr("opacity",1).attr("transform",function(dt){return z(oe(dt)+M)}),it.attr(j+"2",I*v),ht.attr(j,I*ge).text(he),Me.filter(_L).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","middle"),Me.each(function(){this.__axis=oe})}return R.scale=function(X){return arguments.length?(t=X,R):t},R.ticks=function(){return s=Array.from(arguments),R},R.tickArguments=function(X){return arguments.length?(s=X==null?[]:Array.from(X),R):s.slice()},R.tickValues=function(X){return arguments.length?(l=X==null?null:Array.from(X),R):l&&l.slice()},R.tickFormat=function(X){return arguments.length?(p=X,R):p},R.tickSize=function(X){return arguments.length?(v=y=+X,R):v},R.tickSizeInner=function(X){return arguments.length?(v=+X,R):v},R.tickSizeOuter=function(X){return arguments.length?(y=+X,R):y},R.tickPadding=function(X){return arguments.length?(c=+X,R):c},R.offset=function(X){return arguments.length?(M=+X,R):M},R}function xL(e){return vL(pL,e)}var wL={value:()=>{}};function IT(){for(var e=0,t=arguments.length,s={},l;e<t;++e){if(!(l=arguments[e]+"")||l in s||/[\s.]/.test(l))throw new Error("illegal type: "+l);s[l]=[]}return new dm(s)}function dm(e){this._=e}function bL(e,t){return e.trim().split(/^|\s+/).map(function(s){var l="",p=s.indexOf(".");if(p>=0&&(l=s.slice(p+1),s=s.slice(0,p)),s&&!t.hasOwnProperty(s))throw new Error("unknown type: "+s);return{type:s,name:l}})}dm.prototype=IT.prototype={constructor:dm,on:function(e,t){var s=this._,l=bL(e+"",s),p,v=-1,y=l.length;if(arguments.length<2){for(;++v<y;)if((p=(e=l[v]).type)&&(p=SL(s[p],e.name)))return p;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++v<y;)if(p=(e=l[v]).type)s[p]=Ub(s[p],e.name,t);else if(t==null)for(p in s)s[p]=Ub(s[p],e.name,null);return this},copy:function(){var e={},t=this._;for(var s in t)e[s]=t[s].slice();return new dm(e)},call:function(e,t){if((p=arguments.length-2)>0)for(var s=new Array(p),l=0,p,v;l<p;++l)s[l]=arguments[l+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(v=this._[e],l=0,p=v.length;l<p;++l)v[l].value.apply(t,s)},apply:function(e,t,s){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var l=this._[e],p=0,v=l.length;p<v;++p)l[p].value.apply(t,s)}};function SL(e,t){for(var s=0,l=e.length,p;s<l;++s)if((p=e[s]).name===t)return p.value}function Ub(e,t,s){for(var l=0,p=e.length;l<p;++l)if(e[l].name===t){e[l]=wL,e=e.slice(0,l).concat(e.slice(l+1));break}return s!=null&&e.push({name:t,value:s}),e}var j0="http://www.w3.org/1999/xhtml";const Vb={svg:"http://www.w3.org/2000/svg",xhtml:j0,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function wg(e){var t=e+="",s=t.indexOf(":");return s>=0&&(t=e.slice(0,s))!=="xmlns"&&(e=e.slice(s+1)),Vb.hasOwnProperty(t)?{space:Vb[t],local:e}:e}function kL(e){return function(){var t=this.ownerDocument,s=this.namespaceURI;return s===j0&&t.documentElement.namespaceURI===j0?t.createElement(e):t.createElementNS(s,e)}}function TL(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ET(e){var t=wg(e);return(t.local?TL:kL)(t)}function CL(){}function ix(e){return e==null?CL:function(){return this.querySelector(e)}}function ML(e){typeof e!="function"&&(e=ix(e));for(var t=this._groups,s=t.length,l=new Array(s),p=0;p<s;++p)for(var v=t[p],y=v.length,c=l[p]=new Array(y),M,I,j=0;j<y;++j)(M=v[j])&&(I=e.call(M,M.__data__,j,v))&&("__data__"in M&&(I.__data__=M.__data__),c[j]=I);return new Bi(l,this._parents)}function IL(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function EL(){return[]}function PT(e){return e==null?EL:function(){return this.querySelectorAll(e)}}function PL(e){return function(){return IL(e.apply(this,arguments))}}function AL(e){typeof e=="function"?e=PL(e):e=PT(e);for(var t=this._groups,s=t.length,l=[],p=[],v=0;v<s;++v)for(var y=t[v],c=y.length,M,I=0;I<c;++I)(M=y[I])&&(l.push(e.call(M,M.__data__,I,y)),p.push(M));return new Bi(l,p)}function AT(e){return function(){return this.matches(e)}}function zT(e){return function(t){return t.matches(e)}}var zL=Array.prototype.find;function DL(e){return function(){return zL.call(this.children,e)}}function LL(){return this.firstElementChild}function RL(e){return this.select(e==null?LL:DL(typeof e=="function"?e:zT(e)))}var FL=Array.prototype.filter;function OL(){return Array.from(this.children)}function NL(e){return function(){return FL.call(this.children,e)}}function BL(e){return this.selectAll(e==null?OL:NL(typeof e=="function"?e:zT(e)))}function jL(e){typeof e!="function"&&(e=AT(e));for(var t=this._groups,s=t.length,l=new Array(s),p=0;p<s;++p)for(var v=t[p],y=v.length,c=l[p]=[],M,I=0;I<y;++I)(M=v[I])&&e.call(M,M.__data__,I,v)&&c.push(M);return new Bi(l,this._parents)}function DT(e){return new Array(e.length)}function UL(){return new Bi(this._enter||this._groups.map(DT),this._parents)}function Vm(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Vm.prototype={constructor:Vm,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function VL(e){return function(){return e}}function $L(e,t,s,l,p,v){for(var y=0,c,M=t.length,I=v.length;y<I;++y)(c=t[y])?(c.__data__=v[y],l[y]=c):s[y]=new Vm(e,v[y]);for(;y<M;++y)(c=t[y])&&(p[y]=c)}function qL(e,t,s,l,p,v,y){var c,M,I=new Map,j=t.length,z=v.length,R=new Array(j),X;for(c=0;c<j;++c)(M=t[c])&&(R[c]=X=y.call(M,M.__data__,c,t)+"",I.has(X)?p[c]=M:I.set(X,M));for(c=0;c<z;++c)X=y.call(e,v[c],c,v)+"",(M=I.get(X))?(l[c]=M,M.__data__=v[c],I.delete(X)):s[c]=new Vm(e,v[c]);for(c=0;c<j;++c)(M=t[c])&&I.get(R[c])===M&&(p[c]=M)}function ZL(e){return e.__data__}function HL(e,t){if(!arguments.length)return Array.from(this,ZL);var s=t?qL:$L,l=this._parents,p=this._groups;typeof e!="function"&&(e=VL(e));for(var v=p.length,y=new Array(v),c=new Array(v),M=new Array(v),I=0;I<v;++I){var j=l[I],z=p[I],R=z.length,X=GL(e.call(j,j&&j.__data__,I,l)),me=X.length,he=c[I]=new Array(me),ge=y[I]=new Array(me),W=M[I]=new Array(R);s(j,z,he,ge,W,X,t);for(var Q=0,te=0,oe,Me;Q<me;++Q)if(oe=he[Q]){for(Q>=te&&(te=Q+1);!(Me=ge[te])&&++te<me;);oe._next=Me||null}}return y=new Bi(y,l),y._enter=c,y._exit=M,y}function GL(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function WL(){return new Bi(this._exit||this._groups.map(DT),this._parents)}function XL(e,t,s){var l=this.enter(),p=this,v=this.exit();return typeof e=="function"?(l=e(l),l&&(l=l.selection())):l=l.append(e+""),t!=null&&(p=t(p),p&&(p=p.selection())),s==null?v.remove():s(v),l&&p?l.merge(p).order():p}function KL(e){for(var t=e.selection?e.selection():e,s=this._groups,l=t._groups,p=s.length,v=l.length,y=Math.min(p,v),c=new Array(p),M=0;M<y;++M)for(var I=s[M],j=l[M],z=I.length,R=c[M]=new Array(z),X,me=0;me<z;++me)(X=I[me]||j[me])&&(R[me]=X);for(;M<p;++M)c[M]=s[M];return new Bi(c,this._parents)}function YL(){for(var e=this._groups,t=-1,s=e.length;++t<s;)for(var l=e[t],p=l.length-1,v=l[p],y;--p>=0;)(y=l[p])&&(v&&y.compareDocumentPosition(v)^4&&v.parentNode.insertBefore(y,v),v=y);return this}function QL(e){e||(e=JL);function t(z,R){return z&&R?e(z.__data__,R.__data__):!z-!R}for(var s=this._groups,l=s.length,p=new Array(l),v=0;v<l;++v){for(var y=s[v],c=y.length,M=p[v]=new Array(c),I,j=0;j<c;++j)(I=y[j])&&(M[j]=I);M.sort(t)}return new Bi(p,this._parents).order()}function JL(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function e3(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function t3(){return Array.from(this)}function r3(){for(var e=this._groups,t=0,s=e.length;t<s;++t)for(var l=e[t],p=0,v=l.length;p<v;++p){var y=l[p];if(y)return y}return null}function n3(){let e=0;for(const t of this)++e;return e}function i3(){return!this.node()}function s3(e){for(var t=this._groups,s=0,l=t.length;s<l;++s)for(var p=t[s],v=0,y=p.length,c;v<y;++v)(c=p[v])&&e.call(c,c.__data__,v,p);return this}function a3(e){return function(){this.removeAttribute(e)}}function o3(e){return function(){this.removeAttributeNS(e.space,e.local)}}function l3(e,t){return function(){this.setAttribute(e,t)}}function u3(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function c3(e,t){return function(){var s=t.apply(this,arguments);s==null?this.removeAttribute(e):this.setAttribute(e,s)}}function h3(e,t){return function(){var s=t.apply(this,arguments);s==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,s)}}function d3(e,t){var s=wg(e);if(arguments.length<2){var l=this.node();return s.local?l.getAttributeNS(s.space,s.local):l.getAttribute(s)}return this.each((t==null?s.local?o3:a3:typeof t=="function"?s.local?h3:c3:s.local?u3:l3)(s,t))}function LT(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function f3(e){return function(){this.style.removeProperty(e)}}function p3(e,t,s){return function(){this.style.setProperty(e,t,s)}}function m3(e,t,s){return function(){var l=t.apply(this,arguments);l==null?this.style.removeProperty(e):this.style.setProperty(e,l,s)}}function g3(e,t,s){return arguments.length>1?this.each((t==null?f3:typeof t=="function"?m3:p3)(e,t,s??"")):Vc(this.node(),e)}function Vc(e,t){return e.style.getPropertyValue(t)||LT(e).getComputedStyle(e,null).getPropertyValue(t)}function y3(e){return function(){delete this[e]}}function _3(e,t){return function(){this[e]=t}}function v3(e,t){return function(){var s=t.apply(this,arguments);s==null?delete this[e]:this[e]=s}}function x3(e,t){return arguments.length>1?this.each((t==null?y3:typeof t=="function"?v3:_3)(e,t)):this.node()[e]}function RT(e){return e.trim().split(/^|\s+/)}function sx(e){return e.classList||new FT(e)}function FT(e){this._node=e,this._names=RT(e.getAttribute("class")||"")}FT.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function OT(e,t){for(var s=sx(e),l=-1,p=t.length;++l<p;)s.add(t[l])}function NT(e,t){for(var s=sx(e),l=-1,p=t.length;++l<p;)s.remove(t[l])}function w3(e){return function(){OT(this,e)}}function b3(e){return function(){NT(this,e)}}function S3(e,t){return function(){(t.apply(this,arguments)?OT:NT)(this,e)}}function k3(e,t){var s=RT(e+"");if(arguments.length<2){for(var l=sx(this.node()),p=-1,v=s.length;++p<v;)if(!l.contains(s[p]))return!1;return!0}return this.each((typeof t=="function"?S3:t?w3:b3)(s,t))}function T3(){this.textContent=""}function C3(e){return function(){this.textContent=e}}function M3(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function I3(e){return arguments.length?this.each(e==null?T3:(typeof e=="function"?M3:C3)(e)):this.node().textContent}function E3(){this.innerHTML=""}function P3(e){return function(){this.innerHTML=e}}function A3(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function z3(e){return arguments.length?this.each(e==null?E3:(typeof e=="function"?A3:P3)(e)):this.node().innerHTML}function D3(){this.nextSibling&&this.parentNode.appendChild(this)}function L3(){return this.each(D3)}function R3(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function F3(){return this.each(R3)}function O3(e){var t=typeof e=="function"?e:ET(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function N3(){return null}function B3(e,t){var s=typeof e=="function"?e:ET(e),l=t==null?N3:typeof t=="function"?t:ix(t);return this.select(function(){return this.insertBefore(s.apply(this,arguments),l.apply(this,arguments)||null)})}function j3(){var e=this.parentNode;e&&e.removeChild(this)}function U3(){return this.each(j3)}function V3(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function $3(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function q3(e){return this.select(e?$3:V3)}function Z3(e){return arguments.length?this.property("__data__",e):this.node().__data__}function H3(e){return function(t){e.call(this,t,this.__data__)}}function G3(e){return e.trim().split(/^|\s+/).map(function(t){var s="",l=t.indexOf(".");return l>=0&&(s=t.slice(l+1),t=t.slice(0,l)),{type:t,name:s}})}function W3(e){return function(){var t=this.__on;if(t){for(var s=0,l=-1,p=t.length,v;s<p;++s)v=t[s],(!e.type||v.type===e.type)&&v.name===e.name?this.removeEventListener(v.type,v.listener,v.options):t[++l]=v;++l?t.length=l:delete this.__on}}}function X3(e,t,s){return function(){var l=this.__on,p,v=H3(t);if(l){for(var y=0,c=l.length;y<c;++y)if((p=l[y]).type===e.type&&p.name===e.name){this.removeEventListener(p.type,p.listener,p.options),this.addEventListener(p.type,p.listener=v,p.options=s),p.value=t;return}}this.addEventListener(e.type,v,s),p={type:e.type,name:e.name,value:t,listener:v,options:s},l?l.push(p):this.__on=[p]}}function K3(e,t,s){var l=G3(e+""),p,v=l.length,y;if(arguments.length<2){var c=this.node().__on;if(c){for(var M=0,I=c.length,j;M<I;++M)for(p=0,j=c[M];p<v;++p)if((y=l[p]).type===j.type&&y.name===j.name)return j.value}return}for(c=t?X3:W3,p=0;p<v;++p)this.each(c(l[p],t,s));return this}function BT(e,t,s){var l=LT(e),p=l.CustomEvent;typeof p=="function"?p=new p(t,s):(p=l.document.createEvent("Event"),s?(p.initEvent(t,s.bubbles,s.cancelable),p.detail=s.detail):p.initEvent(t,!1,!1)),e.dispatchEvent(p)}function Y3(e,t){return function(){return BT(this,e,t)}}function Q3(e,t){return function(){return BT(this,e,t.apply(this,arguments))}}function J3(e,t){return this.each((typeof t=="function"?Q3:Y3)(e,t))}function*e4(){for(var e=this._groups,t=0,s=e.length;t<s;++t)for(var l=e[t],p=0,v=l.length,y;p<v;++p)(y=l[p])&&(yield y)}var jT=[null];function Bi(e,t){this._groups=e,this._parents=t}function Sf(){return new Bi([[document.documentElement]],jT)}function t4(){return this}Bi.prototype=Sf.prototype={constructor:Bi,select:ML,selectAll:AL,selectChild:RL,selectChildren:BL,filter:jL,data:HL,enter:UL,exit:WL,join:XL,merge:KL,selection:t4,order:YL,sort:QL,call:e3,nodes:t3,node:r3,size:n3,empty:i3,each:s3,attr:d3,style:g3,property:x3,classed:k3,text:I3,html:z3,raise:L3,lower:F3,append:O3,insert:B3,remove:U3,clone:q3,datum:Z3,on:K3,dispatch:J3,[Symbol.iterator]:e4};function r4(e){return typeof e=="string"?new Bi([[document.querySelector(e)]],[document.documentElement]):new Bi([[e]],jT)}function ax(e,t,s){e.prototype=t.prototype=s,s.constructor=e}function UT(e,t){var s=Object.create(e.prototype);for(var l in t)s[l]=t[l];return s}function kf(){}var af=.7,$m=1/af,bc="\\s*([+-]?\\d+)\\s*",of="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Hs="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",n4=/^#([0-9a-f]{3,8})$/,i4=new RegExp(`^rgb\\(${bc},${bc},${bc}\\)$`),s4=new RegExp(`^rgb\\(${Hs},${Hs},${Hs}\\)$`),a4=new RegExp(`^rgba\\(${bc},${bc},${bc},${of}\\)$`),o4=new RegExp(`^rgba\\(${Hs},${Hs},${Hs},${of}\\)$`),l4=new RegExp(`^hsl\\(${of},${Hs},${Hs}\\)$`),u4=new RegExp(`^hsla\\(${of},${Hs},${Hs},${of}\\)$`),$b={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ax(kf,Kl,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:qb,formatHex:qb,formatHex8:c4,formatHsl:h4,formatRgb:Zb,toString:Zb});function qb(){return this.rgb().formatHex()}function c4(){return this.rgb().formatHex8()}function h4(){return VT(this).formatHsl()}function Zb(){return this.rgb().formatRgb()}function Kl(e){var t,s;return e=(e+"").trim().toLowerCase(),(t=n4.exec(e))?(s=t[1].length,t=parseInt(t[1],16),s===6?Hb(t):s===3?new yi(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):s===8?Wp(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):s===4?Wp(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=i4.exec(e))?new yi(t[1],t[2],t[3],1):(t=s4.exec(e))?new yi(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=a4.exec(e))?Wp(t[1],t[2],t[3],t[4]):(t=o4.exec(e))?Wp(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=l4.exec(e))?Xb(t[1],t[2]/100,t[3]/100,1):(t=u4.exec(e))?Xb(t[1],t[2]/100,t[3]/100,t[4]):$b.hasOwnProperty(e)?Hb($b[e]):e==="transparent"?new yi(NaN,NaN,NaN,0):null}function Hb(e){return new yi(e>>16&255,e>>8&255,e&255,1)}function Wp(e,t,s,l){return l<=0&&(e=t=s=NaN),new yi(e,t,s,l)}function d4(e){return e instanceof kf||(e=Kl(e)),e?(e=e.rgb(),new yi(e.r,e.g,e.b,e.opacity)):new yi}function U0(e,t,s,l){return arguments.length===1?d4(e):new yi(e,t,s,l??1)}function yi(e,t,s,l){this.r=+e,this.g=+t,this.b=+s,this.opacity=+l}ax(yi,U0,UT(kf,{brighter(e){return e=e==null?$m:Math.pow($m,e),new yi(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?af:Math.pow(af,e),new yi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new yi($l(this.r),$l(this.g),$l(this.b),qm(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Gb,formatHex:Gb,formatHex8:f4,formatRgb:Wb,toString:Wb}));function Gb(){return`#${Pl(this.r)}${Pl(this.g)}${Pl(this.b)}`}function f4(){return`#${Pl(this.r)}${Pl(this.g)}${Pl(this.b)}${Pl((isNaN(this.opacity)?1:this.opacity)*255)}`}function Wb(){const e=qm(this.opacity);return`${e===1?"rgb(":"rgba("}${$l(this.r)}, ${$l(this.g)}, ${$l(this.b)}${e===1?")":`, ${e})`}`}function qm(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function $l(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Pl(e){return e=$l(e),(e<16?"0":"")+e.toString(16)}function Xb(e,t,s,l){return l<=0?e=t=s=NaN:s<=0||s>=1?e=t=NaN:t<=0&&(e=NaN),new ws(e,t,s,l)}function VT(e){if(e instanceof ws)return new ws(e.h,e.s,e.l,e.opacity);if(e instanceof kf||(e=Kl(e)),!e)return new ws;if(e instanceof ws)return e;e=e.rgb();var t=e.r/255,s=e.g/255,l=e.b/255,p=Math.min(t,s,l),v=Math.max(t,s,l),y=NaN,c=v-p,M=(v+p)/2;return c?(t===v?y=(s-l)/c+(s<l)*6:s===v?y=(l-t)/c+2:y=(t-s)/c+4,c/=M<.5?v+p:2-v-p,y*=60):c=M>0&&M<1?0:y,new ws(y,c,M,e.opacity)}function p4(e,t,s,l){return arguments.length===1?VT(e):new ws(e,t,s,l??1)}function ws(e,t,s,l){this.h=+e,this.s=+t,this.l=+s,this.opacity=+l}ax(ws,p4,UT(kf,{brighter(e){return e=e==null?$m:Math.pow($m,e),new ws(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?af:Math.pow(af,e),new ws(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,s=this.l,l=s+(s<.5?s:1-s)*t,p=2*s-l;return new yi(p_(e>=240?e-240:e+120,p,l),p_(e,p,l),p_(e<120?e+240:e-120,p,l),this.opacity)},clamp(){return new ws(Kb(this.h),Xp(this.s),Xp(this.l),qm(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=qm(this.opacity);return`${e===1?"hsl(":"hsla("}${Kb(this.h)}, ${Xp(this.s)*100}%, ${Xp(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Kb(e){return e=(e||0)%360,e<0?e+360:e}function Xp(e){return Math.max(0,Math.min(1,e||0))}function p_(e,t,s){return(e<60?t+(s-t)*e/60:e<180?s:e<240?t+(s-t)*(240-e)/60:t)*255}const ox=e=>()=>e;function m4(e,t){return function(s){return e+s*t}}function g4(e,t,s){return e=Math.pow(e,s),t=Math.pow(t,s)-e,s=1/s,function(l){return Math.pow(e+l*t,s)}}function y4(e){return(e=+e)==1?$T:function(t,s){return s-t?g4(t,s,e):ox(isNaN(t)?s:t)}}function $T(e,t){var s=t-e;return s?m4(e,s):ox(isNaN(e)?t:e)}const Zm=function e(t){var s=y4(t);function l(p,v){var y=s((p=U0(p)).r,(v=U0(v)).r),c=s(p.g,v.g),M=s(p.b,v.b),I=$T(p.opacity,v.opacity);return function(j){return p.r=y(j),p.g=c(j),p.b=M(j),p.opacity=I(j),p+""}}return l.gamma=e,l}(1);function _4(e,t){t||(t=[]);var s=e?Math.min(t.length,e.length):0,l=t.slice(),p;return function(v){for(p=0;p<s;++p)l[p]=e[p]*(1-v)+t[p]*v;return l}}function v4(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function x4(e,t){var s=t?t.length:0,l=e?Math.min(s,e.length):0,p=new Array(l),v=new Array(s),y;for(y=0;y<l;++y)p[y]=lx(e[y],t[y]);for(;y<s;++y)v[y]=t[y];return function(c){for(y=0;y<l;++y)v[y]=p[y](c);return v}}function w4(e,t){var s=new Date;return e=+e,t=+t,function(l){return s.setTime(e*(1-l)+t*l),s}}function xs(e,t){return e=+e,t=+t,function(s){return e*(1-s)+t*s}}function b4(e,t){var s={},l={},p;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(p in t)p in e?s[p]=lx(e[p],t[p]):l[p]=t[p];return function(v){for(p in s)l[p]=s[p](v);return l}}var V0=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,m_=new RegExp(V0.source,"g");function S4(e){return function(){return e}}function k4(e){return function(t){return e(t)+""}}function qT(e,t){var s=V0.lastIndex=m_.lastIndex=0,l,p,v,y=-1,c=[],M=[];for(e=e+"",t=t+"";(l=V0.exec(e))&&(p=m_.exec(t));)(v=p.index)>s&&(v=t.slice(s,v),c[y]?c[y]+=v:c[++y]=v),(l=l[0])===(p=p[0])?c[y]?c[y]+=p:c[++y]=p:(c[++y]=null,M.push({i:y,x:xs(l,p)})),s=m_.lastIndex;return s<t.length&&(v=t.slice(s),c[y]?c[y]+=v:c[++y]=v),c.length<2?M[0]?k4(M[0].x):S4(t):(t=M.length,function(I){for(var j=0,z;j<t;++j)c[(z=M[j]).i]=z.x(I);return c.join("")})}function lx(e,t){var s=typeof t,l;return t==null||s==="boolean"?ox(t):(s==="number"?xs:s==="string"?(l=Kl(t))?(t=l,Zm):qT:t instanceof Kl?Zm:t instanceof Date?w4:v4(t)?_4:Array.isArray(t)?x4:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?b4:xs)(e,t)}function T4(e,t){return e=+e,t=+t,function(s){return Math.round(e*(1-s)+t*s)}}var Yb=180/Math.PI,$0={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ZT(e,t,s,l,p,v){var y,c,M;return(y=Math.sqrt(e*e+t*t))&&(e/=y,t/=y),(M=e*s+t*l)&&(s-=e*M,l-=t*M),(c=Math.sqrt(s*s+l*l))&&(s/=c,l/=c,M/=c),e*l<t*s&&(e=-e,t=-t,M=-M,y=-y),{translateX:p,translateY:v,rotate:Math.atan2(t,e)*Yb,skewX:Math.atan(M)*Yb,scaleX:y,scaleY:c}}var Kp;function C4(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?$0:ZT(t.a,t.b,t.c,t.d,t.e,t.f)}function M4(e){return e==null||(Kp||(Kp=document.createElementNS("http://www.w3.org/2000/svg","g")),Kp.setAttribute("transform",e),!(e=Kp.transform.baseVal.consolidate()))?$0:(e=e.matrix,ZT(e.a,e.b,e.c,e.d,e.e,e.f))}function HT(e,t,s,l){function p(I){return I.length?I.pop()+" ":""}function v(I,j,z,R,X,me){if(I!==z||j!==R){var he=X.push("translate(",null,t,null,s);me.push({i:he-4,x:xs(I,z)},{i:he-2,x:xs(j,R)})}else(z||R)&&X.push("translate("+z+t+R+s)}function y(I,j,z,R){I!==j?(I-j>180?j+=360:j-I>180&&(I+=360),R.push({i:z.push(p(z)+"rotate(",null,l)-2,x:xs(I,j)})):j&&z.push(p(z)+"rotate("+j+l)}function c(I,j,z,R){I!==j?R.push({i:z.push(p(z)+"skewX(",null,l)-2,x:xs(I,j)}):j&&z.push(p(z)+"skewX("+j+l)}function M(I,j,z,R,X,me){if(I!==z||j!==R){var he=X.push(p(X)+"scale(",null,",",null,")");me.push({i:he-4,x:xs(I,z)},{i:he-2,x:xs(j,R)})}else(z!==1||R!==1)&&X.push(p(X)+"scale("+z+","+R+")")}return function(I,j){var z=[],R=[];return I=e(I),j=e(j),v(I.translateX,I.translateY,j.translateX,j.translateY,z,R),y(I.rotate,j.rotate,z,R),c(I.skewX,j.skewX,z,R),M(I.scaleX,I.scaleY,j.scaleX,j.scaleY,z,R),I=j=null,function(X){for(var me=-1,he=R.length,ge;++me<he;)z[(ge=R[me]).i]=ge.x(X);return z.join("")}}}var I4=HT(C4,"px, ","px)","deg)"),E4=HT(M4,", ",")",")"),$c=0,kd=0,pd=0,GT=1e3,Hm,Td,Gm=0,Yl=0,bg=0,lf=typeof performance=="object"&&performance.now?performance:Date,WT=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ux(){return Yl||(WT(P4),Yl=lf.now()+bg)}function P4(){Yl=0}function Wm(){this._call=this._time=this._next=null}Wm.prototype=XT.prototype={constructor:Wm,restart:function(e,t,s){if(typeof e!="function")throw new TypeError("callback is not a function");s=(s==null?ux():+s)+(t==null?0:+t),!this._next&&Td!==this&&(Td?Td._next=this:Hm=this,Td=this),this._call=e,this._time=s,q0()},stop:function(){this._call&&(this._call=null,this._time=1/0,q0())}};function XT(e,t,s){var l=new Wm;return l.restart(e,t,s),l}function A4(){ux(),++$c;for(var e=Hm,t;e;)(t=Yl-e._time)>=0&&e._call.call(void 0,t),e=e._next;--$c}function Qb(){Yl=(Gm=lf.now())+bg,$c=kd=0;try{A4()}finally{$c=0,D4(),Yl=0}}function z4(){var e=lf.now(),t=e-Gm;t>GT&&(bg-=t,Gm=e)}function D4(){for(var e,t=Hm,s,l=1/0;t;)t._call?(l>t._time&&(l=t._time),e=t,t=t._next):(s=t._next,t._next=null,t=e?e._next=s:Hm=s);Td=e,q0(l)}function q0(e){if(!$c){kd&&(kd=clearTimeout(kd));var t=e-Yl;t>24?(e<1/0&&(kd=setTimeout(Qb,e-lf.now()-bg)),pd&&(pd=clearInterval(pd))):(pd||(Gm=lf.now(),pd=setInterval(z4,GT)),$c=1,WT(Qb))}}function Jb(e,t,s){var l=new Wm;return t=t==null?0:+t,l.restart(p=>{l.stop(),e(p+t)},t,s),l}var L4=IT("start","end","cancel","interrupt"),R4=[],KT=0,e2=1,Z0=2,fm=3,t2=4,H0=5,pm=6;function Sg(e,t,s,l,p,v){var y=e.__transition;if(!y)e.__transition={};else if(s in y)return;F4(e,s,{name:t,index:l,group:p,on:L4,tween:R4,time:v.time,delay:v.delay,duration:v.duration,ease:v.ease,timer:null,state:KT})}function cx(e,t){var s=Ts(e,t);if(s.state>KT)throw new Error("too late; already scheduled");return s}function Gs(e,t){var s=Ts(e,t);if(s.state>fm)throw new Error("too late; already running");return s}function Ts(e,t){var s=e.__transition;if(!s||!(s=s[t]))throw new Error("transition not found");return s}function F4(e,t,s){var l=e.__transition,p;l[t]=s,s.timer=XT(v,0,s.time);function v(I){s.state=e2,s.timer.restart(y,s.delay,s.time),s.delay<=I&&y(I-s.delay)}function y(I){var j,z,R,X;if(s.state!==e2)return M();for(j in l)if(X=l[j],X.name===s.name){if(X.state===fm)return Jb(y);X.state===t2?(X.state=pm,X.timer.stop(),X.on.call("interrupt",e,e.__data__,X.index,X.group),delete l[j]):+j<t&&(X.state=pm,X.timer.stop(),X.on.call("cancel",e,e.__data__,X.index,X.group),delete l[j])}if(Jb(function(){s.state===fm&&(s.state=t2,s.timer.restart(c,s.delay,s.time),c(I))}),s.state=Z0,s.on.call("start",e,e.__data__,s.index,s.group),s.state===Z0){for(s.state=fm,p=new Array(R=s.tween.length),j=0,z=-1;j<R;++j)(X=s.tween[j].value.call(e,e.__data__,s.index,s.group))&&(p[++z]=X);p.length=z+1}}function c(I){for(var j=I<s.duration?s.ease.call(null,I/s.duration):(s.timer.restart(M),s.state=H0,1),z=-1,R=p.length;++z<R;)p[z].call(e,j);s.state===H0&&(s.on.call("end",e,e.__data__,s.index,s.group),M())}function M(){s.state=pm,s.timer.stop(),delete l[t];for(var I in l)return;delete e.__transition}}function O4(e,t){var s=e.__transition,l,p,v=!0,y;if(s){t=t==null?null:t+"";for(y in s){if((l=s[y]).name!==t){v=!1;continue}p=l.state>Z0&&l.state<H0,l.state=pm,l.timer.stop(),l.on.call(p?"interrupt":"cancel",e,e.__data__,l.index,l.group),delete s[y]}v&&delete e.__transition}}function N4(e){return this.each(function(){O4(this,e)})}function B4(e,t){var s,l;return function(){var p=Gs(this,e),v=p.tween;if(v!==s){l=s=v;for(var y=0,c=l.length;y<c;++y)if(l[y].name===t){l=l.slice(),l.splice(y,1);break}}p.tween=l}}function j4(e,t,s){var l,p;if(typeof s!="function")throw new Error;return function(){var v=Gs(this,e),y=v.tween;if(y!==l){p=(l=y).slice();for(var c={name:t,value:s},M=0,I=p.length;M<I;++M)if(p[M].name===t){p[M]=c;break}M===I&&p.push(c)}v.tween=p}}function U4(e,t){var s=this._id;if(e+="",arguments.length<2){for(var l=Ts(this.node(),s).tween,p=0,v=l.length,y;p<v;++p)if((y=l[p]).name===e)return y.value;return null}return this.each((t==null?B4:j4)(s,e,t))}function hx(e,t,s){var l=e._id;return e.each(function(){var p=Gs(this,l);(p.value||(p.value={}))[t]=s.apply(this,arguments)}),function(p){return Ts(p,l).value[t]}}function YT(e,t){var s;return(typeof t=="number"?xs:t instanceof Kl?Zm:(s=Kl(t))?(t=s,Zm):qT)(e,t)}function V4(e){return function(){this.removeAttribute(e)}}function $4(e){return function(){this.removeAttributeNS(e.space,e.local)}}function q4(e,t,s){var l,p=s+"",v;return function(){var y=this.getAttribute(e);return y===p?null:y===l?v:v=t(l=y,s)}}function Z4(e,t,s){var l,p=s+"",v;return function(){var y=this.getAttributeNS(e.space,e.local);return y===p?null:y===l?v:v=t(l=y,s)}}function H4(e,t,s){var l,p,v;return function(){var y,c=s(this),M;return c==null?void this.removeAttribute(e):(y=this.getAttribute(e),M=c+"",y===M?null:y===l&&M===p?v:(p=M,v=t(l=y,c)))}}function G4(e,t,s){var l,p,v;return function(){var y,c=s(this),M;return c==null?void this.removeAttributeNS(e.space,e.local):(y=this.getAttributeNS(e.space,e.local),M=c+"",y===M?null:y===l&&M===p?v:(p=M,v=t(l=y,c)))}}function W4(e,t){var s=wg(e),l=s==="transform"?E4:YT;return this.attrTween(e,typeof t=="function"?(s.local?G4:H4)(s,l,hx(this,"attr."+e,t)):t==null?(s.local?$4:V4)(s):(s.local?Z4:q4)(s,l,t))}function X4(e,t){return function(s){this.setAttribute(e,t.call(this,s))}}function K4(e,t){return function(s){this.setAttributeNS(e.space,e.local,t.call(this,s))}}function Y4(e,t){var s,l;function p(){var v=t.apply(this,arguments);return v!==l&&(s=(l=v)&&K4(e,v)),s}return p._value=t,p}function Q4(e,t){var s,l;function p(){var v=t.apply(this,arguments);return v!==l&&(s=(l=v)&&X4(e,v)),s}return p._value=t,p}function J4(e,t){var s="attr."+e;if(arguments.length<2)return(s=this.tween(s))&&s._value;if(t==null)return this.tween(s,null);if(typeof t!="function")throw new Error;var l=wg(e);return this.tween(s,(l.local?Y4:Q4)(l,t))}function eR(e,t){return function(){cx(this,e).delay=+t.apply(this,arguments)}}function tR(e,t){return t=+t,function(){cx(this,e).delay=t}}function rR(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?eR:tR)(t,e)):Ts(this.node(),t).delay}function nR(e,t){return function(){Gs(this,e).duration=+t.apply(this,arguments)}}function iR(e,t){return t=+t,function(){Gs(this,e).duration=t}}function sR(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?nR:iR)(t,e)):Ts(this.node(),t).duration}function aR(e,t){if(typeof t!="function")throw new Error;return function(){Gs(this,e).ease=t}}function oR(e){var t=this._id;return arguments.length?this.each(aR(t,e)):Ts(this.node(),t).ease}function lR(e,t){return function(){var s=t.apply(this,arguments);if(typeof s!="function")throw new Error;Gs(this,e).ease=s}}function uR(e){if(typeof e!="function")throw new Error;return this.each(lR(this._id,e))}function cR(e){typeof e!="function"&&(e=AT(e));for(var t=this._groups,s=t.length,l=new Array(s),p=0;p<s;++p)for(var v=t[p],y=v.length,c=l[p]=[],M,I=0;I<y;++I)(M=v[I])&&e.call(M,M.__data__,I,v)&&c.push(M);return new Ca(l,this._parents,this._name,this._id)}function hR(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,s=e._groups,l=t.length,p=s.length,v=Math.min(l,p),y=new Array(l),c=0;c<v;++c)for(var M=t[c],I=s[c],j=M.length,z=y[c]=new Array(j),R,X=0;X<j;++X)(R=M[X]||I[X])&&(z[X]=R);for(;c<l;++c)y[c]=t[c];return new Ca(y,this._parents,this._name,this._id)}function dR(e){return(e+"").trim().split(/^|\s+/).every(function(t){var s=t.indexOf(".");return s>=0&&(t=t.slice(0,s)),!t||t==="start"})}function fR(e,t,s){var l,p,v=dR(t)?cx:Gs;return function(){var y=v(this,e),c=y.on;c!==l&&(p=(l=c).copy()).on(t,s),y.on=p}}function pR(e,t){var s=this._id;return arguments.length<2?Ts(this.node(),s).on.on(e):this.each(fR(s,e,t))}function mR(e){return function(){var t=this.parentNode;for(var s in this.__transition)if(+s!==e)return;t&&t.removeChild(this)}}function gR(){return this.on("end.remove",mR(this._id))}function yR(e){var t=this._name,s=this._id;typeof e!="function"&&(e=ix(e));for(var l=this._groups,p=l.length,v=new Array(p),y=0;y<p;++y)for(var c=l[y],M=c.length,I=v[y]=new Array(M),j,z,R=0;R<M;++R)(j=c[R])&&(z=e.call(j,j.__data__,R,c))&&("__data__"in j&&(z.__data__=j.__data__),I[R]=z,Sg(I[R],t,s,R,I,Ts(j,s)));return new Ca(v,this._parents,t,s)}function _R(e){var t=this._name,s=this._id;typeof e!="function"&&(e=PT(e));for(var l=this._groups,p=l.length,v=[],y=[],c=0;c<p;++c)for(var M=l[c],I=M.length,j,z=0;z<I;++z)if(j=M[z]){for(var R=e.call(j,j.__data__,z,M),X,me=Ts(j,s),he=0,ge=R.length;he<ge;++he)(X=R[he])&&Sg(X,t,s,he,R,me);v.push(R),y.push(j)}return new Ca(v,y,t,s)}var vR=Sf.prototype.constructor;function xR(){return new vR(this._groups,this._parents)}function wR(e,t){var s,l,p;return function(){var v=Vc(this,e),y=(this.style.removeProperty(e),Vc(this,e));return v===y?null:v===s&&y===l?p:p=t(s=v,l=y)}}function QT(e){return function(){this.style.removeProperty(e)}}function bR(e,t,s){var l,p=s+"",v;return function(){var y=Vc(this,e);return y===p?null:y===l?v:v=t(l=y,s)}}function SR(e,t,s){var l,p,v;return function(){var y=Vc(this,e),c=s(this),M=c+"";return c==null&&(M=c=(this.style.removeProperty(e),Vc(this,e))),y===M?null:y===l&&M===p?v:(p=M,v=t(l=y,c))}}function kR(e,t){var s,l,p,v="style."+t,y="end."+v,c;return function(){var M=Gs(this,e),I=M.on,j=M.value[v]==null?c||(c=QT(t)):void 0;(I!==s||p!==j)&&(l=(s=I).copy()).on(y,p=j),M.on=l}}function TR(e,t,s){var l=(e+="")=="transform"?I4:YT;return t==null?this.styleTween(e,wR(e,l)).on("end.style."+e,QT(e)):typeof t=="function"?this.styleTween(e,SR(e,l,hx(this,"style."+e,t))).each(kR(this._id,e)):this.styleTween(e,bR(e,l,t),s).on("end.style."+e,null)}function CR(e,t,s){return function(l){this.style.setProperty(e,t.call(this,l),s)}}function MR(e,t,s){var l,p;function v(){var y=t.apply(this,arguments);return y!==p&&(l=(p=y)&&CR(e,y,s)),l}return v._value=t,v}function IR(e,t,s){var l="style."+(e+="");if(arguments.length<2)return(l=this.tween(l))&&l._value;if(t==null)return this.tween(l,null);if(typeof t!="function")throw new Error;return this.tween(l,MR(e,t,s??""))}function ER(e){return function(){this.textContent=e}}function PR(e){return function(){var t=e(this);this.textContent=t??""}}function AR(e){return this.tween("text",typeof e=="function"?PR(hx(this,"text",e)):ER(e==null?"":e+""))}function zR(e){return function(t){this.textContent=e.call(this,t)}}function DR(e){var t,s;function l(){var p=e.apply(this,arguments);return p!==s&&(t=(s=p)&&zR(p)),t}return l._value=e,l}function LR(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,DR(e))}function RR(){for(var e=this._name,t=this._id,s=JT(),l=this._groups,p=l.length,v=0;v<p;++v)for(var y=l[v],c=y.length,M,I=0;I<c;++I)if(M=y[I]){var j=Ts(M,t);Sg(M,e,s,I,y,{time:j.time+j.delay+j.duration,delay:0,duration:j.duration,ease:j.ease})}return new Ca(l,this._parents,e,s)}function FR(){var e,t,s=this,l=s._id,p=s.size();return new Promise(function(v,y){var c={value:y},M={value:function(){--p===0&&v()}};s.each(function(){var I=Gs(this,l),j=I.on;j!==e&&(t=(e=j).copy(),t._.cancel.push(c),t._.interrupt.push(c),t._.end.push(M)),I.on=t}),p===0&&v()})}var OR=0;function Ca(e,t,s,l){this._groups=e,this._parents=t,this._name=s,this._id=l}function JT(){return++OR}var ha=Sf.prototype;Ca.prototype={constructor:Ca,select:yR,selectAll:_R,selectChild:ha.selectChild,selectChildren:ha.selectChildren,filter:cR,merge:hR,selection:xR,transition:RR,call:ha.call,nodes:ha.nodes,node:ha.node,size:ha.size,empty:ha.empty,each:ha.each,on:pR,attr:W4,attrTween:J4,style:TR,styleTween:IR,text:AR,textTween:LR,remove:gR,tween:U4,delay:rR,duration:sR,ease:oR,easeVarying:uR,end:FR,[Symbol.iterator]:ha[Symbol.iterator]};function NR(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var BR={time:null,delay:0,duration:250,ease:NR};function jR(e,t){for(var s;!(s=e.__transition)||!(s=s[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return s}function UR(e){var t,s;e instanceof Ca?(t=e._id,e=e._name):(t=JT(),(s=BR).time=ux(),e=e==null?null:e+"");for(var l=this._groups,p=l.length,v=0;v<p;++v)for(var y=l[v],c=y.length,M,I=0;I<c;++I)(M=y[I])&&Sg(M,e,t,I,y,s||jR(M,t));return new Ca(l,this._parents,e,t)}Sf.prototype.interrupt=N4;Sf.prototype.transition=UR;const G0=Math.PI,W0=2*G0,kl=1e-6,VR=W0-kl;function eC(e){this._+=e[0];for(let t=1,s=e.length;t<s;++t)this._+=arguments[t]+e[t]}function $R(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return eC;const s=10**t;return function(l){this._+=l[0];for(let p=1,v=l.length;p<v;++p)this._+=Math.round(arguments[p]*s)/s+l[p]}}class qR{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?eC:$R(t)}moveTo(t,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+s}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,s){this._append`L${this._x1=+t},${this._y1=+s}`}quadraticCurveTo(t,s,l,p){this._append`Q${+t},${+s},${this._x1=+l},${this._y1=+p}`}bezierCurveTo(t,s,l,p,v,y){this._append`C${+t},${+s},${+l},${+p},${this._x1=+v},${this._y1=+y}`}arcTo(t,s,l,p,v){if(t=+t,s=+s,l=+l,p=+p,v=+v,v<0)throw new Error(`negative radius: ${v}`);let y=this._x1,c=this._y1,M=l-t,I=p-s,j=y-t,z=c-s,R=j*j+z*z;if(this._x1===null)this._append`M${this._x1=t},${this._y1=s}`;else if(R>kl)if(!(Math.abs(z*M-I*j)>kl)||!v)this._append`L${this._x1=t},${this._y1=s}`;else{let X=l-y,me=p-c,he=M*M+I*I,ge=X*X+me*me,W=Math.sqrt(he),Q=Math.sqrt(R),te=v*Math.tan((G0-Math.acos((he+R-ge)/(2*W*Q)))/2),oe=te/Q,Me=te/W;Math.abs(oe-1)>kl&&this._append`L${t+oe*j},${s+oe*z}`,this._append`A${v},${v},0,0,${+(z*X>j*me)},${this._x1=t+Me*M},${this._y1=s+Me*I}`}}arc(t,s,l,p,v,y){if(t=+t,s=+s,l=+l,y=!!y,l<0)throw new Error(`negative radius: ${l}`);let c=l*Math.cos(p),M=l*Math.sin(p),I=t+c,j=s+M,z=1^y,R=y?p-v:v-p;this._x1===null?this._append`M${I},${j}`:(Math.abs(this._x1-I)>kl||Math.abs(this._y1-j)>kl)&&this._append`L${I},${j}`,l&&(R<0&&(R=R%W0+W0),R>VR?this._append`A${l},${l},0,1,${z},${t-c},${s-M}A${l},${l},0,1,${z},${this._x1=I},${this._y1=j}`:R>kl&&this._append`A${l},${l},0,${+(R>=G0)},${z},${this._x1=t+l*Math.cos(v)},${this._y1=s+l*Math.sin(v)}`)}rect(t,s,l,p){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+s}h${l=+l}v${+p}h${-l}Z`}toString(){return this._}}function ZR(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Xm(e,t){if(!isFinite(e)||e===0)return null;var s=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),l=e.slice(0,s);return[l.length>1?l[0]+l.slice(2):l,+e.slice(s+1)]}function qc(e){return e=Xm(Math.abs(e)),e?e[1]:NaN}function HR(e,t){return function(s,l){for(var p=s.length,v=[],y=0,c=e[0],M=0;p>0&&c>0&&(M+c+1>l&&(c=Math.max(1,l-M)),v.push(s.substring(p-=c,p+c)),!((M+=c+1)>l));)c=e[y=(y+1)%e.length];return v.reverse().join(t)}}function GR(e){return function(t){return t.replace(/[0-9]/g,function(s){return e[+s]})}}var WR=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Km(e){if(!(t=WR.exec(e)))throw new Error("invalid format: "+e);var t;return new dx({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Km.prototype=dx.prototype;function dx(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}dx.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function XR(e){e:for(var t=e.length,s=1,l=-1,p;s<t;++s)switch(e[s]){case".":l=p=s;break;case"0":l===0&&(l=s),p=s;break;default:if(!+e[s])break e;l>0&&(l=0);break}return l>0?e.slice(0,l)+e.slice(p+1):e}var Ym;function KR(e,t){var s=Xm(e,t);if(!s)return Ym=void 0,e.toPrecision(t);var l=s[0],p=s[1],v=p-(Ym=Math.max(-8,Math.min(8,Math.floor(p/3)))*3)+1,y=l.length;return v===y?l:v>y?l+new Array(v-y+1).join("0"):v>0?l.slice(0,v)+"."+l.slice(v):"0."+new Array(1-v).join("0")+Xm(e,Math.max(0,t+v-1))[0]}function r2(e,t){var s=Xm(e,t);if(!s)return e+"";var l=s[0],p=s[1];return p<0?"0."+new Array(-p).join("0")+l:l.length>p+1?l.slice(0,p+1)+"."+l.slice(p+1):l+new Array(p-l.length+2).join("0")}const n2={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:ZR,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>r2(e*100,t),r:r2,s:KR,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function i2(e){return e}var s2=Array.prototype.map,a2=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function YR(e){var t=e.grouping===void 0||e.thousands===void 0?i2:HR(s2.call(e.grouping,Number),e.thousands+""),s=e.currency===void 0?"":e.currency[0]+"",l=e.currency===void 0?"":e.currency[1]+"",p=e.decimal===void 0?".":e.decimal+"",v=e.numerals===void 0?i2:GR(s2.call(e.numerals,String)),y=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"":e.minus+"",M=e.nan===void 0?"NaN":e.nan+"";function I(z,R){z=Km(z);var X=z.fill,me=z.align,he=z.sign,ge=z.symbol,W=z.zero,Q=z.width,te=z.comma,oe=z.precision,Me=z.trim,Se=z.type;Se==="n"?(te=!0,Se="g"):n2[Se]||(oe===void 0&&(oe=12),Me=!0,Se="g"),(W||X==="0"&&me==="=")&&(W=!0,X="0",me="=");var ze=(R&&R.prefix!==void 0?R.prefix:"")+(ge==="$"?s:ge==="#"&&/[boxX]/.test(Se)?"0"+Se.toLowerCase():""),Fe=(ge==="$"?l:/[%p]/.test(Se)?y:"")+(R&&R.suffix!==void 0?R.suffix:""),ct=n2[Se],it=/[defgprs%]/.test(Se);oe=oe===void 0?6:/[gprs]/.test(Se)?Math.max(1,Math.min(21,oe)):Math.max(0,Math.min(20,oe));function ht(dt){var Pt=ze,Dt=Fe,pr,yn,Mr;if(Se==="c")Dt=ct(dt)+Dt,dt="";else{dt=+dt;var Ke=dt<0||1/dt<0;if(dt=isNaN(dt)?M:ct(Math.abs(dt),oe),Me&&(dt=XR(dt)),Ke&&+dt==0&&he!=="+"&&(Ke=!1),Pt=(Ke?he==="("?he:c:he==="-"||he==="("?"":he)+Pt,Dt=(Se==="s"&&!isNaN(dt)&&Ym!==void 0?a2[8+Ym/3]:"")+Dt+(Ke&&he==="("?")":""),it){for(pr=-1,yn=dt.length;++pr<yn;)if(Mr=dt.charCodeAt(pr),48>Mr||Mr>57){Dt=(Mr===46?p+dt.slice(pr+1):dt.slice(pr))+Dt,dt=dt.slice(0,pr);break}}}te&&!W&&(dt=t(dt,1/0));var yt=Pt.length+dt.length+Dt.length,ft=yt<Q?new Array(Q-yt+1).join(X):"";switch(te&&W&&(dt=t(ft+dt,ft.length?Q-Dt.length:1/0),ft=""),me){case"<":dt=Pt+dt+Dt+ft;break;case"=":dt=Pt+ft+dt+Dt;break;case"^":dt=ft.slice(0,yt=ft.length>>1)+Pt+dt+Dt+ft.slice(yt);break;default:dt=ft+Pt+dt+Dt;break}return v(dt)}return ht.toString=function(){return z+""},ht}function j(z,R){var X=Math.max(-8,Math.min(8,Math.floor(qc(R)/3)))*3,me=Math.pow(10,-X),he=I((z=Km(z),z.type="f",z),{suffix:a2[8+X/3]});return function(ge){return he(me*ge)}}return{format:I,formatPrefix:j}}var Yp,tC,rC;QR({thousands:",",grouping:[3],currency:["$",""]});function QR(e){return Yp=YR(e),tC=Yp.format,rC=Yp.formatPrefix,Yp}function JR(e){return Math.max(0,-qc(Math.abs(e)))}function e5(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(qc(t)/3)))*3-qc(Math.abs(e)))}function t5(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,qc(t)-qc(e))+1}function nC(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function r5(e){return function(){return e}}function n5(e){return+e}var o2=[0,1];function pc(e){return e}function X0(e,t){return(t-=e=+e)?function(s){return(s-e)/t}:r5(isNaN(t)?NaN:.5)}function i5(e,t){var s;return e>t&&(s=e,e=t,t=s),function(l){return Math.max(e,Math.min(t,l))}}function s5(e,t,s){var l=e[0],p=e[1],v=t[0],y=t[1];return p<l?(l=X0(p,l),v=s(y,v)):(l=X0(l,p),v=s(v,y)),function(c){return v(l(c))}}function a5(e,t,s){var l=Math.min(e.length,t.length)-1,p=new Array(l),v=new Array(l),y=-1;for(e[l]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++y<l;)p[y]=X0(e[y],e[y+1]),v[y]=s(t[y],t[y+1]);return function(c){var M=oL(e,c,1,l)-1;return v[M](p[M](c))}}function iC(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function o5(){var e=o2,t=o2,s=lx,l,p,v,y=pc,c,M,I;function j(){var R=Math.min(e.length,t.length);return y!==pc&&(y=i5(e[0],e[R-1])),c=R>2?a5:s5,M=I=null,z}function z(R){return R==null||isNaN(R=+R)?v:(M||(M=c(e.map(l),t,s)))(l(y(R)))}return z.invert=function(R){return y(p((I||(I=c(t,e.map(l),xs)))(R)))},z.domain=function(R){return arguments.length?(e=Array.from(R,n5),j()):e.slice()},z.range=function(R){return arguments.length?(t=Array.from(R),j()):t.slice()},z.rangeRound=function(R){return t=Array.from(R),s=T4,j()},z.clamp=function(R){return arguments.length?(y=R?!0:pc,j()):y!==pc},z.interpolate=function(R){return arguments.length?(s=R,j()):s},z.unknown=function(R){return arguments.length?(v=R,z):v},function(R,X){return l=R,p=X,j()}}function sC(){return o5()(pc,pc)}function l5(e,t,s,l){var p=B0(e,t,s),v;switch(l=Km(l??",f"),l.type){case"s":{var y=Math.max(Math.abs(e),Math.abs(t));return l.precision==null&&!isNaN(v=e5(p,y))&&(l.precision=v),rC(l,y)}case"":case"e":case"g":case"p":case"r":{l.precision==null&&!isNaN(v=t5(p,Math.max(Math.abs(e),Math.abs(t))))&&(l.precision=v-(l.type==="e"));break}case"f":case"%":{l.precision==null&&!isNaN(v=JR(p))&&(l.precision=v-(l.type==="%")*2);break}}return tC(l)}function u5(e){var t=e.domain;return e.ticks=function(s){var l=t();return dL(l[0],l[l.length-1],s??10)},e.tickFormat=function(s,l){var p=t();return l5(p[0],p[p.length-1],s??10,l)},e.nice=function(s){s==null&&(s=10);var l=t(),p=0,v=l.length-1,y=l[p],c=l[v],M,I,j=10;for(c<y&&(I=y,y=c,c=I,I=p,p=v,v=I);j-- >0;){if(I=N0(y,c,s),I===M)return l[p]=y,l[v]=c,t(l);if(I>0)y=Math.floor(y/I)*I,c=Math.ceil(c/I)*I;else if(I<0)y=Math.ceil(y*I)/I,c=Math.floor(c*I)/I;else break;M=I}return e},e}function aC(){var e=sC();return e.copy=function(){return iC(e,aC())},nC.apply(e,arguments),u5(e)}function c5(e,t){e=e.slice();var s=0,l=e.length-1,p=e[s],v=e[l],y;return v<p&&(y=s,s=l,l=y,y=p,p=v,v=y),e[s]=t.floor(p),e[l]=t.ceil(v),e}const g_=new Date,y_=new Date;function en(e,t,s,l){function p(v){return e(v=arguments.length===0?new Date:new Date(+v)),v}return p.floor=v=>(e(v=new Date(+v)),v),p.ceil=v=>(e(v=new Date(v-1)),t(v,1),e(v),v),p.round=v=>{const y=p(v),c=p.ceil(v);return v-y<c-v?y:c},p.offset=(v,y)=>(t(v=new Date(+v),y==null?1:Math.floor(y)),v),p.range=(v,y,c)=>{const M=[];if(v=p.ceil(v),c=c==null?1:Math.floor(c),!(v<y)||!(c>0))return M;let I;do M.push(I=new Date(+v)),t(v,c),e(v);while(I<v&&v<y);return M},p.filter=v=>en(y=>{if(y>=y)for(;e(y),!v(y);)y.setTime(y-1)},(y,c)=>{if(y>=y)if(c<0)for(;++c<=0;)for(;t(y,-1),!v(y););else for(;--c>=0;)for(;t(y,1),!v(y););}),s&&(p.count=(v,y)=>(g_.setTime(+v),y_.setTime(+y),e(g_),e(y_),Math.floor(s(g_,y_))),p.every=v=>(v=Math.floor(v),!isFinite(v)||!(v>0)?null:v>1?p.filter(l?y=>l(y)%v===0:y=>p.count(0,y)%v===0):p)),p}const Qm=en(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Qm.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?en(t=>{t.setTime(Math.floor(t/e)*e)},(t,s)=>{t.setTime(+t+s*e)},(t,s)=>(s-t)/e):Qm);Qm.range;const va=1e3,ns=va*60,xa=ns*60,Ma=xa*24,fx=Ma*7,l2=Ma*30,__=Ma*365,mc=en(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*va)},(e,t)=>(t-e)/va,e=>e.getUTCSeconds());mc.range;const px=en(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*va)},(e,t)=>{e.setTime(+e+t*ns)},(e,t)=>(t-e)/ns,e=>e.getMinutes());px.range;const h5=en(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*ns)},(e,t)=>(t-e)/ns,e=>e.getUTCMinutes());h5.range;const mx=en(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*va-e.getMinutes()*ns)},(e,t)=>{e.setTime(+e+t*xa)},(e,t)=>(t-e)/xa,e=>e.getHours());mx.range;const d5=en(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*xa)},(e,t)=>(t-e)/xa,e=>e.getUTCHours());d5.range;const Tf=en(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ns)/Ma,e=>e.getDate()-1);Tf.range;const gx=en(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ma,e=>e.getUTCDate()-1);gx.range;const f5=en(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ma,e=>Math.floor(e/Ma));f5.range;function nu(e){return en(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,s)=>{t.setDate(t.getDate()+s*7)},(t,s)=>(s-t-(s.getTimezoneOffset()-t.getTimezoneOffset())*ns)/fx)}const kg=nu(0),Jm=nu(1),p5=nu(2),m5=nu(3),Zc=nu(4),g5=nu(5),y5=nu(6);kg.range;Jm.range;p5.range;m5.range;Zc.range;g5.range;y5.range;function iu(e){return en(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,s)=>{t.setUTCDate(t.getUTCDate()+s*7)},(t,s)=>(s-t)/fx)}const oC=iu(0),eg=iu(1),_5=iu(2),v5=iu(3),Hc=iu(4),x5=iu(5),w5=iu(6);oC.range;eg.range;_5.range;v5.range;Hc.range;x5.range;w5.range;const yx=en(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());yx.range;const b5=en(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());b5.range;const Ia=en(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Ia.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:en(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,s)=>{t.setFullYear(t.getFullYear()+s*e)});Ia.range;const Ql=en(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Ql.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:en(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,s)=>{t.setUTCFullYear(t.getUTCFullYear()+s*e)});Ql.range;function S5(e,t,s,l,p,v){const y=[[mc,1,va],[mc,5,5*va],[mc,15,15*va],[mc,30,30*va],[v,1,ns],[v,5,5*ns],[v,15,15*ns],[v,30,30*ns],[p,1,xa],[p,3,3*xa],[p,6,6*xa],[p,12,12*xa],[l,1,Ma],[l,2,2*Ma],[s,1,fx],[t,1,l2],[t,3,3*l2],[e,1,__]];function c(I,j,z){const R=j<I;R&&([I,j]=[j,I]);const X=z&&typeof z.range=="function"?z:M(I,j,z),me=X?X.range(I,+j+1):[];return R?me.reverse():me}function M(I,j,z){const R=Math.abs(j-I)/z,X=nx(([,,ge])=>ge).right(y,R);if(X===y.length)return e.every(B0(I/__,j/__,z));if(X===0)return Qm.every(Math.max(B0(I,j,z),1));const[me,he]=y[R/y[X-1][2]<y[X][2]/R?X-1:X];return me.every(he)}return[c,M]}const[k5,T5]=S5(Ia,yx,kg,Tf,mx,px);function v_(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function x_(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function md(e,t,s){return{y:e,m:t,d:s,H:0,M:0,S:0,L:0}}function C5(e){var t=e.dateTime,s=e.date,l=e.time,p=e.periods,v=e.days,y=e.shortDays,c=e.months,M=e.shortMonths,I=gd(p),j=yd(p),z=gd(v),R=yd(v),X=gd(y),me=yd(y),he=gd(c),ge=yd(c),W=gd(M),Q=yd(M),te={a:Mr,A:Ke,b:yt,B:ft,c:null,d:p2,e:p2,f:X5,g:sF,G:oF,H:H5,I:G5,j:W5,L:lC,m:K5,M:Y5,p:Lt,q:Wt,Q:y2,s:_2,S:Q5,u:J5,U:eF,V:tF,w:rF,W:nF,x:null,X:null,y:iF,Y:aF,Z:lF,"%":g2},oe={a:$n,A:Vr,b:tn,B:rn,c:null,d:m2,e:m2,f:dF,g:bF,G:kF,H:uF,I:cF,j:hF,L:cC,m:fF,M:pF,p:Dr,q:qn,Q:y2,s:_2,S:mF,u:gF,U:yF,V:_F,w:vF,W:xF,x:null,X:null,y:wF,Y:SF,Z:TF,"%":g2},Me={a:it,A:ht,b:dt,B:Pt,c:Dt,d:d2,e:d2,f:V5,g:h2,G:c2,H:f2,I:f2,j:N5,L:U5,m:O5,M:B5,p:ct,q:F5,Q:q5,s:Z5,S:j5,u:A5,U:z5,V:D5,w:P5,W:L5,x:pr,X:yn,y:h2,Y:c2,Z:R5,"%":$5};te.x=Se(s,te),te.X=Se(l,te),te.c=Se(t,te),oe.x=Se(s,oe),oe.X=Se(l,oe),oe.c=Se(t,oe);function Se(et,Tt){return function(Rt){var Le=[],yr=-1,Nt=0,Lr=et.length,be,_n,Cs;for(Rt instanceof Date||(Rt=new Date(+Rt));++yr<Lr;)et.charCodeAt(yr)===37&&(Le.push(et.slice(Nt,yr)),(_n=u2[be=et.charAt(++yr)])!=null?be=et.charAt(++yr):_n=be==="e"?" ":"0",(Cs=Tt[be])&&(be=Cs(Rt,_n)),Le.push(be),Nt=yr+1);return Le.push(et.slice(Nt,yr)),Le.join("")}}function ze(et,Tt){return function(Rt){var Le=md(1900,void 0,1),yr=Fe(Le,et,Rt+="",0),Nt,Lr;if(yr!=Rt.length)return null;if("Q"in Le)return new Date(Le.Q);if("s"in Le)return new Date(Le.s*1e3+("L"in Le?Le.L:0));if(Tt&&!("Z"in Le)&&(Le.Z=0),"p"in Le&&(Le.H=Le.H%12+Le.p*12),Le.m===void 0&&(Le.m="q"in Le?Le.q:0),"V"in Le){if(Le.V<1||Le.V>53)return null;"w"in Le||(Le.w=1),"Z"in Le?(Nt=x_(md(Le.y,0,1)),Lr=Nt.getUTCDay(),Nt=Lr>4||Lr===0?eg.ceil(Nt):eg(Nt),Nt=gx.offset(Nt,(Le.V-1)*7),Le.y=Nt.getUTCFullYear(),Le.m=Nt.getUTCMonth(),Le.d=Nt.getUTCDate()+(Le.w+6)%7):(Nt=v_(md(Le.y,0,1)),Lr=Nt.getDay(),Nt=Lr>4||Lr===0?Jm.ceil(Nt):Jm(Nt),Nt=Tf.offset(Nt,(Le.V-1)*7),Le.y=Nt.getFullYear(),Le.m=Nt.getMonth(),Le.d=Nt.getDate()+(Le.w+6)%7)}else("W"in Le||"U"in Le)&&("w"in Le||(Le.w="u"in Le?Le.u%7:"W"in Le?1:0),Lr="Z"in Le?x_(md(Le.y,0,1)).getUTCDay():v_(md(Le.y,0,1)).getDay(),Le.m=0,Le.d="W"in Le?(Le.w+6)%7+Le.W*7-(Lr+5)%7:Le.w+Le.U*7-(Lr+6)%7);return"Z"in Le?(Le.H+=Le.Z/100|0,Le.M+=Le.Z%100,x_(Le)):v_(Le)}}function Fe(et,Tt,Rt,Le){for(var yr=0,Nt=Tt.length,Lr=Rt.length,be,_n;yr<Nt;){if(Le>=Lr)return-1;if(be=Tt.charCodeAt(yr++),be===37){if(be=Tt.charAt(yr++),_n=Me[be in u2?Tt.charAt(yr++):be],!_n||(Le=_n(et,Rt,Le))<0)return-1}else if(be!=Rt.charCodeAt(Le++))return-1}return Le}function ct(et,Tt,Rt){var Le=I.exec(Tt.slice(Rt));return Le?(et.p=j.get(Le[0].toLowerCase()),Rt+Le[0].length):-1}function it(et,Tt,Rt){var Le=X.exec(Tt.slice(Rt));return Le?(et.w=me.get(Le[0].toLowerCase()),Rt+Le[0].length):-1}function ht(et,Tt,Rt){var Le=z.exec(Tt.slice(Rt));return Le?(et.w=R.get(Le[0].toLowerCase()),Rt+Le[0].length):-1}function dt(et,Tt,Rt){var Le=W.exec(Tt.slice(Rt));return Le?(et.m=Q.get(Le[0].toLowerCase()),Rt+Le[0].length):-1}function Pt(et,Tt,Rt){var Le=he.exec(Tt.slice(Rt));return Le?(et.m=ge.get(Le[0].toLowerCase()),Rt+Le[0].length):-1}function Dt(et,Tt,Rt){return Fe(et,t,Tt,Rt)}function pr(et,Tt,Rt){return Fe(et,s,Tt,Rt)}function yn(et,Tt,Rt){return Fe(et,l,Tt,Rt)}function Mr(et){return y[et.getDay()]}function Ke(et){return v[et.getDay()]}function yt(et){return M[et.getMonth()]}function ft(et){return c[et.getMonth()]}function Lt(et){return p[+(et.getHours()>=12)]}function Wt(et){return 1+~~(et.getMonth()/3)}function $n(et){return y[et.getUTCDay()]}function Vr(et){return v[et.getUTCDay()]}function tn(et){return M[et.getUTCMonth()]}function rn(et){return c[et.getUTCMonth()]}function Dr(et){return p[+(et.getUTCHours()>=12)]}function qn(et){return 1+~~(et.getUTCMonth()/3)}return{format:function(et){var Tt=Se(et+="",te);return Tt.toString=function(){return et},Tt},parse:function(et){var Tt=ze(et+="",!1);return Tt.toString=function(){return et},Tt},utcFormat:function(et){var Tt=Se(et+="",oe);return Tt.toString=function(){return et},Tt},utcParse:function(et){var Tt=ze(et+="",!0);return Tt.toString=function(){return et},Tt}}}var u2={"-":"",_:" ",0:"0"},gn=/^\s*\d+/,M5=/^%/,I5=/[\\^$*+?|[\]().{}]/g;function er(e,t,s){var l=e<0?"-":"",p=(l?-e:e)+"",v=p.length;return l+(v<s?new Array(s-v+1).join(t)+p:p)}function E5(e){return e.replace(I5,"\\$&")}function gd(e){return new RegExp("^(?:"+e.map(E5).join("|")+")","i")}function yd(e){return new Map(e.map((t,s)=>[t.toLowerCase(),s]))}function P5(e,t,s){var l=gn.exec(t.slice(s,s+1));return l?(e.w=+l[0],s+l[0].length):-1}function A5(e,t,s){var l=gn.exec(t.slice(s,s+1));return l?(e.u=+l[0],s+l[0].length):-1}function z5(e,t,s){var l=gn.exec(t.slice(s,s+2));return l?(e.U=+l[0],s+l[0].length):-1}function D5(e,t,s){var l=gn.exec(t.slice(s,s+2));return l?(e.V=+l[0],s+l[0].length):-1}function L5(e,t,s){var l=gn.exec(t.slice(s,s+2));return l?(e.W=+l[0],s+l[0].length):-1}function c2(e,t,s){var l=gn.exec(t.slice(s,s+4));return l?(e.y=+l[0],s+l[0].length):-1}function h2(e,t,s){var l=gn.exec(t.slice(s,s+2));return l?(e.y=+l[0]+(+l[0]>68?1900:2e3),s+l[0].length):-1}function R5(e,t,s){var l=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(s,s+6));return l?(e.Z=l[1]?0:-(l[2]+(l[3]||"00")),s+l[0].length):-1}function F5(e,t,s){var l=gn.exec(t.slice(s,s+1));return l?(e.q=l[0]*3-3,s+l[0].length):-1}function O5(e,t,s){var l=gn.exec(t.slice(s,s+2));return l?(e.m=l[0]-1,s+l[0].length):-1}function d2(e,t,s){var l=gn.exec(t.slice(s,s+2));return l?(e.d=+l[0],s+l[0].length):-1}function N5(e,t,s){var l=gn.exec(t.slice(s,s+3));return l?(e.m=0,e.d=+l[0],s+l[0].length):-1}function f2(e,t,s){var l=gn.exec(t.slice(s,s+2));return l?(e.H=+l[0],s+l[0].length):-1}function B5(e,t,s){var l=gn.exec(t.slice(s,s+2));return l?(e.M=+l[0],s+l[0].length):-1}function j5(e,t,s){var l=gn.exec(t.slice(s,s+2));return l?(e.S=+l[0],s+l[0].length):-1}function U5(e,t,s){var l=gn.exec(t.slice(s,s+3));return l?(e.L=+l[0],s+l[0].length):-1}function V5(e,t,s){var l=gn.exec(t.slice(s,s+6));return l?(e.L=Math.floor(l[0]/1e3),s+l[0].length):-1}function $5(e,t,s){var l=M5.exec(t.slice(s,s+1));return l?s+l[0].length:-1}function q5(e,t,s){var l=gn.exec(t.slice(s));return l?(e.Q=+l[0],s+l[0].length):-1}function Z5(e,t,s){var l=gn.exec(t.slice(s));return l?(e.s=+l[0],s+l[0].length):-1}function p2(e,t){return er(e.getDate(),t,2)}function H5(e,t){return er(e.getHours(),t,2)}function G5(e,t){return er(e.getHours()%12||12,t,2)}function W5(e,t){return er(1+Tf.count(Ia(e),e),t,3)}function lC(e,t){return er(e.getMilliseconds(),t,3)}function X5(e,t){return lC(e,t)+"000"}function K5(e,t){return er(e.getMonth()+1,t,2)}function Y5(e,t){return er(e.getMinutes(),t,2)}function Q5(e,t){return er(e.getSeconds(),t,2)}function J5(e){var t=e.getDay();return t===0?7:t}function eF(e,t){return er(kg.count(Ia(e)-1,e),t,2)}function uC(e){var t=e.getDay();return t>=4||t===0?Zc(e):Zc.ceil(e)}function tF(e,t){return e=uC(e),er(Zc.count(Ia(e),e)+(Ia(e).getDay()===4),t,2)}function rF(e){return e.getDay()}function nF(e,t){return er(Jm.count(Ia(e)-1,e),t,2)}function iF(e,t){return er(e.getFullYear()%100,t,2)}function sF(e,t){return e=uC(e),er(e.getFullYear()%100,t,2)}function aF(e,t){return er(e.getFullYear()%1e4,t,4)}function oF(e,t){var s=e.getDay();return e=s>=4||s===0?Zc(e):Zc.ceil(e),er(e.getFullYear()%1e4,t,4)}function lF(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+er(t/60|0,"0",2)+er(t%60,"0",2)}function m2(e,t){return er(e.getUTCDate(),t,2)}function uF(e,t){return er(e.getUTCHours(),t,2)}function cF(e,t){return er(e.getUTCHours()%12||12,t,2)}function hF(e,t){return er(1+gx.count(Ql(e),e),t,3)}function cC(e,t){return er(e.getUTCMilliseconds(),t,3)}function dF(e,t){return cC(e,t)+"000"}function fF(e,t){return er(e.getUTCMonth()+1,t,2)}function pF(e,t){return er(e.getUTCMinutes(),t,2)}function mF(e,t){return er(e.getUTCSeconds(),t,2)}function gF(e){var t=e.getUTCDay();return t===0?7:t}function yF(e,t){return er(oC.count(Ql(e)-1,e),t,2)}function hC(e){var t=e.getUTCDay();return t>=4||t===0?Hc(e):Hc.ceil(e)}function _F(e,t){return e=hC(e),er(Hc.count(Ql(e),e)+(Ql(e).getUTCDay()===4),t,2)}function vF(e){return e.getUTCDay()}function xF(e,t){return er(eg.count(Ql(e)-1,e),t,2)}function wF(e,t){return er(e.getUTCFullYear()%100,t,2)}function bF(e,t){return e=hC(e),er(e.getUTCFullYear()%100,t,2)}function SF(e,t){return er(e.getUTCFullYear()%1e4,t,4)}function kF(e,t){var s=e.getUTCDay();return e=s>=4||s===0?Hc(e):Hc.ceil(e),er(e.getUTCFullYear()%1e4,t,4)}function TF(){return"+0000"}function g2(){return"%"}function y2(e){return+e}function _2(e){return Math.floor(+e/1e3)}var tc,dC;CF({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function CF(e){return tc=C5(e),dC=tc.format,tc.parse,tc.utcFormat,tc.utcParse,tc}function MF(e){return new Date(e)}function IF(e){return e instanceof Date?+e:+new Date(+e)}function fC(e,t,s,l,p,v,y,c,M,I){var j=sC(),z=j.invert,R=j.domain,X=I(".%L"),me=I(":%S"),he=I("%I:%M"),ge=I("%I %p"),W=I("%a %d"),Q=I("%b %d"),te=I("%B"),oe=I("%Y");function Me(Se){return(M(Se)<Se?X:c(Se)<Se?me:y(Se)<Se?he:v(Se)<Se?ge:l(Se)<Se?p(Se)<Se?W:Q:s(Se)<Se?te:oe)(Se)}return j.invert=function(Se){return new Date(z(Se))},j.domain=function(Se){return arguments.length?R(Array.from(Se,IF)):R().map(MF)},j.ticks=function(Se){var ze=R();return e(ze[0],ze[ze.length-1],Se??10)},j.tickFormat=function(Se,ze){return ze==null?Me:I(ze)},j.nice=function(Se){var ze=R();return(!Se||typeof Se.range!="function")&&(Se=t(ze[0],ze[ze.length-1],Se??10)),Se?R(c5(ze,Se)):j},j.copy=function(){return iC(j,fC(e,t,s,l,p,v,y,c,M,I))},j}function EF(){return nC.apply(fC(k5,T5,Ia,yx,kg,Tf,mx,px,mc,dC).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function fn(e){return function(){return e}}function pC(e){let t=3;return e.digits=function(s){if(!arguments.length)return t;if(s==null)t=null;else{const l=Math.floor(s);if(!(l>=0))throw new RangeError(`invalid digits: ${s}`);t=l}return e},()=>new qR(t)}function mC(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function gC(e){this._context=e}gC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function yC(e){return new gC(e)}function _C(e){return e[0]}function vC(e){return e[1]}function xC(e,t){var s=fn(!0),l=null,p=yC,v=null,y=pC(c);e=typeof e=="function"?e:e===void 0?_C:fn(e),t=typeof t=="function"?t:t===void 0?vC:fn(t);function c(M){var I,j=(M=mC(M)).length,z,R=!1,X;for(l==null&&(v=p(X=y())),I=0;I<=j;++I)!(I<j&&s(z=M[I],I,M))===R&&((R=!R)?v.lineStart():v.lineEnd()),R&&v.point(+e(z,I,M),+t(z,I,M));if(X)return v=null,X+""||null}return c.x=function(M){return arguments.length?(e=typeof M=="function"?M:fn(+M),c):e},c.y=function(M){return arguments.length?(t=typeof M=="function"?M:fn(+M),c):t},c.defined=function(M){return arguments.length?(s=typeof M=="function"?M:fn(!!M),c):s},c.curve=function(M){return arguments.length?(p=M,l!=null&&(v=p(l)),c):p},c.context=function(M){return arguments.length?(M==null?l=v=null:v=p(l=M),c):l},c}function PF(e,t,s){var l=null,p=fn(!0),v=null,y=yC,c=null,M=pC(I);e=typeof e=="function"?e:e===void 0?_C:fn(+e),t=typeof t=="function"?t:fn(t===void 0?0:+t),s=typeof s=="function"?s:s===void 0?vC:fn(+s);function I(z){var R,X,me,he=(z=mC(z)).length,ge,W=!1,Q,te=new Array(he),oe=new Array(he);for(v==null&&(c=y(Q=M())),R=0;R<=he;++R){if(!(R<he&&p(ge=z[R],R,z))===W)if(W=!W)X=R,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),me=R-1;me>=X;--me)c.point(te[me],oe[me]);c.lineEnd(),c.areaEnd()}W&&(te[R]=+e(ge,R,z),oe[R]=+t(ge,R,z),c.point(l?+l(ge,R,z):te[R],s?+s(ge,R,z):oe[R]))}if(Q)return c=null,Q+""||null}function j(){return xC().defined(p).curve(y).context(v)}return I.x=function(z){return arguments.length?(e=typeof z=="function"?z:fn(+z),l=null,I):e},I.x0=function(z){return arguments.length?(e=typeof z=="function"?z:fn(+z),I):e},I.x1=function(z){return arguments.length?(l=z==null?null:typeof z=="function"?z:fn(+z),I):l},I.y=function(z){return arguments.length?(t=typeof z=="function"?z:fn(+z),s=null,I):t},I.y0=function(z){return arguments.length?(t=typeof z=="function"?z:fn(+z),I):t},I.y1=function(z){return arguments.length?(s=z==null?null:typeof z=="function"?z:fn(+z),I):s},I.lineX0=I.lineY0=function(){return j().x(e).y(t)},I.lineY1=function(){return j().x(e).y(s)},I.lineX1=function(){return j().x(l).y(t)},I.defined=function(z){return arguments.length?(p=typeof z=="function"?z:fn(!!z),I):p},I.curve=function(z){return arguments.length?(y=z,v!=null&&(c=y(v)),I):y},I.context=function(z){return arguments.length?(z==null?v=c=null:c=y(v=z),I):v},I}function v2(e){return e<0?-1:1}function x2(e,t,s){var l=e._x1-e._x0,p=t-e._x1,v=(e._y1-e._y0)/(l||p<0&&-0),y=(s-e._y1)/(p||l<0&&-0),c=(v*p+y*l)/(l+p);return(v2(v)+v2(y))*Math.min(Math.abs(v),Math.abs(y),.5*Math.abs(c))||0}function w2(e,t){var s=e._x1-e._x0;return s?(3*(e._y1-e._y0)/s-t)/2:t}function w_(e,t,s){var l=e._x0,p=e._y0,v=e._x1,y=e._y1,c=(v-l)/3;e._context.bezierCurveTo(l+c,p+c*t,v-c,y-c*s,v,y)}function tg(e){this._context=e}tg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:w_(this,this._t0,w2(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var s=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,w_(this,w2(this,s=x2(this,e,t)),s);break;default:w_(this,this._t0,s=x2(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=s}}};Object.create(tg.prototype).point=function(e,t){tg.prototype.point.call(this,t,e)};function b2(e){return new tg(e)}function Cd(e,t,s){this.k=e,this.x=t,this.y=s}Cd.prototype={constructor:Cd,scale:function(e){return e===1?this:new Cd(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Cd(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Cd.prototype;function AF({hourly:e,minutely:t,summary:s}){const l=Pe.useRef(null),p=Yc(M=>M.reducedMotion),v=Pe.useMemo(()=>t&&t.length>0?t.map(M=>({time:M.time,intensity:M.intensity,probability:M.probability})):e.slice(0,12).map(M=>({time:M.time,intensity:M.precipitation,probability:M.precipitationProbability})),[e,t]),y=Math.max(...v.map(M=>M.intensity),.1),c=v.some(M=>M.intensity>0||M.probability>20);return Pe.useEffect(()=>{if(!l.current||v.length===0)return;const M=r4(l.current);M.selectAll("*").remove();const I={top:20,right:20,bottom:30,left:10},j=l.current.clientWidth-I.left-I.right,z=120-I.top-I.bottom,R=M.append("g").attr("transform",`translate(${I.left},${I.top})`),me=M.append("defs").append("linearGradient").attr("id","precipGradient").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");me.append("stop").attr("offset","0%").attr("stop-color","rgb(59, 130, 246)").attr("stop-opacity",.7),me.append("stop").attr("offset","100%").attr("stop-color","rgb(59, 130, 246)").attr("stop-opacity",.1);const he=EF().domain(lL(v,oe=>oe.time)).range([0,j]),ge=aC().domain([0,y]).range([z,0]),W=PF().x(oe=>he(oe.time)).y0(z).y1(oe=>ge(oe.intensity)).curve(b2),Q=xC().x(oe=>he(oe.time)).y(oe=>ge(oe.intensity)).curve(b2);R.append("path").datum(v).attr("class","area").attr("fill","url(#precipGradient)").attr("d",W),R.append("path").datum(v).attr("class","line").attr("fill","none").attr("stroke","rgb(59, 130, 246)").attr("stroke-width",2).attr("d",Q);const te=xL(he).ticks(6).tickFormat(oe=>{const Se=oe.getHours();return Se===0?"12AM":Se<12?`${Se}AM`:Se===12?"12PM":`${Se-12}PM`});if(R.append("g").attr("class","axis").attr("transform",`translate(0,${z})`).call(te).selectAll("text").attr("class","text-xs fill-slate-400"),c){const oe=[{value:y*.33,label:"Light"},{value:y*.66,label:"Medium"},{value:y,label:"Heavy"}];R.selectAll(".intensity-label").data(oe).enter().append("text").attr("class","text-xs fill-slate-400").attr("x",j-5).attr("y",Me=>ge(Me.value)+4).attr("text-anchor","end").attr("opacity",.5).text(Me=>Me.label)}!p&&c&&v.forEach(oe=>{if(oe.probability>50&&oe.intensity>0){const Me=oe.probability/100*3;R.append("circle").attr("cx",he(oe.time)).attr("cy",ge(oe.intensity)).attr("r",3).attr("fill","rgb(59, 130, 246)").style("--wobble-amount",`${Me}px`).attr("class","precip-uncertain")}})},[v,y,c,p]),G.jsxs(El,{className:"overflow-hidden",children:[G.jsxs("div",{className:"px-4 py-3 border-b border-slate-100 dark:border-slate-700",children:[G.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wider text-slate-500 dark:text-slate-400",children:"Precipitation"}),s&&G.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 mt-1",children:s})]}),G.jsx("div",{className:"p-4",children:c?G.jsx("svg",{ref:l,className:"w-full",style:{height:120},preserveAspectRatio:"xMidYMid meet"}):G.jsx("div",{className:"flex items-center justify-center h-20 text-slate-500 dark:text-slate-400",children:"No precipitation expected"})})]})}function zF({alerts:e}){const[t,s]=Pe.useState(null),[l,p]=Pe.useState(new Set);if(e.length===0)return null;const v=e.filter(M=>!l.has(M.id));if(v.length===0)return null;const y=M=>{p(I=>new Set([...I,M]))},c=M=>{s(I=>I===M?null:M)};return G.jsx("div",{className:"space-y-2 mb-4",children:v.map(M=>{const I=t===M.id,j=JD(M.severity);return G.jsx("div",{className:"rounded-xl overflow-hidden",style:{backgroundColor:`${j}15`,borderLeft:`4px solid ${j}`},children:G.jsxs("div",{className:"flex items-start gap-3 p-3",children:[G.jsx(rD,{size:20,style:{color:j},className:"shrink-0 mt-0.5"}),G.jsx("div",{className:"flex-1 min-w-0",children:G.jsxs("button",{onClick:()=>c(M.id),className:"w-full text-left",children:[G.jsxs("div",{className:"flex items-center gap-2",children:[G.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:j},children:M.severity}),G.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:M.event})]}),G.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100 mt-1",children:M.headline}),I&&G.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mt-2 whitespace-pre-line",children:M.description})]})}),G.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[G.jsx("button",{onClick:()=>c(M.id),className:"p-1 hover:bg-black/10 dark:hover:bg-white/10 rounded","aria-label":I?"Collapse alert":"Expand alert",children:I?G.jsx(Lz,{size:16,className:"text-slate-500"}):G.jsx(_T,{size:16,className:"text-slate-500"})}),G.jsx("button",{onClick:()=>y(M.id),className:"p-1 hover:bg-black/10 dark:hover:bg-white/10 rounded","aria-label":"Dismiss alert",children:G.jsx(bT,{size:16,className:"text-slate-500"})})]})]})},M.id)})})}function DF(){const e=mT(),t=Ri(z=>z.getActiveLocation()),s=sf(z=>z.isRefreshing),l=sf(z=>z.setRefreshing),{data:p,isLoading:v,error:y,refetch:c}=MD(),M=Pe.useCallback(async()=>{if(t){l(!0);try{await e.invalidateQueries({queryKey:vg.weather(t.coordinates.latitude,t.coordinates.longitude)}),await c()}finally{l(!1)}}},[t,e,c,l]);if(!t)return G.jsxs("div",{className:"min-h-screen flex flex-col",children:[G.jsx(Gp,{}),G.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:G.jsxs("div",{className:"text-center",children:[G.jsx("p",{className:"text-lg text-slate-600 dark:text-slate-400 mb-4",children:"No location selected"}),G.jsx("p",{className:"text-sm text-slate-500",children:"Tap the location button above to add a location"})]})})]});if(v&&!p)return G.jsxs("div",{className:"min-h-screen flex flex-col",children:[G.jsx(Gp,{}),G.jsxs("div",{className:"flex-1 p-4 space-y-4 pb-24",children:[G.jsx(Lb,{}),G.jsx(Lb,{})]})]});if(y)return G.jsxs("div",{className:"min-h-screen flex flex-col",children:[G.jsx(Gp,{onRefresh:M,isRefreshing:s}),G.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:G.jsxs("div",{className:"text-center",children:[G.jsx("p",{className:"text-lg text-red-500 mb-2",children:"Failed to load weather"}),G.jsx("p",{className:"text-sm text-slate-500 mb-4",children:y instanceof Error?y.message:"Unknown error"}),G.jsx("button",{onClick:M,className:"btn btn-primary btn-md",children:"Try Again"})]})})]});if(!p)return null;const I=wD(p.minutely),j=p.daily[0];return G.jsxs("div",{className:"min-h-screen flex flex-col bg-slate-50 dark:bg-slate-900",children:[G.jsx(Gp,{onRefresh:M,isRefreshing:s}),G.jsxs("main",{className:"flex-1 overflow-y-auto pb-24",children:[G.jsx(zF,{alerts:p.alerts}),G.jsx(XD,{conditions:p.current,location:p.location,today:j}),G.jsxs("div",{className:"px-4 space-y-4",children:[G.jsx(AF,{hourly:p.hourly,minutely:p.minutely,summary:I}),G.jsx(eL,{hourly:p.hourly}),G.jsx(tL,{daily:p.daily}),G.jsx(rL,{current:p.current,today:j}),G.jsxs("p",{className:"text-xs text-center text-slate-400 dark:text-slate-500 py-4",children:["Last updated: ",p.lastUpdated.toLocaleTimeString()]})]})]})]})}var wC={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.1/LICENSE.txt
 */(function(e,t){(function(s,l){e.exports=l()})(gI,function(){var s={},l={};function p(y,c,M){if(l[y]=M,y==="index"){var I="var sharedModule = {}; ("+l.shared+")(sharedModule); ("+l.worker+")(sharedModule);",j={};return l.shared(j),l.index(s,j),typeof window<"u"&&s.setWorkerUrl(window.URL.createObjectURL(new Blob([I],{type:"text/javascript"}))),s}}p("shared",["exports"],function(y){function c(i,n,a,u){return new(a||(a=Promise))(function(f,_){function x(C){try{S(u.next(C))}catch(E){_(E)}}function w(C){try{S(u.throw(C))}catch(E){_(E)}}function S(C){var E;C.done?f(C.value):(E=C.value,E instanceof a?E:new a(function(A){A(E)})).then(x,w)}S((u=u.apply(i,n||[])).next())})}function M(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}typeof SuppressedError=="function"&&SuppressedError;var I=j;function j(i,n){this.x=i,this.y=n}j.prototype={clone:function(){return new j(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,n){return this.clone()._rotateAround(i,n)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var n=i.x-this.x,a=i.y-this.y;return n*n+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,n){return Math.atan2(this.x*n-this.y*i,this.x*i+this.y*n)},_matMult:function(i){var n=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=n,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var n=Math.cos(i),a=Math.sin(i),u=a*this.x+n*this.y;return this.x=n*this.x-a*this.y,this.y=u,this},_rotateAround:function(i,n){var a=Math.cos(i),u=Math.sin(i),f=n.y+u*(this.x-n.x)+a*(this.y-n.y);return this.x=n.x+a*(this.x-n.x)-u*(this.y-n.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},j.convert=function(i){return i instanceof j?i:Array.isArray(i)?new j(i[0],i[1]):i};var z=M(I),R=X;function X(i,n,a,u){this.cx=3*i,this.bx=3*(a-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(u-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=n,this.p2x=a,this.p2y=u}X.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,n){if(n===void 0&&(n=1e-6),i<0)return 0;if(i>1)return 1;for(var a=i,u=0;u<8;u++){var f=this.sampleCurveX(a)-i;if(Math.abs(f)<n)return a;var _=this.sampleCurveDerivativeX(a);if(Math.abs(_)<1e-6)break;a-=f/_}var x=0,w=1;for(a=i,u=0;u<20&&(f=this.sampleCurveX(a),!(Math.abs(f-i)<n));u++)i>f?x=a:w=a,a=.5*(w-x)+x;return a},solve:function(i,n){return this.sampleCurveY(this.solveCurveX(i,n))}};var me=M(R);let he,ge;function W(){return he==null&&(he=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),he}function Q(){if(ge==null&&(ge=!1,W())){const n=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(n){for(let u=0;u<5*5;u++){const f=4*u;n.fillStyle=`rgb(${f},${f+1},${f+2})`,n.fillRect(u%5,Math.floor(u/5),1,1)}const a=n.getImageData(0,0,5,5).data;for(let u=0;u<5*5*4;u++)if(u%4!=3&&a[u]!==u){ge=!0;break}}}return ge||!1}function te(i,n,a,u){const f=new me(i,n,a,u);return _=>f.solve(_)}const oe=te(.25,.1,.25,1);function Me(i,n,a){return Math.min(a,Math.max(n,i))}function Se(i,n,a){const u=a-n,f=((i-n)%u+u)%u+n;return f===n?a:f}function ze(i,...n){for(const a of n)for(const u in a)i[u]=a[u];return i}let Fe=1;function ct(i,n,a){const u={};for(const f in i)u[f]=n.call(this,i[f],f,i);return u}function it(i,n,a){const u={};for(const f in i)n.call(this,i[f],f,i)&&(u[f]=i[f]);return u}function ht(i){return Array.isArray(i)?i.map(ht):typeof i=="object"&&i?ct(i,ht):i}const dt={};function Pt(i){dt[i]||(typeof console<"u"&&console.warn(i),dt[i]=!0)}function Dt(i,n,a){return(a.y-i.y)*(n.x-i.x)>(n.y-i.y)*(a.x-i.x)}function pr(i){return typeof WorkerGlobalScope<"u"&&i!==void 0&&i instanceof WorkerGlobalScope}let yn=null;function Mr(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const Ke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function yt(i,n,a,u,f){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const _=new VideoFrame(i,{timestamp:0});try{const x=_==null?void 0:_.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const w=x.startsWith("BGR"),S=new Uint8ClampedArray(u*f*4);if(yield _.copyTo(S,function(C,E,A,F,B){const V=4*Math.max(-E,0),$=(Math.max(0,A)-A)*F*4+V,Y=4*F,ne=Math.max(0,E),xe=Math.max(0,A);return{rect:{x:ne,y:xe,width:Math.min(C.width,E+F)-ne,height:Math.min(C.height,A+B)-xe},layout:[{offset:$,stride:Y}]}}(i,n,a,u,f)),w)for(let C=0;C<S.length;C+=4){const E=S[C];S[C]=S[C+2],S[C+2]=E}return S}finally{_.close()}})}let ft,Lt;const Wt="AbortError";function $n(){return new Error(Wt)}const Vr={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function tn(i){return Vr.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]}const rn="global-dispatcher";class Dr extends Error{constructor(n,a,u,f){super(`AJAXError: ${a} (${n}): ${u}`),this.status=n,this.statusText=a,this.url=u,this.body=f}}const qn=()=>pr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,et=function(i,n){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){const u=tn(i.url);if(u)return u(i,n);if(pr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,targetMapId:rn},n)}if(!(/^file:/.test(a=i.url)||/^file:/.test(qn())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(u,f){return c(this,void 0,void 0,function*(){const _=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,cache:u.cache,referrer:qn(),signal:f.signal});u.type!=="json"||_.headers.has("Accept")||_.headers.set("Accept","application/json");const x=yield fetch(_);if(!x.ok){const C=yield x.blob();throw new Dr(x.status,x.statusText,u.url,C)}let w;w=u.type==="arrayBuffer"||u.type==="image"?x.arrayBuffer():u.type==="json"?x.json():x.text();const S=yield w;if(f.signal.aborted)throw $n();return{data:S,cacheControl:x.headers.get("Cache-Control"),expires:x.headers.get("Expires")}})}(i,n);if(pr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,mustQueue:!0,targetMapId:rn},n)}var a;return function(u,f){return new Promise((_,x)=>{var w;const S=new XMLHttpRequest;S.open(u.method||"GET",u.url,!0),u.type!=="arrayBuffer"&&u.type!=="image"||(S.responseType="arraybuffer");for(const C in u.headers)S.setRequestHeader(C,u.headers[C]);u.type==="json"&&(S.responseType="text",!((w=u.headers)===null||w===void 0)&&w.Accept||S.setRequestHeader("Accept","application/json")),S.withCredentials=u.credentials==="include",S.onerror=()=>{x(new Error(S.statusText))},S.onload=()=>{if(!f.signal.aborted)if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){let C=S.response;if(u.type==="json")try{C=JSON.parse(S.response)}catch(E){return void x(E)}_({data:C,cacheControl:S.getResponseHeader("Cache-Control"),expires:S.getResponseHeader("Expires")})}else{const C=new Blob([S.response],{type:S.getResponseHeader("Content-Type")});x(new Dr(S.status,S.statusText,u.url,C))}},f.signal.addEventListener("abort",()=>{S.abort(),x($n())}),S.send(u.body)})}(i,n)};function Tt(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const n=new URL(i),a=window.location;return n.protocol===a.protocol&&n.host===a.host}function Rt(i,n,a){a[i]&&a[i].indexOf(n)!==-1||(a[i]=a[i]||[],a[i].push(n))}function Le(i,n,a){if(a&&a[i]){const u=a[i].indexOf(n);u!==-1&&a[i].splice(u,1)}}class yr{constructor(n,a={}){ze(this,a),this.type=n}}class Nt extends yr{constructor(n,a={}){super("error",ze({error:n},a))}}class Lr{on(n,a){return this._listeners=this._listeners||{},Rt(n,a,this._listeners),this}off(n,a){return Le(n,a,this._listeners),Le(n,a,this._oneTimeListeners),this}once(n,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Rt(n,a,this._oneTimeListeners),this):new Promise(u=>this.once(n,u))}fire(n,a){typeof n=="string"&&(n=new yr(n,a||{}));const u=n.type;if(this.listens(u)){n.target=this;const f=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const w of f)w.call(this,n);const _=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const w of _)Le(u,w,this._oneTimeListeners),w.call(this,n);const x=this._eventedParent;x&&(ze(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(n))}else n instanceof Nt&&console.error(n.error);return this}listens(n){return this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n)}setEventedParent(n,a){return this._eventedParent=n,this._eventedParentData=a,this}}var be={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const _n=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Cs(i,n){const a={};for(const u in i)u!=="ref"&&(a[u]=i[u]);return _n.forEach(u=>{u in n&&(a[u]=n[u])}),a}function qt(i,n){if(Array.isArray(i)){if(!Array.isArray(n)||i.length!==n.length)return!1;for(let a=0;a<i.length;a++)if(!qt(i[a],n[a]))return!1;return!0}if(typeof i=="object"&&i!==null&&n!==null){if(typeof n!="object"||Object.keys(i).length!==Object.keys(n).length)return!1;for(const a in i)if(!qt(i[a],n[a]))return!1;return!0}return i===n}function _r(i,n){i.push(n)}function qo(i,n,a){_r(a,{command:"addSource",args:[i,n[i]]})}function Ms(i,n,a){_r(n,{command:"removeSource",args:[i]}),a[i]=!0}function os(i,n,a,u){Ms(i,a,u),qo(i,n,a)}function Pa(i,n,a){let u;for(u in i[a])if(Object.prototype.hasOwnProperty.call(i[a],u)&&u!=="data"&&!qt(i[a][u],n[a][u]))return!1;for(u in n[a])if(Object.prototype.hasOwnProperty.call(n[a],u)&&u!=="data"&&!qt(i[a][u],n[a][u]))return!1;return!0}function ii(i,n,a,u,f,_){i=i||{},n=n||{};for(const x in i)Object.prototype.hasOwnProperty.call(i,x)&&(qt(i[x],n[x])||a.push({command:_,args:[u,x,n[x],f]}));for(const x in n)Object.prototype.hasOwnProperty.call(n,x)&&!Object.prototype.hasOwnProperty.call(i,x)&&(qt(i[x],n[x])||a.push({command:_,args:[u,x,n[x],f]}))}function Zo(i){return i.id}function Ho(i,n){return i[n.id]=n,i}class Oe{constructor(n,a,u,f){this.message=(n?`${n}: `:"")+u,f&&(this.identifier=f),a!=null&&a.__line__&&(this.line=a.__line__)}}function Vi(i,...n){for(const a of n)for(const u in a)i[u]=a[u];return i}class vn extends Error{constructor(n,a){super(a),this.message=a,this.key=n}}class $i{constructor(n,a=[]){this.parent=n,this.bindings={};for(const[u,f]of a)this.bindings[u]=f}concat(n){return new $i(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const Is={kind:"null"},Ve={kind:"number"},Mt={kind:"string"},_t={kind:"boolean"},En={kind:"color"},wi={kind:"object"},St={kind:"value"},qi={kind:"collator"},ls={kind:"formatted"},Es={kind:"padding"},Zi={kind:"resolvedImage"},re={kind:"variableAnchorOffsetCollection"};function N(i,n){return{kind:"array",itemType:i,N:n}}function O(i){if(i.kind==="array"){const n=O(i.itemType);return typeof i.N=="number"?`array<${n}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${n}>`}return i.kind}const q=[Is,Ve,Mt,_t,En,ls,wi,N(St),Es,Zi,re];function J(i,n){if(n.kind==="error")return null;if(i.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!J(i.itemType,n.itemType))&&(typeof i.N!="number"||i.N===n.N))return null}else{if(i.kind===n.kind)return null;if(i.kind==="value"){for(const a of q)if(!J(a,n))return null}}return`Expected ${O(i)} but found ${O(n)} instead.`}function ce(i,n){return n.some(a=>a.kind===i.kind)}function fe(i,n){return n.some(a=>a==="null"?i===null:a==="array"?Array.isArray(i):a==="object"?i&&!Array.isArray(i)&&typeof i=="object":a===typeof i)}function ve(i,n){return i.kind==="array"&&n.kind==="array"?i.itemType.kind===n.itemType.kind&&typeof i.N=="number":i.kind===n.kind}const ae=.96422,Ce=.82521,Ae=4/29,ke=6/29,Be=3*ke*ke,lt=ke*ke*ke,pt=Math.PI/180,Bt=180/Math.PI;function kt(i){return(i%=360)<0&&(i+=360),i}function jt([i,n,a,u]){let f,_;const x=Rr((.2225045*(i=At(i))+.7168786*(n=At(n))+.0606169*(a=At(a)))/1);i===n&&n===a?f=_=x:(f=Rr((.4360747*i+.3850649*n+.1430804*a)/ae),_=Rr((.0139322*i+.0971045*n+.7141733*a)/Ce));const w=116*x-16;return[w<0?0:w,500*(f-x),200*(x-_),u]}function At(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Rr(i){return i>lt?Math.pow(i,1/3):i/Be+Ae}function vr([i,n,a,u]){let f=(i+16)/116,_=isNaN(n)?f:f+n/500,x=isNaN(a)?f:f-a/200;return f=1*Qt(f),_=ae*Qt(_),x=Ce*Qt(x),[It(3.1338561*_-1.6168667*f-.4906146*x),It(-.9787684*_+1.9161415*f+.033454*x),It(.0719453*_-.2289914*f+1.4052427*x),u]}function It(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function Qt(i){return i>ke?i*i*i:Be*(i-Ae)}function mr(i){return parseInt(i.padEnd(2,i),16)/255}function $r(i,n){return Xr(n?i/100:i,0,1)}function Xr(i,n,a){return Math.min(Math.max(n,i),a)}function xn(i){return!i.some(Number.isNaN)}const Aa={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Jt{constructor(n,a,u,f=1,_=!0){this.r=n,this.g=a,this.b=u,this.a=f,_||(this.r*=f,this.g*=f,this.b*=f,f||this.overwriteGetter("rgb",[n,a,u,f]))}static parse(n){if(n instanceof Jt)return n;if(typeof n!="string")return;const a=function(u){if((u=u.toLowerCase().trim())==="transparent")return[0,0,0,0];const f=Aa[u];if(f){const[x,w,S]=f;return[x/255,w/255,S/255,1]}if(u.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(u)){const x=u.length<6?1:2;let w=1;return[mr(u.slice(w,w+=x)),mr(u.slice(w,w+=x)),mr(u.slice(w,w+=x)),mr(u.slice(w,w+x)||"ff")]}if(u.startsWith("rgb")){const x=u.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[w,S,C,E,A,F,B,V,$,Y,ne,xe]=x,ue=[E||" ",B||" ",Y].join("");if(ue==="  "||ue==="  /"||ue===",,"||ue===",,,"){const _e=[C,F,$].join(""),Te=_e==="%%%"?100:_e===""?255:0;if(Te){const De=[Xr(+S/Te,0,1),Xr(+A/Te,0,1),Xr(+V/Te,0,1),ne?$r(+ne,xe):1];if(xn(De))return De}}return}}const _=u.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[x,w,S,C,E,A,F,B,V]=_,$=[S||" ",E||" ",F].join("");if($==="  "||$==="  /"||$===",,"||$===",,,"){const Y=[+w,Xr(+C,0,100),Xr(+A,0,100),B?$r(+B,V):1];if(xn(Y))return function([ne,xe,ue,_e]){function Te(De){const We=(De+ne/30)%12,mt=xe*Math.min(ue,1-ue);return ue-mt*Math.max(-1,Math.min(We-3,9-We,1))}return ne=kt(ne),xe/=100,ue/=100,[Te(0),Te(8),Te(4),_e]}(Y)}}}(n);return a?new Jt(...a,!1):void 0}get rgb(){const{r:n,g:a,b:u,a:f}=this,_=f||1/0;return this.overwriteGetter("rgb",[n/_,a/_,u/_,f])}get hcl(){return this.overwriteGetter("hcl",function(n){const[a,u,f,_]=jt(n),x=Math.sqrt(u*u+f*f);return[Math.round(1e4*x)?kt(Math.atan2(f,u)*Bt):NaN,x,a,_]}(this.rgb))}get lab(){return this.overwriteGetter("lab",jt(this.rgb))}overwriteGetter(n,a){return Object.defineProperty(this,n,{value:a}),a}toString(){const[n,a,u,f]=this.rgb;return`rgba(${[n,a,u].map(_=>Math.round(255*_)).join(",")},${f})`}}Jt.black=new Jt(0,0,0,1),Jt.white=new Jt(1,1,1,1),Jt.transparent=new Jt(0,0,0,0),Jt.red=new Jt(1,0,0,1);class Qc{constructor(n,a,u){this.sensitivity=n?a?"variant":"case":a?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,a){return this.collator.compare(n,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Jc{constructor(n,a,u,f,_){this.text=n,this.image=a,this.scale=u,this.fontStack=f,this.textColor=_}}class Zn{constructor(n){this.sections=n}static fromString(n){return new Zn([new Jc(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.name.length!==0)}static factory(n){return n instanceof Zn?n:Zn.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}}class Hn{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof Hn)return n;if(typeof n=="number")return new Hn([n,n,n,n]);if(Array.isArray(n)&&!(n.length<1||n.length>4)){for(const a of n)if(typeof a!="number")return;switch(n.length){case 1:n=[n[0],n[0],n[0],n[0]];break;case 2:n=[n[0],n[1],n[0],n[1]];break;case 3:n=[n[0],n[1],n[2],n[1]]}return new Hn(n)}}toString(){return JSON.stringify(this.values)}}const Tg=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class si{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof si)return n;if(Array.isArray(n)&&!(n.length<1)&&n.length%2==0){for(let a=0;a<n.length;a+=2){const u=n[a],f=n[a+1];if(typeof u!="string"||!Tg.has(u)||!Array.isArray(f)||f.length!==2||typeof f[0]!="number"||typeof f[1]!="number")return}return new si(n)}}toString(){return JSON.stringify(this.values)}}class Gn{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new Gn({name:n,available:!1}):null}}function za(i,n,a,u){return typeof i=="number"&&i>=0&&i<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof a=="number"&&a>=0&&a<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[i,n,a,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[i,n,a,u]:[i,n,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ws(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Jt||i instanceof Qc||i instanceof Zn||i instanceof Hn||i instanceof si||i instanceof Gn)return!0;if(Array.isArray(i)){for(const n of i)if(!Ws(n))return!1;return!0}if(typeof i=="object"){for(const n in i)if(!Ws(i[n]))return!1;return!0}return!1}function Fr(i){if(i===null)return Is;if(typeof i=="string")return Mt;if(typeof i=="boolean")return _t;if(typeof i=="number")return Ve;if(i instanceof Jt)return En;if(i instanceof Qc)return qi;if(i instanceof Zn)return ls;if(i instanceof Hn)return Es;if(i instanceof si)return re;if(i instanceof Gn)return Zi;if(Array.isArray(i)){const n=i.length;let a;for(const u of i){const f=Fr(u);if(a){if(a===f)continue;a=St;break}a=f}return N(a||St,n)}return wi}function Go(i){const n=typeof i;return i===null?"":n==="string"||n==="number"||n==="boolean"?String(i):i instanceof Jt||i instanceof Zn||i instanceof Hn||i instanceof si||i instanceof Gn?i.toString():JSON.stringify(i)}class bi{constructor(n,a){this.type=n,this.value=a}static parse(n,a){if(n.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Ws(n[1]))return a.error("invalid value");const u=n[1];let f=Fr(u);const _=a.expectedType;return f.kind!=="array"||f.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(f=_),new bi(f,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Ir{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const su={string:Mt,number:Ve,boolean:_t,object:wi};class Si{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");let u,f=1;const _=n[0];if(_==="array"){let w,S;if(n.length>2){const C=n[1];if(typeof C!="string"||!(C in su)||C==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);w=su[C],f++}else w=St;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return a.error('The length argument to "array" must be a positive integer literal',2);S=n[2],f++}u=N(w,S)}else{if(!su[_])throw new Error(`Types doesn't contain name = ${_}`);u=su[_]}const x=[];for(;f<n.length;f++){const w=a.parse(n[f],f,St);if(!w)return null;x.push(w)}return new Si(u,x)}evaluate(n){for(let a=0;a<this.args.length;a++){const u=this.args[a].evaluate(n);if(!J(this.type,Fr(u)))return u;if(a===this.args.length-1)throw new Ir(`Expected value to be of type ${O(this.type)}, but found ${O(Fr(u))} instead.`)}throw new Error}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const eh={"to-boolean":_t,"to-color":En,"to-number":Ve,"to-string":Mt};class ki{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");const u=n[0];if(!eh[u])throw new Error(`Can't parse ${u} as it is not part of the known types`);if((u==="to-boolean"||u==="to-string")&&n.length!==2)return a.error("Expected one argument.");const f=eh[u],_=[];for(let x=1;x<n.length;x++){const w=a.parse(n[x],x,St);if(!w)return null;_.push(w)}return new ki(f,_)}evaluate(n){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(n);case"color":{let a,u;for(const f of this.args){if(a=f.evaluate(n),u=null,a instanceof Jt)return a;if(typeof a=="string"){const _=n.parseColor(a);if(_)return _}else if(Array.isArray(a)&&(u=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:za(a[0],a[1],a[2],a[3]),!u))return new Jt(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new Ir(u||`Could not parse color from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"padding":{let a;for(const u of this.args){a=u.evaluate(n);const f=Hn.parse(a);if(f)return f}throw new Ir(`Could not parse padding from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"variableAnchorOffsetCollection":{let a;for(const u of this.args){a=u.evaluate(n);const f=si.parse(a);if(f)return f}throw new Ir(`Could not parse variableAnchorOffsetCollection from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"number":{let a=null;for(const u of this.args){if(a=u.evaluate(n),a===null)return 0;const f=Number(a);if(!isNaN(f))return f}throw new Ir(`Could not convert ${JSON.stringify(a)} to number.`)}case"formatted":return Zn.fromString(Go(this.args[0].evaluate(n)));case"resolvedImage":return Gn.fromString(Go(this.args[0].evaluate(n)));default:return Go(this.args[0].evaluate(n))}}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const Cg=["Unknown","Point","LineString","Polygon"];class au{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Cg[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(n){let a=this._parseColorCache[n];return a||(a=this._parseColorCache[n]=Jt.parse(n)),a}}class Xs{constructor(n,a,u=[],f,_=new $i,x=[]){this.registry=n,this.path=u,this.key=u.map(w=>`[${w}]`).join(""),this.scope=_,this.errors=x,this.expectedType=f,this._isConstant=a}parse(n,a,u,f,_={}){return a?this.concat(a,u,f)._parse(n,_):this._parse(n,_)}_parse(n,a){function u(f,_,x){return x==="assert"?new Si(_,[f]):x==="coerce"?new ki(_,[f]):f}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=n[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[f];if(_){let x=_.parse(n,this);if(!x)return null;if(this.expectedType){const w=this.expectedType,S=x.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||S.kind!=="value")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(w.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(w.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(w,S))return null}else x=u(x,w,a.typeAnnotation||"coerce");else x=u(x,w,a.typeAnnotation||"coerce");else x=u(x,w,a.typeAnnotation||"coerce");else x=u(x,w,a.typeAnnotation||"assert")}if(!(x instanceof bi)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const w=new au;try{x=new bi(x.type,x.evaluate(w))}catch(S){return this.error(S.message),null}}return x}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,a,u){const f=typeof n=="number"?this.path.concat(n):this.path,_=u?this.scope.concat(u):this.scope;return new Xs(this.registry,this._isConstant,f,a||null,_,this.errors)}error(n,...a){const u=`${this.key}${a.map(f=>`[${f}]`).join("")}`;this.errors.push(new vn(u,n))}checkSubtype(n,a){const u=J(n,a);return u&&this.error(u),u}}class Ps{constructor(n,a){this.type=a.type,this.bindings=[].concat(n),this.result=a}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const a of this.bindings)n(a[1]);n(this.result)}static parse(n,a){if(n.length<4)return a.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const u=[];for(let _=1;_<n.length-1;_+=2){const x=n[_];if(typeof x!="string")return a.error(`Expected string, but found ${typeof x} instead.`,_);if(/[^a-zA-Z0-9_]/.test(x))return a.error("Variable names must contain only alphanumeric characters or '_'.",_);const w=a.parse(n[_+1],_+1);if(!w)return null;u.push([x,w])}const f=a.parse(n[n.length-1],n.length-1,a.expectedType,u);return f?new Ps(u,f):null}outputDefined(){return this.result.outputDefined()}}class Zt{constructor(n,a){this.type=a.type,this.name=n,this.boundExpression=a}static parse(n,a){if(n.length!==2||typeof n[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const u=n[1];return a.scope.has(u)?new Zt(u,a.scope.get(u)):a.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}}class th{constructor(n,a,u){this.type=n,this.index=a,this.input=u}static parse(n,a){if(n.length!==3)return a.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=a.parse(n[1],1,Ve),f=a.parse(n[2],2,N(a.expectedType||St));return u&&f?new th(f.type.itemType,u,f):null}evaluate(n){const a=this.index.evaluate(n),u=this.input.evaluate(n);if(a<0)throw new Ir(`Array index out of bounds: ${a} < 0.`);if(a>=u.length)throw new Ir(`Array index out of bounds: ${a} > ${u.length-1}.`);if(a!==Math.floor(a))throw new Ir(`Array index must be an integer, but found ${a} instead.`);return u[a]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}}class rh{constructor(n,a){this.type=_t,this.needle=n,this.haystack=a}static parse(n,a){if(n.length!==3)return a.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=a.parse(n[1],1,St),f=a.parse(n[2],2,St);return u&&f?ce(u.type,[_t,Mt,Ve,Is,St])?new rh(u,f):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${O(u.type)} instead`):null}evaluate(n){const a=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(!u)return!1;if(!fe(a,["boolean","string","number","null"]))throw new Ir(`Expected first argument to be of type boolean, string, number or null, but found ${O(Fr(a))} instead.`);if(!fe(u,["string","array"]))throw new Ir(`Expected second argument to be of type array or string, but found ${O(Fr(u))} instead.`);return u.indexOf(a)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}}class Da{constructor(n,a,u){this.type=Ve,this.needle=n,this.haystack=a,this.fromIndex=u}static parse(n,a){if(n.length<=2||n.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=a.parse(n[1],1,St),f=a.parse(n[2],2,St);if(!u||!f)return null;if(!ce(u.type,[_t,Mt,Ve,Is,St]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${O(u.type)} instead`);if(n.length===4){const _=a.parse(n[3],3,Ve);return _?new Da(u,f,_):null}return new Da(u,f)}evaluate(n){const a=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(!fe(a,["boolean","string","number","null"]))throw new Ir(`Expected first argument to be of type boolean, string, number or null, but found ${O(Fr(a))} instead.`);let f;if(this.fromIndex&&(f=this.fromIndex.evaluate(n)),fe(u,["string"])){const _=u.indexOf(a,f);return _===-1?-1:[...u.slice(0,_)].length}if(fe(u,["array"]))return u.indexOf(a,f);throw new Ir(`Expected second argument to be of type array or string, but found ${O(Fr(u))} instead.`)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}}class nh{constructor(n,a,u,f,_,x){this.inputType=n,this.type=a,this.input=u,this.cases=f,this.outputs=_,this.otherwise=x}static parse(n,a){if(n.length<5)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return a.error("Expected an even number of arguments.");let u,f;a.expectedType&&a.expectedType.kind!=="value"&&(f=a.expectedType);const _={},x=[];for(let C=2;C<n.length-1;C+=2){let E=n[C];const A=n[C+1];Array.isArray(E)||(E=[E]);const F=a.concat(C);if(E.length===0)return F.error("Expected at least one branch label.");for(const V of E){if(typeof V!="number"&&typeof V!="string")return F.error("Branch labels must be numbers or strings.");if(typeof V=="number"&&Math.abs(V)>Number.MAX_SAFE_INTEGER)return F.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof V=="number"&&Math.floor(V)!==V)return F.error("Numeric branch labels must be integer values.");if(u){if(F.checkSubtype(u,Fr(V)))return null}else u=Fr(V);if(_[String(V)]!==void 0)return F.error("Branch labels must be unique.");_[String(V)]=x.length}const B=a.parse(A,C,f);if(!B)return null;f=f||B.type,x.push(B)}const w=a.parse(n[1],1,St);if(!w)return null;const S=a.parse(n[n.length-1],n.length-1,f);return S?w.type.kind!=="value"&&a.concat(1).checkSubtype(u,w.type)?null:new nh(u,f,w,_,x,S):null}evaluate(n){const a=this.input.evaluate(n);return(Fr(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}}class ou{constructor(n,a,u){this.type=n,this.branches=a,this.otherwise=u}static parse(n,a){if(n.length<4)return a.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return a.error("Expected an odd number of arguments.");let u;a.expectedType&&a.expectedType.kind!=="value"&&(u=a.expectedType);const f=[];for(let x=1;x<n.length-1;x+=2){const w=a.parse(n[x],x,_t);if(!w)return null;const S=a.parse(n[x+1],x+1,u);if(!S)return null;f.push([w,S]),u=u||S.type}const _=a.parse(n[n.length-1],n.length-1,u);if(!_)return null;if(!u)throw new Error("Can't infer output type");return new ou(u,f,_)}evaluate(n){for(const[a,u]of this.branches)if(a.evaluate(n))return u.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[a,u]of this.branches)n(a),n(u);n(this.otherwise)}outputDefined(){return this.branches.every(([n,a])=>a.outputDefined())&&this.otherwise.outputDefined()}}class Wo{constructor(n,a,u,f){this.type=n,this.input=a,this.beginIndex=u,this.endIndex=f}static parse(n,a){if(n.length<=2||n.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=a.parse(n[1],1,St),f=a.parse(n[2],2,Ve);if(!u||!f)return null;if(!ce(u.type,[N(St),Mt,St]))return a.error(`Expected first argument to be of type array or string, but found ${O(u.type)} instead`);if(n.length===4){const _=a.parse(n[3],3,Ve);return _?new Wo(u.type,u,f,_):null}return new Wo(u.type,u,f)}evaluate(n){const a=this.input.evaluate(n),u=this.beginIndex.evaluate(n);let f;if(this.endIndex&&(f=this.endIndex.evaluate(n)),fe(a,["string"]))return[...a].slice(u,f).join("");if(fe(a,["array"]))return a.slice(u,f);throw new Ir(`Expected first argument to be of type array or string, but found ${O(Fr(a))} instead.`)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}}function lu(i,n){const a=i.length-1;let u,f,_=0,x=a,w=0;for(;_<=x;)if(w=Math.floor((_+x)/2),u=i[w],f=i[w+1],u<=n){if(w===a||n<f)return w;_=w+1}else{if(!(u>n))throw new Ir("Input is not a number.");x=w-1}return 0}class La{constructor(n,a,u){this.type=n,this.input=a,this.labels=[],this.outputs=[];for(const[f,_]of u)this.labels.push(f),this.outputs.push(_)}static parse(n,a){if(n.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return a.error("Expected an even number of arguments.");const u=a.parse(n[1],1,Ve);if(!u)return null;const f=[];let _=null;a.expectedType&&a.expectedType.kind!=="value"&&(_=a.expectedType);for(let x=1;x<n.length;x+=2){const w=x===1?-1/0:n[x],S=n[x+1],C=x,E=x+1;if(typeof w!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(f.length&&f[f.length-1][0]>=w)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const A=a.parse(S,E,_);if(!A)return null;_=_||A.type,f.push([w,A])}return new La(_,u,f)}evaluate(n){const a=this.labels,u=this.outputs;if(a.length===1)return u[0].evaluate(n);const f=this.input.evaluate(n);if(f<=a[0])return u[0].evaluate(n);const _=a.length;return f>=a[_-1]?u[_-1].evaluate(n):u[lu(a,f)].evaluate(n)}eachChild(n){n(this.input);for(const a of this.outputs)n(a)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function Cf(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Mg=Mf;function Mf(i,n,a,u){this.cx=3*i,this.bx=3*(a-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(u-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=n,this.p2x=a,this.p2y=u}Mf.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,n){if(n===void 0&&(n=1e-6),i<0)return 0;if(i>1)return 1;for(var a=i,u=0;u<8;u++){var f=this.sampleCurveX(a)-i;if(Math.abs(f)<n)return a;var _=this.sampleCurveDerivativeX(a);if(Math.abs(_)<1e-6)break;a-=f/_}var x=0,w=1;for(a=i,u=0;u<20&&(f=this.sampleCurveX(a),!(Math.abs(f-i)<n));u++)i>f?x=a:w=a,a=.5*(w-x)+x;return a},solve:function(i,n){return this.sampleCurveY(this.solveCurveX(i,n))}};var Ig=Cf(Mg);function Ks(i,n,a){return i+a*(n-i)}function Xo(i,n,a){return i.map((u,f)=>Ks(u,n[f],a))}const Pn={number:Ks,color:function(i,n,a,u="rgb"){switch(u){case"rgb":{const[f,_,x,w]=Xo(i.rgb,n.rgb,a);return new Jt(f,_,x,w,!1)}case"hcl":{const[f,_,x,w]=i.hcl,[S,C,E,A]=n.hcl;let F,B;if(isNaN(f)||isNaN(S))isNaN(f)?isNaN(S)?F=NaN:(F=S,x!==1&&x!==0||(B=C)):(F=f,E!==1&&E!==0||(B=_));else{let xe=S-f;S>f&&xe>180?xe-=360:S<f&&f-S>180&&(xe+=360),F=f+a*xe}const[V,$,Y,ne]=function([xe,ue,_e,Te]){return xe=isNaN(xe)?0:xe*pt,vr([_e,Math.cos(xe)*ue,Math.sin(xe)*ue,Te])}([F,B??Ks(_,C,a),Ks(x,E,a),Ks(w,A,a)]);return new Jt(V,$,Y,ne,!1)}case"lab":{const[f,_,x,w]=vr(Xo(i.lab,n.lab,a));return new Jt(f,_,x,w,!1)}}},array:Xo,padding:function(i,n,a){return new Hn(Xo(i.values,n.values,a))},variableAnchorOffsetCollection:function(i,n,a){const u=i.values,f=n.values;if(u.length!==f.length)throw new Ir(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${n.toString()}`);const _=[];for(let x=0;x<u.length;x+=2){if(u[x]!==f[x])throw new Ir(`Cannot interpolate values containing mismatched anchors. from[${x}]: ${u[x]}, to[${x}]: ${f[x]}`);_.push(u[x]);const[w,S]=u[x+1],[C,E]=f[x+1];_.push([Ks(w,C,a),Ks(S,E,a)])}return new si(_)}};class An{constructor(n,a,u,f,_){this.type=n,this.operator=a,this.interpolation=u,this.input=f,this.labels=[],this.outputs=[];for(const[x,w]of _)this.labels.push(x),this.outputs.push(w)}static interpolationFactor(n,a,u,f){let _=0;if(n.name==="exponential")_=uu(a,n.base,u,f);else if(n.name==="linear")_=uu(a,1,u,f);else if(n.name==="cubic-bezier"){const x=n.controlPoints;_=new Ig(x[0],x[1],x[2],x[3]).solve(uu(a,1,u,f))}return _}static parse(n,a){let[u,f,_,...x]=n;if(!Array.isArray(f)||f.length===0)return a.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const C=f[1];if(typeof C!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:C}}else{if(f[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const C=f.slice(1);if(C.length!==4||C.some(E=>typeof E!="number"||E<0||E>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:C}}}if(n.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(_=a.parse(_,2,Ve),!_)return null;const w=[];let S=null;u==="interpolate-hcl"||u==="interpolate-lab"?S=En:a.expectedType&&a.expectedType.kind!=="value"&&(S=a.expectedType);for(let C=0;C<x.length;C+=2){const E=x[C],A=x[C+1],F=C+3,B=C+4;if(typeof E!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(w.length&&w[w.length-1][0]>=E)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',F);const V=a.parse(A,B,S);if(!V)return null;S=S||V.type,w.push([E,V])}return ve(S,Ve)||ve(S,En)||ve(S,Es)||ve(S,re)||ve(S,N(Ve))?new An(S,u,f,_,w):a.error(`Type ${O(S)} is not interpolatable.`)}evaluate(n){const a=this.labels,u=this.outputs;if(a.length===1)return u[0].evaluate(n);const f=this.input.evaluate(n);if(f<=a[0])return u[0].evaluate(n);const _=a.length;if(f>=a[_-1])return u[_-1].evaluate(n);const x=lu(a,f),w=An.interpolationFactor(this.interpolation,f,a[x],a[x+1]),S=u[x].evaluate(n),C=u[x+1].evaluate(n);switch(this.operator){case"interpolate":return Pn[this.type.kind](S,C,w);case"interpolate-hcl":return Pn.color(S,C,w,"hcl");case"interpolate-lab":return Pn.color(S,C,w,"lab")}}eachChild(n){n(this.input);for(const a of this.outputs)n(a)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function uu(i,n,a,u){const f=u-a,_=i-a;return f===0?0:n===1?_/f:(Math.pow(n,_)-1)/(Math.pow(n,f)-1)}class cu{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expectected at least one argument.");let u=null;const f=a.expectedType;f&&f.kind!=="value"&&(u=f);const _=[];for(const w of n.slice(1)){const S=a.parse(w,1+_.length,u,void 0,{typeAnnotation:"omit"});if(!S)return null;u=u||S.type,_.push(S)}if(!u)throw new Error("No output type");const x=f&&_.some(w=>J(f,w.type));return new cu(x?St:u,_)}evaluate(n){let a,u=null,f=0;for(const _ of this.args)if(f++,u=_.evaluate(n),u&&u instanceof Gn&&!u.available&&(a||(a=u.name),u=null,f===this.args.length&&(u=a)),u!==null)break;return u}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}function hu(i,n){return i==="=="||i==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function If(i,n,a,u){return u.compare(n,a)===0}function Ra(i,n,a){const u=i!=="=="&&i!=="!=";return class bC{constructor(_,x,w){this.type=_t,this.lhs=_,this.rhs=x,this.collator=w,this.hasUntypedArgument=_.type.kind==="value"||x.type.kind==="value"}static parse(_,x){if(_.length!==3&&_.length!==4)return x.error("Expected two or three arguments.");const w=_[0];let S=x.parse(_[1],1,St);if(!S)return null;if(!hu(w,S.type))return x.concat(1).error(`"${w}" comparisons are not supported for type '${O(S.type)}'.`);let C=x.parse(_[2],2,St);if(!C)return null;if(!hu(w,C.type))return x.concat(2).error(`"${w}" comparisons are not supported for type '${O(C.type)}'.`);if(S.type.kind!==C.type.kind&&S.type.kind!=="value"&&C.type.kind!=="value")return x.error(`Cannot compare types '${O(S.type)}' and '${O(C.type)}'.`);u&&(S.type.kind==="value"&&C.type.kind!=="value"?S=new Si(C.type,[S]):S.type.kind!=="value"&&C.type.kind==="value"&&(C=new Si(S.type,[C])));let E=null;if(_.length===4){if(S.type.kind!=="string"&&C.type.kind!=="string"&&S.type.kind!=="value"&&C.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(E=x.parse(_[3],3,qi),!E)return null}return new bC(S,C,E)}evaluate(_){const x=this.lhs.evaluate(_),w=this.rhs.evaluate(_);if(u&&this.hasUntypedArgument){const S=Fr(x),C=Fr(w);if(S.kind!==C.kind||S.kind!=="string"&&S.kind!=="number")throw new Ir(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${S.kind}, ${C.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const S=Fr(x),C=Fr(w);if(S.kind!=="string"||C.kind!=="string")return n(_,x,w)}return this.collator?a(_,x,w,this.collator.evaluate(_)):n(_,x,w)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}const Eg=Ra("==",function(i,n,a){return n===a},If),Ef=Ra("!=",function(i,n,a){return n!==a},function(i,n,a,u){return!If(0,n,a,u)}),Pf=Ra("<",function(i,n,a){return n<a},function(i,n,a,u){return u.compare(n,a)<0}),Pg=Ra(">",function(i,n,a){return n>a},function(i,n,a,u){return u.compare(n,a)>0}),Ag=Ra("<=",function(i,n,a){return n<=a},function(i,n,a,u){return u.compare(n,a)<=0}),Af=Ra(">=",function(i,n,a){return n>=a},function(i,n,a,u){return u.compare(n,a)>=0});class Ko{constructor(n,a,u){this.type=qi,this.locale=u,this.caseSensitive=n,this.diacriticSensitive=a}static parse(n,a){if(n.length!==2)return a.error("Expected one argument.");const u=n[1];if(typeof u!="object"||Array.isArray(u))return a.error("Collator options argument must be an object.");const f=a.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,_t);if(!f)return null;const _=a.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,_t);if(!_)return null;let x=null;return u.locale&&(x=a.parse(u.locale,1,Mt),!x)?null:new Ko(f,_,x)}evaluate(n){return new Qc(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}}class ih{constructor(n,a,u,f,_){this.type=Mt,this.number=n,this.locale=a,this.currency=u,this.minFractionDigits=f,this.maxFractionDigits=_}static parse(n,a){if(n.length!==3)return a.error("Expected two arguments.");const u=a.parse(n[1],1,Ve);if(!u)return null;const f=n[2];if(typeof f!="object"||Array.isArray(f))return a.error("NumberFormat options argument must be an object.");let _=null;if(f.locale&&(_=a.parse(f.locale,1,Mt),!_))return null;let x=null;if(f.currency&&(x=a.parse(f.currency,1,Mt),!x))return null;let w=null;if(f["min-fraction-digits"]&&(w=a.parse(f["min-fraction-digits"],1,Ve),!w))return null;let S=null;return f["max-fraction-digits"]&&(S=a.parse(f["max-fraction-digits"],1,Ve),!S)?null:new ih(u,_,x,w,S)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}}class du{constructor(n){this.type=ls,this.sections=n}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");const u=n[1];if(!Array.isArray(u)&&typeof u=="object")return a.error("First argument must be an image or text section.");const f=[];let _=!1;for(let x=1;x<=n.length-1;++x){const w=n[x];if(_&&typeof w=="object"&&!Array.isArray(w)){_=!1;let S=null;if(w["font-scale"]&&(S=a.parse(w["font-scale"],1,Ve),!S))return null;let C=null;if(w["text-font"]&&(C=a.parse(w["text-font"],1,N(Mt)),!C))return null;let E=null;if(w["text-color"]&&(E=a.parse(w["text-color"],1,En),!E))return null;const A=f[f.length-1];A.scale=S,A.font=C,A.textColor=E}else{const S=a.parse(n[x],1,St);if(!S)return null;const C=S.type.kind;if(C!=="string"&&C!=="value"&&C!=="null"&&C!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,f.push({content:S,scale:null,font:null,textColor:null})}}return new du(f)}evaluate(n){return new Zn(this.sections.map(a=>{const u=a.content.evaluate(n);return Fr(u)===Zi?new Jc("",u,null,null,null):new Jc(Go(u),null,a.scale?a.scale.evaluate(n):null,a.font?a.font.evaluate(n).join(","):null,a.textColor?a.textColor.evaluate(n):null)}))}eachChild(n){for(const a of this.sections)n(a.content),a.scale&&n(a.scale),a.font&&n(a.font),a.textColor&&n(a.textColor)}outputDefined(){return!1}}class sh{constructor(n){this.type=Zi,this.input=n}static parse(n,a){if(n.length!==2)return a.error("Expected two arguments.");const u=a.parse(n[1],1,Mt);return u?new sh(u):a.error("No image name provided.")}evaluate(n){const a=this.input.evaluate(n),u=Gn.fromString(a);return u&&n.availableImages&&(u.available=n.availableImages.indexOf(a)>-1),u}eachChild(n){n(this.input)}outputDefined(){return!1}}class ah{constructor(n){this.type=Ve,this.input=n}static parse(n,a){if(n.length!==2)return a.error(`Expected 1 argument, but found ${n.length-1} instead.`);const u=a.parse(n[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${O(u.type)} instead.`):new ah(u):null}evaluate(n){const a=this.input.evaluate(n);if(typeof a=="string")return[...a].length;if(Array.isArray(a))return a.length;throw new Ir(`Expected value to be of type string or array, but found ${O(Fr(a))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}}const Hi=8192;function zg(i,n){const a=(180+i[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,f=Math.pow(2,n.z);return[Math.round(a*f*Hi),Math.round(u*f*Hi)]}function oh(i,n){const a=Math.pow(2,n.z);return[(f=(i[0]/Hi+n.x)/a,360*f-180),(u=(i[1]/Hi+n.y)/a,360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90)];var u,f}function Ys(i,n){i[0]=Math.min(i[0],n[0]),i[1]=Math.min(i[1],n[1]),i[2]=Math.max(i[2],n[0]),i[3]=Math.max(i[3],n[1])}function As(i,n){return!(i[0]<=n[0]||i[2]>=n[2]||i[1]<=n[1]||i[3]>=n[3])}function Xt(i,n,a){const u=i[0]-n[0],f=i[1]-n[1],_=i[0]-a[0],x=i[1]-a[1];return u*x-_*f==0&&u*_<=0&&f*x<=0}function fu(i,n,a,u){return(f=[u[0]-a[0],u[1]-a[1]])[0]*(_=[n[0]-i[0],n[1]-i[1]])[1]-f[1]*_[0]!=0&&!(!Df(i,n,a,u)||!Df(a,u,i,n));var f,_}function Dg(i,n,a){for(const u of a)for(let f=0;f<u.length-1;++f)if(fu(i,n,u[f],u[f+1]))return!0;return!1}function Fa(i,n,a=!1){let u=!1;for(const w of n)for(let S=0;S<w.length-1;S++){if(Xt(i,w[S],w[S+1]))return a;(_=w[S])[1]>(f=i)[1]!=(x=w[S+1])[1]>f[1]&&f[0]<(x[0]-_[0])*(f[1]-_[1])/(x[1]-_[1])+_[0]&&(u=!u)}var f,_,x;return u}function Lg(i,n){for(const a of n)if(Fa(i,a))return!0;return!1}function zf(i,n){for(const a of i)if(!Fa(a,n))return!1;for(let a=0;a<i.length-1;++a)if(Dg(i[a],i[a+1],n))return!1;return!0}function Rg(i,n){for(const a of n)if(zf(i,a))return!0;return!1}function Df(i,n,a,u){const f=u[0]-a[0],_=u[1]-a[1],x=(i[0]-a[0])*_-f*(i[1]-a[1]),w=(n[0]-a[0])*_-f*(n[1]-a[1]);return x>0&&w<0||x<0&&w>0}function lh(i,n,a){const u=[];for(let f=0;f<i.length;f++){const _=[];for(let x=0;x<i[f].length;x++){const w=zg(i[f][x],a);Ys(n,w),_.push(w)}u.push(_)}return u}function Lf(i,n,a){const u=[];for(let f=0;f<i.length;f++){const _=lh(i[f],n,a);u.push(_)}return u}function Rf(i,n,a,u){if(i[0]<a[0]||i[0]>a[2]){const f=.5*u;let _=i[0]-a[0]>f?-u:a[0]-i[0]>f?u:0;_===0&&(_=i[0]-a[2]>f?-u:a[2]-i[0]>f?u:0),i[0]+=_}Ys(n,i)}function Ff(i,n,a,u){const f=Math.pow(2,u.z)*Hi,_=[u.x*Hi,u.y*Hi],x=[];for(const w of i)for(const S of w){const C=[S.x+_[0],S.y+_[1]];Rf(C,n,a,f),x.push(C)}return x}function Of(i,n,a,u){const f=Math.pow(2,u.z)*Hi,_=[u.x*Hi,u.y*Hi],x=[];for(const S of i){const C=[];for(const E of S){const A=[E.x+_[0],E.y+_[1]];Ys(n,A),C.push(A)}x.push(C)}if(n[2]-n[0]<=f/2){(w=n)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const S of x)for(const C of S)Rf(C,n,a,f)}var w;return x}class Qs{constructor(n,a){this.type=_t,this.geojson=n,this.geometries=a}static parse(n,a){if(n.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Ws(n[1])){const u=n[1];if(u.type==="FeatureCollection"){const f=[];for(const _ of u.features){const{type:x,coordinates:w}=_.geometry;x==="Polygon"&&f.push(w),x==="MultiPolygon"&&f.push(...w)}if(f.length)return new Qs(u,{type:"MultiPolygon",coordinates:f})}else if(u.type==="Feature"){const f=u.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Qs(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Qs(u,u)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(a,u){const f=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=a.canonicalID();if(u.type==="Polygon"){const w=lh(u.coordinates,_,x),S=Ff(a.geometry(),f,_,x);if(!As(f,_))return!1;for(const C of S)if(!Fa(C,w))return!1}if(u.type==="MultiPolygon"){const w=Lf(u.coordinates,_,x),S=Ff(a.geometry(),f,_,x);if(!As(f,_))return!1;for(const C of S)if(!Lg(C,w))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(a,u){const f=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=a.canonicalID();if(u.type==="Polygon"){const w=lh(u.coordinates,_,x),S=Of(a.geometry(),f,_,x);if(!As(f,_))return!1;for(const C of S)if(!zf(C,w))return!1}if(u.type==="MultiPolygon"){const w=Lf(u.coordinates,_,x),S=Of(a.geometry(),f,_,x);if(!As(f,_))return!1;for(const C of S)if(!Rg(C,w))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Nf=class{constructor(i=[],n=(a,u)=>a<u?-1:a>u?1:0){if(this.data=i,this.length=this.data.length,this.compare=n,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:n,compare:a}=this,u=n[i];for(;i>0;){const f=i-1>>1,_=n[f];if(a(u,_)>=0)break;n[i]=_,i=f}n[i]=u}_down(i){const{data:n,compare:a}=this,u=this.length>>1,f=n[i];for(;i<u;){let _=1+(i<<1);const x=_+1;if(x<this.length&&a(n[x],n[_])<0&&(_=x),a(n[_],f)>=0)break;n[i]=n[_],i=_}n[i]=f}};function Fg(i,n,a,u,f){Bf(i,n,a,u||i.length-1,f||Og)}function Bf(i,n,a,u,f){for(;u>a;){if(u-a>600){var _=u-a+1,x=n-a+1,w=Math.log(_),S=.5*Math.exp(2*w/3),C=.5*Math.sqrt(w*S*(_-S)/_)*(x-_/2<0?-1:1);Bf(i,n,Math.max(a,Math.floor(n-x*S/_+C)),Math.min(u,Math.floor(n+(_-x)*S/_+C)),f)}var E=i[n],A=a,F=u;for(Yo(i,a,n),f(i[u],E)>0&&Yo(i,a,u);A<F;){for(Yo(i,A,F),A++,F--;f(i[A],E)<0;)A++;for(;f(i[F],E)>0;)F--}f(i[a],E)===0?Yo(i,a,F):Yo(i,++F,u),F<=n&&(a=F+1),n<=F&&(u=F-1)}}function Yo(i,n,a){var u=i[n];i[n]=i[a],i[a]=u}function Og(i,n){return i<n?-1:i>n?1:0}function pu(i,n){if(i.length<=1)return[i];const a=[];let u,f;for(const _ of i){const x=Bg(_);x!==0&&(_.area=Math.abs(x),f===void 0&&(f=x<0),f===x<0?(u&&a.push(u),u=[_]):u.push(_))}if(u&&a.push(u),n>1)for(let _=0;_<a.length;_++)a[_].length<=n||(Fg(a[_],n,1,a[_].length-1,Ng),a[_]=a[_].slice(0,n));return a}function Ng(i,n){return n.area-i.area}function Bg(i){let n=0;for(let a,u,f=0,_=i.length,x=_-1;f<_;x=f++)a=i[f],u=i[x],n+=(u.x-a.x)*(a.y+u.y);return n}const jf=1/298.257223563,Uf=jf*(2-jf),Vf=Math.PI/180;class uh{constructor(n){const a=6378.137*Vf*1e3,u=Math.cos(n*Vf),f=1/(1-Uf*(1-u*u)),_=Math.sqrt(f);this.kx=a*_*u,this.ky=a*_*f*(1-Uf)}distance(n,a){const u=this.wrap(n[0]-a[0])*this.kx,f=(n[1]-a[1])*this.ky;return Math.sqrt(u*u+f*f)}pointOnLine(n,a){let u,f,_,x,w=1/0;for(let S=0;S<n.length-1;S++){let C=n[S][0],E=n[S][1],A=this.wrap(n[S+1][0]-C)*this.kx,F=(n[S+1][1]-E)*this.ky,B=0;A===0&&F===0||(B=(this.wrap(a[0]-C)*this.kx*A+(a[1]-E)*this.ky*F)/(A*A+F*F),B>1?(C=n[S+1][0],E=n[S+1][1]):B>0&&(C+=A/this.kx*B,E+=F/this.ky*B)),A=this.wrap(a[0]-C)*this.kx,F=(a[1]-E)*this.ky;const V=A*A+F*F;V<w&&(w=V,u=C,f=E,_=S,x=B)}return{point:[u,f],index:_,t:Math.max(0,Math.min(1,x))}}wrap(n){for(;n<-180;)n+=360;for(;n>180;)n-=360;return n}}function $f(i,n){return n[0]-i[0]}function mu(i){return i[1]-i[0]+1}function us(i,n){return i[1]>=i[0]&&i[1]<n}function ch(i,n){if(i[0]>i[1])return[null,null];const a=mu(i);if(n){if(a===2)return[i,null];const f=Math.floor(a/2);return[[i[0],i[0]+f],[i[0]+f,i[1]]]}if(a===1)return[i,null];const u=Math.floor(a/2)-1;return[[i[0],i[0]+u],[i[0]+u+1,i[1]]]}function hh(i,n){if(!us(n,i.length))return[1/0,1/0,-1/0,-1/0];const a=[1/0,1/0,-1/0,-1/0];for(let u=n[0];u<=n[1];++u)Ys(a,i[u]);return a}function dh(i){const n=[1/0,1/0,-1/0,-1/0];for(const a of i)for(const u of a)Ys(n,u);return n}function gu(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}function fh(i,n,a){if(!gu(i)||!gu(n))return NaN;let u=0,f=0;return i[2]<n[0]&&(u=n[0]-i[2]),i[0]>n[2]&&(u=i[0]-n[2]),i[1]>n[3]&&(f=i[1]-n[3]),i[3]<n[1]&&(f=n[1]-i[3]),a.distance([0,0],[u,f])}function Js(i,n,a){const u=a.pointOnLine(n,i);return a.distance(i,u.point)}function ph(i,n,a,u,f){const _=Math.min(Js(i,[a,u],f),Js(n,[a,u],f)),x=Math.min(Js(a,[i,n],f),Js(u,[i,n],f));return Math.min(_,x)}function jg(i,n,a,u,f){if(!us(n,i.length)||!us(u,a.length))return 1/0;let _=1/0;for(let x=n[0];x<n[1];++x){const w=i[x],S=i[x+1];for(let C=u[0];C<u[1];++C){const E=a[C],A=a[C+1];if(fu(w,S,E,A))return 0;_=Math.min(_,ph(w,S,E,A,f))}}return _}function Sr(i,n,a,u,f){if(!us(n,i.length)||!us(u,a.length))return NaN;let _=1/0;for(let x=n[0];x<=n[1];++x)for(let w=u[0];w<=u[1];++w)if(_=Math.min(_,f.distance(i[x],a[w])),_===0)return _;return _}function Ug(i,n,a){if(Fa(i,n,!0))return 0;let u=1/0;for(const f of n){const _=f[0],x=f[f.length-1];if(_!==x&&(u=Math.min(u,Js(i,[x,_],a)),u===0))return u;const w=a.pointOnLine(f,i);if(u=Math.min(u,a.distance(i,w.point)),u===0)return u}return u}function Et(i,n,a,u){if(!us(n,i.length))return NaN;for(let _=n[0];_<=n[1];++_)if(Fa(i[_],a,!0))return 0;let f=1/0;for(let _=n[0];_<n[1];++_){const x=i[_],w=i[_+1];for(const S of a)for(let C=0,E=S.length,A=E-1;C<E;A=C++){const F=S[A],B=S[C];if(fu(x,w,F,B))return 0;f=Math.min(f,ph(x,w,F,B,u))}}return f}function yu(i,n){for(const a of i)for(const u of a)if(Fa(u,n,!0))return!0;return!1}function ar(i,n,a,u=1/0){const f=dh(i),_=dh(n);if(u!==1/0&&fh(f,_,a)>=u)return u;if(As(f,_)){if(yu(i,n))return 0}else if(yu(n,i))return 0;let x=1/0;for(const w of i)for(let S=0,C=w.length,E=C-1;S<C;E=S++){const A=w[E],F=w[S];for(const B of n)for(let V=0,$=B.length,Y=$-1;V<$;Y=V++){const ne=B[Y],xe=B[V];if(fu(A,F,ne,xe))return 0;x=Math.min(x,ph(A,F,ne,xe,a))}}return x}function tr(i,n,a,u,f,_){if(!_)return;const x=fh(hh(u,_),f,a);x<n&&i.push([x,_,[0,0]])}function ea(i,n,a,u,f,_,x){if(!_||!x)return;const w=fh(hh(u,_),hh(f,x),a);w<n&&i.push([w,_,x])}function Qo(i,n,a,u,f=1/0){let _=Math.min(u.distance(i[0],a[0][0]),f);if(_===0)return _;const x=new Nf([[0,[0,i.length-1],[0,0]]],$f),w=dh(a);for(;x.length>0;){const S=x.pop();if(S[0]>=_)continue;const C=S[1],E=n?50:100;if(mu(C)<=E){if(!us(C,i.length))return NaN;if(n){const A=Et(i,C,a,u);if(isNaN(A)||A===0)return A;_=Math.min(_,A)}else for(let A=C[0];A<=C[1];++A){const F=Ug(i[A],a,u);if(_=Math.min(_,F),_===0)return 0}}else{const A=ch(C,n);tr(x,_,u,i,w,A[0]),tr(x,_,u,i,w,A[1])}}return _}function Jo(i,n,a,u,f,_=1/0){let x=Math.min(_,f.distance(i[0],a[0]));if(x===0)return x;const w=new Nf([[0,[0,i.length-1],[0,a.length-1]]],$f);for(;w.length>0;){const S=w.pop();if(S[0]>=x)continue;const C=S[1],E=S[2],A=n?50:100,F=u?50:100;if(mu(C)<=A&&mu(E)<=F){if(!us(C,i.length)&&us(E,a.length))return NaN;let B;if(n&&u)B=jg(i,C,a,E,f),x=Math.min(x,B);else if(n&&!u){const V=i.slice(C[0],C[1]+1);for(let $=E[0];$<=E[1];++$)if(B=Js(a[$],V,f),x=Math.min(x,B),x===0)return x}else if(!n&&u){const V=a.slice(E[0],E[1]+1);for(let $=C[0];$<=C[1];++$)if(B=Js(i[$],V,f),x=Math.min(x,B),x===0)return x}else B=Sr(i,C,a,E,f),x=Math.min(x,B)}else{const B=ch(C,n),V=ch(E,u);ea(w,x,f,i,a,B[0],V[0]),ea(w,x,f,i,a,B[0],V[1]),ea(w,x,f,i,a,B[1],V[0]),ea(w,x,f,i,a,B[1],V[1])}}return x}function mh(i){return i.type==="MultiPolygon"?i.coordinates.map(n=>({type:"Polygon",coordinates:n})):i.type==="MultiLineString"?i.coordinates.map(n=>({type:"LineString",coordinates:n})):i.type==="MultiPoint"?i.coordinates.map(n=>({type:"Point",coordinates:n})):[i]}class ta{constructor(n,a){this.type=Ve,this.geojson=n,this.geometries=a}static parse(n,a){if(n.length!==2)return a.error(`'distance' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Ws(n[1])){const u=n[1];if(u.type==="FeatureCollection")return new ta(u,u.features.map(f=>mh(f.geometry)).flat());if(u.type==="Feature")return new ta(u,mh(u.geometry));if("type"in u&&"coordinates"in u)return new ta(u,mh(u))}return a.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(a,u){const f=a.geometry(),_=f.flat().map(S=>oh([S.x,S.y],a.canonical));if(f.length===0)return NaN;const x=new uh(_[0][1]);let w=1/0;for(const S of u){switch(S.type){case"Point":w=Math.min(w,Jo(_,!1,[S.coordinates],!1,x,w));break;case"LineString":w=Math.min(w,Jo(_,!1,S.coordinates,!0,x,w));break;case"Polygon":w=Math.min(w,Qo(_,!1,S.coordinates,x,w))}if(w===0)return w}return w}(n,this.geometries);if(n.geometryType()==="LineString")return function(a,u){const f=a.geometry(),_=f.flat().map(S=>oh([S.x,S.y],a.canonical));if(f.length===0)return NaN;const x=new uh(_[0][1]);let w=1/0;for(const S of u){switch(S.type){case"Point":w=Math.min(w,Jo(_,!0,[S.coordinates],!1,x,w));break;case"LineString":w=Math.min(w,Jo(_,!0,S.coordinates,!0,x,w));break;case"Polygon":w=Math.min(w,Qo(_,!0,S.coordinates,x,w))}if(w===0)return w}return w}(n,this.geometries);if(n.geometryType()==="Polygon")return function(a,u){const f=a.geometry();if(f.length===0||f[0].length===0)return NaN;const _=pu(f,0).map(S=>S.map(C=>C.map(E=>oh([E.x,E.y],a.canonical)))),x=new uh(_[0][0][0][1]);let w=1/0;for(const S of u)for(const C of _){switch(S.type){case"Point":w=Math.min(w,Qo([S.coordinates],!1,C,x,w));break;case"LineString":w=Math.min(w,Qo(S.coordinates,!0,C,x,w));break;case"Polygon":w=Math.min(w,ar(C,S.coordinates,x,w))}if(w===0)return w}return w}(n,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Oa={"==":Eg,"!=":Ef,">":Pg,"<":Pf,">=":Af,"<=":Ag,array:Si,at:th,boolean:Si,case:ou,coalesce:cu,collator:Ko,format:du,image:sh,in:rh,"index-of":Da,interpolate:An,"interpolate-hcl":An,"interpolate-lab":An,length:ah,let:Ps,literal:bi,match:nh,number:Si,"number-format":ih,object:Si,slice:Wo,step:La,string:Si,"to-boolean":ki,"to-color":ki,"to-number":ki,"to-string":ki,var:Zt,within:Qs,distance:ta};class ai{constructor(n,a,u,f){this.name=n,this.type=a,this._evaluate=u,this.args=f}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}static parse(n,a){const u=n[0],f=ai.definitions[u];if(!f)return a.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(f)?f[0]:f.type,x=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,w=x.filter(([C])=>!Array.isArray(C)||C.length===n.length-1);let S=null;for(const[C,E]of w){S=new Xs(a.registry,el,a.path,null,a.scope);const A=[];let F=!1;for(let B=1;B<n.length;B++){const V=n[B],$=Array.isArray(C)?C[B-1]:C.type,Y=S.parse(V,1+A.length,$);if(!Y){F=!0;break}A.push(Y)}if(!F)if(Array.isArray(C)&&C.length!==A.length)S.error(`Expected ${C.length} arguments, but found ${A.length} instead.`);else{for(let B=0;B<A.length;B++){const V=Array.isArray(C)?C[B]:C.type,$=A[B];S.concat(B+1).checkSubtype(V,$.type)}if(S.errors.length===0)return new ai(u,_,E,A)}}if(w.length===1)a.errors.push(...S.errors);else{const C=(w.length?w:x).map(([A])=>{return F=A,Array.isArray(F)?`(${F.map(O).join(", ")})`:`(${O(F.type)}...)`;var F}).join(" | "),E=[];for(let A=1;A<n.length;A++){const F=a.parse(n[A],1+E.length);if(!F)return null;E.push(O(F.type))}a.error(`Expected arguments of type ${C}, but found (${E.join(", ")}) instead.`)}return null}static register(n,a){ai.definitions=a;for(const u in a)n[u]=ai}}function gh(i,[n,a,u,f]){n=n.evaluate(i),a=a.evaluate(i),u=u.evaluate(i);const _=f?f.evaluate(i):1,x=za(n,a,u,_);if(x)throw new Ir(x);return new Jt(n/255,a/255,u/255,_,!1)}function yh(i,n){return i in n}function _h(i,n){const a=n[i];return a===void 0?null:a}function ra(i){return{type:i}}function el(i){if(i instanceof Zt)return el(i.boundExpression);if(i instanceof ai&&i.name==="error"||i instanceof Ko||i instanceof Qs||i instanceof ta)return!1;const n=i instanceof ki||i instanceof Si;let a=!0;return i.eachChild(u=>{a=n?a&&el(u):a&&u instanceof bi}),!!a&&tl(i)&&rl(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function tl(i){if(i instanceof ai&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Qs||i instanceof ta)return!1;let n=!0;return i.eachChild(a=>{n&&!tl(a)&&(n=!1)}),n}function Na(i){if(i instanceof ai&&i.name==="feature-state")return!1;let n=!0;return i.eachChild(a=>{n&&!Na(a)&&(n=!1)}),n}function rl(i,n){if(i instanceof ai&&n.indexOf(i.name)>=0)return!1;let a=!0;return i.eachChild(u=>{a&&!rl(u,n)&&(a=!1)}),a}function _u(i){return{result:"success",value:i}}function Ba(i){return{result:"error",value:i}}function ja(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function qf(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function vh(i){return!!i.expression&&i.expression.interpolated}function Vt(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function vu(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Vg(i){return i}function Zf(i,n){const a=n.type==="color",u=i.stops&&typeof i.stops[0][0]=="object",f=u||!(u||i.property!==void 0),_=i.type||(vh(n)?"exponential":"interval");if(a||n.type==="padding"){const E=a?Jt.parse:Hn.parse;(i=Vi({},i)).stops&&(i.stops=i.stops.map(A=>[A[0],E(A[1])])),i.default=E(i.default?i.default:n.default)}if(i.colorSpace&&(x=i.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var x;let w,S,C;if(_==="exponential")w=Gf;else if(_==="interval")w=xu;else if(_==="categorical"){w=Hf,S=Object.create(null);for(const E of i.stops)S[E[0]]=E[1];C=typeof i.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);w=Wf}if(u){const E={},A=[];for(let V=0;V<i.stops.length;V++){const $=i.stops[V],Y=$[0].zoom;E[Y]===void 0&&(E[Y]={zoom:Y,type:i.type,property:i.property,default:i.default,stops:[]},A.push(Y)),E[Y].stops.push([$[0].value,$[1]])}const F=[];for(const V of A)F.push([E[V].zoom,Zf(E[V],n)]);const B={name:"linear"};return{kind:"composite",interpolationType:B,interpolationFactor:An.interpolationFactor.bind(void 0,B),zoomStops:F.map(V=>V[0]),evaluate:({zoom:V},$)=>Gf({stops:F,base:i.base},n,V).evaluate(V,$)}}if(f){const E=_==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:E,interpolationFactor:An.interpolationFactor.bind(void 0,E),zoomStops:i.stops.map(A=>A[0]),evaluate:({zoom:A})=>w(i,n,A,S,C)}}return{kind:"source",evaluate(E,A){const F=A&&A.properties?A.properties[i.property]:void 0;return F===void 0?Ua(i.default,n.default):w(i,n,F,S,C)}}}function Ua(i,n,a){return i!==void 0?i:n!==void 0?n:a!==void 0?a:void 0}function Hf(i,n,a,u,f){return Ua(typeof a===f?u[a]:void 0,i.default,n.default)}function xu(i,n,a){if(Vt(a)!=="number")return Ua(i.default,n.default);const u=i.stops.length;if(u===1||a<=i.stops[0][0])return i.stops[0][1];if(a>=i.stops[u-1][0])return i.stops[u-1][1];const f=lu(i.stops.map(_=>_[0]),a);return i.stops[f][1]}function Gf(i,n,a){const u=i.base!==void 0?i.base:1;if(Vt(a)!=="number")return Ua(i.default,n.default);const f=i.stops.length;if(f===1||a<=i.stops[0][0])return i.stops[0][1];if(a>=i.stops[f-1][0])return i.stops[f-1][1];const _=lu(i.stops.map(E=>E[0]),a),x=function(E,A,F,B){const V=B-F,$=E-F;return V===0?0:A===1?$/V:(Math.pow(A,$)-1)/(Math.pow(A,V)-1)}(a,u,i.stops[_][0],i.stops[_+1][0]),w=i.stops[_][1],S=i.stops[_+1][1],C=Pn[n.type]||Vg;return typeof w.evaluate=="function"?{evaluate(...E){const A=w.evaluate.apply(void 0,E),F=S.evaluate.apply(void 0,E);if(A!==void 0&&F!==void 0)return C(A,F,x,i.colorSpace)}}:C(w,S,x,i.colorSpace)}function Wf(i,n,a){switch(n.type){case"color":a=Jt.parse(a);break;case"formatted":a=Zn.fromString(a.toString());break;case"resolvedImage":a=Gn.fromString(a.toString());break;case"padding":a=Hn.parse(a);break;default:Vt(a)===n.type||n.type==="enum"&&n.values[a]||(a=void 0)}return Ua(a,i.default,n.default)}ai.register(Oa,{error:[{kind:"error"},[Mt],(i,[n])=>{throw new Ir(n.evaluate(i))}],typeof:[Mt,[St],(i,[n])=>O(Fr(n.evaluate(i)))],"to-rgba":[N(Ve,4),[En],(i,[n])=>{const[a,u,f,_]=n.evaluate(i).rgb;return[255*a,255*u,255*f,_]}],rgb:[En,[Ve,Ve,Ve],gh],rgba:[En,[Ve,Ve,Ve,Ve],gh],has:{type:_t,overloads:[[[Mt],(i,[n])=>yh(n.evaluate(i),i.properties())],[[Mt,wi],(i,[n,a])=>yh(n.evaluate(i),a.evaluate(i))]]},get:{type:St,overloads:[[[Mt],(i,[n])=>_h(n.evaluate(i),i.properties())],[[Mt,wi],(i,[n,a])=>_h(n.evaluate(i),a.evaluate(i))]]},"feature-state":[St,[Mt],(i,[n])=>_h(n.evaluate(i),i.featureState||{})],properties:[wi,[],i=>i.properties()],"geometry-type":[Mt,[],i=>i.geometryType()],id:[St,[],i=>i.id()],zoom:[Ve,[],i=>i.globals.zoom],"heatmap-density":[Ve,[],i=>i.globals.heatmapDensity||0],"line-progress":[Ve,[],i=>i.globals.lineProgress||0],accumulated:[St,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Ve,ra(Ve),(i,n)=>{let a=0;for(const u of n)a+=u.evaluate(i);return a}],"*":[Ve,ra(Ve),(i,n)=>{let a=1;for(const u of n)a*=u.evaluate(i);return a}],"-":{type:Ve,overloads:[[[Ve,Ve],(i,[n,a])=>n.evaluate(i)-a.evaluate(i)],[[Ve],(i,[n])=>-n.evaluate(i)]]},"/":[Ve,[Ve,Ve],(i,[n,a])=>n.evaluate(i)/a.evaluate(i)],"%":[Ve,[Ve,Ve],(i,[n,a])=>n.evaluate(i)%a.evaluate(i)],ln2:[Ve,[],()=>Math.LN2],pi:[Ve,[],()=>Math.PI],e:[Ve,[],()=>Math.E],"^":[Ve,[Ve,Ve],(i,[n,a])=>Math.pow(n.evaluate(i),a.evaluate(i))],sqrt:[Ve,[Ve],(i,[n])=>Math.sqrt(n.evaluate(i))],log10:[Ve,[Ve],(i,[n])=>Math.log(n.evaluate(i))/Math.LN10],ln:[Ve,[Ve],(i,[n])=>Math.log(n.evaluate(i))],log2:[Ve,[Ve],(i,[n])=>Math.log(n.evaluate(i))/Math.LN2],sin:[Ve,[Ve],(i,[n])=>Math.sin(n.evaluate(i))],cos:[Ve,[Ve],(i,[n])=>Math.cos(n.evaluate(i))],tan:[Ve,[Ve],(i,[n])=>Math.tan(n.evaluate(i))],asin:[Ve,[Ve],(i,[n])=>Math.asin(n.evaluate(i))],acos:[Ve,[Ve],(i,[n])=>Math.acos(n.evaluate(i))],atan:[Ve,[Ve],(i,[n])=>Math.atan(n.evaluate(i))],min:[Ve,ra(Ve),(i,n)=>Math.min(...n.map(a=>a.evaluate(i)))],max:[Ve,ra(Ve),(i,n)=>Math.max(...n.map(a=>a.evaluate(i)))],abs:[Ve,[Ve],(i,[n])=>Math.abs(n.evaluate(i))],round:[Ve,[Ve],(i,[n])=>{const a=n.evaluate(i);return a<0?-Math.round(-a):Math.round(a)}],floor:[Ve,[Ve],(i,[n])=>Math.floor(n.evaluate(i))],ceil:[Ve,[Ve],(i,[n])=>Math.ceil(n.evaluate(i))],"filter-==":[_t,[Mt,St],(i,[n,a])=>i.properties()[n.value]===a.value],"filter-id-==":[_t,[St],(i,[n])=>i.id()===n.value],"filter-type-==":[_t,[Mt],(i,[n])=>i.geometryType()===n.value],"filter-<":[_t,[Mt,St],(i,[n,a])=>{const u=i.properties()[n.value],f=a.value;return typeof u==typeof f&&u<f}],"filter-id-<":[_t,[St],(i,[n])=>{const a=i.id(),u=n.value;return typeof a==typeof u&&a<u}],"filter->":[_t,[Mt,St],(i,[n,a])=>{const u=i.properties()[n.value],f=a.value;return typeof u==typeof f&&u>f}],"filter-id->":[_t,[St],(i,[n])=>{const a=i.id(),u=n.value;return typeof a==typeof u&&a>u}],"filter-<=":[_t,[Mt,St],(i,[n,a])=>{const u=i.properties()[n.value],f=a.value;return typeof u==typeof f&&u<=f}],"filter-id-<=":[_t,[St],(i,[n])=>{const a=i.id(),u=n.value;return typeof a==typeof u&&a<=u}],"filter->=":[_t,[Mt,St],(i,[n,a])=>{const u=i.properties()[n.value],f=a.value;return typeof u==typeof f&&u>=f}],"filter-id->=":[_t,[St],(i,[n])=>{const a=i.id(),u=n.value;return typeof a==typeof u&&a>=u}],"filter-has":[_t,[St],(i,[n])=>n.value in i.properties()],"filter-has-id":[_t,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[_t,[N(Mt)],(i,[n])=>n.value.indexOf(i.geometryType())>=0],"filter-id-in":[_t,[N(St)],(i,[n])=>n.value.indexOf(i.id())>=0],"filter-in-small":[_t,[Mt,N(St)],(i,[n,a])=>a.value.indexOf(i.properties()[n.value])>=0],"filter-in-large":[_t,[Mt,N(St)],(i,[n,a])=>function(u,f,_,x){for(;_<=x;){const w=_+x>>1;if(f[w]===u)return!0;f[w]>u?x=w-1:_=w+1}return!1}(i.properties()[n.value],a.value,0,a.value.length-1)],all:{type:_t,overloads:[[[_t,_t],(i,[n,a])=>n.evaluate(i)&&a.evaluate(i)],[ra(_t),(i,n)=>{for(const a of n)if(!a.evaluate(i))return!1;return!0}]]},any:{type:_t,overloads:[[[_t,_t],(i,[n,a])=>n.evaluate(i)||a.evaluate(i)],[ra(_t),(i,n)=>{for(const a of n)if(a.evaluate(i))return!0;return!1}]]},"!":[_t,[_t],(i,[n])=>!n.evaluate(i)],"is-supported-script":[_t,[Mt],(i,[n])=>{const a=i.globals&&i.globals.isSupportedScript;return!a||a(n.evaluate(i))}],upcase:[Mt,[Mt],(i,[n])=>n.evaluate(i).toUpperCase()],downcase:[Mt,[Mt],(i,[n])=>n.evaluate(i).toLowerCase()],concat:[Mt,ra(St),(i,n)=>n.map(a=>Go(a.evaluate(i))).join("")],"resolved-locale":[Mt,[qi],(i,[n])=>n.evaluate(i).resolvedLocale()]});class wu{constructor(n,a){var u;this.expression=n,this._warningHistory={},this._evaluator=new au,this._defaultValue=a?(u=a).type==="color"&&vu(u.default)?new Jt(0,0,0,0):u.type==="color"?Jt.parse(u.default)||null:u.type==="padding"?Hn.parse(u.default)||null:u.type==="variableAnchorOffsetCollection"?si.parse(u.default)||null:u.default===void 0?null:u.default:null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(n,a,u,f,_,x){return this._evaluator.globals=n,this._evaluator.feature=a,this._evaluator.featureState=u,this._evaluator.canonical=f,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(n,a,u,f,_,x){this._evaluator.globals=n,this._evaluator.feature=a||null,this._evaluator.featureState=u||null,this._evaluator.canonical=f,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new Ir(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function bu(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in Oa}function Va(i,n){const a=new Xs(Oa,el,[],n?function(f){const _={color:En,string:Mt,number:Ve,enum:Mt,boolean:_t,formatted:ls,padding:Es,resolvedImage:Zi,variableAnchorOffsetCollection:re};return f.type==="array"?N(_[f.value]||St,f.length):_[f.type]}(n):void 0),u=a.parse(i,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?_u(new wu(u,n)):Ba(a.errors)}class $a{constructor(n,a){this.kind=n,this._styleExpression=a,this.isStateDependent=n!=="constant"&&!Na(a.expression)}evaluateWithoutErrorHandling(n,a,u,f,_,x){return this._styleExpression.evaluateWithoutErrorHandling(n,a,u,f,_,x)}evaluate(n,a,u,f,_,x){return this._styleExpression.evaluate(n,a,u,f,_,x)}}class qa{constructor(n,a,u,f){this.kind=n,this.zoomStops=u,this._styleExpression=a,this.isStateDependent=n!=="camera"&&!Na(a.expression),this.interpolationType=f}evaluateWithoutErrorHandling(n,a,u,f,_,x){return this._styleExpression.evaluateWithoutErrorHandling(n,a,u,f,_,x)}evaluate(n,a,u,f,_,x){return this._styleExpression.evaluate(n,a,u,f,_,x)}interpolationFactor(n,a,u){return this.interpolationType?An.interpolationFactor(this.interpolationType,n,a,u):0}}function xh(i,n){const a=Va(i,n);if(a.result==="error")return a;const u=a.value.expression,f=tl(u);if(!f&&!ja(n))return Ba([new vn("","data expressions not supported")]);const _=rl(u,["zoom"]);if(!_&&!qf(n))return Ba([new vn("","zoom expressions not supported")]);const x=nl(u);return x||_?x instanceof vn?Ba([x]):x instanceof An&&!vh(n)?Ba([new vn("",'"interpolate" expressions cannot be used with this property')]):_u(x?new qa(f?"camera":"composite",a.value,x.labels,x instanceof An?x.interpolation:void 0):new $a(f?"constant":"source",a.value)):Ba([new vn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Za{constructor(n,a){this._parameters=n,this._specification=a,Vi(this,Zf(this._parameters,this._specification))}static deserialize(n){return new Za(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function nl(i){let n=null;if(i instanceof Ps)n=nl(i.result);else if(i instanceof cu){for(const a of i.args)if(n=nl(a),n)break}else(i instanceof La||i instanceof An)&&i.input instanceof ai&&i.input.name==="zoom"&&(n=i);return n instanceof vn||i.eachChild(a=>{const u=nl(a);u instanceof vn?n=u:!n&&u?n=new vn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&u&&n!==u&&(n=new vn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}function Su(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const n of i.slice(1))if(!Su(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}const ku={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function wh(i){if(i==null)return{filter:()=>!0,needGeometry:!1};Su(i)||(i=Tu(i));const n=Va(i,ku);if(n.result==="error")throw new Error(n.value.map(a=>`${a.key}: ${a.message}`).join(", "));return{filter:(a,u,f)=>n.value.evaluate(a,u,{},f),needGeometry:Xf(i)}}function $g(i,n){return i<n?-1:i>n?1:0}function Xf(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let n=1;n<i.length;n++)if(Xf(i[n]))return!0;return!1}function Tu(i){if(!i)return!0;const n=i[0];return i.length<=1?n!=="any":n==="=="?bh(i[1],i[2],"=="):n==="!="?nn(bh(i[1],i[2],"==")):n==="<"||n===">"||n==="<="||n===">="?bh(i[1],i[2],n):n==="any"?(a=i.slice(1),["any"].concat(a.map(Tu))):n==="all"?["all"].concat(i.slice(1).map(Tu)):n==="none"?["all"].concat(i.slice(1).map(Tu).map(nn)):n==="in"?il(i[1],i.slice(2)):n==="!in"?nn(il(i[1],i.slice(2))):n==="has"?sl(i[1]):n!=="!has"||nn(sl(i[1]));var a}function bh(i,n,a){switch(i){case"$type":return[`filter-type-${a}`,n];case"$id":return[`filter-id-${a}`,n];default:return[`filter-${a}`,i,n]}}function il(i,n){if(n.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(a=>typeof a!=typeof n[0])?["filter-in-large",i,["literal",n.sort($g)]]:["filter-in-small",i,["literal",n]]}}function sl(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function nn(i){return["!",i]}function na(i){const n=typeof i;if(n==="number"||n==="boolean"||n==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let f="[";for(const _ of i)f+=`${na(_)},`;return`${f}]`}const a=Object.keys(i).sort();let u="{";for(let f=0;f<a.length;f++)u+=`${JSON.stringify(a[f])}:${na(i[a[f]])},`;return`${u}}`}function Kf(i){let n="";for(const a of _n)n+=`/${na(i[a])}`;return n}function Yf(i){const n=i.value;return n?[new Oe(i.key,n,"constants have been deprecated as of v8")]:[]}function kr(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Ti(i){if(Array.isArray(i))return i.map(Ti);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const n={};for(const a in i)n[a]=Ti(i[a]);return n}return kr(i)}function Wn(i){const n=i.key,a=i.value,u=i.valueSpec||{},f=i.objectElementValidators||{},_=i.style,x=i.styleSpec,w=i.validateSpec;let S=[];const C=Vt(a);if(C!=="object")return[new Oe(n,a,`object expected, ${C} found`)];for(const E in a){const A=E.split(".")[0],F=u[A]||u["*"];let B;if(f[A])B=f[A];else if(u[A])B=w;else if(f["*"])B=f["*"];else{if(!u["*"]){S.push(new Oe(n,a[E],`unknown property "${E}"`));continue}B=w}S=S.concat(B({key:(n&&`${n}.`)+E,value:a[E],valueSpec:F,style:_,styleSpec:x,object:a,objectKey:E,validateSpec:w},a))}for(const E in u)f[E]||u[E].required&&u[E].default===void 0&&a[E]===void 0&&S.push(new Oe(n,a,`missing required property "${E}"`));return S}function al(i){const n=i.value,a=i.valueSpec,u=i.style,f=i.styleSpec,_=i.key,x=i.arrayElementValidator||i.validateSpec;if(Vt(n)!=="array")return[new Oe(_,n,`array expected, ${Vt(n)} found`)];if(a.length&&n.length!==a.length)return[new Oe(_,n,`array length ${a.length} expected, length ${n.length} found`)];if(a["min-length"]&&n.length<a["min-length"])return[new Oe(_,n,`array length at least ${a["min-length"]} expected, length ${n.length} found`)];let w={type:a.value,values:a.values};f.$version<7&&(w.function=a.function),Vt(a.value)==="object"&&(w=a.value);let S=[];for(let C=0;C<n.length;C++)S=S.concat(x({array:n,arrayIndex:C,value:n[C],valueSpec:w,validateSpec:i.validateSpec,style:u,styleSpec:f,key:`${_}[${C}]`}));return S}function Sh(i){const n=i.key,a=i.value,u=i.valueSpec;let f=Vt(a);return f==="number"&&a!=a&&(f="NaN"),f!=="number"?[new Oe(n,a,`number expected, ${f} found`)]:"minimum"in u&&a<u.minimum?[new Oe(n,a,`${a} is less than the minimum value ${u.minimum}`)]:"maximum"in u&&a>u.maximum?[new Oe(n,a,`${a} is greater than the maximum value ${u.maximum}`)]:[]}function Cu(i){const n=i.valueSpec,a=kr(i.value.type);let u,f,_,x={};const w=a!=="categorical"&&i.value.property===void 0,S=!w,C=Vt(i.value.stops)==="array"&&Vt(i.value.stops[0])==="array"&&Vt(i.value.stops[0][0])==="object",E=Wn({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(B){if(a==="identity")return[new Oe(B.key,B.value,'identity function may not have a "stops" property')];let V=[];const $=B.value;return V=V.concat(al({key:B.key,value:$,valueSpec:B.valueSpec,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,arrayElementValidator:A})),Vt($)==="array"&&$.length===0&&V.push(new Oe(B.key,$,"array must have at least one stop")),V},default:function(B){return B.validateSpec({key:B.key,value:B.value,valueSpec:n,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec})}}});return a==="identity"&&w&&E.push(new Oe(i.key,i.value,'missing required property "property"')),a==="identity"||i.value.stops||E.push(new Oe(i.key,i.value,'missing required property "stops"')),a==="exponential"&&i.valueSpec.expression&&!vh(i.valueSpec)&&E.push(new Oe(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(S&&!ja(i.valueSpec)?E.push(new Oe(i.key,i.value,"property functions not supported")):w&&!qf(i.valueSpec)&&E.push(new Oe(i.key,i.value,"zoom functions not supported"))),a!=="categorical"&&!C||i.value.property!==void 0||E.push(new Oe(i.key,i.value,'"property" property is required')),E;function A(B){let V=[];const $=B.value,Y=B.key;if(Vt($)!=="array")return[new Oe(Y,$,`array expected, ${Vt($)} found`)];if($.length!==2)return[new Oe(Y,$,`array length 2 expected, length ${$.length} found`)];if(C){if(Vt($[0])!=="object")return[new Oe(Y,$,`object expected, ${Vt($[0])} found`)];if($[0].zoom===void 0)return[new Oe(Y,$,"object stop key must have zoom")];if($[0].value===void 0)return[new Oe(Y,$,"object stop key must have value")];if(_&&_>kr($[0].zoom))return[new Oe(Y,$[0].zoom,"stop zoom values must appear in ascending order")];kr($[0].zoom)!==_&&(_=kr($[0].zoom),f=void 0,x={}),V=V.concat(Wn({key:`${Y}[0]`,value:$[0],valueSpec:{zoom:{}},validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,objectElementValidators:{zoom:Sh,value:F}}))}else V=V.concat(F({key:`${Y}[0]`,value:$[0],validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec},$));return bu(Ti($[1]))?V.concat([new Oe(`${Y}[1]`,$[1],"expressions are not allowed in function stops.")]):V.concat(B.validateSpec({key:`${Y}[1]`,value:$[1],valueSpec:n,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec}))}function F(B,V){const $=Vt(B.value),Y=kr(B.value),ne=B.value!==null?B.value:V;if(u){if($!==u)return[new Oe(B.key,ne,`${$} stop domain type must match previous stop domain type ${u}`)]}else u=$;if($!=="number"&&$!=="string"&&$!=="boolean")return[new Oe(B.key,ne,"stop domain value must be a number, string, or boolean")];if($!=="number"&&a!=="categorical"){let xe=`number expected, ${$} found`;return ja(n)&&a===void 0&&(xe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Oe(B.key,ne,xe)]}return a!=="categorical"||$!=="number"||isFinite(Y)&&Math.floor(Y)===Y?a!=="categorical"&&$==="number"&&f!==void 0&&Y<f?[new Oe(B.key,ne,"stop domain values must appear in ascending order")]:(f=Y,a==="categorical"&&Y in x?[new Oe(B.key,ne,"stop domain values must be unique")]:(x[Y]=!0,[])):[new Oe(B.key,ne,`integer expected, found ${Y}`)]}}function Ha(i){const n=(i.expressionContext==="property"?xh:Va)(Ti(i.value),i.valueSpec);if(n.result==="error")return n.value.map(u=>new Oe(`${i.key}${u.key}`,i.value,u.message));const a=n.value.expression||n.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!a.outputDefined())return[new Oe(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Na(a))return[new Oe(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!Na(a))return[new Oe(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!rl(a,["zoom","feature-state"]))return[new Oe(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!tl(a))return[new Oe(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function cs(i){const n=i.key,a=i.value,u=i.valueSpec,f=[];return Array.isArray(u.values)?u.values.indexOf(kr(a))===-1&&f.push(new Oe(n,a,`expected one of [${u.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(u.values).indexOf(kr(a))===-1&&f.push(new Oe(n,a,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(a)} found`)),f}function kh(i){return Su(Ti(i.value))?Ha(Vi({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Mu(i)}function Mu(i){const n=i.value,a=i.key;if(Vt(n)!=="array")return[new Oe(a,n,`array expected, ${Vt(n)} found`)];const u=i.styleSpec;let f,_=[];if(n.length<1)return[new Oe(a,n,"filter array must have at least 1 element")];switch(_=_.concat(cs({key:`${a}[0]`,value:n[0],valueSpec:u.filter_operator,style:i.style,styleSpec:i.styleSpec})),kr(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&kr(n[1])==="$type"&&_.push(new Oe(a,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&_.push(new Oe(a,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(f=Vt(n[1]),f!=="string"&&_.push(new Oe(`${a}[1]`,n[1],`string expected, ${f} found`)));for(let x=2;x<n.length;x++)f=Vt(n[x]),kr(n[1])==="$type"?_=_.concat(cs({key:`${a}[${x}]`,value:n[x],valueSpec:u.geometry_type,style:i.style,styleSpec:i.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&_.push(new Oe(`${a}[${x}]`,n[x],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let x=1;x<n.length;x++)_=_.concat(Mu({key:`${a}[${x}]`,value:n[x],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":f=Vt(n[1]),n.length!==2?_.push(new Oe(a,n,`filter array for "${n[0]}" operator must have 2 elements`)):f!=="string"&&_.push(new Oe(`${a}[1]`,n[1],`string expected, ${f} found`))}return _}function Th(i,n){const a=i.key,u=i.validateSpec,f=i.style,_=i.styleSpec,x=i.value,w=i.objectKey,S=_[`${n}_${i.layerType}`];if(!S)return[];const C=w.match(/^(.*)-transition$/);if(n==="paint"&&C&&S[C[1]]&&S[C[1]].transition)return u({key:a,value:x,valueSpec:_.transition,style:f,styleSpec:_});const E=i.valueSpec||S[w];if(!E)return[new Oe(a,x,`unknown property "${w}"`)];let A;if(Vt(x)==="string"&&ja(E)&&!E.tokens&&(A=/^{([^}]+)}$/.exec(x)))return[new Oe(a,x,`"${w}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(A[1])} }\`.`)];const F=[];return i.layerType==="symbol"&&(w==="text-field"&&f&&!f.glyphs&&F.push(new Oe(a,x,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&vu(Ti(x))&&kr(x.type)==="identity"&&F.push(new Oe(a,x,'"text-font" does not support identity functions'))),F.concat(u({key:i.key,value:x,valueSpec:E,style:f,styleSpec:_,expressionContext:"property",propertyType:n,propertyKey:w}))}function Iu(i){return Th(i,"paint")}function Ch(i){return Th(i,"layout")}function Mh(i){let n=[];const a=i.value,u=i.key,f=i.style,_=i.styleSpec;a.type||a.ref||n.push(new Oe(u,a,'either "type" or "ref" is required'));let x=kr(a.type);const w=kr(a.ref);if(a.id){const S=kr(a.id);for(let C=0;C<i.arrayIndex;C++){const E=f.layers[C];kr(E.id)===S&&n.push(new Oe(u,a.id,`duplicate layer id "${a.id}", previously used at line ${E.id.__line__}`))}}if("ref"in a){let S;["type","source","source-layer","filter","layout"].forEach(C=>{C in a&&n.push(new Oe(u,a[C],`"${C}" is prohibited for ref layers`))}),f.layers.forEach(C=>{kr(C.id)===w&&(S=C)}),S?S.ref?n.push(new Oe(u,a.ref,"ref cannot reference another ref layer")):x=kr(S.type):n.push(new Oe(u,a.ref,`ref layer "${w}" not found`))}else if(x!=="background")if(a.source){const S=f.sources&&f.sources[a.source],C=S&&kr(S.type);S?C==="vector"&&x==="raster"?n.push(new Oe(u,a.source,`layer "${a.id}" requires a raster source`)):C!=="raster-dem"&&x==="hillshade"?n.push(new Oe(u,a.source,`layer "${a.id}" requires a raster-dem source`)):C==="raster"&&x!=="raster"?n.push(new Oe(u,a.source,`layer "${a.id}" requires a vector source`)):C!=="vector"||a["source-layer"]?C==="raster-dem"&&x!=="hillshade"?n.push(new Oe(u,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!a.paint||!a.paint["line-gradient"]||C==="geojson"&&S.lineMetrics||n.push(new Oe(u,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new Oe(u,a,`layer "${a.id}" must specify a "source-layer"`)):n.push(new Oe(u,a.source,`source "${a.source}" not found`))}else n.push(new Oe(u,a,'missing required property "source"'));return n=n.concat(Wn({key:u,value:a,valueSpec:_.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${u}.type`,value:a.type,valueSpec:_.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:a,objectKey:"type"}),filter:kh,layout:S=>Wn({layer:a,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":C=>Ch(Vi({layerType:x},C))}}),paint:S=>Wn({layer:a,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":C=>Iu(Vi({layerType:x},C))}})}})),n}function ia(i){const n=i.value,a=i.key,u=Vt(n);return u!=="string"?[new Oe(a,n,`string expected, ${u} found`)]:[]}const Eu={promoteId:function({key:i,value:n}){if(Vt(n)==="string")return ia({key:i,value:n});{const a=[];for(const u in n)a.push(...ia({key:`${i}.${u}`,value:n[u]}));return a}}};function ol(i){const n=i.value,a=i.key,u=i.styleSpec,f=i.style,_=i.validateSpec;if(!n.type)return[new Oe(a,n,'"type" is required')];const x=kr(n.type);let w;switch(x){case"vector":case"raster":return w=Wn({key:a,value:n,valueSpec:u[`source_${x.replace("-","_")}`],style:i.style,styleSpec:u,objectElementValidators:Eu,validateSpec:_}),w;case"raster-dem":return w=function(S){var C;const E=(C=S.sourceName)!==null&&C!==void 0?C:"",A=S.value,F=S.styleSpec,B=F.source_raster_dem,V=S.style;let $=[];const Y=Vt(A);if(A===void 0)return $;if(Y!=="object")return $.push(new Oe("source_raster_dem",A,`object expected, ${Y} found`)),$;const ne=kr(A.encoding)==="custom",xe=["redFactor","greenFactor","blueFactor","baseShift"],ue=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const _e in A)!ne&&xe.includes(_e)?$.push(new Oe(_e,A[_e],`In "${E}": "${_e}" is only valid when "encoding" is set to "custom". ${ue} encoding found`)):B[_e]?$=$.concat(S.validateSpec({key:_e,value:A[_e],valueSpec:B[_e],validateSpec:S.validateSpec,style:V,styleSpec:F})):$.push(new Oe(_e,A[_e],`unknown property "${_e}"`));return $}({sourceName:a,value:n,style:i.style,styleSpec:u,validateSpec:_}),w;case"geojson":if(w=Wn({key:a,value:n,valueSpec:u.source_geojson,style:f,styleSpec:u,validateSpec:_,objectElementValidators:Eu}),n.cluster)for(const S in n.clusterProperties){const[C,E]=n.clusterProperties[S],A=typeof C=="string"?[C,["accumulated"],["get",S]]:C;w.push(...Ha({key:`${a}.${S}.map`,value:E,expressionContext:"cluster-map"})),w.push(...Ha({key:`${a}.${S}.reduce`,value:A,expressionContext:"cluster-reduce"}))}return w;case"video":return Wn({key:a,value:n,valueSpec:u.source_video,style:f,validateSpec:_,styleSpec:u});case"image":return Wn({key:a,value:n,valueSpec:u.source_image,style:f,validateSpec:_,styleSpec:u});case"canvas":return[new Oe(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return cs({key:`${a}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Ih(i){const n=i.value,a=i.styleSpec,u=a.light,f=i.style;let _=[];const x=Vt(n);if(n===void 0)return _;if(x!=="object")return _=_.concat([new Oe("light",n,`object expected, ${x} found`)]),_;for(const w in n){const S=w.match(/^(.*)-transition$/);_=_.concat(S&&u[S[1]]&&u[S[1]].transition?i.validateSpec({key:w,value:n[w],valueSpec:a.transition,validateSpec:i.validateSpec,style:f,styleSpec:a}):u[w]?i.validateSpec({key:w,value:n[w],valueSpec:u[w],validateSpec:i.validateSpec,style:f,styleSpec:a}):[new Oe(w,n[w],`unknown property "${w}"`)])}return _}function Eh(i){const n=i.value,a=i.styleSpec,u=a.sky,f=i.style,_=Vt(n);if(n===void 0)return[];if(_!=="object")return[new Oe("sky",n,`object expected, ${_} found`)];let x=[];for(const w in n)x=x.concat(u[w]?i.validateSpec({key:w,value:n[w],valueSpec:u[w],style:f,styleSpec:a}):[new Oe(w,n[w],`unknown property "${w}"`)]);return x}function Ph(i){const n=i.value,a=i.styleSpec,u=a.terrain,f=i.style;let _=[];const x=Vt(n);if(n===void 0)return _;if(x!=="object")return _=_.concat([new Oe("terrain",n,`object expected, ${x} found`)]),_;for(const w in n)_=_.concat(u[w]?i.validateSpec({key:w,value:n[w],valueSpec:u[w],validateSpec:i.validateSpec,style:f,styleSpec:a}):[new Oe(w,n[w],`unknown property "${w}"`)]);return _}function Ah(i){let n=[];const a=i.value,u=i.key;if(Array.isArray(a)){const f=[],_=[];for(const x in a)a[x].id&&f.includes(a[x].id)&&n.push(new Oe(u,a,`all the sprites' ids must be unique, but ${a[x].id} is duplicated`)),f.push(a[x].id),a[x].url&&_.includes(a[x].url)&&n.push(new Oe(u,a,`all the sprites' URLs must be unique, but ${a[x].url} is duplicated`)),_.push(a[x].url),n=n.concat(Wn({key:`${u}[${x}]`,value:a[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return n}return ia({key:u,value:a})}const Pu={"*":()=>[],array:al,boolean:function(i){const n=i.value,a=i.key,u=Vt(n);return u!=="boolean"?[new Oe(a,n,`boolean expected, ${u} found`)]:[]},number:Sh,color:function(i){const n=i.key,a=i.value,u=Vt(a);return u!=="string"?[new Oe(n,a,`color expected, ${u} found`)]:Jt.parse(String(a))?[]:[new Oe(n,a,`color expected, "${a}" found`)]},constants:Yf,enum:cs,filter:kh,function:Cu,layer:Mh,object:Wn,source:ol,light:Ih,sky:Eh,terrain:Ph,projection:function(i){const n=i.value,a=i.styleSpec,u=a.projection,f=i.style,_=Vt(n);if(n===void 0)return[];if(_!=="object")return[new Oe("projection",n,`object expected, ${_} found`)];let x=[];for(const w in n)x=x.concat(u[w]?i.validateSpec({key:w,value:n[w],valueSpec:u[w],style:f,styleSpec:a}):[new Oe(w,n[w],`unknown property "${w}"`)]);return x},string:ia,formatted:function(i){return ia(i).length===0?[]:Ha(i)},resolvedImage:function(i){return ia(i).length===0?[]:Ha(i)},padding:function(i){const n=i.key,a=i.value;if(Vt(a)==="array"){if(a.length<1||a.length>4)return[new Oe(n,a,`padding requires 1 to 4 values; ${a.length} values found`)];const u={type:"number"};let f=[];for(let _=0;_<a.length;_++)f=f.concat(i.validateSpec({key:`${n}[${_}]`,value:a[_],validateSpec:i.validateSpec,valueSpec:u}));return f}return Sh({key:n,value:a,valueSpec:{}})},variableAnchorOffsetCollection:function(i){const n=i.key,a=i.value,u=Vt(a),f=i.styleSpec;if(u!=="array"||a.length<1||a.length%2!=0)return[new Oe(n,a,"variableAnchorOffsetCollection requires a non-empty array of even length")];let _=[];for(let x=0;x<a.length;x+=2)_=_.concat(cs({key:`${n}[${x}]`,value:a[x],valueSpec:f.layout_symbol["text-anchor"]})),_=_.concat(al({key:`${n}[${x+1}]`,value:a[x+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:f}));return _},sprite:Ah};function ll(i){const n=i.value,a=i.valueSpec,u=i.styleSpec;return i.validateSpec=ll,a.expression&&vu(kr(n))?Cu(i):a.expression&&bu(Ti(n))?Ha(i):a.type&&Pu[a.type]?Pu[a.type](i):Wn(Vi({},i,{valueSpec:a.type?u[a.type]:a}))}function Qf(i){const n=i.value,a=i.key,u=ia(i);return u.length||(n.indexOf("{fontstack}")===-1&&u.push(new Oe(a,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&u.push(new Oe(a,n,'"glyphs" url must include a "{range}" token'))),u}function oi(i,n=be){let a=[];return a=a.concat(ll({key:"",value:i,valueSpec:n.$root,styleSpec:n,style:i,validateSpec:ll,objectElementValidators:{glyphs:Qf,"*":()=>[]}})),i.constants&&(a=a.concat(Yf({key:"constants",value:i.constants}))),zh(a)}function Gi(i){return function(n){return i({...n,validateSpec:ll})}}function zh(i){return[].concat(i).sort((n,a)=>n.line-a.line)}function Ci(i){return function(...n){return zh(i.apply(this,n))}}oi.source=Ci(Gi(ol)),oi.sprite=Ci(Gi(Ah)),oi.glyphs=Ci(Gi(Qf)),oi.light=Ci(Gi(Ih)),oi.sky=Ci(Gi(Eh)),oi.terrain=Ci(Gi(Ph)),oi.layer=Ci(Gi(Mh)),oi.filter=Ci(Gi(kh)),oi.paintProperty=Ci(Gi(Iu)),oi.layoutProperty=Ci(Gi(Ch));const sa=oi,qg=sa.light,Zg=sa.sky,Jf=sa.paintProperty,ep=sa.layoutProperty;function Dh(i,n){let a=!1;if(n&&n.length)for(const u of n)i.fire(new Nt(new Error(u.message))),a=!0;return a}class Ga{constructor(n,a,u){const f=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;const x=new Int32Array(this.arrayBuffer);n=x[0],this.d=(a=x[1])+2*(u=x[2]);for(let S=0;S<this.d*this.d;S++){const C=x[3+S],E=x[3+S+1];f.push(C===E?null:x.subarray(C,E))}const w=x[3+f.length+1];this.keys=x.subarray(x[3+f.length],w),this.bboxes=x.subarray(w),this.insert=this._insertReadonly}else{this.d=a+2*u;for(let x=0;x<this.d*this.d;x++)f.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=n,this.padding=u,this.scale=a/n,this.uid=0;const _=u/a*n;this.min=-_,this.max=n+_}insert(n,a,u,f,_){this._forEachCell(a,u,f,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(n),this.bboxes.push(a),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(n,a,u,f,_,x){this.cells[_].push(x)}query(n,a,u,f,_){const x=this.min,w=this.max;if(n<=x&&a<=x&&w<=u&&w<=f&&!_)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(n,a,u,f,this._queryCell,S,{},_),S}}_queryCell(n,a,u,f,_,x,w,S){const C=this.cells[_];if(C!==null){const E=this.keys,A=this.bboxes;for(let F=0;F<C.length;F++){const B=C[F];if(w[B]===void 0){const V=4*B;(S?S(A[V+0],A[V+1],A[V+2],A[V+3]):n<=A[V+2]&&a<=A[V+3]&&u>=A[V+0]&&f>=A[V+1])?(w[B]=!0,x.push(E[B])):w[B]=!1}}}}_forEachCell(n,a,u,f,_,x,w,S){const C=this._convertToCellCoord(n),E=this._convertToCellCoord(a),A=this._convertToCellCoord(u),F=this._convertToCellCoord(f);for(let B=C;B<=A;B++)for(let V=E;V<=F;V++){const $=this.d*V+B;if((!S||S(this._convertFromCellCoord(B),this._convertFromCellCoord(V),this._convertFromCellCoord(B+1),this._convertFromCellCoord(V+1)))&&_.call(this,n,a,u,f,$,x,w,S))return}}_convertFromCellCoord(n){return(n-this.padding)/this.scale}_convertToCellCoord(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const n=this.cells,a=3+this.cells.length+1+1;let u=0;for(let x=0;x<this.cells.length;x++)u+=this.cells[x].length;const f=new Int32Array(a+u+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;let _=a;for(let x=0;x<n.length;x++){const w=n[x];f[3+x]=_,f.set(w,_),_+=w.length}return f[3+n.length]=_,f.set(this.keys,_),_+=this.keys.length,f[3+n.length+1]=_,f.set(this.bboxes,_),_+=this.bboxes.length,f.buffer}static serialize(n,a){const u=n.toArrayBuffer();return a&&a.push(u),{buffer:u}}static deserialize(n){return new Ga(n.buffer)}}const li={};function Qe(i,n,a={}){if(li[i])throw new Error(`${i} is already registered.`);Object.defineProperty(n,"_classRegistryKey",{value:i,writeable:!1}),li[i]={klass:n,omit:a.omit||[],shallow:a.shallow||[]}}Qe("Object",Object),Qe("TransferableGridIndex",Ga),Qe("Color",Jt),Qe("Error",Error),Qe("AJAXError",Dr),Qe("ResolvedImage",Gn),Qe("StylePropertyFunction",Za),Qe("StyleExpression",wu,{omit:["_evaluator"]}),Qe("ZoomDependentExpression",qa),Qe("ZoomConstantExpression",$a),Qe("CompoundExpression",ai,{omit:["_evaluate"]});for(const i in Oa)Oa[i]._classRegistryKey||Qe(`Expression_${i}`,Oa[i]);function Au(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Lh(i){return i.$name||i.constructor._classRegistryKey}function tp(i){return!function(n){if(n===null||typeof n!="object")return!1;const a=Lh(n);return!(!a||a==="Object")}(i)&&(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error||Au(i)||Mr(i)||ArrayBuffer.isView(i)||i instanceof ImageData)}function Wa(i,n){if(tp(i))return(Au(i)||Mr(i))&&n&&n.push(i),ArrayBuffer.isView(i)&&n&&n.push(i.buffer),i instanceof ImageData&&n&&n.push(i.data.buffer),i;if(Array.isArray(i)){const _=[];for(const x of i)_.push(Wa(x,n));return _}if(typeof i!="object")throw new Error("can't serialize object of type "+typeof i);const a=Lh(i);if(!a)throw new Error(`can't serialize object of unregistered class ${i.constructor.name}`);if(!li[a])throw new Error(`${a} is not registered.`);const{klass:u}=li[a],f=u.serialize?u.serialize(i,n):{};if(u.serialize){if(n&&f===n[n.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const _ in i){if(!i.hasOwnProperty(_)||li[a].omit.indexOf(_)>=0)continue;const x=i[_];f[_]=li[a].shallow.indexOf(_)>=0?x:Wa(x,n)}i instanceof Error&&(f.message=i.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(f.$name=a),f}function Xa(i){if(tp(i))return i;if(Array.isArray(i))return i.map(Xa);if(typeof i!="object")throw new Error("can't deserialize object of type "+typeof i);const n=Lh(i)||"Object";if(!li[n])throw new Error(`can't deserialize unregistered class ${n}`);const{klass:a}=li[n];if(!a)throw new Error(`can't deserialize unregistered class ${n}`);if(a.deserialize)return a.deserialize(i);const u=Object.create(a.prototype);for(const f of Object.keys(i)){if(f==="$name")continue;const _=i[f];u[f]=li[n].shallow.indexOf(f)>=0?_:Xa(_)}return u}class Rh{constructor(){this.first=!0}update(n,a){const u=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=a),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=u,!0))}}const Ft={"Latin-1 Supplement":i=>i>=128&&i<=255,"Hangul Jamo":i=>i>=4352&&i<=4607,Khmer:i=>i>=6016&&i<=6143,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Katakana:i=>i>=12448&&i<=12543,Kanbun:i=>i>=12688&&i<=12703,"CJK Strokes":i=>i>=12736&&i<=12783,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"Private Use Area":i=>i>=57344&&i<=63743,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function Fh(i){for(const n of i)if(Nh(n.charCodeAt(0)))return!0;return!1}function Hg(i){for(const n of i)if(!Ka(n.charCodeAt(0)))return!1;return!0}function Oh(i){const n=i.map(a=>{try{return new RegExp(`\\p{sc=${a}}`,"u").source}catch{return null}}).filter(a=>a);return new RegExp(n.join("|"),"u")}const Gg=Oh(["Arab","Dupl","Mong","Ougr","Syrc"]);function Ka(i){return!Gg.test(String.fromCodePoint(i))}const rp=Oh(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Nh(i){return!(i!==746&&i!==747&&(i<4352||!(Ft["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||Ft["CJK Compatibility"](i)||Ft["CJK Strokes"](i)||!(!Ft["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Ft["Enclosed CJK Letters and Months"](i)||Ft["Ideographic Description Characters"](i)||Ft.Kanbun(i)||Ft.Katakana(i)&&i!==12540||!(!Ft["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Ft["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||Ft["Vertical Forms"](i)||Ft["Yijing Hexagram Symbols"](i)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(i))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(i))||rp.test(String.fromCodePoint(i)))))}function np(i){return!(Nh(i)||function(n){return!!(Ft["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Ft["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Ft["Letterlike Symbols"](n)||Ft["Number Forms"](n)||Ft["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Ft["Control Pictures"](n)&&n!==9251||Ft["Optical Character Recognition"](n)||Ft["Enclosed Alphanumerics"](n)||Ft["Geometric Shapes"](n)||Ft["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Ft["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Ft["CJK Symbols and Punctuation"](n)||Ft.Katakana(n)||Ft["Private Use Area"](n)||Ft["CJK Compatibility Forms"](n)||Ft["Small Form Variants"](n)||Ft["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(i))}const Wg=Oh(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Bh(i){return Wg.test(String.fromCodePoint(i))}function Xg(i,n){return!(!n&&Bh(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||Ft.Khmer(i))}function Kg(i){for(const n of i)if(Bh(n.charCodeAt(0)))return!0;return!1}const Xn=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(i){this.pluginStatus=i.pluginStatus,this.pluginURL=i.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(i){this.applyArabicShaping=i.applyArabicShaping,this.processBidirectionalText=i.processBidirectionalText,this.processStyledBidirectionalText=i.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class ur{constructor(n,a){this.zoom=n,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.zoomHistory=a.zoomHistory,this.transition=a.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Rh,this.transition={})}isSupportedScript(n){return function(a,u){for(const f of a)if(!Xg(f.charCodeAt(0),u))return!1;return!0}(n,Xn.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,a=n-Math.floor(n),u=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*a}}}class Ya{constructor(n,a){this.property=n,this.value=a,this.expression=function(u,f){if(vu(u))return new Za(u,f);if(bu(u)){const _=xh(u,f);if(_.result==="error")throw new Error(_.value.map(x=>`${x.key}: ${x.message}`).join(", "));return _.value}{let _=u;return f.type==="color"&&typeof u=="string"?_=Jt.parse(u):f.type!=="padding"||typeof u!="number"&&!Array.isArray(u)?f.type==="variableAnchorOffsetCollection"&&Array.isArray(u)&&(_=si.parse(u)):_=Hn.parse(u),{kind:"constant",evaluate:()=>_}}}(a===void 0?n.specification.default:a,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,a,u){return this.property.possiblyEvaluate(this,n,a,u)}}class zu{constructor(n){this.property=n,this.value=new Ya(n,void 0)}transitioned(n,a){return new ip(this.property,this.value,a,ze({},n.transition,this.transition),n.now)}untransitioned(){return new ip(this.property,this.value,null,{},0)}}class Du{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return ht(this._values[n].value.value)}setValue(n,a){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new zu(this._values[n].property)),this._values[n].value=new Ya(this._values[n].property,a===null?void 0:ht(a))}getTransition(n){return ht(this._values[n].transition)}setTransition(n,a){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new zu(this._values[n].property)),this._values[n].transition=ht(a)||void 0}serialize(){const n={};for(const a of Object.keys(this._values)){const u=this.getValue(a);u!==void 0&&(n[a]=u);const f=this.getTransition(a);f!==void 0&&(n[`${a}-transition`]=f)}return n}transitioned(n,a){const u=new ul(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].transitioned(n,a._values[f]);return u}untransitioned(){const n=new ul(this._properties);for(const a of Object.keys(this._values))n._values[a]=this._values[a].untransitioned();return n}}class ip{constructor(n,a,u,f,_){this.property=n,this.value=a,this.begin=_+f.delay||0,this.end=this.begin+f.duration||0,n.specification.transition&&(f.delay||f.duration)&&(this.prior=u)}possiblyEvaluate(n,a,u){const f=n.now||0,_=this.value.possiblyEvaluate(n,a,u),x=this.prior;if(x){if(f>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(f<this.begin)return x.possiblyEvaluate(n,a,u);{const w=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(n,a,u),_,function(S){if(S<=0)return 0;if(S>=1)return 1;const C=S*S,E=C*S;return 4*(S<.5?E:3*(S-C)+E-.75)}(w))}}return _}}class ul{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,a,u){const f=new hl(this._properties);for(const _ of Object.keys(this._values))f._values[_]=this._values[_].possiblyEvaluate(n,a,u);return f}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class cl{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}hasValue(n){return this._values[n].value!==void 0}getValue(n){return ht(this._values[n].value)}setValue(n,a){this._values[n]=new Ya(this._values[n].property,a===null?void 0:ht(a))}serialize(){const n={};for(const a of Object.keys(this._values)){const u=this.getValue(a);u!==void 0&&(n[a]=u)}return n}possiblyEvaluate(n,a,u){const f=new hl(this._properties);for(const _ of Object.keys(this._values))f._values[_]=this._values[_].possiblyEvaluate(n,a,u);return f}}class Wi{constructor(n,a,u){this.property=n,this.value=a,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,a,u,f){return this.property.evaluate(this.value,this.parameters,n,a,u,f)}}class hl{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class tt{constructor(n){this.specification=n}possiblyEvaluate(n,a){if(n.isDataDriven())throw new Error("Value should not be data driven");return n.expression.evaluate(a)}interpolate(n,a,u){const f=Pn[this.specification.type];return f?f(n,a,u):n}}class gt{constructor(n,a){this.specification=n,this.overrides=a}possiblyEvaluate(n,a,u,f){return new Wi(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(a,null,{},u,f)}:n.expression,a)}interpolate(n,a,u){if(n.value.kind!=="constant"||a.value.kind!=="constant")return n;if(n.value.value===void 0||a.value.value===void 0)return new Wi(this,{kind:"constant",value:void 0},n.parameters);const f=Pn[this.specification.type];if(f){const _=f(n.value.value,a.value.value,u);return new Wi(this,{kind:"constant",value:_},n.parameters)}return n}evaluate(n,a,u,f,_,x){return n.kind==="constant"?n.value:n.evaluate(a,u,f,_,x)}}class Lu extends gt{possiblyEvaluate(n,a,u,f){if(n.value===void 0)return new Wi(this,{kind:"constant",value:void 0},a);if(n.expression.kind==="constant"){const _=n.expression.evaluate(a,null,{},u,f),x=n.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,w=this._calculate(x,x,x,a);return new Wi(this,{kind:"constant",value:w},a)}if(n.expression.kind==="camera"){const _=this._calculate(n.expression.evaluate({zoom:a.zoom-1}),n.expression.evaluate({zoom:a.zoom}),n.expression.evaluate({zoom:a.zoom+1}),a);return new Wi(this,{kind:"constant",value:_},a)}return new Wi(this,n.expression,a)}evaluate(n,a,u,f,_,x){if(n.kind==="source"){const w=n.evaluate(a,u,f,_,x);return this._calculate(w,w,w,a)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(a.zoom)-1},u,f),n.evaluate({zoom:Math.floor(a.zoom)},u,f),n.evaluate({zoom:Math.floor(a.zoom)+1},u,f),a):n.value}_calculate(n,a,u,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:n,to:a}:{from:u,to:a}}interpolate(n){return n}}class Ru{constructor(n){this.specification=n}possiblyEvaluate(n,a,u,f){if(n.value!==void 0){if(n.expression.kind==="constant"){const _=n.expression.evaluate(a,null,{},u,f);return this._calculate(_,_,_,a)}return this._calculate(n.expression.evaluate(new ur(Math.floor(a.zoom-1),a)),n.expression.evaluate(new ur(Math.floor(a.zoom),a)),n.expression.evaluate(new ur(Math.floor(a.zoom+1),a)),a)}}_calculate(n,a,u,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:n,to:a}:{from:u,to:a}}interpolate(n){return n}}class jh{constructor(n){this.specification=n}possiblyEvaluate(n,a,u,f){return!!n.expression.evaluate(a,null,{},u,f)}interpolate(){return!1}}class g{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in n){const u=n[a];u.specification.overridable&&this.overridableProperties.push(a);const f=this.defaultPropertyValues[a]=new Ya(u,void 0),_=this.defaultTransitionablePropertyValues[a]=new zu(u);this.defaultTransitioningPropertyValues[a]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=f.possiblyEvaluate({})}}}Qe("DataDrivenProperty",gt),Qe("DataConstantProperty",tt),Qe("CrossFadedDataDrivenProperty",Lu),Qe("CrossFadedProperty",Ru),Qe("ColorRampProperty",jh);const r="-transition";class o extends Lr{constructor(n,a){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1},n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),a.layout&&(this._unevaluatedLayout=new cl(a.layout)),a.paint)){this._transitionablePaint=new Du(a.paint);for(const u in n.paint)this.setPaintProperty(u,n.paint[u],{validate:!1});for(const u in n.layout)this.setLayoutProperty(u,n.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new hl(a.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,a,u={}){a!=null&&this._validate(ep,`layers.${this.id}.layout.${n}`,n,a,u)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,a):this.visibility=a)}getPaintProperty(n){return n.endsWith(r)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,a,u={}){if(a!=null&&this._validate(Jf,`layers.${this.id}.paint.${n}`,n,a,u))return!1;if(n.endsWith(r))return this._transitionablePaint.setTransition(n.slice(0,-11),a||void 0),!1;{const f=this._transitionablePaint._values[n],_=f.property.specification["property-type"]==="cross-faded-data-driven",x=f.value.isDataDriven(),w=f.value;this._transitionablePaint.setValue(n,a),this._handleSpecialPaintPropertyUpdate(n);const S=this._transitionablePaint._values[n].value;return S.isDataDriven()||x||_||this._handleOverridablePaintPropertyUpdate(n,w,S)}}_handleSpecialPaintPropertyUpdate(n){}_handleOverridablePaintPropertyUpdate(n,a,u){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,a){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,a)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),it(n,(a,u)=>!(a===void 0||u==="layout"&&!Object.keys(a).length||u==="paint"&&!Object.keys(a).length))}_validate(n,a,u,f,_={}){return(!_||_.validate!==!1)&&Dh(this,n.call(sa,{key:a,layerType:this.type,objectKey:u,value:f,styleSpec:be,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const a=this.paint.get(n);if(a instanceof Wi&&ja(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}const h={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class d{constructor(n,a){this._structArray=n,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class m{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,a){return n._trim(),a&&(n.isTransferred=!0,a.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const a=Object.create(this.prototype);return a.arrayBuffer=n.arrayBuffer,a.length=n.length,a.capacity=n.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function b(i,n=1){let a=0,u=0;return{members:i.map(f=>{const _=h[f.type].BYTES_PER_ELEMENT,x=a=k(a,Math.max(n,_)),w=f.components||1;return u=Math.max(u,_),a+=_*w,{name:f.name,type:f.type,components:w,offset:x}}),size:k(a,Math.max(u,n)),alignment:n}}function k(i,n){return Math.ceil(i/n)*n}class T extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a){const u=this.length;return this.resize(u+1),this.emplace(u,n,a)}emplace(n,a,u){const f=2*n;return this.int16[f+0]=a,this.int16[f+1]=u,n}}T.prototype.bytesPerElement=4,Qe("StructArrayLayout2i4",T);class P extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,n,a,u)}emplace(n,a,u,f){const _=3*n;return this.int16[_+0]=a,this.int16[_+1]=u,this.int16[_+2]=f,n}}P.prototype.bytesPerElement=6,Qe("StructArrayLayout3i6",P);class D extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,f){const _=this.length;return this.resize(_+1),this.emplace(_,n,a,u,f)}emplace(n,a,u,f,_){const x=4*n;return this.int16[x+0]=a,this.int16[x+1]=u,this.int16[x+2]=f,this.int16[x+3]=_,n}}D.prototype.bytesPerElement=8,Qe("StructArrayLayout4i8",D);class L extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,f,_,x){const w=this.length;return this.resize(w+1),this.emplace(w,n,a,u,f,_,x)}emplace(n,a,u,f,_,x,w){const S=6*n;return this.int16[S+0]=a,this.int16[S+1]=u,this.int16[S+2]=f,this.int16[S+3]=_,this.int16[S+4]=x,this.int16[S+5]=w,n}}L.prototype.bytesPerElement=12,Qe("StructArrayLayout2i4i12",L);class U extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,f,_,x){const w=this.length;return this.resize(w+1),this.emplace(w,n,a,u,f,_,x)}emplace(n,a,u,f,_,x,w){const S=4*n,C=8*n;return this.int16[S+0]=a,this.int16[S+1]=u,this.uint8[C+4]=f,this.uint8[C+5]=_,this.uint8[C+6]=x,this.uint8[C+7]=w,n}}U.prototype.bytesPerElement=8,Qe("StructArrayLayout2i4ub8",U);class Z extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a){const u=this.length;return this.resize(u+1),this.emplace(u,n,a)}emplace(n,a,u){const f=2*n;return this.float32[f+0]=a,this.float32[f+1]=u,n}}Z.prototype.bytesPerElement=8,Qe("StructArrayLayout2f8",Z);class H extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u,f,_,x,w,S,C,E){const A=this.length;return this.resize(A+1),this.emplace(A,n,a,u,f,_,x,w,S,C,E)}emplace(n,a,u,f,_,x,w,S,C,E,A){const F=10*n;return this.uint16[F+0]=a,this.uint16[F+1]=u,this.uint16[F+2]=f,this.uint16[F+3]=_,this.uint16[F+4]=x,this.uint16[F+5]=w,this.uint16[F+6]=S,this.uint16[F+7]=C,this.uint16[F+8]=E,this.uint16[F+9]=A,n}}H.prototype.bytesPerElement=20,Qe("StructArrayLayout10ui20",H);class ee extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u,f,_,x,w,S,C,E,A,F){const B=this.length;return this.resize(B+1),this.emplace(B,n,a,u,f,_,x,w,S,C,E,A,F)}emplace(n,a,u,f,_,x,w,S,C,E,A,F,B){const V=12*n;return this.int16[V+0]=a,this.int16[V+1]=u,this.int16[V+2]=f,this.int16[V+3]=_,this.uint16[V+4]=x,this.uint16[V+5]=w,this.uint16[V+6]=S,this.uint16[V+7]=C,this.int16[V+8]=E,this.int16[V+9]=A,this.int16[V+10]=F,this.int16[V+11]=B,n}}ee.prototype.bytesPerElement=24,Qe("StructArrayLayout4i4ui4i24",ee);class ie extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,n,a,u)}emplace(n,a,u,f){const _=3*n;return this.float32[_+0]=a,this.float32[_+1]=u,this.float32[_+2]=f,n}}ie.prototype.bytesPerElement=12,Qe("StructArrayLayout3f12",ie);class se extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint32[1*n+0]=a,n}}se.prototype.bytesPerElement=4,Qe("StructArrayLayout1ul4",se);class le extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u,f,_,x,w,S,C){const E=this.length;return this.resize(E+1),this.emplace(E,n,a,u,f,_,x,w,S,C)}emplace(n,a,u,f,_,x,w,S,C,E){const A=10*n,F=5*n;return this.int16[A+0]=a,this.int16[A+1]=u,this.int16[A+2]=f,this.int16[A+3]=_,this.int16[A+4]=x,this.int16[A+5]=w,this.uint32[F+3]=S,this.uint16[A+8]=C,this.uint16[A+9]=E,n}}le.prototype.bytesPerElement=20,Qe("StructArrayLayout6i1ul2ui20",le);class K extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,f,_,x){const w=this.length;return this.resize(w+1),this.emplace(w,n,a,u,f,_,x)}emplace(n,a,u,f,_,x,w){const S=6*n;return this.int16[S+0]=a,this.int16[S+1]=u,this.int16[S+2]=f,this.int16[S+3]=_,this.int16[S+4]=x,this.int16[S+5]=w,n}}K.prototype.bytesPerElement=12,Qe("StructArrayLayout2i2i2i12",K);class de extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,f,_){const x=this.length;return this.resize(x+1),this.emplace(x,n,a,u,f,_)}emplace(n,a,u,f,_,x){const w=4*n,S=8*n;return this.float32[w+0]=a,this.float32[w+1]=u,this.float32[w+2]=f,this.int16[S+6]=_,this.int16[S+7]=x,n}}de.prototype.bytesPerElement=16,Qe("StructArrayLayout2f1f2i16",de);class ye extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,f,_,x){const w=this.length;return this.resize(w+1),this.emplace(w,n,a,u,f,_,x)}emplace(n,a,u,f,_,x,w){const S=16*n,C=4*n,E=8*n;return this.uint8[S+0]=a,this.uint8[S+1]=u,this.float32[C+1]=f,this.float32[C+2]=_,this.int16[E+6]=x,this.int16[E+7]=w,n}}ye.prototype.bytesPerElement=16,Qe("StructArrayLayout2ub2f2i16",ye);class we extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,n,a,u)}emplace(n,a,u,f){const _=3*n;return this.uint16[_+0]=a,this.uint16[_+1]=u,this.uint16[_+2]=f,n}}we.prototype.bytesPerElement=6,Qe("StructArrayLayout3ui6",we);class Ee extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,f,_,x,w,S,C,E,A,F,B,V,$,Y,ne){const xe=this.length;return this.resize(xe+1),this.emplace(xe,n,a,u,f,_,x,w,S,C,E,A,F,B,V,$,Y,ne)}emplace(n,a,u,f,_,x,w,S,C,E,A,F,B,V,$,Y,ne,xe){const ue=24*n,_e=12*n,Te=48*n;return this.int16[ue+0]=a,this.int16[ue+1]=u,this.uint16[ue+2]=f,this.uint16[ue+3]=_,this.uint32[_e+2]=x,this.uint32[_e+3]=w,this.uint32[_e+4]=S,this.uint16[ue+10]=C,this.uint16[ue+11]=E,this.uint16[ue+12]=A,this.float32[_e+7]=F,this.float32[_e+8]=B,this.uint8[Te+36]=V,this.uint8[Te+37]=$,this.uint8[Te+38]=Y,this.uint32[_e+10]=ne,this.int16[ue+22]=xe,n}}Ee.prototype.bytesPerElement=48,Qe("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ee);class Re extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,f,_,x,w,S,C,E,A,F,B,V,$,Y,ne,xe,ue,_e,Te,De,We,mt,He,qe,st,Je){const Ye=this.length;return this.resize(Ye+1),this.emplace(Ye,n,a,u,f,_,x,w,S,C,E,A,F,B,V,$,Y,ne,xe,ue,_e,Te,De,We,mt,He,qe,st,Je)}emplace(n,a,u,f,_,x,w,S,C,E,A,F,B,V,$,Y,ne,xe,ue,_e,Te,De,We,mt,He,qe,st,Je,Ye){const Ie=32*n,ot=16*n;return this.int16[Ie+0]=a,this.int16[Ie+1]=u,this.int16[Ie+2]=f,this.int16[Ie+3]=_,this.int16[Ie+4]=x,this.int16[Ie+5]=w,this.int16[Ie+6]=S,this.int16[Ie+7]=C,this.uint16[Ie+8]=E,this.uint16[Ie+9]=A,this.uint16[Ie+10]=F,this.uint16[Ie+11]=B,this.uint16[Ie+12]=V,this.uint16[Ie+13]=$,this.uint16[Ie+14]=Y,this.uint16[Ie+15]=ne,this.uint16[Ie+16]=xe,this.uint16[Ie+17]=ue,this.uint16[Ie+18]=_e,this.uint16[Ie+19]=Te,this.uint16[Ie+20]=De,this.uint16[Ie+21]=We,this.uint16[Ie+22]=mt,this.uint32[ot+12]=He,this.float32[ot+13]=qe,this.float32[ot+14]=st,this.uint16[Ie+30]=Je,this.uint16[Ie+31]=Ye,n}}Re.prototype.bytesPerElement=64,Qe("StructArrayLayout8i15ui1ul2f2ui64",Re);class Ze extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.float32[1*n+0]=a,n}}Ze.prototype.bytesPerElement=4,Qe("StructArrayLayout1f4",Ze);class Xe extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,n,a,u)}emplace(n,a,u,f){const _=3*n;return this.uint16[6*n+0]=a,this.float32[_+1]=u,this.float32[_+2]=f,n}}Xe.prototype.bytesPerElement=12,Qe("StructArrayLayout1ui2f12",Xe);class Ue extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,n,a,u)}emplace(n,a,u,f){const _=4*n;return this.uint32[2*n+0]=a,this.uint16[_+2]=u,this.uint16[_+3]=f,n}}Ue.prototype.bytesPerElement=8,Qe("StructArrayLayout1ul2ui8",Ue);class je extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a){const u=this.length;return this.resize(u+1),this.emplace(u,n,a)}emplace(n,a,u){const f=2*n;return this.uint16[f+0]=a,this.uint16[f+1]=u,n}}je.prototype.bytesPerElement=4,Qe("StructArrayLayout2ui4",je);class rt extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint16[1*n+0]=a,n}}rt.prototype.bytesPerElement=2,Qe("StructArrayLayout1ui2",rt);class wt extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,f){const _=this.length;return this.resize(_+1),this.emplace(_,n,a,u,f)}emplace(n,a,u,f,_){const x=4*n;return this.float32[x+0]=a,this.float32[x+1]=u,this.float32[x+2]=f,this.float32[x+3]=_,n}}wt.prototype.bytesPerElement=16,Qe("StructArrayLayout4f16",wt);class $e extends d{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new z(this.anchorPointX,this.anchorPointY)}}$e.prototype.size=20;class Ge extends le{get(n){return new $e(this,n)}}Qe("CollisionBoxArray",Ge);class vt extends d{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(n){this._structArray.uint8[this._pos1+37]=n}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(n){this._structArray.uint8[this._pos1+38]=n}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(n){this._structArray.uint32[this._pos4+10]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}vt.prototype.size=48;class cr extends Ee{get(n){return new vt(this,n)}}Qe("PlacedSymbolArray",cr);class Ct extends d{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(n){this._structArray.uint32[this._pos4+12]=n}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Ct.prototype.size=64;class zt extends Re{get(n){return new Ct(this,n)}}Qe("SymbolInstanceArray",zt);class hr extends Ze{getoffsetX(n){return this.float32[1*n+0]}}Qe("GlyphOffsetArray",hr);class sn extends P{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}Qe("SymbolLineVertexArray",sn);class Mi extends d{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Mi.prototype.size=12;class dr extends Xe{get(n){return new Mi(this,n)}}Qe("TextAnchorOffsetArray",dr);class zn extends d{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}zn.prototype.size=8;class wn extends Ue{get(n){return new zn(this,n)}}Qe("FeatureIndexArray",wn);class an extends T{}class bn extends T{}class Xi extends T{}class Qa extends L{}class Fu extends U{}class Ja extends Z{}class ui extends H{}class Ou extends ee{}class Uh extends ie{}class ci extends se{}class hi extends K{}class zs extends ye{}class Ii extends we{}class Kr extends je{}const on=b([{name:"a_pos",components:2,type:"Int16"}],4),{members:Kn}=on;class Ot{constructor(n=[]){this.segments=n}prepareSegment(n,a,u,f){let _=this.segments[this.segments.length-1];return n>Ot.MAX_VERTEX_ARRAY_LENGTH&&Pt(`Max vertices per segment is ${Ot.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!_||_.vertexLength+n>Ot.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==f)&&(_={vertexOffset:a.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},f!==void 0&&(_.sortKey=f),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const n of this.segments)for(const a in n.vaos)n.vaos[a].destroy()}static simpleSegment(n,a,u,f){return new Ot([{vertexOffset:n,primitiveOffset:a,vertexLength:u,primitiveLength:f,vaos:{},sortKey:0}])}}function aa(i,n){return 256*(i=Me(Math.floor(i),0,255))+Me(Math.floor(n),0,255)}Ot.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Qe("SegmentVector",Ot);const eo=b([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var to={exports:{}},sp={exports:{}};sp.exports=function(i,n){var a,u,f,_,x,w,S,C;for(u=i.length-(a=3&i.length),f=n,x=3432918353,w=461845907,C=0;C<u;)S=255&i.charCodeAt(C)|(255&i.charCodeAt(++C))<<8|(255&i.charCodeAt(++C))<<16|(255&i.charCodeAt(++C))<<24,++C,f=27492+(65535&(_=5*(65535&(f=(f^=S=(65535&(S=(S=(65535&S)*x+(((S>>>16)*x&65535)<<16)&4294967295)<<15|S>>>17))*w+(((S>>>16)*w&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(S=0,a){case 3:S^=(255&i.charCodeAt(C+2))<<16;case 2:S^=(255&i.charCodeAt(C+1))<<8;case 1:f^=S=(65535&(S=(S=(65535&(S^=255&i.charCodeAt(C)))*x+(((S>>>16)*x&65535)<<16)&4294967295)<<15|S>>>17))*w+(((S>>>16)*w&65535)<<16)&4294967295}return f^=i.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0};var Yg=sp.exports,ap={exports:{}};ap.exports=function(i,n){for(var a,u=i.length,f=n^u,_=0;u>=4;)a=1540483477*(65535&(a=255&i.charCodeAt(_)|(255&i.charCodeAt(++_))<<8|(255&i.charCodeAt(++_))<<16|(255&i.charCodeAt(++_))<<24))+((1540483477*(a>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),u-=4,++_;switch(u){case 3:f^=(255&i.charCodeAt(_+2))<<16;case 2:f^=(255&i.charCodeAt(_+1))<<8;case 1:f=1540483477*(65535&(f^=255&i.charCodeAt(_)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0};var Ds=Yg,op=ap.exports;to.exports=Ds,to.exports.murmur3=Ds,to.exports.murmur2=op;var Nu=M(to.exports);class dl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,a,u,f){this.ids.push(Bu(n)),this.positions.push(a,u,f)}getPositions(n){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const a=Bu(n);let u=0,f=this.ids.length-1;for(;u<f;){const x=u+f>>1;this.ids[x]>=a?f=x:u=x+1}const _=[];for(;this.ids[u]===a;)_.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return _}static serialize(n,a){const u=new Float64Array(n.ids),f=new Uint32Array(n.positions);return ju(u,f,0,u.length-1),a&&a.push(u.buffer,f.buffer),{ids:u,positions:f}}static deserialize(n){const a=new dl;return a.ids=n.ids,a.positions=n.positions,a.indexed=!0,a}}function Bu(i){const n=+i;return!isNaN(n)&&n<=Number.MAX_SAFE_INTEGER?n:Nu(String(i))}function ju(i,n,a,u){for(;a<u;){const f=i[a+u>>1];let _=a-1,x=u+1;for(;;){do _++;while(i[_]<f);do x--;while(i[x]>f);if(_>=x)break;ro(i,_,x),ro(n,3*_,3*x),ro(n,3*_+1,3*x+1),ro(n,3*_+2,3*x+2)}x-a<u-x?(ju(i,n,a,x),a=x+1):(ju(i,n,x+1,u),u=x)}}function ro(i,n,a){const u=i[n];i[n]=i[a],i[a]=u}Qe("FeaturePositionMap",dl);class fl{constructor(n,a){this.gl=n.gl,this.location=a}}class lp extends fl{constructor(n,a){super(n,a),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class _x extends fl{constructor(n,a){super(n,a),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class vx extends fl{constructor(n,a){super(n,a),this.current=Jt.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const SC=new Float32Array(16);function Qg(i){return[aa(255*i.r,255*i.g),aa(255*i.b,255*i.a)]}class Vh{constructor(n,a,u){this.value=n,this.uniformNames=a.map(f=>`u_${f}`),this.type=u}setUniform(n,a,u){n.set(u.constantOr(this.value))}getBinding(n,a,u){return this.type==="color"?new vx(n,a):new lp(n,a)}}class Uu{constructor(n,a){this.uniformNames=a.map(u=>`u_${u}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=n.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=n.tlbr}setUniform(n,a,u,f){const _=f==="u_pattern_to"?this.patternTo:f==="u_pattern_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;_&&n.set(_)}getBinding(n,a,u){return u.substr(0,9)==="u_pattern"?new _x(n,a):new lp(n,a)}}class oa{constructor(n,a,u,f){this.expression=n,this.type=u,this.maxValue=0,this.paintVertexAttributes=a.map(_=>({name:`a_${_}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(n,a,u,f,_){const x=this.paintVertexArray.length,w=this.expression.evaluate(new ur(0),a,{},f,[],_);this.paintVertexArray.resize(n),this._setPaintValue(x,n,w)}updatePaintArray(n,a,u,f){const _=this.expression.evaluate({zoom:0},u,f);this._setPaintValue(n,a,_)}_setPaintValue(n,a,u){if(this.type==="color"){const f=Qg(u);for(let _=n;_<a;_++)this.paintVertexArray.emplace(_,f[0],f[1])}else{for(let f=n;f<a;f++)this.paintVertexArray.emplace(f,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class hs{constructor(n,a,u,f,_,x){this.expression=n,this.uniformNames=a.map(w=>`u_${w}_t`),this.type=u,this.useIntegerZoom=f,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=a.map(w=>({name:`a_${w}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(n,a,u,f,_){const x=this.expression.evaluate(new ur(this.zoom),a,{},f,[],_),w=this.expression.evaluate(new ur(this.zoom+1),a,{},f,[],_),S=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(S,n,x,w)}updatePaintArray(n,a,u,f){const _=this.expression.evaluate({zoom:this.zoom},u,f),x=this.expression.evaluate({zoom:this.zoom+1},u,f);this._setPaintValue(n,a,_,x)}_setPaintValue(n,a,u,f){if(this.type==="color"){const _=Qg(u),x=Qg(f);for(let w=n;w<a;w++)this.paintVertexArray.emplace(w,_[0],_[1],x[0],x[1])}else{for(let _=n;_<a;_++)this.paintVertexArray.emplace(_,u,f);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(f))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,a){const u=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,f=Me(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);n.set(f)}getBinding(n,a,u){return new lp(n,a)}}class no{constructor(n,a,u,f,_,x){this.expression=n,this.type=a,this.useIntegerZoom=u,this.zoom=f,this.layerId=x,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(n,a,u){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(f,n,a.patterns&&a.patterns[this.layerId],u)}updatePaintArray(n,a,u,f,_){this._setPaintValues(n,a,u.patterns&&u.patterns[this.layerId],_)}_setPaintValues(n,a,u,f){if(!f||!u)return;const{min:_,mid:x,max:w}=u,S=f[_],C=f[x],E=f[w];if(S&&C&&E)for(let A=n;A<a;A++)this.zoomInPaintVertexArray.emplace(A,C.tl[0],C.tl[1],C.br[0],C.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],C.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(A,C.tl[0],C.tl[1],C.br[0],C.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],C.pixelRatio,E.pixelRatio)}upload(n){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,eo.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,eo.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class xx{constructor(n,a,u){this.binders={},this._buffers=[];const f=[];for(const _ in n.paint._values){if(!u(_))continue;const x=n.paint.get(_);if(!(x instanceof Wi&&ja(x.property.specification)))continue;const w=kC(_,n.type),S=x.value,C=x.property.specification.type,E=x.property.useIntegerZoom,A=x.property.specification["property-type"],F=A==="cross-faded"||A==="cross-faded-data-driven";if(S.kind==="constant")this.binders[_]=F?new Uu(S.value,w):new Vh(S.value,w,C),f.push(`/u_${_}`);else if(S.kind==="source"||F){const B=wx(_,C,"source");this.binders[_]=F?new no(S,C,E,a,B,n.id):new oa(S,w,C,B),f.push(`/a_${_}`)}else{const B=wx(_,C,"composite");this.binders[_]=new hs(S,w,C,E,a,B),f.push(`/z_${_}`)}}this.cacheKey=f.sort().join("")}getMaxValue(n){const a=this.binders[n];return a instanceof oa||a instanceof hs?a.maxValue:0}populatePaintArrays(n,a,u,f,_){for(const x in this.binders){const w=this.binders[x];(w instanceof oa||w instanceof hs||w instanceof no)&&w.populatePaintArray(n,a,u,f,_)}}setConstantPatternPositions(n,a){for(const u in this.binders){const f=this.binders[u];f instanceof Uu&&f.setConstantPatternPositions(n,a)}}updatePaintArrays(n,a,u,f,_){let x=!1;for(const w in n){const S=a.getPositions(w);for(const C of S){const E=u.feature(C.index);for(const A in this.binders){const F=this.binders[A];if((F instanceof oa||F instanceof hs||F instanceof no)&&F.expression.isStateDependent===!0){const B=f.paint.get(A);F.expression=B.value,F.updatePaintArray(C.start,C.end,E,n[w],_),x=!0}}}}return x}defines(){const n=[];for(const a in this.binders){const u=this.binders[a];(u instanceof Vh||u instanceof Uu)&&n.push(...u.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return n}getBinderAttributes(){const n=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof oa||u instanceof hs)for(let f=0;f<u.paintVertexAttributes.length;f++)n.push(u.paintVertexAttributes[f].name);else if(u instanceof no)for(let f=0;f<eo.members.length;f++)n.push(eo.members[f].name)}return n}getBinderUniforms(){const n=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof Vh||u instanceof Uu||u instanceof hs)for(const f of u.uniformNames)n.push(f)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,a){const u=[];for(const f in this.binders){const _=this.binders[f];if(_ instanceof Vh||_ instanceof Uu||_ instanceof hs){for(const x of _.uniformNames)if(a[x]){const w=_.getBinding(n,a[x],x);u.push({name:x,property:f,binding:w})}}}return u}setUniforms(n,a,u,f){for(const{name:_,property:x,binding:w}of a)this.binders[x].setUniform(w,f,u.get(x),_)}updatePaintBuffers(n){this._buffers=[];for(const a in this.binders){const u=this.binders[a];if(n&&u instanceof no){const f=n.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(u instanceof oa||u instanceof hs)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(n){for(const a in this.binders){const u=this.binders[a];(u instanceof oa||u instanceof hs||u instanceof no)&&u.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const a=this.binders[n];(a instanceof oa||a instanceof hs||a instanceof no)&&a.destroy()}}}class pl{constructor(n,a,u=()=>!0){this.programConfigurations={};for(const f of n)this.programConfigurations[f.id]=new xx(f,a,u);this.needsUpload=!1,this._featureMap=new dl,this._bufferOffset=0}populatePaintArrays(n,a,u,f,_,x){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(n,a,f,_,x);a.id!==void 0&&this._featureMap.add(a.id,u,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,a,u,f){for(const _ of u)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(n,this._featureMap,a,_,f)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}function kC(i,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${n}-`,"").replace(/-/g,"_")]}function wx(i,n,a){const u={color:{source:Z,composite:wt},number:{source:Ze,composite:Z}},f=function(_){return{"line-pattern":{source:ui,composite:ui},"fill-pattern":{source:ui,composite:ui},"fill-extrusion-pattern":{source:ui,composite:ui}}[_]}(i);return f&&f[a]||u[n][a]}Qe("ConstantBinder",Vh),Qe("CrossFadedConstantBinder",Uu),Qe("SourceExpressionBinder",oa),Qe("CrossFadedCompositeBinder",no),Qe("CompositeExpressionBinder",hs),Qe("ProgramConfiguration",xx,{omit:["_buffers"]}),Qe("ProgramConfigurationSet",pl);const Or=8192,Jg=Math.pow(2,14)-1,bx=-Jg-1;function ml(i){const n=Or/i.extent,a=i.loadGeometry();for(let u=0;u<a.length;u++){const f=a[u];for(let _=0;_<f.length;_++){const x=f[_],w=Math.round(x.x*n),S=Math.round(x.y*n);x.x=Me(w,bx,Jg),x.y=Me(S,bx,Jg),(w<x.x||w>x.x+1||S<x.y||S>x.y+1)&&Pt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function gl(i,n){return{type:i.type,id:i.id,properties:i.properties,geometry:n?ml(i):[]}}function up(i,n,a,u,f){i.emplaceBack(2*n+(u+1)/2,2*a+(f+1)/2)}class ey{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new bn,this.indexArray=new Ii,this.segments=new Ot,this.programConfigurations=new pl(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(n,a,u){const f=this.layers[0],_=[];let x=null,w=!1;f.type==="circle"&&(x=f.layout.get("circle-sort-key"),w=!x.isConstant());for(const{feature:S,id:C,index:E,sourceLayerIndex:A}of n){const F=this.layers[0]._featureFilter.needGeometry,B=gl(S,F);if(!this.layers[0]._featureFilter.filter(new ur(this.zoom),B,u))continue;const V=w?x.evaluate(B,{},u):void 0,$={id:C,properties:S.properties,type:S.type,sourceLayerIndex:A,index:E,geometry:F?B.geometry:ml(S),patterns:{},sortKey:V};_.push($)}w&&_.sort((S,C)=>S.sortKey-C.sortKey);for(const S of _){const{geometry:C,index:E,sourceLayerIndex:A}=S,F=n[E].feature;this.addFeature(S,C,E,u),a.featureIndex.insert(F,C,E,A,this.index)}}update(n,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,a,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Kn),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,a,u,f){for(const _ of a)for(const x of _){const w=x.x,S=x.y;if(w<0||w>=Or||S<0||S>=Or)continue;const C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),E=C.vertexLength;up(this.layoutVertexArray,w,S,-1,-1),up(this.layoutVertexArray,w,S,1,-1),up(this.layoutVertexArray,w,S,1,1),up(this.layoutVertexArray,w,S,-1,1),this.indexArray.emplaceBack(E,E+1,E+2),this.indexArray.emplaceBack(E,E+3,E+2),C.vertexLength+=4,C.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,{},f)}}function Sx(i,n){for(let a=0;a<i.length;a++)if(Vu(n,i[a]))return!0;for(let a=0;a<n.length;a++)if(Vu(i,n[a]))return!0;return!!ty(i,n)}function TC(i,n,a){return!!Vu(i,n)||!!ry(n,i,a)}function kx(i,n){if(i.length===1)return Cx(n,i[0]);for(let a=0;a<n.length;a++){const u=n[a];for(let f=0;f<u.length;f++)if(Vu(i,u[f]))return!0}for(let a=0;a<i.length;a++)if(Cx(n,i[a]))return!0;for(let a=0;a<n.length;a++)if(ty(i,n[a]))return!0;return!1}function CC(i,n,a){if(i.length>1){if(ty(i,n))return!0;for(let u=0;u<n.length;u++)if(ry(n[u],i,a))return!0}for(let u=0;u<i.length;u++)if(ry(i[u],n,a))return!0;return!1}function ty(i,n){if(i.length===0||n.length===0)return!1;for(let a=0;a<i.length-1;a++){const u=i[a],f=i[a+1];for(let _=0;_<n.length-1;_++)if(MC(u,f,n[_],n[_+1]))return!0}return!1}function MC(i,n,a,u){return Dt(i,a,u)!==Dt(n,a,u)&&Dt(i,n,a)!==Dt(i,n,u)}function ry(i,n,a){const u=a*a;if(n.length===1)return i.distSqr(n[0])<u;for(let f=1;f<n.length;f++)if(Tx(i,n[f-1],n[f])<u)return!0;return!1}function Tx(i,n,a){const u=n.distSqr(a);if(u===0)return i.distSqr(n);const f=((i.x-n.x)*(a.x-n.x)+(i.y-n.y)*(a.y-n.y))/u;return i.distSqr(f<0?n:f>1?a:a.sub(n)._mult(f)._add(n))}function Cx(i,n){let a,u,f,_=!1;for(let x=0;x<i.length;x++){a=i[x];for(let w=0,S=a.length-1;w<a.length;S=w++)u=a[w],f=a[S],u.y>n.y!=f.y>n.y&&n.x<(f.x-u.x)*(n.y-u.y)/(f.y-u.y)+u.x&&(_=!_)}return _}function Vu(i,n){let a=!1;for(let u=0,f=i.length-1;u<i.length;f=u++){const _=i[u],x=i[f];_.y>n.y!=x.y>n.y&&n.x<(x.x-_.x)*(n.y-_.y)/(x.y-_.y)+_.x&&(a=!a)}return a}function IC(i,n,a){const u=a[0],f=a[2];if(i.x<u.x&&n.x<u.x||i.x>f.x&&n.x>f.x||i.y<u.y&&n.y<u.y||i.y>f.y&&n.y>f.y)return!1;const _=Dt(i,n,a[0]);return _!==Dt(i,n,a[1])||_!==Dt(i,n,a[2])||_!==Dt(i,n,a[3])}function $h(i,n,a){const u=n.paint.get(i).value;return u.kind==="constant"?u.value:a.programConfigurations.get(n.id).getMaxValue(i)}function cp(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function hp(i,n,a,u,f){if(!n[0]&&!n[1])return i;const _=z.convert(n)._mult(f);a==="viewport"&&_._rotate(-u);const x=[];for(let w=0;w<i.length;w++)x.push(i[w].sub(_));return x}let Mx,Ix;Qe("CircleBucket",ey,{omit:["layers"]});var EC={get paint(){return Ix=Ix||new g({"circle-radius":new gt(be.paint_circle["circle-radius"]),"circle-color":new gt(be.paint_circle["circle-color"]),"circle-blur":new gt(be.paint_circle["circle-blur"]),"circle-opacity":new gt(be.paint_circle["circle-opacity"]),"circle-translate":new tt(be.paint_circle["circle-translate"]),"circle-translate-anchor":new tt(be.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new tt(be.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new tt(be.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new gt(be.paint_circle["circle-stroke-width"]),"circle-stroke-color":new gt(be.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new gt(be.paint_circle["circle-stroke-opacity"])})},get layout(){return Mx=Mx||new g({"circle-sort-key":new gt(be.layout_circle["circle-sort-key"])})}},Dn=1e-6,$u=typeof Float32Array<"u"?Float32Array:Array;function ny(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Ex(i,n,a){var u=n[0],f=n[1],_=n[2],x=n[3],w=n[4],S=n[5],C=n[6],E=n[7],A=n[8],F=n[9],B=n[10],V=n[11],$=n[12],Y=n[13],ne=n[14],xe=n[15],ue=a[0],_e=a[1],Te=a[2],De=a[3];return i[0]=ue*u+_e*w+Te*A+De*$,i[1]=ue*f+_e*S+Te*F+De*Y,i[2]=ue*_+_e*C+Te*B+De*ne,i[3]=ue*x+_e*E+Te*V+De*xe,i[4]=(ue=a[4])*u+(_e=a[5])*w+(Te=a[6])*A+(De=a[7])*$,i[5]=ue*f+_e*S+Te*F+De*Y,i[6]=ue*_+_e*C+Te*B+De*ne,i[7]=ue*x+_e*E+Te*V+De*xe,i[8]=(ue=a[8])*u+(_e=a[9])*w+(Te=a[10])*A+(De=a[11])*$,i[9]=ue*f+_e*S+Te*F+De*Y,i[10]=ue*_+_e*C+Te*B+De*ne,i[11]=ue*x+_e*E+Te*V+De*xe,i[12]=(ue=a[12])*u+(_e=a[13])*w+(Te=a[14])*A+(De=a[15])*$,i[13]=ue*f+_e*S+Te*F+De*Y,i[14]=ue*_+_e*C+Te*B+De*ne,i[15]=ue*x+_e*E+Te*V+De*xe,i}Math.hypot||(Math.hypot=function(){for(var i=0,n=arguments.length;n--;)i+=arguments[n]*arguments[n];return Math.sqrt(i)});var qh,PC=Ex;function dp(i,n,a){var u=n[0],f=n[1],_=n[2],x=n[3];return i[0]=a[0]*u+a[4]*f+a[8]*_+a[12]*x,i[1]=a[1]*u+a[5]*f+a[9]*_+a[13]*x,i[2]=a[2]*u+a[6]*f+a[10]*_+a[14]*x,i[3]=a[3]*u+a[7]*f+a[11]*_+a[15]*x,i}qh=new $u(4),$u!=Float32Array&&(qh[0]=0,qh[1]=0,qh[2]=0,qh[3]=0);class AC extends o{constructor(n){super(n,EC)}createBucket(n){return new ey(n)}queryRadius(n){const a=n;return $h("circle-radius",this,a)+$h("circle-stroke-width",this,a)+cp(this.paint.get("circle-translate"))}queryIntersectsFeature(n,a,u,f,_,x,w,S){const C=hp(n,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,w),E=this.paint.get("circle-radius").evaluate(a,u)+this.paint.get("circle-stroke-width").evaluate(a,u),A=this.paint.get("circle-pitch-alignment")==="map",F=A?C:function(V,$){return V.map(Y=>Px(Y,$))}(C,S),B=A?E*w:E;for(const V of f)for(const $ of V){const Y=A?$:Px($,S);let ne=B;const xe=dp([],[$.x,$.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ne*=xe[3]/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ne*=x.cameraToCenterDistance/xe[3]),TC(F,Y,ne))return!0}return!1}}function Px(i,n){const a=dp([],[i.x,i.y,0,1],n);return new z(a[0]/a[3],a[1]/a[3])}class Ax extends ey{}let zx;Qe("HeatmapBucket",Ax,{omit:["layers"]});var zC={get paint(){return zx=zx||new g({"heatmap-radius":new gt(be.paint_heatmap["heatmap-radius"]),"heatmap-weight":new gt(be.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new tt(be.paint_heatmap["heatmap-intensity"]),"heatmap-color":new jh(be.paint_heatmap["heatmap-color"]),"heatmap-opacity":new tt(be.paint_heatmap["heatmap-opacity"])})}};function iy(i,{width:n,height:a},u,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==n*a*u)throw new RangeError(`mismatched image size. expected: ${f.length} but got: ${n*a*u}`)}else f=new Uint8Array(n*a*u);return i.width=n,i.height=a,i.data=f,i}function Dx(i,{width:n,height:a},u){if(n===i.width&&a===i.height)return;const f=iy({},{width:n,height:a},u);sy(i,f,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,n),height:Math.min(i.height,a)},u),i.width=n,i.height=a,i.data=f.data}function sy(i,n,a,u,f,_){if(f.width===0||f.height===0)return n;if(f.width>i.width||f.height>i.height||a.x>i.width-f.width||a.y>i.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>n.width||f.height>n.height||u.x>n.width-f.width||u.y>n.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const x=i.data,w=n.data;if(x===w)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<f.height;S++){const C=((a.y+S)*i.width+a.x)*_,E=((u.y+S)*n.width+u.x)*_;for(let A=0;A<f.width*_;A++)w[E+A]=x[C+A]}return n}class Zh{constructor(n,a){iy(this,n,1,a)}resize(n){Dx(this,n,1)}clone(){return new Zh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,a,u,f,_){sy(n,a,u,f,_,1)}}class Ei{constructor(n,a){iy(this,n,4,a)}resize(n){Dx(this,n,4)}replace(n,a){a?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new Ei({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,a,u,f,_){sy(n,a,u,f,_,4)}}function Lx(i){const n={},a=i.resolution||256,u=i.clips?i.clips.length:1,f=i.image||new Ei({width:a,height:u});if(Math.log(a)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${a}`);const _=(x,w,S)=>{n[i.evaluationKey]=S;const C=i.expression.evaluate(n);f.data[x+w+0]=Math.floor(255*C.r/C.a),f.data[x+w+1]=Math.floor(255*C.g/C.a),f.data[x+w+2]=Math.floor(255*C.b/C.a),f.data[x+w+3]=Math.floor(255*C.a)};if(i.clips)for(let x=0,w=0;x<u;++x,w+=4*a)for(let S=0,C=0;S<a;S++,C+=4){const E=S/(a-1),{start:A,end:F}=i.clips[x];_(w,C,A*(1-E)+F*E)}else for(let x=0,w=0;x<a;x++,w+=4)_(0,w,x/(a-1));return f}Qe("AlphaImage",Zh),Qe("RGBAImage",Ei);const ay="big-fb";class DC extends o{createBucket(n){return new Ax(n)}constructor(n){super(n,zC),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Lx({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(ay)&&this.heatmapFbos.delete(ay)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Rx;var LC={get paint(){return Rx=Rx||new g({"hillshade-illumination-direction":new tt(be.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new tt(be.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new tt(be.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new tt(be.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new tt(be.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new tt(be.paint_hillshade["hillshade-accent-color"])})}};class RC extends o{constructor(n){super(n,LC)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const FC=b([{name:"a_pos",components:2,type:"Int16"}],4),{members:OC}=FC;function Fx(i,n,a=2){const u=n&&n.length,f=u?n[0]*a:i.length;let _=Ox(i,0,f,a,!0);const x=[];if(!_||_.next===_.prev)return x;let w,S,C;if(u&&(_=function(E,A,F,B){const V=[];for(let $=0,Y=A.length;$<Y;$++){const ne=Ox(E,A[$]*B,$<Y-1?A[$+1]*B:E.length,B,!1);ne===ne.next&&(ne.steiner=!0),V.push(ZC(ne))}V.sort(VC);for(let $=0;$<V.length;$++)F=$C(V[$],F);return F}(i,n,_,a)),i.length>80*a){w=1/0,S=1/0;let E=-1/0,A=-1/0;for(let F=a;F<f;F+=a){const B=i[F],V=i[F+1];B<w&&(w=B),V<S&&(S=V),B>E&&(E=B),V>A&&(A=V)}C=Math.max(E-w,A-S),C=C!==0?32767/C:0}return Hh(_,x,a,w,S,C,0),x}function Ox(i,n,a,u,f){let _;if(f===function(x,w,S,C){let E=0;for(let A=w,F=S-C;A<S;A+=C)E+=(x[F]-x[A])*(x[A+1]+x[F+1]),F=A;return E}(i,n,a,u)>0)for(let x=n;x<a;x+=u)_=jx(x/u|0,i[x],i[x+1],_);else for(let x=a-u;x>=n;x-=u)_=jx(x/u|0,i[x],i[x+1],_);return _&&fp(_,_.next)&&(Wh(_),_=_.next),_}function yl(i,n){if(!i)return i;n||(n=i);let a,u=i;do if(a=!1,u.steiner||!fp(u,u.next)&&Er(u.prev,u,u.next)!==0)u=u.next;else{if(Wh(u),u=n=u.prev,u===u.next)break;a=!0}while(a||u!==n);return n}function Hh(i,n,a,u,f,_,x){if(!i)return;!x&&_&&function(S,C,E,A){let F=S;do F.z===0&&(F.z=oy(F.x,F.y,C,E,A)),F.prevZ=F.prev,F.nextZ=F.next,F=F.next;while(F!==S);F.prevZ.nextZ=null,F.prevZ=null,function(B){let V,$=1;do{let Y,ne=B;B=null;let xe=null;for(V=0;ne;){V++;let ue=ne,_e=0;for(let De=0;De<$&&(_e++,ue=ue.nextZ,ue);De++);let Te=$;for(;_e>0||Te>0&&ue;)_e!==0&&(Te===0||!ue||ne.z<=ue.z)?(Y=ne,ne=ne.nextZ,_e--):(Y=ue,ue=ue.nextZ,Te--),xe?xe.nextZ=Y:B=Y,Y.prevZ=xe,xe=Y;ne=ue}xe.nextZ=null,$*=2}while(V>1)}(F)}(i,u,f,_);let w=i;for(;i.prev!==i.next;){const S=i.prev,C=i.next;if(_?BC(i,u,f,_):NC(i))n.push(S.i,i.i,C.i),Wh(i),i=C.next,w=C.next;else if((i=C)===w){x?x===1?Hh(i=jC(yl(i),n),n,a,u,f,_,2):x===2&&UC(i,n,a,u,f,_):Hh(yl(i),n,a,u,f,_,1);break}}}function NC(i){const n=i.prev,a=i,u=i.next;if(Er(n,a,u)>=0)return!1;const f=n.x,_=a.x,x=u.x,w=n.y,S=a.y,C=u.y,E=f<_?f<x?f:x:_<x?_:x,A=w<S?w<C?w:C:S<C?S:C,F=f>_?f>x?f:x:_>x?_:x,B=w>S?w>C?w:C:S>C?S:C;let V=u.next;for(;V!==n;){if(V.x>=E&&V.x<=F&&V.y>=A&&V.y<=B&&qu(f,w,_,S,x,C,V.x,V.y)&&Er(V.prev,V,V.next)>=0)return!1;V=V.next}return!0}function BC(i,n,a,u){const f=i.prev,_=i,x=i.next;if(Er(f,_,x)>=0)return!1;const w=f.x,S=_.x,C=x.x,E=f.y,A=_.y,F=x.y,B=w<S?w<C?w:C:S<C?S:C,V=E<A?E<F?E:F:A<F?A:F,$=w>S?w>C?w:C:S>C?S:C,Y=E>A?E>F?E:F:A>F?A:F,ne=oy(B,V,n,a,u),xe=oy($,Y,n,a,u);let ue=i.prevZ,_e=i.nextZ;for(;ue&&ue.z>=ne&&_e&&_e.z<=xe;){if(ue.x>=B&&ue.x<=$&&ue.y>=V&&ue.y<=Y&&ue!==f&&ue!==x&&qu(w,E,S,A,C,F,ue.x,ue.y)&&Er(ue.prev,ue,ue.next)>=0||(ue=ue.prevZ,_e.x>=B&&_e.x<=$&&_e.y>=V&&_e.y<=Y&&_e!==f&&_e!==x&&qu(w,E,S,A,C,F,_e.x,_e.y)&&Er(_e.prev,_e,_e.next)>=0))return!1;_e=_e.nextZ}for(;ue&&ue.z>=ne;){if(ue.x>=B&&ue.x<=$&&ue.y>=V&&ue.y<=Y&&ue!==f&&ue!==x&&qu(w,E,S,A,C,F,ue.x,ue.y)&&Er(ue.prev,ue,ue.next)>=0)return!1;ue=ue.prevZ}for(;_e&&_e.z<=xe;){if(_e.x>=B&&_e.x<=$&&_e.y>=V&&_e.y<=Y&&_e!==f&&_e!==x&&qu(w,E,S,A,C,F,_e.x,_e.y)&&Er(_e.prev,_e,_e.next)>=0)return!1;_e=_e.nextZ}return!0}function jC(i,n){let a=i;do{const u=a.prev,f=a.next.next;!fp(u,f)&&Nx(u,a,a.next,f)&&Gh(u,f)&&Gh(f,u)&&(n.push(u.i,a.i,f.i),Wh(a),Wh(a.next),a=i=f),a=a.next}while(a!==i);return yl(a)}function UC(i,n,a,u,f,_){let x=i;do{let w=x.next.next;for(;w!==x.prev;){if(x.i!==w.i&&HC(x,w)){let S=Bx(x,w);return x=yl(x,x.next),S=yl(S,S.next),Hh(x,n,a,u,f,_,0),void Hh(S,n,a,u,f,_,0)}w=w.next}x=x.next}while(x!==i)}function VC(i,n){return i.x-n.x}function $C(i,n){const a=function(f,_){let x=_;const w=f.x,S=f.y;let C,E=-1/0;do{if(S<=x.y&&S>=x.next.y&&x.next.y!==x.y){const $=x.x+(S-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if($<=w&&$>E&&(E=$,C=x.x<x.next.x?x:x.next,$===w))return C}x=x.next}while(x!==_);if(!C)return null;const A=C,F=C.x,B=C.y;let V=1/0;x=C;do{if(w>=x.x&&x.x>=F&&w!==x.x&&qu(S<B?w:E,S,F,B,S<B?E:w,S,x.x,x.y)){const $=Math.abs(S-x.y)/(w-x.x);Gh(x,f)&&($<V||$===V&&(x.x>C.x||x.x===C.x&&qC(C,x)))&&(C=x,V=$)}x=x.next}while(x!==A);return C}(i,n);if(!a)return n;const u=Bx(a,i);return yl(u,u.next),yl(a,a.next)}function qC(i,n){return Er(i.prev,i,n.prev)<0&&Er(n.next,i,i.next)<0}function oy(i,n,a,u,f){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-a)*f|0)|i<<8))|i<<4))|i<<2))|i<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-u)*f|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function ZC(i){let n=i,a=i;do(n.x<a.x||n.x===a.x&&n.y<a.y)&&(a=n),n=n.next;while(n!==i);return a}function qu(i,n,a,u,f,_,x,w){return(f-x)*(n-w)>=(i-x)*(_-w)&&(i-x)*(u-w)>=(a-x)*(n-w)&&(a-x)*(_-w)>=(f-x)*(u-w)}function HC(i,n){return i.next.i!==n.i&&i.prev.i!==n.i&&!function(a,u){let f=a;do{if(f.i!==a.i&&f.next.i!==a.i&&f.i!==u.i&&f.next.i!==u.i&&Nx(f,f.next,a,u))return!0;f=f.next}while(f!==a);return!1}(i,n)&&(Gh(i,n)&&Gh(n,i)&&function(a,u){let f=a,_=!1;const x=(a.x+u.x)/2,w=(a.y+u.y)/2;do f.y>w!=f.next.y>w&&f.next.y!==f.y&&x<(f.next.x-f.x)*(w-f.y)/(f.next.y-f.y)+f.x&&(_=!_),f=f.next;while(f!==a);return _}(i,n)&&(Er(i.prev,i,n.prev)||Er(i,n.prev,n))||fp(i,n)&&Er(i.prev,i,i.next)>0&&Er(n.prev,n,n.next)>0)}function Er(i,n,a){return(n.y-i.y)*(a.x-n.x)-(n.x-i.x)*(a.y-n.y)}function fp(i,n){return i.x===n.x&&i.y===n.y}function Nx(i,n,a,u){const f=mp(Er(i,n,a)),_=mp(Er(i,n,u)),x=mp(Er(a,u,i)),w=mp(Er(a,u,n));return f!==_&&x!==w||!(f!==0||!pp(i,a,n))||!(_!==0||!pp(i,u,n))||!(x!==0||!pp(a,i,u))||!(w!==0||!pp(a,n,u))}function pp(i,n,a){return n.x<=Math.max(i.x,a.x)&&n.x>=Math.min(i.x,a.x)&&n.y<=Math.max(i.y,a.y)&&n.y>=Math.min(i.y,a.y)}function mp(i){return i>0?1:i<0?-1:0}function Gh(i,n){return Er(i.prev,i,i.next)<0?Er(i,n,i.next)>=0&&Er(i,i.prev,n)>=0:Er(i,n,i.prev)<0||Er(i,i.next,n)<0}function Bx(i,n){const a=ly(i.i,i.x,i.y),u=ly(n.i,n.x,n.y),f=i.next,_=n.prev;return i.next=n,n.prev=i,a.next=f,f.prev=a,u.next=a,a.prev=u,_.next=u,u.prev=_,u}function jx(i,n,a,u){const f=ly(i,n,a);return u?(f.next=u.next,f.prev=u,u.next.prev=f,u.next=f):(f.prev=f,f.next=f),f}function Wh(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function ly(i,n,a){return{i,x:n,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function uy(i,n,a){const u=a.patternDependencies;let f=!1;for(const _ of n){const x=_.paint.get(`${i}-pattern`);x.isConstant()||(f=!0);const w=x.constantOr(null);w&&(f=!0,u[w.to]=!0,u[w.from]=!0)}return f}function cy(i,n,a,u,f){const _=f.patternDependencies;for(const x of n){const w=x.paint.get(`${i}-pattern`).value;if(w.kind!=="constant"){let S=w.evaluate({zoom:u-1},a,{},f.availableImages),C=w.evaluate({zoom:u},a,{},f.availableImages),E=w.evaluate({zoom:u+1},a,{},f.availableImages);S=S&&S.name?S.name:S,C=C&&C.name?C.name:C,E=E&&E.name?E.name:E,_[S]=!0,_[C]=!0,_[E]=!0,a.patterns[x.id]={min:S,mid:C,max:E}}}return a}class hy{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Xi,this.indexArray=new Ii,this.indexArray2=new Kr,this.programConfigurations=new pl(n.layers,n.zoom),this.segments=new Ot,this.segments2=new Ot,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(n,a,u){this.hasPattern=uy("fill",this.layers,a);const f=this.layers[0].layout.get("fill-sort-key"),_=!f.isConstant(),x=[];for(const{feature:w,id:S,index:C,sourceLayerIndex:E}of n){const A=this.layers[0]._featureFilter.needGeometry,F=gl(w,A);if(!this.layers[0]._featureFilter.filter(new ur(this.zoom),F,u))continue;const B=_?f.evaluate(F,{},u,a.availableImages):void 0,V={id:S,properties:w.properties,type:w.type,sourceLayerIndex:E,index:C,geometry:A?F.geometry:ml(w),patterns:{},sortKey:B};x.push(V)}_&&x.sort((w,S)=>w.sortKey-S.sortKey);for(const w of x){const{geometry:S,index:C,sourceLayerIndex:E}=w;if(this.hasPattern){const A=cy("fill",this.layers,w,this.zoom,a);this.patternFeatures.push(A)}else this.addFeature(w,S,C,u,{});a.featureIndex.insert(n[C].feature,S,C,E,this.index)}}update(n,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,a,this.stateDependentLayers,u)}addFeatures(n,a,u){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,a,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,OC),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,a,u,f,_){for(const x of pu(a,500)){let w=0;for(const B of x)w+=B.length;const S=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),C=S.vertexLength,E=[],A=[];for(const B of x){if(B.length===0)continue;B!==x[0]&&A.push(E.length/2);const V=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),$=V.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack($+B.length-1,$),E.push(B[0].x),E.push(B[0].y);for(let Y=1;Y<B.length;Y++)this.layoutVertexArray.emplaceBack(B[Y].x,B[Y].y),this.indexArray2.emplaceBack($+Y-1,$+Y),E.push(B[Y].x),E.push(B[Y].y);V.vertexLength+=B.length,V.primitiveLength+=B.length}const F=Fx(E,A);for(let B=0;B<F.length;B+=3)this.indexArray.emplaceBack(C+F[B],C+F[B+1],C+F[B+2]);S.vertexLength+=w,S.primitiveLength+=F.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,_,f)}}let Ux,Vx;Qe("FillBucket",hy,{omit:["layers","patternFeatures"]});var GC={get paint(){return Vx=Vx||new g({"fill-antialias":new tt(be.paint_fill["fill-antialias"]),"fill-opacity":new gt(be.paint_fill["fill-opacity"]),"fill-color":new gt(be.paint_fill["fill-color"]),"fill-outline-color":new gt(be.paint_fill["fill-outline-color"]),"fill-translate":new tt(be.paint_fill["fill-translate"]),"fill-translate-anchor":new tt(be.paint_fill["fill-translate-anchor"]),"fill-pattern":new Lu(be.paint_fill["fill-pattern"])})},get layout(){return Ux=Ux||new g({"fill-sort-key":new gt(be.layout_fill["fill-sort-key"])})}};class WC extends o{constructor(n){super(n,GC)}recalculate(n,a){super.recalculate(n,a);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new hy(n)}queryRadius(){return cp(this.paint.get("fill-translate"))}queryIntersectsFeature(n,a,u,f,_,x,w){return kx(hp(n,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,w),f)}isTileClipped(){return!0}}const XC=b([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),KC=b([{name:"a_centroid",components:2,type:"Int16"}],4),{members:YC}=XC;var io={},QC=I,$x=Zu;function Zu(i,n,a,u,f){this.properties={},this.extent=a,this.type=0,this._pbf=i,this._geometry=-1,this._keys=u,this._values=f,i.readFields(JC,this,n)}function JC(i,n,a){i==1?n.id=a.readVarint():i==2?function(u,f){for(var _=u.readVarint()+u.pos;u.pos<_;){var x=f._keys[u.readVarint()],w=f._values[u.readVarint()];f.properties[x]=w}}(a,n):i==3?n.type=a.readVarint():i==4&&(n._geometry=a.pos)}function eM(i){for(var n,a,u=0,f=0,_=i.length,x=_-1;f<_;x=f++)u+=((a=i[x]).x-(n=i[f]).x)*(n.y+a.y);return u}Zu.types=["Unknown","Point","LineString","Polygon"],Zu.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var n,a=i.readVarint()+i.pos,u=1,f=0,_=0,x=0,w=[];i.pos<a;){if(f<=0){var S=i.readVarint();u=7&S,f=S>>3}if(f--,u===1||u===2)_+=i.readSVarint(),x+=i.readSVarint(),u===1&&(n&&w.push(n),n=[]),n.push(new QC(_,x));else{if(u!==7)throw new Error("unknown command "+u);n&&n.push(n[0].clone())}}return n&&w.push(n),w},Zu.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var n=i.readVarint()+i.pos,a=1,u=0,f=0,_=0,x=1/0,w=-1/0,S=1/0,C=-1/0;i.pos<n;){if(u<=0){var E=i.readVarint();a=7&E,u=E>>3}if(u--,a===1||a===2)(f+=i.readSVarint())<x&&(x=f),f>w&&(w=f),(_+=i.readSVarint())<S&&(S=_),_>C&&(C=_);else if(a!==7)throw new Error("unknown command "+a)}return[x,S,w,C]},Zu.prototype.toGeoJSON=function(i,n,a){var u,f,_=this.extent*Math.pow(2,a),x=this.extent*i,w=this.extent*n,S=this.loadGeometry(),C=Zu.types[this.type];function E(B){for(var V=0;V<B.length;V++){var $=B[V];B[V]=[360*($.x+x)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*($.y+w)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var A=[];for(u=0;u<S.length;u++)A[u]=S[u][0];E(S=A);break;case 2:for(u=0;u<S.length;u++)E(S[u]);break;case 3:for(S=function(B){var V=B.length;if(V<=1)return[B];for(var $,Y,ne=[],xe=0;xe<V;xe++){var ue=eM(B[xe]);ue!==0&&(Y===void 0&&(Y=ue<0),Y===ue<0?($&&ne.push($),$=[B[xe]]):$.push(B[xe]))}return $&&ne.push($),ne}(S),u=0;u<S.length;u++)for(f=0;f<S[u].length;f++)E(S[u][f])}S.length===1?S=S[0]:C="Multi"+C;var F={type:"Feature",geometry:{type:C,coordinates:S},properties:this.properties};return"id"in this&&(F.id=this.id),F};var tM=$x,qx=Zx;function Zx(i,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(rM,this,n),this.length=this._features.length}function rM(i,n,a){i===15?n.version=a.readVarint():i===1?n.name=a.readString():i===5?n.extent=a.readVarint():i===2?n._features.push(a.pos):i===3?n._keys.push(a.readString()):i===4&&n._values.push(function(u){for(var f=null,_=u.readVarint()+u.pos;u.pos<_;){var x=u.readVarint()>>3;f=x===1?u.readString():x===2?u.readFloat():x===3?u.readDouble():x===4?u.readVarint64():x===5?u.readVarint():x===6?u.readSVarint():x===7?u.readBoolean():null}return f}(a))}Zx.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var n=this._pbf.readVarint()+this._pbf.pos;return new tM(this._pbf,n,this.extent,this._keys,this._values)};var nM=qx;function iM(i,n,a){if(i===3){var u=new nM(a,a.readVarint()+a.pos);u.length&&(n[u.name]=u)}}io.VectorTile=function(i,n){this.layers=i.readFields(iM,{},n)},io.VectorTileFeature=$x,io.VectorTileLayer=qx;const sM=io.VectorTileFeature.types,dy=Math.pow(2,13);function Xh(i,n,a,u,f,_,x,w){i.emplaceBack(n,a,2*Math.floor(u*dy)+x,f*dy*2,_*dy*2,Math.round(w))}class fy{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new Qa,this.centroidVertexArray=new an,this.indexArray=new Ii,this.programConfigurations=new pl(n.layers,n.zoom),this.segments=new Ot,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(n,a,u){this.features=[],this.hasPattern=uy("fill-extrusion",this.layers,a);for(const{feature:f,id:_,index:x,sourceLayerIndex:w}of n){const S=this.layers[0]._featureFilter.needGeometry,C=gl(f,S);if(!this.layers[0]._featureFilter.filter(new ur(this.zoom),C,u))continue;const E={id:_,sourceLayerIndex:w,index:x,geometry:S?C.geometry:ml(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(cy("fill-extrusion",this.layers,E,this.zoom,a)):this.addFeature(E,E.geometry,x,u,{}),a.featureIndex.insert(f,E.geometry,x,w,this.index,!0)}}addFeatures(n,a,u){for(const f of this.features){const{geometry:_}=f;this.addFeature(f,_,f.index,a,u)}}update(n,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,a,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,YC),this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,KC.members,!0),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(n,a,u,f,_){for(const x of pu(a,500)){const w={x:0,y:0,vertexCount:0};let S=0;for(const V of x)S+=V.length;let C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const V of x){if(V.length===0||oM(V))continue;let $=0;for(let Y=0;Y<V.length;Y++){const ne=V[Y];if(Y>=1){const xe=V[Y-1];if(!aM(ne,xe)){C.vertexLength+4>Ot.MAX_VERTEX_ARRAY_LENGTH&&(C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ue=ne.sub(xe)._perp()._unit(),_e=xe.dist(ne);$+_e>32768&&($=0),Xh(this.layoutVertexArray,ne.x,ne.y,ue.x,ue.y,0,0,$),Xh(this.layoutVertexArray,ne.x,ne.y,ue.x,ue.y,0,1,$),w.x+=2*ne.x,w.y+=2*ne.y,w.vertexCount+=2,$+=_e,Xh(this.layoutVertexArray,xe.x,xe.y,ue.x,ue.y,0,0,$),Xh(this.layoutVertexArray,xe.x,xe.y,ue.x,ue.y,0,1,$),w.x+=2*xe.x,w.y+=2*xe.y,w.vertexCount+=2;const Te=C.vertexLength;this.indexArray.emplaceBack(Te,Te+2,Te+1),this.indexArray.emplaceBack(Te+1,Te+2,Te+3),C.vertexLength+=4,C.primitiveLength+=2}}}}if(C.vertexLength+S>Ot.MAX_VERTEX_ARRAY_LENGTH&&(C=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),sM[n.type]!=="Polygon")continue;const E=[],A=[],F=C.vertexLength;for(const V of x)if(V.length!==0){V!==x[0]&&A.push(E.length/2);for(let $=0;$<V.length;$++){const Y=V[$];Xh(this.layoutVertexArray,Y.x,Y.y,0,0,1,1,0),w.x+=Y.x,w.y+=Y.y,w.vertexCount+=1,E.push(Y.x),E.push(Y.y)}}const B=Fx(E,A);for(let V=0;V<B.length;V+=3)this.indexArray.emplaceBack(F+B[V],F+B[V+2],F+B[V+1]);C.primitiveLength+=B.length/3,C.vertexLength+=S;for(let V=0;V<w.vertexCount;V++){const $=Math.floor(w.x/w.vertexCount),Y=Math.floor(w.y/w.vertexCount);this.centroidVertexArray.emplaceBack($,Y)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,_,f)}}function aM(i,n){return i.x===n.x&&(i.x<0||i.x>Or)||i.y===n.y&&(i.y<0||i.y>Or)}function oM(i){return i.every(n=>n.x<0)||i.every(n=>n.x>Or)||i.every(n=>n.y<0)||i.every(n=>n.y>Or)}let Hx;Qe("FillExtrusionBucket",fy,{omit:["layers","features"]});var lM={get paint(){return Hx=Hx||new g({"fill-extrusion-opacity":new tt(be["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new gt(be["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new tt(be["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new tt(be["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Lu(be["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new gt(be["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new gt(be["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new tt(be["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class uM extends o{constructor(n){super(n,lM)}createBucket(n){return new fy(n)}queryRadius(){return cp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(n,a,u,f,_,x,w,S){const C=hp(n,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,w),E=this.paint.get("fill-extrusion-height").evaluate(a,u),A=this.paint.get("fill-extrusion-base").evaluate(a,u),F=function(V,$,Y,ne){const xe=[];for(const ue of V){const _e=[ue.x,ue.y,0,1];dp(_e,_e,$),xe.push(new z(_e[0]/_e[3],_e[1]/_e[3]))}return xe}(C,S),B=function(V,$,Y,ne){const xe=[],ue=[],_e=ne[8]*$,Te=ne[9]*$,De=ne[10]*$,We=ne[11]*$,mt=ne[8]*Y,He=ne[9]*Y,qe=ne[10]*Y,st=ne[11]*Y;for(const Je of V){const Ye=[],Ie=[];for(const ot of Je){const nt=ot.x,xt=ot.y,ir=ne[0]*nt+ne[4]*xt+ne[12],nr=ne[1]*nt+ne[5]*xt+ne[13],qr=ne[2]*nt+ne[6]*xt+ne[14],Ki=ne[3]*nt+ne[7]*xt+ne[15],un=qr+De,Zr=Ki+We,Ln=ir+mt,Rn=nr+He,Fn=qr+qe,Tr=Ki+st,Hr=new z((ir+_e)/Zr,(nr+Te)/Zr);Hr.z=un/Zr,Ye.push(Hr);const Sn=new z(Ln/Tr,Rn/Tr);Sn.z=Fn/Tr,Ie.push(Sn)}xe.push(Ye),ue.push(Ie)}return[xe,ue]}(f,A,E,S);return function(V,$,Y){let ne=1/0;kx(Y,$)&&(ne=Gx(Y,$[0]));for(let xe=0;xe<$.length;xe++){const ue=$[xe],_e=V[xe];for(let Te=0;Te<ue.length-1;Te++){const De=ue[Te],We=[De,ue[Te+1],_e[Te+1],_e[Te],De];Sx(Y,We)&&(ne=Math.min(ne,Gx(Y,We)))}}return ne!==1/0&&ne}(B[0],B[1],F)}}function Kh(i,n){return i.x*n.x+i.y*n.y}function Gx(i,n){if(i.length===1){let a=0;const u=n[a++];let f;for(;!f||u.equals(f);)if(f=n[a++],!f)return 1/0;for(;a<n.length;a++){const _=n[a],x=i[0],w=f.sub(u),S=_.sub(u),C=x.sub(u),E=Kh(w,w),A=Kh(w,S),F=Kh(S,S),B=Kh(C,w),V=Kh(C,S),$=E*F-A*A,Y=(F*B-A*V)/$,ne=(E*V-A*B)/$,xe=u.z*(1-Y-ne)+f.z*Y+_.z*ne;if(isFinite(xe))return xe}return 1/0}{let a=1/0;for(const u of n)a=Math.min(a,u.z);return a}}const cM=b([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:hM}=cM,dM=b([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:fM}=dM,pM=io.VectorTileFeature.types,mM=Math.cos(Math.PI/180*37.5),Wx=Math.pow(2,14)/.5;class py{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new Fu,this.layoutVertexArray2=new Ja,this.indexArray=new Ii,this.programConfigurations=new pl(n.layers,n.zoom),this.segments=new Ot,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(n,a,u){this.hasPattern=uy("line",this.layers,a);const f=this.layers[0].layout.get("line-sort-key"),_=!f.isConstant(),x=[];for(const{feature:w,id:S,index:C,sourceLayerIndex:E}of n){const A=this.layers[0]._featureFilter.needGeometry,F=gl(w,A);if(!this.layers[0]._featureFilter.filter(new ur(this.zoom),F,u))continue;const B=_?f.evaluate(F,{},u):void 0,V={id:S,properties:w.properties,type:w.type,sourceLayerIndex:E,index:C,geometry:A?F.geometry:ml(w),patterns:{},sortKey:B};x.push(V)}_&&x.sort((w,S)=>w.sortKey-S.sortKey);for(const w of x){const{geometry:S,index:C,sourceLayerIndex:E}=w;if(this.hasPattern){const A=cy("line",this.layers,w,this.zoom,a);this.patternFeatures.push(A)}else this.addFeature(w,S,C,u,{});a.featureIndex.insert(n[C].feature,S,C,E,this.index)}}update(n,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,a,this.stateDependentLayers,u)}addFeatures(n,a,u){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,a,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,fM)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,hM),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,a,u,f,_){const x=this.layers[0].layout,w=x.get("line-join").evaluate(n,{}),S=x.get("line-cap"),C=x.get("line-miter-limit"),E=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const A of a)this.addLine(A,n,w,S,C,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,_,f)}addLine(n,a,u,f,_,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ne=0;ne<n.length-1;ne++)this.totalDistance+=n[ne].dist(n[ne+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w=pM[a.type]==="Polygon";let S=n.length;for(;S>=2&&n[S-1].equals(n[S-2]);)S--;let C=0;for(;C<S-1&&n[C].equals(n[C+1]);)C++;if(S<(w?3:2))return;u==="bevel"&&(_=1.05);const E=this.overscaling<=16?15*Or/(512*this.overscaling):0,A=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let F,B,V,$,Y;this.e1=this.e2=-1,w&&(F=n[S-2],Y=n[C].sub(F)._unit()._perp());for(let ne=C;ne<S;ne++){if(V=ne===S-1?w?n[C+1]:void 0:n[ne+1],V&&n[ne].equals(V))continue;Y&&($=Y),F&&(B=F),F=n[ne],Y=V?V.sub(F)._unit()._perp():$,$=$||Y;let xe=$.add(Y);xe.x===0&&xe.y===0||xe._unit();const ue=$.x*Y.x+$.y*Y.y,_e=xe.x*Y.x+xe.y*Y.y,Te=_e!==0?1/_e:1/0,De=2*Math.sqrt(2-2*_e),We=_e<mM&&B&&V,mt=$.x*Y.y-$.y*Y.x>0;if(We&&ne>C){const st=F.dist(B);if(st>2*E){const Je=F.sub(F.sub(B)._mult(E/st)._round());this.updateDistance(B,Je),this.addCurrentVertex(Je,$,0,0,A),B=Je}}const He=B&&V;let qe=He?u:w?"butt":f;if(He&&qe==="round"&&(Te<x?qe="miter":Te<=2&&(qe="fakeround")),qe==="miter"&&Te>_&&(qe="bevel"),qe==="bevel"&&(Te>2&&(qe="flipbevel"),Te<_&&(qe="miter")),B&&this.updateDistance(B,F),qe==="miter")xe._mult(Te),this.addCurrentVertex(F,xe,0,0,A);else if(qe==="flipbevel"){if(Te>100)xe=Y.mult(-1);else{const st=Te*$.add(Y).mag()/$.sub(Y).mag();xe._perp()._mult(st*(mt?-1:1))}this.addCurrentVertex(F,xe,0,0,A),this.addCurrentVertex(F,xe.mult(-1),0,0,A)}else if(qe==="bevel"||qe==="fakeround"){const st=-Math.sqrt(Te*Te-1),Je=mt?st:0,Ye=mt?0:st;if(B&&this.addCurrentVertex(F,$,Je,Ye,A),qe==="fakeround"){const Ie=Math.round(180*De/Math.PI/20);for(let ot=1;ot<Ie;ot++){let nt=ot/Ie;if(nt!==.5){const ir=nt-.5;nt+=nt*ir*(nt-1)*((1.0904+ue*(ue*(3.55645-1.43519*ue)-3.2452))*ir*ir+(.848013+ue*(.215638*ue-1.06021)))}const xt=Y.sub($)._mult(nt)._add($)._unit()._mult(mt?-1:1);this.addHalfVertex(F,xt.x,xt.y,!1,mt,0,A)}}V&&this.addCurrentVertex(F,Y,-Je,-Ye,A)}else if(qe==="butt")this.addCurrentVertex(F,xe,0,0,A);else if(qe==="square"){const st=B?1:-1;this.addCurrentVertex(F,xe,st,st,A)}else qe==="round"&&(B&&(this.addCurrentVertex(F,$,0,0,A),this.addCurrentVertex(F,$,1,1,A,!0)),V&&(this.addCurrentVertex(F,Y,-1,-1,A,!0),this.addCurrentVertex(F,Y,0,0,A)));if(We&&ne<S-1){const st=F.dist(V);if(st>2*E){const Je=F.add(V.sub(F)._mult(E/st)._round());this.updateDistance(F,Je),this.addCurrentVertex(Je,Y,0,0,A),F=Je}}}}addCurrentVertex(n,a,u,f,_,x=!1){const w=a.y*f-a.x,S=-a.y-a.x*f;this.addHalfVertex(n,a.x+a.y*u,a.y-a.x*u,x,!1,u,_),this.addHalfVertex(n,w,S,x,!0,-f,_),this.distance>Wx/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(n,a,u,f,_,x))}addHalfVertex({x:n,y:a},u,f,_,x,w,S){const C=.5*(this.lineClips?this.scaledDistance*(Wx-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((n<<1)+(_?1:0),(a<<1)+(x?1:0),Math.round(63*u)+128,Math.round(63*f)+128,1+(w===0?0:w<0?-1:1)|(63&C)<<2,C>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const E=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,E),S.primitiveLength++),x?this.e2=E:this.e1=E}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(n,a){this.distance+=n.dist(a),this.updateScaledDistance()}}let Xx,Kx;Qe("LineBucket",py,{omit:["layers","patternFeatures"]});var Yx={get paint(){return Kx=Kx||new g({"line-opacity":new gt(be.paint_line["line-opacity"]),"line-color":new gt(be.paint_line["line-color"]),"line-translate":new tt(be.paint_line["line-translate"]),"line-translate-anchor":new tt(be.paint_line["line-translate-anchor"]),"line-width":new gt(be.paint_line["line-width"]),"line-gap-width":new gt(be.paint_line["line-gap-width"]),"line-offset":new gt(be.paint_line["line-offset"]),"line-blur":new gt(be.paint_line["line-blur"]),"line-dasharray":new Ru(be.paint_line["line-dasharray"]),"line-pattern":new Lu(be.paint_line["line-pattern"]),"line-gradient":new jh(be.paint_line["line-gradient"])})},get layout(){return Xx=Xx||new g({"line-cap":new tt(be.layout_line["line-cap"]),"line-join":new gt(be.layout_line["line-join"]),"line-miter-limit":new tt(be.layout_line["line-miter-limit"]),"line-round-limit":new tt(be.layout_line["line-round-limit"]),"line-sort-key":new gt(be.layout_line["line-sort-key"])})}};class gM extends gt{possiblyEvaluate(n,a){return a=new ur(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(n,a)}evaluate(n,a,u,f){return a=ze({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(n,a,u,f)}}let gp;class yM extends o{constructor(n){super(n,Yx),this.gradientVersion=0,gp||(gp=new gM(Yx.paint.properties["line-width"].specification),gp.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const a=this.gradientExpression();this.stepInterpolant=!!function(u){return u._styleExpression!==void 0}(a)&&a._styleExpression.expression instanceof La,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,a){super.recalculate(n,a),this.paint._values["line-floorwidth"]=gp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new py(n)}queryRadius(n){const a=n,u=Qx($h("line-width",this,a),$h("line-gap-width",this,a)),f=$h("line-offset",this,a);return u/2+Math.abs(f)+cp(this.paint.get("line-translate"))}queryIntersectsFeature(n,a,u,f,_,x,w){const S=hp(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,w),C=w/2*Qx(this.paint.get("line-width").evaluate(a,u),this.paint.get("line-gap-width").evaluate(a,u)),E=this.paint.get("line-offset").evaluate(a,u);return E&&(f=function(A,F){const B=[];for(let V=0;V<A.length;V++){const $=A[V],Y=[];for(let ne=0;ne<$.length;ne++){const xe=$[ne-1],ue=$[ne],_e=$[ne+1],Te=ne===0?new z(0,0):ue.sub(xe)._unit()._perp(),De=ne===$.length-1?new z(0,0):_e.sub(ue)._unit()._perp(),We=Te._add(De)._unit(),mt=We.x*De.x+We.y*De.y;mt!==0&&We._mult(1/mt),Y.push(We._mult(F)._add(ue))}B.push(Y)}return B}(f,E*w)),function(A,F,B){for(let V=0;V<F.length;V++){const $=F[V];if(A.length>=3){for(let Y=0;Y<$.length;Y++)if(Vu(A,$[Y]))return!0}if(CC(A,$,B))return!0}return!1}(S,f,C)}isTileClipped(){return!0}}function Qx(i,n){return n>0?n+2*i:i}const _M=b([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),vM=b([{name:"a_projected_pos",components:3,type:"Float32"}],4);b([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const xM=b([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);b([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Jx=b([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),wM=b([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function bM(i,n,a){return i.sections.forEach(u=>{u.text=function(f,_,x){const w=_.layout.get("text-transform").evaluate(x,{});return w==="uppercase"?f=f.toLocaleUpperCase():w==="lowercase"&&(f=f.toLocaleLowerCase()),Xn.applyArabicShaping&&(f=Xn.applyArabicShaping(f)),f}(u.text,n,a)}),i}b([{name:"triangle",components:3,type:"Uint16"}]),b([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),b([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),b([{type:"Float32",name:"offsetX"}]),b([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),b([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Yh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var jr=24,e1=rr,t1=function(i,n,a,u,f){var _,x,w=8*f-u-1,S=(1<<w)-1,C=S>>1,E=-7,A=f-1,F=-1,B=i[n+A];for(A+=F,_=B&(1<<-E)-1,B>>=-E,E+=w;E>0;_=256*_+i[n+A],A+=F,E-=8);for(x=_&(1<<-E)-1,_>>=-E,E+=u;E>0;x=256*x+i[n+A],A+=F,E-=8);if(_===0)_=1-C;else{if(_===S)return x?NaN:1/0*(B?-1:1);x+=Math.pow(2,u),_-=C}return(B?-1:1)*x*Math.pow(2,_-u)},r1=function(i,n,a,u,f,_){var x,w,S,C=8*_-f-1,E=(1<<C)-1,A=E>>1,F=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,B=0,V=1,$=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(w=isNaN(n)?1:0,x=E):(x=Math.floor(Math.log(n)/Math.LN2),n*(S=Math.pow(2,-x))<1&&(x--,S*=2),(n+=x+A>=1?F/S:F*Math.pow(2,1-A))*S>=2&&(x++,S/=2),x+A>=E?(w=0,x=E):x+A>=1?(w=(n*S-1)*Math.pow(2,f),x+=A):(w=n*Math.pow(2,A-1)*Math.pow(2,f),x=0));f>=8;i[a+B]=255&w,B+=V,w/=256,f-=8);for(x=x<<f|w,C+=f;C>0;i[a+B]=255&x,B+=V,x/=256,C-=8);i[a+B-V]|=128*$};function rr(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}rr.Varint=0,rr.Fixed64=1,rr.Bytes=2,rr.Fixed32=5;var my=4294967296,n1=1/my,i1=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function la(i){return i.type===rr.Bytes?i.readVarint()+i.pos:i.pos+1}function Hu(i,n,a){return a?4294967296*n+(i>>>0):4294967296*(n>>>0)+(i>>>0)}function s1(i,n,a){var u=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));a.realloc(u);for(var f=a.pos-1;f>=i;f--)a.buf[f+u]=a.buf[f]}function SM(i,n){for(var a=0;a<i.length;a++)n.writeVarint(i[a])}function kM(i,n){for(var a=0;a<i.length;a++)n.writeSVarint(i[a])}function TM(i,n){for(var a=0;a<i.length;a++)n.writeFloat(i[a])}function CM(i,n){for(var a=0;a<i.length;a++)n.writeDouble(i[a])}function MM(i,n){for(var a=0;a<i.length;a++)n.writeBoolean(i[a])}function IM(i,n){for(var a=0;a<i.length;a++)n.writeFixed32(i[a])}function EM(i,n){for(var a=0;a<i.length;a++)n.writeSFixed32(i[a])}function PM(i,n){for(var a=0;a<i.length;a++)n.writeFixed64(i[a])}function AM(i,n){for(var a=0;a<i.length;a++)n.writeSFixed64(i[a])}function yp(i,n){return(i[n]|i[n+1]<<8|i[n+2]<<16)+16777216*i[n+3]}function Gu(i,n,a){i[a]=n,i[a+1]=n>>>8,i[a+2]=n>>>16,i[a+3]=n>>>24}function a1(i,n){return(i[n]|i[n+1]<<8|i[n+2]<<16)+(i[n+3]<<24)}rr.prototype={destroy:function(){this.buf=null},readFields:function(i,n,a){for(a=a||this.length;this.pos<a;){var u=this.readVarint(),f=u>>3,_=this.pos;this.type=7&u,i(f,n,this),this.pos===_&&this.skip(u)}return n},readMessage:function(i,n){return this.readFields(i,n,this.readVarint()+this.pos)},readFixed32:function(){var i=yp(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=a1(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=yp(this.buf,this.pos)+yp(this.buf,this.pos+4)*my;return this.pos+=8,i},readSFixed64:function(){var i=yp(this.buf,this.pos)+a1(this.buf,this.pos+4)*my;return this.pos+=8,i},readFloat:function(){var i=t1(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=t1(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var n,a,u=this.buf;return n=127&(a=u[this.pos++]),a<128?n:(n|=(127&(a=u[this.pos++]))<<7,a<128?n:(n|=(127&(a=u[this.pos++]))<<14,a<128?n:(n|=(127&(a=u[this.pos++]))<<21,a<128?n:function(f,_,x){var w,S,C=x.buf;if(w=(112&(S=C[x.pos++]))>>4,S<128||(w|=(127&(S=C[x.pos++]))<<3,S<128)||(w|=(127&(S=C[x.pos++]))<<10,S<128)||(w|=(127&(S=C[x.pos++]))<<17,S<128)||(w|=(127&(S=C[x.pos++]))<<24,S<128)||(w|=(1&(S=C[x.pos++]))<<31,S<128))return Hu(f,w,_);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(a=u[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,n=this.pos;return this.pos=i,i-n>=12&&i1?function(a,u,f){return i1.decode(a.subarray(u,f))}(this.buf,n,i):function(a,u,f){for(var _="",x=u;x<f;){var w,S,C,E=a[x],A=null,F=E>239?4:E>223?3:E>191?2:1;if(x+F>f)break;F===1?E<128&&(A=E):F===2?(192&(w=a[x+1]))==128&&(A=(31&E)<<6|63&w)<=127&&(A=null):F===3?(S=a[x+2],(192&(w=a[x+1]))==128&&(192&S)==128&&((A=(15&E)<<12|(63&w)<<6|63&S)<=2047||A>=55296&&A<=57343)&&(A=null)):F===4&&(S=a[x+2],C=a[x+3],(192&(w=a[x+1]))==128&&(192&S)==128&&(192&C)==128&&((A=(15&E)<<18|(63&w)<<12|(63&S)<<6|63&C)<=65535||A>=1114112)&&(A=null)),A===null?(A=65533,F=1):A>65535&&(A-=65536,_+=String.fromCharCode(A>>>10&1023|55296),A=56320|1023&A),_+=String.fromCharCode(A),x+=F}return _}(this.buf,n,i)},readBytes:function(){var i=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,i);return this.pos=i,n},readPackedVarint:function(i,n){if(this.type!==rr.Bytes)return i.push(this.readVarint(n));var a=la(this);for(i=i||[];this.pos<a;)i.push(this.readVarint(n));return i},readPackedSVarint:function(i){if(this.type!==rr.Bytes)return i.push(this.readSVarint());var n=la(this);for(i=i||[];this.pos<n;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==rr.Bytes)return i.push(this.readBoolean());var n=la(this);for(i=i||[];this.pos<n;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==rr.Bytes)return i.push(this.readFloat());var n=la(this);for(i=i||[];this.pos<n;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==rr.Bytes)return i.push(this.readDouble());var n=la(this);for(i=i||[];this.pos<n;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==rr.Bytes)return i.push(this.readFixed32());var n=la(this);for(i=i||[];this.pos<n;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==rr.Bytes)return i.push(this.readSFixed32());var n=la(this);for(i=i||[];this.pos<n;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==rr.Bytes)return i.push(this.readFixed64());var n=la(this);for(i=i||[];this.pos<n;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==rr.Bytes)return i.push(this.readSFixed64());var n=la(this);for(i=i||[];this.pos<n;)i.push(this.readSFixed64());return i},skip:function(i){var n=7&i;if(n===rr.Varint)for(;this.buf[this.pos++]>127;);else if(n===rr.Bytes)this.pos=this.readVarint()+this.pos;else if(n===rr.Fixed32)this.pos+=4;else{if(n!==rr.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(i,n){this.writeVarint(i<<3|n)},realloc:function(i){for(var n=this.length||16;n<this.pos+i;)n*=2;if(n!==this.length){var a=new Uint8Array(n);a.set(this.buf),this.buf=a,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),Gu(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),Gu(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),Gu(this.buf,-1&i,this.pos),Gu(this.buf,Math.floor(i*n1),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),Gu(this.buf,-1&i,this.pos),Gu(this.buf,Math.floor(i*n1),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(n,a){var u,f;if(n>=0?(u=n%4294967296|0,f=n/4294967296|0):(f=~(-n/4294967296),4294967295^(u=~(-n%4294967296))?u=u+1|0:(u=0,f=f+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),function(_,x,w){w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,w.buf[w.pos]=127&(_>>>=7)}(u,0,a),function(_,x){var w=(7&_)<<4;x.buf[x.pos++]|=w|((_>>>=3)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_)))))}(f,a)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var n=this.pos;this.pos=function(u,f,_){for(var x,w,S=0;S<f.length;S++){if((x=f.charCodeAt(S))>55295&&x<57344){if(!w){x>56319||S+1===f.length?(u[_++]=239,u[_++]=191,u[_++]=189):w=x;continue}if(x<56320){u[_++]=239,u[_++]=191,u[_++]=189,w=x;continue}x=w-55296<<10|x-56320|65536,w=null}else w&&(u[_++]=239,u[_++]=191,u[_++]=189,w=null);x<128?u[_++]=x:(x<2048?u[_++]=x>>6|192:(x<65536?u[_++]=x>>12|224:(u[_++]=x>>18|240,u[_++]=x>>12&63|128),u[_++]=x>>6&63|128),u[_++]=63&x|128)}return _}(this.buf,i,this.pos);var a=this.pos-n;a>=128&&s1(n,a,this),this.pos=n-1,this.writeVarint(a),this.pos+=a},writeFloat:function(i){this.realloc(4),r1(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),r1(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var n=i.length;this.writeVarint(n),this.realloc(n);for(var a=0;a<n;a++)this.buf[this.pos++]=i[a]},writeRawMessage:function(i,n){this.pos++;var a=this.pos;i(n,this);var u=this.pos-a;u>=128&&s1(a,u,this),this.pos=a-1,this.writeVarint(u),this.pos+=u},writeMessage:function(i,n,a){this.writeTag(i,rr.Bytes),this.writeRawMessage(n,a)},writePackedVarint:function(i,n){n.length&&this.writeMessage(i,SM,n)},writePackedSVarint:function(i,n){n.length&&this.writeMessage(i,kM,n)},writePackedBoolean:function(i,n){n.length&&this.writeMessage(i,MM,n)},writePackedFloat:function(i,n){n.length&&this.writeMessage(i,TM,n)},writePackedDouble:function(i,n){n.length&&this.writeMessage(i,CM,n)},writePackedFixed32:function(i,n){n.length&&this.writeMessage(i,IM,n)},writePackedSFixed32:function(i,n){n.length&&this.writeMessage(i,EM,n)},writePackedFixed64:function(i,n){n.length&&this.writeMessage(i,PM,n)},writePackedSFixed64:function(i,n){n.length&&this.writeMessage(i,AM,n)},writeBytesField:function(i,n){this.writeTag(i,rr.Bytes),this.writeBytes(n)},writeFixed32Field:function(i,n){this.writeTag(i,rr.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(i,n){this.writeTag(i,rr.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(i,n){this.writeTag(i,rr.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(i,n){this.writeTag(i,rr.Fixed64),this.writeSFixed64(n)},writeVarintField:function(i,n){this.writeTag(i,rr.Varint),this.writeVarint(n)},writeSVarintField:function(i,n){this.writeTag(i,rr.Varint),this.writeSVarint(n)},writeStringField:function(i,n){this.writeTag(i,rr.Bytes),this.writeString(n)},writeFloatField:function(i,n){this.writeTag(i,rr.Fixed32),this.writeFloat(n)},writeDoubleField:function(i,n){this.writeTag(i,rr.Fixed64),this.writeDouble(n)},writeBooleanField:function(i,n){this.writeVarintField(i,!!n)}};var gy=M(e1);const yy=3;function zM(i,n,a){i===1&&a.readMessage(DM,n)}function DM(i,n,a){if(i===3){const{id:u,bitmap:f,width:_,height:x,left:w,top:S,advance:C}=a.readMessage(LM,{});n.push({id:u,bitmap:new Zh({width:_+2*yy,height:x+2*yy},f),metrics:{width:_,height:x,left:w,top:S,advance:C}})}}function LM(i,n,a){i===1?n.id=a.readVarint():i===2?n.bitmap=a.readBytes():i===3?n.width=a.readVarint():i===4?n.height=a.readVarint():i===5?n.left=a.readSVarint():i===6?n.top=a.readSVarint():i===7&&(n.advance=a.readVarint())}const o1=yy;function l1(i){let n=0,a=0;for(const x of i)n+=x.w*x.h,a=Math.max(a,x.w);i.sort((x,w)=>w.h-x.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),a),h:1/0}];let f=0,_=0;for(const x of i)for(let w=u.length-1;w>=0;w--){const S=u[w];if(!(x.w>S.w||x.h>S.h)){if(x.x=S.x,x.y=S.y,_=Math.max(_,x.y+x.h),f=Math.max(f,x.x+x.w),x.w===S.w&&x.h===S.h){const C=u.pop();w<u.length&&(u[w]=C)}else x.h===S.h?(S.x+=x.w,S.w-=x.w):x.w===S.w?(S.y+=x.h,S.h-=x.h):(u.push({x:S.x+x.w,y:S.y,w:S.w-x.w,h:x.h}),S.y+=x.h,S.h-=x.h);break}}return{w:f,h:_,fill:n/(f*_)||0}}const Yn=1;class _y{constructor(n,{pixelRatio:a,version:u,stretchX:f,stretchY:_,content:x,textFitWidth:w,textFitHeight:S}){this.paddedRect=n,this.pixelRatio=a,this.stretchX=f,this.stretchY=_,this.content=x,this.version=u,this.textFitWidth=w,this.textFitHeight=S}get tl(){return[this.paddedRect.x+Yn,this.paddedRect.y+Yn]}get br(){return[this.paddedRect.x+this.paddedRect.w-Yn,this.paddedRect.y+this.paddedRect.h-Yn]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Yn)/this.pixelRatio,(this.paddedRect.h-2*Yn)/this.pixelRatio]}}class u1{constructor(n,a){const u={},f={};this.haveRenderCallbacks=[];const _=[];this.addImages(n,u,_),this.addImages(a,f,_);const{w:x,h:w}=l1(_),S=new Ei({width:x||1,height:w||1});for(const C in n){const E=n[C],A=u[C].paddedRect;Ei.copy(E.data,S,{x:0,y:0},{x:A.x+Yn,y:A.y+Yn},E.data)}for(const C in a){const E=a[C],A=f[C].paddedRect,F=A.x+Yn,B=A.y+Yn,V=E.data.width,$=E.data.height;Ei.copy(E.data,S,{x:0,y:0},{x:F,y:B},E.data),Ei.copy(E.data,S,{x:0,y:$-1},{x:F,y:B-1},{width:V,height:1}),Ei.copy(E.data,S,{x:0,y:0},{x:F,y:B+$},{width:V,height:1}),Ei.copy(E.data,S,{x:V-1,y:0},{x:F-1,y:B},{width:1,height:$}),Ei.copy(E.data,S,{x:0,y:0},{x:F+V,y:B},{width:1,height:$})}this.image=S,this.iconPositions=u,this.patternPositions=f}addImages(n,a,u){for(const f in n){const _=n[f],x={x:0,y:0,w:_.data.width+2*Yn,h:_.data.height+2*Yn};u.push(x),a[f]=new _y(x,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(n,a){n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in n.updatedImages)this.patchUpdatedImage(this.iconPositions[u],n.getImage(u),a),this.patchUpdatedImage(this.patternPositions[u],n.getImage(u),a)}patchUpdatedImage(n,a,u){if(!n||!a||n.version===a.version)return;n.version=a.version;const[f,_]=n.tl;u.update(a.data,void 0,{x:f,y:_})}}var so;Qe("ImagePosition",_y),Qe("ImageAtlas",u1),y.ah=void 0,(so=y.ah||(y.ah={}))[so.none=0]="none",so[so.horizontal=1]="horizontal",so[so.vertical=2]="vertical",so[so.horizontalOnly=3]="horizontalOnly";const Qh=-17;class Jh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,a){const u=new Jh;return u.scale=n||1,u.fontStack=a,u}static forImage(n){const a=new Jh;return a.imageName=n,a}}class Wu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,a){const u=new Wu;for(let f=0;f<n.sections.length;f++){const _=n.sections[f];_.image?u.addImageSection(_):u.addTextSection(_,a)}return u}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(){this.text=function(n){let a="";for(let u=0;u<n.length;u++){const f=n.charCodeAt(u+1)||null,_=n.charCodeAt(u-1)||null;a+=f&&np(f)&&!Yh[n[u+1]]||_&&np(_)&&!Yh[n[u-1]]||!Yh[n[u]]?n[u]:Yh[n[u]]}return a}(this.text)}trim(){let n=0;for(let u=0;u<this.text.length&&vp[this.text.charCodeAt(u)];u++)n++;let a=this.text.length;for(let u=this.text.length-1;u>=0&&u>=n&&vp[this.text.charCodeAt(u)];u--)a--;this.text=this.text.substring(n,a),this.sectionIndex=this.sectionIndex.slice(n,a)}substring(n,a){const u=new Wu;return u.text=this.text.substring(n,a),u.sectionIndex=this.sectionIndex.slice(n,a),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,a)=>Math.max(n,this.sections[a].scale),0)}addTextSection(n,a){this.text+=n.text,this.sections.push(Jh.forText(n.scale,n.fontStack||a));const u=this.sections.length-1;for(let f=0;f<n.text.length;++f)this.sectionIndex.push(u)}addImageSection(n){const a=n.image?n.image.name:"";if(a.length===0)return void Pt("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Jh.forImage(a)),this.sectionIndex.push(this.sections.length-1)):Pt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function _p(i,n,a,u,f,_,x,w,S,C,E,A,F,B,V){const $=Wu.fromFeature(i,f);let Y;A===y.ah.vertical&&$.verticalizePunctuation();const{processBidirectionalText:ne,processStyledBidirectionalText:xe}=Xn;if(ne&&$.sections.length===1){Y=[];const Te=ne($.toString(),vy($,C,_,n,u,B));for(const De of Te){const We=new Wu;We.text=De,We.sections=$.sections;for(let mt=0;mt<De.length;mt++)We.sectionIndex.push(0);Y.push(We)}}else if(xe){Y=[];const Te=xe($.text,$.sectionIndex,vy($,C,_,n,u,B));for(const De of Te){const We=new Wu;We.text=De[0],We.sectionIndex=De[1],We.sections=$.sections,Y.push(We)}}else Y=function(Te,De){const We=[],mt=Te.text;let He=0;for(const qe of De)We.push(Te.substring(He,qe)),He=qe;return He<mt.length&&We.push(Te.substring(He,mt.length)),We}($,vy($,C,_,n,u,B));const ue=[],_e={positionedLines:ue,text:$.toString(),top:E[1],bottom:E[1],left:E[0],right:E[0],writingMode:A,iconsInText:!1,verticalizable:!1};return function(Te,De,We,mt,He,qe,st,Je,Ye,Ie,ot,nt){let xt=0,ir=Qh,nr=0,qr=0;const Ki=Je==="right"?1:Je==="left"?0:.5;let un=0;for(const Tr of He){Tr.trim();const Hr=Tr.getMaxScale(),Sn=(Hr-1)*jr,cn={positionedGlyphs:[],lineOffset:0};Te.positionedLines[un]=cn;const On=cn.positionedGlyphs;let hn=0;if(!Tr.length()){ir+=qe,++un;continue}for(let Qn=0;Qn<Tr.length();Qn++){const $t=Tr.getSection(Qn),or=Tr.getSectionIndex(Qn),fr=Tr.getCharCode(Qn);let di=0,xr=null,Qu=null,Rs=null,Fs=jr;const Yi=!(Ye===y.ah.horizontal||!ot&&!Nh(fr)||ot&&(vp[fr]||(Zr=fr,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Zr)))));if($t.imageName){const zi=mt[$t.imageName];if(!zi)continue;Rs=$t.imageName,Te.iconsInText=Te.iconsInText||!0,Qu=zi.paddedRect;const Yr=zi.displaySize;$t.scale=$t.scale*jr/nt,xr={width:Yr[0],height:Yr[1],left:Yn,top:-o1,advance:Yi?Yr[1]:Yr[0]},di=Sn+(jr-Yr[1]*$t.scale),Fs=xr.advance;const ua=Yi?Yr[0]*$t.scale-jr*Hr:Yr[1]*$t.scale-jr*Hr;ua>0&&ua>hn&&(hn=ua)}else{const zi=We[$t.fontStack],Yr=zi&&zi[fr];if(Yr&&Yr.rect)Qu=Yr.rect,xr=Yr.metrics;else{const ua=De[$t.fontStack],sd=ua&&ua[fr];if(!sd)continue;xr=sd.metrics}di=(Hr-$t.scale)*jr}Yi?(Te.verticalizable=!0,On.push({glyph:fr,imageName:Rs,x:xt,y:ir+di,vertical:Yi,scale:$t.scale,fontStack:$t.fontStack,sectionIndex:or,metrics:xr,rect:Qu}),xt+=Fs*$t.scale+Ie):(On.push({glyph:fr,imageName:Rs,x:xt,y:ir+di,vertical:Yi,scale:$t.scale,fontStack:$t.fontStack,sectionIndex:or,metrics:xr,rect:Qu}),xt+=xr.advance*$t.scale+Ie)}On.length!==0&&(nr=Math.max(xt-Ie,nr),NM(On,0,On.length-1,Ki,hn)),xt=0;const Ai=qe*Hr+hn;cn.lineOffset=Math.max(hn,Sn),ir+=Ai,qr=Math.max(Ai,qr),++un}var Zr;const Ln=ir-Qh,{horizontalAlign:Rn,verticalAlign:Fn}=xy(st);(function(Tr,Hr,Sn,cn,On,hn,Ai,Qn,$t){const or=(Hr-Sn)*On;let fr=0;fr=hn!==Ai?-Qn*cn-Qh:(-cn*$t+.5)*Ai;for(const di of Tr)for(const xr of di.positionedGlyphs)xr.x+=or,xr.y+=fr})(Te.positionedLines,Ki,Rn,Fn,nr,qr,qe,Ln,He.length),Te.top+=-Fn*Ln,Te.bottom=Te.top+Ln,Te.left+=-Rn*nr,Te.right=Te.left+nr}(_e,n,a,u,Y,x,w,S,A,C,F,V),!function(Te){for(const De of Te)if(De.positionedGlyphs.length!==0)return!1;return!0}(ue)&&_e}const vp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},RM={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},FM={40:!0};function c1(i,n,a,u,f,_){if(n.imageName){const x=u[n.imageName];return x?x.displaySize[0]*n.scale*jr/_+f:0}{const x=a[n.fontStack],w=x&&x[i];return w?w.metrics.advance*n.scale+f:0}}function h1(i,n,a,u){const f=Math.pow(i-n,2);return u?i<n?f/2:2*f:f+Math.abs(a)*a}function OM(i,n,a){let u=0;return i===10&&(u-=1e4),a&&(u+=150),i!==40&&i!==65288||(u+=50),n!==41&&n!==65289||(u+=50),u}function d1(i,n,a,u,f,_){let x=null,w=h1(n,a,f,_);for(const S of u){const C=h1(n-S.x,a,f,_)+S.badness;C<=w&&(x=S,w=C)}return{index:i,x:n,priorBreak:x,badness:w}}function f1(i){return i?f1(i.priorBreak).concat(i.index):[]}function vy(i,n,a,u,f,_){if(!i)return[];const x=[],w=function(A,F,B,V,$,Y){let ne=0;for(let xe=0;xe<A.length();xe++){const ue=A.getSection(xe);ne+=c1(A.getCharCode(xe),ue,V,$,F,Y)}return ne/Math.max(1,Math.ceil(ne/B))}(i,n,a,u,f,_),S=i.text.indexOf("")>=0;let C=0;for(let A=0;A<i.length();A++){const F=i.getSection(A),B=i.getCharCode(A);if(vp[B]||(C+=c1(B,F,u,f,n,_)),A<i.length()-1){const V=!((E=B)<11904)&&(!!Ft["CJK Compatibility Forms"](E)||!!Ft["CJK Compatibility"](E)||!!Ft["CJK Strokes"](E)||!!Ft["CJK Symbols and Punctuation"](E)||!!Ft["Enclosed CJK Letters and Months"](E)||!!Ft["Halfwidth and Fullwidth Forms"](E)||!!Ft["Ideographic Description Characters"](E)||!!Ft["Vertical Forms"](E)||rp.test(String.fromCodePoint(E)));(RM[B]||V||F.imageName||A!==i.length()-2&&FM[i.getCharCode(A+1)])&&x.push(d1(A+1,C,w,x,OM(B,i.getCharCode(A+1),V&&S),!1))}}var E;return f1(d1(i.length(),C,w,x,0,!0))}function xy(i){let n=.5,a=.5;switch(i){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:n,verticalAlign:a}}function NM(i,n,a,u,f){if(!u&&!f)return;const _=i[a],x=(i[a].x+_.metrics.advance*_.scale)*u;for(let w=n;w<=a;w++)i[w].x-=x,i[w].y+=f}function BM(i,n,a){const{horizontalAlign:u,verticalAlign:f}=xy(a),_=n[0]-i.displaySize[0]*u,x=n[1]-i.displaySize[1]*f;return{image:i,top:x,bottom:x+i.displaySize[1],left:_,right:_+i.displaySize[0]}}function p1(i){var n,a;let u=i.left,f=i.top,_=i.right-u,x=i.bottom-f;const w=(n=i.image.textFitWidth)!==null&&n!==void 0?n:"stretchOrShrink",S=(a=i.image.textFitHeight)!==null&&a!==void 0?a:"stretchOrShrink",C=(i.image.content[2]-i.image.content[0])/(i.image.content[3]-i.image.content[1]);if(S==="proportional"){if(w==="stretchOnly"&&_/x<C||w==="proportional"){const E=Math.ceil(x*C);u*=E/_,_=E}}else if(w==="proportional"&&S==="stretchOnly"&&C!==0&&_/x>C){const E=Math.ceil(_/C);f*=E/x,x=E}return{x1:u,y1:f,x2:u+_,y2:f+x}}function m1(i,n,a,u,f,_){const x=i.image;let w;if(x.content){const Y=x.content,ne=x.pixelRatio||1;w=[Y[0]/ne,Y[1]/ne,x.displaySize[0]-Y[2]/ne,x.displaySize[1]-Y[3]/ne]}const S=n.left*_,C=n.right*_;let E,A,F,B;a==="width"||a==="both"?(B=f[0]+S-u[3],A=f[0]+C+u[1]):(B=f[0]+(S+C-x.displaySize[0])/2,A=B+x.displaySize[0]);const V=n.top*_,$=n.bottom*_;return a==="height"||a==="both"?(E=f[1]+V-u[0],F=f[1]+$+u[2]):(E=f[1]+(V+$-x.displaySize[1])/2,F=E+x.displaySize[1]),{image:x,top:E,right:A,bottom:F,left:B,collisionPadding:w}}const ed=255,Ls=128,ao=ed*Ls;function g1(i,n){const{expression:a}=n;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new ur(i+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:f}=a;let _=0;for(;_<u.length&&u[_]<=i;)_++;_=Math.max(0,_-1);let x=_;for(;x<u.length&&u[x]<i+1;)x++;x=Math.min(u.length-1,x);const w=u[_],S=u[x];return a.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:S,interpolationType:f}:{kind:"camera",minZoom:w,maxZoom:S,minSize:a.evaluate(new ur(w)),maxSize:a.evaluate(new ur(S)),interpolationType:f}}}function wy(i,n,a){let u="never";const f=i.get(n);return f?u=f:i.get(a)&&(u="always"),u}const jM=io.VectorTileFeature.types,UM=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function xp(i,n,a,u,f,_,x,w,S,C,E,A,F){const B=w?Math.min(ao,Math.round(w[0])):0,V=w?Math.min(ao,Math.round(w[1])):0;i.emplaceBack(n,a,Math.round(32*u),Math.round(32*f),_,x,(B<<1)+(S?1:0),V,16*C,16*E,256*A,256*F)}function by(i,n,a){i.emplaceBack(n.x,n.y,a),i.emplaceBack(n.x,n.y,a),i.emplaceBack(n.x,n.y,a),i.emplaceBack(n.x,n.y,a)}function VM(i){for(const n of i.sections)if(Kg(n.text))return!0;return!1}class Sy{constructor(n){this.layoutVertexArray=new Ou,this.indexArray=new Ii,this.programConfigurations=n,this.segments=new Ot,this.dynamicLayoutVertexArray=new Uh,this.opacityVertexArray=new ci,this.hasVisibleVertices=!1,this.placedSymbolArray=new cr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,a,u,f){this.isEmpty()||(u&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,_M.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,vM.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,UM,!0),this.opacityVertexBuffer.itemSize=1),(u||f)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Qe("SymbolBuffers",Sy);class ky{constructor(n,a,u){this.layoutVertexArray=new n,this.layoutAttributes=a,this.indexArray=new u,this.segments=new Ot,this.collisionVertexArray=new zs}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,xM.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Qe("CollisionBuffers",ky);class Xu{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(x=>x.id),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ny([]),this.placementViewportMatrix=ny([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=g1(this.zoom,a["text-size"]),this.iconSizeData=g1(this.zoom,a["icon-size"]);const u=this.layers[0].layout,f=u.get("symbol-sort-key"),_=u.get("symbol-z-order");this.canOverlap=wy(u,"text-overlap","text-allow-overlap")!=="never"||wy(u,"icon-overlap","icon-allow-overlap")!=="never"||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!f.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(x=>y.ah[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=n.sourceID}createArrays(){this.text=new Sy(new pl(this.layers,this.zoom,n=>/^text/.test(n))),this.icon=new Sy(new pl(this.layers,this.zoom,n=>/^icon/.test(n))),this.glyphOffsetArray=new hr,this.lineVertexArray=new sn,this.symbolInstances=new zt,this.textAnchorOffsets=new dr}calculateGlyphDependencies(n,a,u,f,_){for(let x=0;x<n.length;x++)if(a[n.charCodeAt(x)]=!0,(u||f)&&_){const w=Yh[n.charAt(x)];w&&(a[w.charCodeAt(0)]=!0)}}populate(n,a,u){const f=this.layers[0],_=f.layout,x=_.get("text-font"),w=_.get("text-field"),S=_.get("icon-image"),C=(w.value.kind!=="constant"||w.value.value instanceof Zn&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),E=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,A=_.get("symbol-sort-key");if(this.features=[],!C&&!E)return;const F=a.iconDependencies,B=a.glyphDependencies,V=a.availableImages,$=new ur(this.zoom);for(const{feature:Y,id:ne,index:xe,sourceLayerIndex:ue}of n){const _e=f._featureFilter.needGeometry,Te=gl(Y,_e);if(!f._featureFilter.filter($,Te,u))continue;let De,We;if(_e||(Te.geometry=ml(Y)),C){const He=f.getValueAndResolveTokens("text-field",Te,u,V),qe=Zn.factory(He),st=this.hasRTLText=this.hasRTLText||VM(qe);(!st||Xn.getRTLTextPluginStatus()==="unavailable"||st&&Xn.isParsed())&&(De=bM(qe,f,Te))}if(E){const He=f.getValueAndResolveTokens("icon-image",Te,u,V);We=He instanceof Gn?He:Gn.fromString(He)}if(!De&&!We)continue;const mt=this.sortFeaturesByKey?A.evaluate(Te,{},u):void 0;if(this.features.push({id:ne,text:De,icon:We,index:xe,sourceLayerIndex:ue,geometry:Te.geometry,properties:Y.properties,type:jM[Y.type],sortKey:mt}),We&&(F[We.name]=!0),De){const He=x.evaluate(Te,{},u).join(","),qe=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(y.ah.vertical)>=0;for(const st of De.sections)if(st.image)F[st.image.name]=!0;else{const Je=Fh(De.toString()),Ye=st.fontStack||He,Ie=B[Ye]=B[Ye]||{};this.calculateGlyphDependencies(st.text,Ie,qe,this.allowVerticalPlacement,Je)}}}_.get("symbol-placement")==="line"&&(this.features=function(Y){const ne={},xe={},ue=[];let _e=0;function Te(He){ue.push(Y[He]),_e++}function De(He,qe,st){const Je=xe[He];return delete xe[He],xe[qe]=Je,ue[Je].geometry[0].pop(),ue[Je].geometry[0]=ue[Je].geometry[0].concat(st[0]),Je}function We(He,qe,st){const Je=ne[qe];return delete ne[qe],ne[He]=Je,ue[Je].geometry[0].shift(),ue[Je].geometry[0]=st[0].concat(ue[Je].geometry[0]),Je}function mt(He,qe,st){const Je=st?qe[0][qe[0].length-1]:qe[0][0];return`${He}:${Je.x}:${Je.y}`}for(let He=0;He<Y.length;He++){const qe=Y[He],st=qe.geometry,Je=qe.text?qe.text.toString():null;if(!Je){Te(He);continue}const Ye=mt(Je,st),Ie=mt(Je,st,!0);if(Ye in xe&&Ie in ne&&xe[Ye]!==ne[Ie]){const ot=We(Ye,Ie,st),nt=De(Ye,Ie,ue[ot].geometry);delete ne[Ye],delete xe[Ie],xe[mt(Je,ue[nt].geometry,!0)]=nt,ue[ot].geometry=null}else Ye in xe?De(Ye,Ie,st):Ie in ne?We(Ye,Ie,st):(Te(He),ne[Ye]=_e-1,xe[Ie]=_e-1)}return ue.filter(He=>He.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Y,ne)=>Y.sortKey-ne.sortKey)}update(n,a,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,a,this.layers,u),this.icon.programConfigurations.updatePaintArrays(n,a,this.layers,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,a){const u=this.lineVertexArray.length;if(n.segment!==void 0){let f=n.dist(a[n.segment+1]),_=n.dist(a[n.segment]);const x={};for(let w=n.segment+1;w<a.length;w++)x[w]={x:a[w].x,y:a[w].y,tileUnitDistanceFromAnchor:f},w<a.length-1&&(f+=a[w+1].dist(a[w]));for(let w=n.segment||0;w>=0;w--)x[w]={x:a[w].x,y:a[w].y,tileUnitDistanceFromAnchor:_},w>0&&(_+=a[w-1].dist(a[w]));for(let w=0;w<a.length;w++){const S=x[w];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(n,a,u,f,_,x,w,S,C,E,A,F){const B=n.indexArray,V=n.layoutVertexArray,$=n.segments.prepareSegment(4*a.length,V,B,this.canOverlap?x.sortKey:void 0),Y=this.glyphOffsetArray.length,ne=$.vertexLength,xe=this.allowVerticalPlacement&&w===y.ah.vertical?Math.PI/2:0,ue=x.text&&x.text.sections;for(let _e=0;_e<a.length;_e++){const{tl:Te,tr:De,bl:We,br:mt,tex:He,pixelOffsetTL:qe,pixelOffsetBR:st,minFontScaleX:Je,minFontScaleY:Ye,glyphOffset:Ie,isSDF:ot,sectionIndex:nt}=a[_e],xt=$.vertexLength,ir=Ie[1];xp(V,S.x,S.y,Te.x,ir+Te.y,He.x,He.y,u,ot,qe.x,qe.y,Je,Ye),xp(V,S.x,S.y,De.x,ir+De.y,He.x+He.w,He.y,u,ot,st.x,qe.y,Je,Ye),xp(V,S.x,S.y,We.x,ir+We.y,He.x,He.y+He.h,u,ot,qe.x,st.y,Je,Ye),xp(V,S.x,S.y,mt.x,ir+mt.y,He.x+He.w,He.y+He.h,u,ot,st.x,st.y,Je,Ye),by(n.dynamicLayoutVertexArray,S,xe),B.emplaceBack(xt,xt+1,xt+2),B.emplaceBack(xt+1,xt+2,xt+3),$.vertexLength+=4,$.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ie[0]),_e!==a.length-1&&nt===a[_e+1].sectionIndex||n.programConfigurations.populatePaintArrays(V.length,x,x.index,{},F,ue&&ue[nt])}n.placedSymbolArray.emplaceBack(S.x,S.y,Y,this.glyphOffsetArray.length-Y,ne,C,E,S.segment,u?u[0]:0,u?u[1]:0,f[0],f[1],w,0,!1,0,A)}_addCollisionDebugVertex(n,a,u,f,_,x){return a.emplaceBack(0,0),n.emplaceBack(u.x,u.y,f,_,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(n,a,u,f,_,x,w){const S=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),C=S.vertexLength,E=_.layoutVertexArray,A=_.collisionVertexArray,F=w.anchorX,B=w.anchorY;this._addCollisionDebugVertex(E,A,x,F,B,new z(n,a)),this._addCollisionDebugVertex(E,A,x,F,B,new z(u,a)),this._addCollisionDebugVertex(E,A,x,F,B,new z(u,f)),this._addCollisionDebugVertex(E,A,x,F,B,new z(n,f)),S.vertexLength+=4;const V=_.indexArray;V.emplaceBack(C,C+1),V.emplaceBack(C+1,C+2),V.emplaceBack(C+2,C+3),V.emplaceBack(C+3,C),S.primitiveLength+=4}addDebugCollisionBoxes(n,a,u,f){for(let _=n;_<a;_++){const x=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,f?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,u)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ky(hi,Jx.members,Kr),this.iconCollisionBox=new ky(hi,Jx.members,Kr);for(let n=0;n<this.symbolInstances.length;n++){const a=this.symbolInstances.get(n);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(n,a,u,f,_,x,w,S,C){const E={};for(let A=a;A<u;A++){const F=n.get(A);E.textBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},E.textFeatureIndex=F.featureIndex;break}for(let A=f;A<_;A++){const F=n.get(A);E.verticalTextBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},E.verticalTextFeatureIndex=F.featureIndex;break}for(let A=x;A<w;A++){const F=n.get(A);E.iconBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},E.iconFeatureIndex=F.featureIndex;break}for(let A=S;A<C;A++){const F=n.get(A);E.verticalIconBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},E.verticalIconFeatureIndex=F.featureIndex;break}return E}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const u=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,a){const u=n.placedSymbolArray.get(a),f=u.vertexStartIndex+4*u.numGlyphs;for(let _=u.vertexStartIndex;_<f;_+=4)n.indexArray.emplaceBack(_,_+1,_+2),n.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(n),u=Math.cos(n),f=[],_=[],x=[];for(let w=0;w<this.symbolInstances.length;++w){x.push(w);const S=this.symbolInstances.get(w);f.push(0|Math.round(a*S.anchorX+u*S.anchorY)),_.push(S.featureIndex)}return x.sort((w,S)=>f[w]-f[S]||_[S]-_[w]),x}addToSortKeyRanges(n,a){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===a?u.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const u=this.symbolInstances.get(a);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach((f,_,x)=>{f>=0&&x.indexOf(f)===_&&this.addIndicesForPlacedSymbol(this.text,f)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let y1,_1;Qe("SymbolBucket",Xu,{omit:["layers","collisionBoxArray","features","compareText"]}),Xu.MAX_GLYPHS=65535,Xu.addDynamicAttributes=by;var Ty={get paint(){return _1=_1||new g({"icon-opacity":new gt(be.paint_symbol["icon-opacity"]),"icon-color":new gt(be.paint_symbol["icon-color"]),"icon-halo-color":new gt(be.paint_symbol["icon-halo-color"]),"icon-halo-width":new gt(be.paint_symbol["icon-halo-width"]),"icon-halo-blur":new gt(be.paint_symbol["icon-halo-blur"]),"icon-translate":new tt(be.paint_symbol["icon-translate"]),"icon-translate-anchor":new tt(be.paint_symbol["icon-translate-anchor"]),"text-opacity":new gt(be.paint_symbol["text-opacity"]),"text-color":new gt(be.paint_symbol["text-color"],{runtimeType:En,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new gt(be.paint_symbol["text-halo-color"]),"text-halo-width":new gt(be.paint_symbol["text-halo-width"]),"text-halo-blur":new gt(be.paint_symbol["text-halo-blur"]),"text-translate":new tt(be.paint_symbol["text-translate"]),"text-translate-anchor":new tt(be.paint_symbol["text-translate-anchor"])})},get layout(){return y1=y1||new g({"symbol-placement":new tt(be.layout_symbol["symbol-placement"]),"symbol-spacing":new tt(be.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new tt(be.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new gt(be.layout_symbol["symbol-sort-key"]),"symbol-z-order":new tt(be.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new tt(be.layout_symbol["icon-allow-overlap"]),"icon-overlap":new tt(be.layout_symbol["icon-overlap"]),"icon-ignore-placement":new tt(be.layout_symbol["icon-ignore-placement"]),"icon-optional":new tt(be.layout_symbol["icon-optional"]),"icon-rotation-alignment":new tt(be.layout_symbol["icon-rotation-alignment"]),"icon-size":new gt(be.layout_symbol["icon-size"]),"icon-text-fit":new tt(be.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new tt(be.layout_symbol["icon-text-fit-padding"]),"icon-image":new gt(be.layout_symbol["icon-image"]),"icon-rotate":new gt(be.layout_symbol["icon-rotate"]),"icon-padding":new gt(be.layout_symbol["icon-padding"]),"icon-keep-upright":new tt(be.layout_symbol["icon-keep-upright"]),"icon-offset":new gt(be.layout_symbol["icon-offset"]),"icon-anchor":new gt(be.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new tt(be.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new tt(be.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new tt(be.layout_symbol["text-rotation-alignment"]),"text-field":new gt(be.layout_symbol["text-field"]),"text-font":new gt(be.layout_symbol["text-font"]),"text-size":new gt(be.layout_symbol["text-size"]),"text-max-width":new gt(be.layout_symbol["text-max-width"]),"text-line-height":new tt(be.layout_symbol["text-line-height"]),"text-letter-spacing":new gt(be.layout_symbol["text-letter-spacing"]),"text-justify":new gt(be.layout_symbol["text-justify"]),"text-radial-offset":new gt(be.layout_symbol["text-radial-offset"]),"text-variable-anchor":new tt(be.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new gt(be.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new gt(be.layout_symbol["text-anchor"]),"text-max-angle":new tt(be.layout_symbol["text-max-angle"]),"text-writing-mode":new tt(be.layout_symbol["text-writing-mode"]),"text-rotate":new gt(be.layout_symbol["text-rotate"]),"text-padding":new tt(be.layout_symbol["text-padding"]),"text-keep-upright":new tt(be.layout_symbol["text-keep-upright"]),"text-transform":new gt(be.layout_symbol["text-transform"]),"text-offset":new gt(be.layout_symbol["text-offset"]),"text-allow-overlap":new tt(be.layout_symbol["text-allow-overlap"]),"text-overlap":new tt(be.layout_symbol["text-overlap"]),"text-ignore-placement":new tt(be.layout_symbol["text-ignore-placement"]),"text-optional":new tt(be.layout_symbol["text-optional"])})}};class v1{constructor(n){if(n.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=n.property.overrides?n.property.overrides.runtimeType:Is,this.defaultValue=n}evaluate(n){if(n.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(n.formattedSection))return a.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Qe("FormatSectionOverride",v1,{omit:["defaultValue"]});class wp extends o{constructor(n){super(n,Ty)}recalculate(n,a){if(super.recalculate(n,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const u=this.layout.get("text-writing-mode");if(u){const f=[];for(const _ of u)f.indexOf(_)<0&&f.push(_);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(n,a,u,f){const _=this.layout.get(n).evaluate(a,{},u,f),x=this._unevaluatedLayout._values[n];return x.isDataDriven()||bu(x.value)||!_?_:function(w,S){return S.replace(/{([^{}]+)}/g,(C,E)=>w&&E in w?String(w[E]):"")}(a.properties,_)}createBucket(n){return new Xu(n)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const n of Ty.paint.overridableProperties){if(!wp.hasPaintOverride(this.layout,n))continue;const a=this.paint.get(n),u=new v1(a),f=new wu(u,a.property.specification);let _=null;_=a.value.kind==="constant"||a.value.kind==="source"?new $a("source",f):new qa("composite",f,a.value.zoomStops),this.paint._values[n]=new Wi(a.property,_,a.parameters)}}_handleOverridablePaintPropertyUpdate(n,a,u){return!(!this.layout||a.isDataDriven()||u.isDataDriven())&&wp.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,a){const u=n.get("text-field"),f=Ty.paint.properties[a];let _=!1;const x=w=>{for(const S of w)if(f.overrides&&f.overrides.hasOverride(S))return void(_=!0)};if(u.value.kind==="constant"&&u.value.value instanceof Zn)x(u.value.value.sections);else if(u.value.kind==="source"){const w=C=>{_||(C instanceof bi&&Fr(C.value)===ls?x(C.value.sections):C instanceof du?x(C.sections):C.eachChild(w))},S=u.value;S._styleExpression&&w(S._styleExpression.expression)}return _}}let x1;var $M={get paint(){return x1=x1||new g({"background-color":new tt(be.paint_background["background-color"]),"background-pattern":new Ru(be.paint_background["background-pattern"]),"background-opacity":new tt(be.paint_background["background-opacity"])})}};class qM extends o{constructor(n){super(n,$M)}}let w1;var ZM={get paint(){return w1=w1||new g({"raster-opacity":new tt(be.paint_raster["raster-opacity"]),"raster-hue-rotate":new tt(be.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new tt(be.paint_raster["raster-brightness-min"]),"raster-brightness-max":new tt(be.paint_raster["raster-brightness-max"]),"raster-saturation":new tt(be.paint_raster["raster-saturation"]),"raster-contrast":new tt(be.paint_raster["raster-contrast"]),"raster-resampling":new tt(be.paint_raster["raster-resampling"]),"raster-fade-duration":new tt(be.paint_raster["raster-fade-duration"])})}};class HM extends o{constructor(n){super(n,ZM)}}class GM extends o{constructor(n){super(n,{}),this.onAdd=a=>{this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},this.onRemove=a=>{this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class WM{constructor(n){this._methodToThrottle=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Cy=63710088e-1;class oo{constructor(n,a){if(isNaN(n)||isNaN(a))throw new Error(`Invalid LngLat object: (${n}, ${a})`);if(this.lng=+n,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new oo(Se(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const a=Math.PI/180,u=this.lat*a,f=n.lat*a,_=Math.sin(u)*Math.sin(f)+Math.cos(u)*Math.cos(f)*Math.cos((n.lng-this.lng)*a);return Cy*Math.acos(Math.min(_,1))}static convert(n){if(n instanceof oo)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new oo(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new oo(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const b1=2*Math.PI*Cy;function S1(i){return b1*Math.cos(i*Math.PI/180)}function k1(i){return(180+i)/360}function T1(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function C1(i,n){return i/S1(n)}function My(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class td{constructor(n,a,u=0){this.x=+n,this.y=+a,this.z=+u}static fromLngLat(n,a=0){const u=oo.convert(n);return new td(k1(u.lng),T1(u.lat),C1(a,u.lat))}toLngLat(){return new oo(360*this.x-180,My(this.y))}toAltitude(){return this.z*S1(My(this.y))}meterInMercatorCoordinateUnits(){return 1/b1*(n=My(this.y),1/Math.cos(n*Math.PI/180));var n}}function M1(i,n,a){var u=2*Math.PI*6378137/256/Math.pow(2,a);return[i*u-2*Math.PI*6378137/2,n*u-2*Math.PI*6378137/2]}class Iy{constructor(n,a,u){if(!function(f,_,x){return!(f<0||f>25||x<0||x>=Math.pow(2,f)||_<0||_>=Math.pow(2,f))}(n,a,u))throw new Error(`x=${a}, y=${u}, z=${n} outside of bounds. 0<=x<${Math.pow(2,n)}, 0<=y<${Math.pow(2,n)} 0<=z<=25 `);this.z=n,this.x=a,this.y=u,this.key=rd(0,n,n,a,u)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,a,u){const f=(x=this.y,w=this.z,S=M1(256*(_=this.x),256*(x=Math.pow(2,w)-x-1),w),C=M1(256*(_+1),256*(x+1),w),S[0]+","+S[1]+","+C[0]+","+C[1]);var _,x,w,S,C;const E=function(A,F,B){let V,$="";for(let Y=A;Y>0;Y--)V=1<<Y-1,$+=(F&V?1:0)+(B&V?2:0);return $}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,E).replace(/{bbox-epsg-3857}/g,f)}isChildOf(n){const a=this.z-n.z;return a>0&&n.x===this.x>>a&&n.y===this.y>>a}getTilePoint(n){const a=Math.pow(2,this.z);return new z((n.x*a-this.x)*Or,(n.y*a-this.y)*Or)}toString(){return`${this.z}/${this.x}/${this.y}`}}class I1{constructor(n,a){this.wrap=n,this.canonical=a,this.key=rd(n,a.z,a.z,a.x,a.y)}}class Pi{constructor(n,a,u,f,_){if(n<u)throw new Error(`overscaledZ should be >= z; overscaledZ = ${n}; z = ${u}`);this.overscaledZ=n,this.wrap=a,this.canonical=new Iy(u,+f,+_),this.key=rd(a,n,u,f,_)}clone(){return new Pi(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-n;return n>this.canonical.z?new Pi(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Pi(n,this.wrap,n,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(n,a){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-n;return n>this.canonical.z?rd(this.wrap*+a,n,this.canonical.z,this.canonical.x,this.canonical.y):rd(this.wrap*+a,n,n,this.canonical.x>>u,this.canonical.y>>u)}isChildOf(n){if(n.wrap!==this.wrap)return!1;const a=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>a&&n.canonical.y===this.canonical.y>>a}children(n){if(this.overscaledZ>=n)return[new Pi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,u=2*this.canonical.x,f=2*this.canonical.y;return[new Pi(a,this.wrap,a,u,f),new Pi(a,this.wrap,a,u+1,f),new Pi(a,this.wrap,a,u,f+1),new Pi(a,this.wrap,a,u+1,f+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new Pi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new Pi(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new I1(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(n){return this.canonical.getTilePoint(new td(n.x-this.wrap,n.y))}}function rd(i,n,a,u,f){(i*=2)<0&&(i=-1*i-1);const _=1<<a;return(_*_*i+_*f+u).toString(36)+a.toString(36)+n.toString(36)}Qe("CanonicalTileID",Iy),Qe("OverscaledTileID",Pi,{omit:["posMatrix"]});class E1{constructor(n,a,u,f=1,_=1,x=1,w=0){if(this.uid=n,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(u&&!["mapbox","terrarium","custom"].includes(u))return void Pt(`"${u}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=a.height;const S=this.dim=a.height-2;switch(this.data=new Uint32Array(a.data.buffer),u){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=f,this.greenFactor=_,this.blueFactor=x,this.baseShift=w;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let C=0;C<S;C++)this.data[this._idx(-1,C)]=this.data[this._idx(0,C)],this.data[this._idx(S,C)]=this.data[this._idx(S-1,C)],this.data[this._idx(C,-1)]=this.data[this._idx(C,0)],this.data[this._idx(C,S)]=this.data[this._idx(C,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let C=0;C<S;C++)for(let E=0;E<S;E++){const A=this.get(C,E);A>this.max&&(this.max=A),A<this.min&&(this.min=A)}}get(n,a){const u=new Uint8Array(this.data.buffer),f=4*this._idx(n,a);return this.unpack(u[f],u[f+1],u[f+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(n,a){if(n<-1||n>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(n+1)}unpack(n,a,u){return n*this.redFactor+a*this.greenFactor+u*this.blueFactor-this.baseShift}getPixels(){return new Ei({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(n,a,u){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let f=a*this.dim,_=a*this.dim+this.dim,x=u*this.dim,w=u*this.dim+this.dim;switch(a){case-1:f=_-1;break;case 1:_=f+1}switch(u){case-1:x=w-1;break;case 1:w=x+1}const S=-a*this.dim,C=-u*this.dim;for(let E=x;E<w;E++)for(let A=f;A<_;A++)this.data[this._idx(A,E)]=n.data[this._idx(A+S,E+C)]}}Qe("DEMData",E1);class P1{constructor(n){this._stringToNumber={},this._numberToString=[];for(let a=0;a<n.length;a++){const u=n[a];this._stringToNumber[u]=a,this._numberToString[a]=u}}encode(n){return this._stringToNumber[n]}decode(n){if(n>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${n} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[n]}}class A1{constructor(n,a,u,f,_){this.type="Feature",this._vectorTileFeature=n,n._z=a,n._x=u,n._y=f,this.properties=n.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(n[a]=this[a]);return n}}class z1{constructor(n,a){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Ga(Or,16,0),this.grid3D=new Ga(Or,16,0),this.featureIndexArray=new wn,this.promoteId=a}insert(n,a,u,f,_,x){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,f,_);const S=x?this.grid3D:this.grid;for(let C=0;C<a.length;C++){const E=a[C],A=[1/0,1/0,-1/0,-1/0];for(let F=0;F<E.length;F++){const B=E[F];A[0]=Math.min(A[0],B.x),A[1]=Math.min(A[1],B.y),A[2]=Math.max(A[2],B.x),A[3]=Math.max(A[3],B.y)}A[0]<Or&&A[1]<Or&&A[2]>=0&&A[3]>=0&&S.insert(w,A[0],A[1],A[2],A[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new io.VectorTile(new gy(this.rawTileData)).layers,this.sourceLayerCoder=new P1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(n,a,u,f){this.loadVTLayers();const _=n.params||{},x=Or/n.tileSize/n.scale,w=wh(_.filter),S=n.queryGeometry,C=n.queryPadding*x,E=L1(S),A=this.grid.query(E.minX-C,E.minY-C,E.maxX+C,E.maxY+C),F=L1(n.cameraQueryGeometry),B=this.grid3D.query(F.minX-C,F.minY-C,F.maxX+C,F.maxY+C,(Y,ne,xe,ue)=>function(_e,Te,De,We,mt){for(const qe of _e)if(Te<=qe.x&&De<=qe.y&&We>=qe.x&&mt>=qe.y)return!0;const He=[new z(Te,De),new z(Te,mt),new z(We,mt),new z(We,De)];if(_e.length>2){for(const qe of He)if(Vu(_e,qe))return!0}for(let qe=0;qe<_e.length-1;qe++)if(IC(_e[qe],_e[qe+1],He))return!0;return!1}(n.cameraQueryGeometry,Y-C,ne-C,xe+C,ue+C));for(const Y of B)A.push(Y);A.sort(XM);const V={};let $;for(let Y=0;Y<A.length;Y++){const ne=A[Y];if(ne===$)continue;$=ne;const xe=this.featureIndexArray.get(ne);let ue=null;this.loadMatchingFeature(V,xe.bucketIndex,xe.sourceLayerIndex,xe.featureIndex,w,_.layers,_.availableImages,a,u,f,(_e,Te,De)=>(ue||(ue=ml(_e)),Te.queryIntersectsFeature(S,_e,De,ue,this.z,n.transform,x,n.pixelPosMatrix)))}return V}loadMatchingFeature(n,a,u,f,_,x,w,S,C,E,A){const F=this.bucketLayerIDs[a];if(x&&!function(Y,ne){for(let xe=0;xe<Y.length;xe++)if(ne.indexOf(Y[xe])>=0)return!0;return!1}(x,F))return;const B=this.sourceLayerCoder.decode(u),V=this.vtLayers[B].feature(f);if(_.needGeometry){const Y=gl(V,!0);if(!_.filter(new ur(this.tileID.overscaledZ),Y,this.tileID.canonical))return}else if(!_.filter(new ur(this.tileID.overscaledZ),V))return;const $=this.getId(V,B);for(let Y=0;Y<F.length;Y++){const ne=F[Y];if(x&&x.indexOf(ne)<0)continue;const xe=S[ne];if(!xe)continue;let ue={};$&&E&&(ue=E.getState(xe.sourceLayer||"_geojsonTileLayer",$));const _e=ze({},C[ne]);_e.paint=D1(_e.paint,xe.paint,V,ue,w),_e.layout=D1(_e.layout,xe.layout,V,ue,w);const Te=!A||A(V,xe,ue);if(!Te)continue;const De=new A1(V,this.z,this.x,this.y,$);De.layer=_e;let We=n[ne];We===void 0&&(We=n[ne]=[]),We.push({featureIndex:f,feature:De,intersectionZ:Te})}}lookupSymbolFeatures(n,a,u,f,_,x,w,S){const C={};this.loadVTLayers();const E=wh(_);for(const A of n)this.loadMatchingFeature(C,u,f,A,E,x,w,S,a);return C}hasLayer(n){for(const a of this.bucketLayerIDs)for(const u of a)if(n===u)return!0;return!1}getId(n,a){let u=n.id;return this.promoteId&&(u=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof u=="boolean"&&(u=Number(u))),u}}function D1(i,n,a,u,f){return ct(i,(_,x)=>{const w=n instanceof hl?n.get(x):null;return w&&w.evaluate?w.evaluate(a,u,f):w})}function L1(i){let n=1/0,a=1/0,u=-1/0,f=-1/0;for(const _ of i)n=Math.min(n,_.x),a=Math.min(a,_.y),u=Math.max(u,_.x),f=Math.max(f,_.y);return{minX:n,minY:a,maxX:u,maxY:f}}function XM(i,n){return n-i}function R1(i,n,a,u,f){const _=[];for(let x=0;x<i.length;x++){const w=i[x];let S;for(let C=0;C<w.length-1;C++){let E=w[C],A=w[C+1];E.x<n&&A.x<n||(E.x<n?E=new z(n,E.y+(n-E.x)/(A.x-E.x)*(A.y-E.y))._round():A.x<n&&(A=new z(n,E.y+(n-E.x)/(A.x-E.x)*(A.y-E.y))._round()),E.y<a&&A.y<a||(E.y<a?E=new z(E.x+(a-E.y)/(A.y-E.y)*(A.x-E.x),a)._round():A.y<a&&(A=new z(E.x+(a-E.y)/(A.y-E.y)*(A.x-E.x),a)._round()),E.x>=u&&A.x>=u||(E.x>=u?E=new z(u,E.y+(u-E.x)/(A.x-E.x)*(A.y-E.y))._round():A.x>=u&&(A=new z(u,E.y+(u-E.x)/(A.x-E.x)*(A.y-E.y))._round()),E.y>=f&&A.y>=f||(E.y>=f?E=new z(E.x+(f-E.y)/(A.y-E.y)*(A.x-E.x),f)._round():A.y>=f&&(A=new z(E.x+(f-E.y)/(A.y-E.y)*(A.x-E.x),f)._round()),S&&E.equals(S[S.length-1])||(S=[E],_.push(S)),S.push(A)))))}}return _}Qe("FeatureIndex",z1,{omit:["rawTileData","sourceLayerCoder"]});class lo extends z{constructor(n,a,u,f){super(n,a),this.angle=u,f!==void 0&&(this.segment=f)}clone(){return new lo(this.x,this.y,this.angle,this.segment)}}function F1(i,n,a,u,f){if(n.segment===void 0||a===0)return!0;let _=n,x=n.segment+1,w=0;for(;w>-a/2;){if(x--,x<0)return!1;w-=i[x].dist(_),_=i[x]}w+=i[x].dist(i[x+1]),x++;const S=[];let C=0;for(;w<a/2;){const E=i[x],A=i[x+1];if(!A)return!1;let F=i[x-1].angleTo(E)-E.angleTo(A);for(F=Math.abs((F+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:w,angleDelta:F}),C+=F;w-S[0].distance>u;)C-=S.shift().angleDelta;if(C>f)return!1;x++,w+=E.dist(A)}return!0}function O1(i){let n=0;for(let a=0;a<i.length-1;a++)n+=i[a].dist(i[a+1]);return n}function N1(i,n,a){return i?.6*n*a:0}function B1(i,n){return Math.max(i?i.right-i.left:0,n?n.right-n.left:0)}function KM(i,n,a,u,f,_){const x=N1(a,f,_),w=B1(a,u)*_;let S=0;const C=O1(i)/2;for(let E=0;E<i.length-1;E++){const A=i[E],F=i[E+1],B=A.dist(F);if(S+B>C){const V=(C-S)/B,$=Pn.number(A.x,F.x,V),Y=Pn.number(A.y,F.y,V),ne=new lo($,Y,F.angleTo(A),E);return ne._round(),!x||F1(i,ne,w,x,n)?ne:void 0}S+=B}}function YM(i,n,a,u,f,_,x,w,S){const C=N1(u,_,x),E=B1(u,f),A=E*x,F=i[0].x===0||i[0].x===S||i[0].y===0||i[0].y===S;return n-A<n/4&&(n=A+n/4),j1(i,F?n/2*w%n:(E/2+2*_)*x*w%n,n,C,a,A,F,!1,S)}function j1(i,n,a,u,f,_,x,w,S){const C=_/2,E=O1(i);let A=0,F=n-a,B=[];for(let V=0;V<i.length-1;V++){const $=i[V],Y=i[V+1],ne=$.dist(Y),xe=Y.angleTo($);for(;F+a<A+ne;){F+=a;const ue=(F-A)/ne,_e=Pn.number($.x,Y.x,ue),Te=Pn.number($.y,Y.y,ue);if(_e>=0&&_e<S&&Te>=0&&Te<S&&F-C>=0&&F+C<=E){const De=new lo(_e,Te,xe,V);De._round(),u&&!F1(i,De,_,u,f)||B.push(De)}}A+=ne}return w||B.length||x||(B=j1(i,A/2,a,u,f,_,x,!0,S)),B}Qe("Anchor",lo);const Ku=Yn;function U1(i,n,a,u){const f=[],_=i.image,x=_.pixelRatio,w=_.paddedRect.w-2*Ku,S=_.paddedRect.h-2*Ku;let C={x1:i.left,y1:i.top,x2:i.right,y2:i.bottom};const E=_.stretchX||[[0,w]],A=_.stretchY||[[0,S]],F=(Ie,ot)=>Ie+ot[1]-ot[0],B=E.reduce(F,0),V=A.reduce(F,0),$=w-B,Y=S-V;let ne=0,xe=B,ue=0,_e=V,Te=0,De=$,We=0,mt=Y;if(_.content&&u){const Ie=_.content,ot=Ie[2]-Ie[0],nt=Ie[3]-Ie[1];(_.textFitWidth||_.textFitHeight)&&(C=p1(i)),ne=bp(E,0,Ie[0]),ue=bp(A,0,Ie[1]),xe=bp(E,Ie[0],Ie[2]),_e=bp(A,Ie[1],Ie[3]),Te=Ie[0]-ne,We=Ie[1]-ue,De=ot-xe,mt=nt-_e}const He=C.x1,qe=C.y1,st=C.x2-He,Je=C.y2-qe,Ye=(Ie,ot,nt,xt)=>{const ir=Sp(Ie.stretch-ne,xe,st,He),nr=kp(Ie.fixed-Te,De,Ie.stretch,B),qr=Sp(ot.stretch-ue,_e,Je,qe),Ki=kp(ot.fixed-We,mt,ot.stretch,V),un=Sp(nt.stretch-ne,xe,st,He),Zr=kp(nt.fixed-Te,De,nt.stretch,B),Ln=Sp(xt.stretch-ue,_e,Je,qe),Rn=kp(xt.fixed-We,mt,xt.stretch,V),Fn=new z(ir,qr),Tr=new z(un,qr),Hr=new z(un,Ln),Sn=new z(ir,Ln),cn=new z(nr/x,Ki/x),On=new z(Zr/x,Rn/x),hn=n*Math.PI/180;if(hn){const $t=Math.sin(hn),or=Math.cos(hn),fr=[or,-$t,$t,or];Fn._matMult(fr),Tr._matMult(fr),Sn._matMult(fr),Hr._matMult(fr)}const Ai=Ie.stretch+Ie.fixed,Qn=ot.stretch+ot.fixed;return{tl:Fn,tr:Tr,bl:Sn,br:Hr,tex:{x:_.paddedRect.x+Ku+Ai,y:_.paddedRect.y+Ku+Qn,w:nt.stretch+nt.fixed-Ai,h:xt.stretch+xt.fixed-Qn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:cn,pixelOffsetBR:On,minFontScaleX:De/x/st,minFontScaleY:mt/x/Je,isSDF:a}};if(u&&(_.stretchX||_.stretchY)){const Ie=V1(E,$,B),ot=V1(A,Y,V);for(let nt=0;nt<Ie.length-1;nt++){const xt=Ie[nt],ir=Ie[nt+1];for(let nr=0;nr<ot.length-1;nr++)f.push(Ye(xt,ot[nr],ir,ot[nr+1]))}}else f.push(Ye({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:S+1}));return f}function bp(i,n,a){let u=0;for(const f of i)u+=Math.max(n,Math.min(a,f[1]))-Math.max(n,Math.min(a,f[0]));return u}function V1(i,n,a){const u=[{fixed:-Ku,stretch:0}];for(const[f,_]of i){const x=u[u.length-1];u.push({fixed:f-x.stretch,stretch:x.stretch}),u.push({fixed:f-x.stretch,stretch:x.stretch+(_-f)})}return u.push({fixed:n+Ku,stretch:a}),u}function Sp(i,n,a,u){return i/n*a+u}function kp(i,n,a,u){return i-n*a/u}class Tp{constructor(n,a,u,f,_,x,w,S,C,E){var A;if(this.boxStartIndex=n.length,C){let F=x.top,B=x.bottom;const V=x.collisionPadding;V&&(F-=V[1],B+=V[3]);let $=B-F;$>0&&($=Math.max(10,$),this.circleDiameter=$)}else{const F=!((A=x.image)===null||A===void 0)&&A.content&&(x.image.textFitWidth||x.image.textFitHeight)?p1(x):{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom};F.y1=F.y1*w-S[0],F.y2=F.y2*w+S[2],F.x1=F.x1*w-S[3],F.x2=F.x2*w+S[1];const B=x.collisionPadding;if(B&&(F.x1-=B[0]*w,F.y1-=B[1]*w,F.x2+=B[2]*w,F.y2+=B[3]*w),E){const V=new z(F.x1,F.y1),$=new z(F.x2,F.y1),Y=new z(F.x1,F.y2),ne=new z(F.x2,F.y2),xe=E*Math.PI/180;V._rotate(xe),$._rotate(xe),Y._rotate(xe),ne._rotate(xe),F.x1=Math.min(V.x,$.x,Y.x,ne.x),F.x2=Math.max(V.x,$.x,Y.x,ne.x),F.y1=Math.min(V.y,$.y,Y.y,ne.y),F.y2=Math.max(V.y,$.y,Y.y,ne.y)}n.emplaceBack(a.x,a.y,F.x1,F.y1,F.x2,F.y2,u,f,_)}this.boxEndIndex=n.length}}class QM{constructor(n=[],a=(u,f)=>u<f?-1:u>f?1:0){if(this.data=n,this.length=this.data.length,this.compare=a,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:a,compare:u}=this,f=a[n];for(;n>0;){const _=n-1>>1,x=a[_];if(u(f,x)>=0)break;a[n]=x,n=_}a[n]=f}_down(n){const{data:a,compare:u}=this,f=this.length>>1,_=a[n];for(;n<f;){let x=1+(n<<1);const w=x+1;if(w<this.length&&u(a[w],a[x])<0&&(x=w),u(a[x],_)>=0)break;a[n]=a[x],n=x}a[n]=_}}function JM(i,n=1,a=!1){let u=1/0,f=1/0,_=-1/0,x=-1/0;const w=i[0];for(let B=0;B<w.length;B++){const V=w[B];(!B||V.x<u)&&(u=V.x),(!B||V.y<f)&&(f=V.y),(!B||V.x>_)&&(_=V.x),(!B||V.y>x)&&(x=V.y)}const S=Math.min(_-u,x-f);let C=S/2;const E=new QM([],eI);if(S===0)return new z(u,f);for(let B=u;B<_;B+=S)for(let V=f;V<x;V+=S)E.push(new Yu(B+C,V+C,C,i));let A=function(B){let V=0,$=0,Y=0;const ne=B[0];for(let xe=0,ue=ne.length,_e=ue-1;xe<ue;_e=xe++){const Te=ne[xe],De=ne[_e],We=Te.x*De.y-De.x*Te.y;$+=(Te.x+De.x)*We,Y+=(Te.y+De.y)*We,V+=3*We}return new Yu($/V,Y/V,0,B)}(i),F=E.length;for(;E.length;){const B=E.pop();(B.d>A.d||!A.d)&&(A=B,a&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,F)),B.max-A.d<=n||(C=B.h/2,E.push(new Yu(B.p.x-C,B.p.y-C,C,i)),E.push(new Yu(B.p.x+C,B.p.y-C,C,i)),E.push(new Yu(B.p.x-C,B.p.y+C,C,i)),E.push(new Yu(B.p.x+C,B.p.y+C,C,i)),F+=4)}return a&&(console.log(`num probes: ${F}`),console.log(`best distance: ${A.d}`)),A.p}function eI(i,n){return n.max-i.max}function Yu(i,n,a,u){this.p=new z(i,n),this.h=a,this.d=function(f,_){let x=!1,w=1/0;for(let S=0;S<_.length;S++){const C=_[S];for(let E=0,A=C.length,F=A-1;E<A;F=E++){const B=C[E],V=C[F];B.y>f.y!=V.y>f.y&&f.x<(V.x-B.x)*(f.y-B.y)/(V.y-B.y)+B.x&&(x=!x),w=Math.min(w,Tx(f,B,V))}}return(x?1:-1)*Math.sqrt(w)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}var ln;y.aq=void 0,(ln=y.aq||(y.aq={}))[ln.center=1]="center",ln[ln.left=2]="left",ln[ln.right=3]="right",ln[ln.top=4]="top",ln[ln.bottom=5]="bottom",ln[ln["top-left"]=6]="top-left",ln[ln["top-right"]=7]="top-right",ln[ln["bottom-left"]=8]="bottom-left",ln[ln["bottom-right"]=9]="bottom-right";const uo=7,Ey=Number.POSITIVE_INFINITY;function $1(i,n){return n[1]!==Ey?function(a,u,f){let _=0,x=0;switch(u=Math.abs(u),f=Math.abs(f),a){case"top-right":case"top-left":case"top":x=f-uo;break;case"bottom-right":case"bottom-left":case"bottom":x=-f+uo}switch(a){case"top-right":case"bottom-right":case"right":_=-u;break;case"top-left":case"bottom-left":case"left":_=u}return[_,x]}(i,n[0],n[1]):function(a,u){let f=0,_=0;u<0&&(u=0);const x=u/Math.SQRT2;switch(a){case"top-right":case"top-left":_=x-uo;break;case"bottom-right":case"bottom-left":_=-x+uo;break;case"bottom":_=-u+uo;break;case"top":_=u-uo}switch(a){case"top-right":case"bottom-right":f=-x;break;case"top-left":case"bottom-left":f=x;break;case"left":f=u;break;case"right":f=-u}return[f,_]}(i,n[0])}function q1(i,n,a){var u;const f=i.layout,_=(u=f.get("text-variable-anchor-offset"))===null||u===void 0?void 0:u.evaluate(n,{},a);if(_){const w=_.values,S=[];for(let C=0;C<w.length;C+=2){const E=S[C]=w[C],A=w[C+1].map(F=>F*jr);E.startsWith("top")?A[1]-=uo:E.startsWith("bottom")&&(A[1]+=uo),S[C+1]=A}return new si(S)}const x=f.get("text-variable-anchor");if(x){let w;w=i._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[f.get("text-radial-offset").evaluate(n,{},a)*jr,Ey]:f.get("text-offset").evaluate(n,{},a).map(C=>C*jr);const S=[];for(const C of x)S.push(C,$1(C,w));return new si(S)}return null}function Py(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function tI(i,n,a,u,f,_,x,w,S,C,E){let A=_.textMaxSize.evaluate(n,{});A===void 0&&(A=x);const F=i.layers[0].layout,B=F.get("icon-offset").evaluate(n,{},E),V=H1(a.horizontal),$=x/24,Y=i.tilePixelRatio*$,ne=i.tilePixelRatio*A/24,xe=i.tilePixelRatio*w,ue=i.tilePixelRatio*F.get("symbol-spacing"),_e=F.get("text-padding")*i.tilePixelRatio,Te=function(Ie,ot,nt,xt=1){const ir=Ie.get("icon-padding").evaluate(ot,{},nt),nr=ir&&ir.values;return[nr[0]*xt,nr[1]*xt,nr[2]*xt,nr[3]*xt]}(F,n,E,i.tilePixelRatio),De=F.get("text-max-angle")/180*Math.PI,We=F.get("text-rotation-alignment")!=="viewport"&&F.get("symbol-placement")!=="point",mt=F.get("icon-rotation-alignment")==="map"&&F.get("symbol-placement")!=="point",He=F.get("symbol-placement"),qe=ue/2,st=F.get("icon-text-fit");let Je;u&&st!=="none"&&(i.allowVerticalPlacement&&a.vertical&&(Je=m1(u,a.vertical,st,F.get("icon-text-fit-padding"),B,$)),V&&(u=m1(u,V,st,F.get("icon-text-fit-padding"),B,$)));const Ye=(Ie,ot)=>{ot.x<0||ot.x>=Or||ot.y<0||ot.y>=Or||function(nt,xt,ir,nr,qr,Ki,un,Zr,Ln,Rn,Fn,Tr,Hr,Sn,cn,On,hn,Ai,Qn,$t,or,fr,di,xr,Qu){const Rs=nt.addToLineVertexArray(xt,ir);let Fs,Yi,zi,Yr,ua=0,sd=0,K1=0,Y1=0,Ny=-1,By=-1;const ca={};let Q1=Nu("");if(nt.allowVerticalPlacement&&nr.vertical){const kn=Zr.layout.get("text-rotate").evaluate(or,{},xr)+90;zi=new Tp(Ln,xt,Rn,Fn,Tr,nr.vertical,Hr,Sn,cn,kn),un&&(Yr=new Tp(Ln,xt,Rn,Fn,Tr,un,hn,Ai,cn,kn))}if(qr){const kn=Zr.layout.get("icon-rotate").evaluate(or,{}),Di=Zr.layout.get("icon-text-fit")!=="none",_l=U1(qr,kn,di,Di),fs=un?U1(un,kn,di,Di):void 0;Yi=new Tp(Ln,xt,Rn,Fn,Tr,qr,hn,Ai,!1,kn),ua=4*_l.length;const vl=nt.iconSizeData;let Os=null;vl.kind==="source"?(Os=[Ls*Zr.layout.get("icon-size").evaluate(or,{})],Os[0]>ao&&Pt(`${nt.layerIds[0]}: Value for "icon-size" is >= ${ed}. Reduce your "icon-size".`)):vl.kind==="composite"&&(Os=[Ls*fr.compositeIconSizes[0].evaluate(or,{},xr),Ls*fr.compositeIconSizes[1].evaluate(or,{},xr)],(Os[0]>ao||Os[1]>ao)&&Pt(`${nt.layerIds[0]}: Value for "icon-size" is >= ${ed}. Reduce your "icon-size".`)),nt.addSymbols(nt.icon,_l,Os,$t,Qn,or,y.ah.none,xt,Rs.lineStartIndex,Rs.lineLength,-1,xr),Ny=nt.icon.placedSymbolArray.length-1,fs&&(sd=4*fs.length,nt.addSymbols(nt.icon,fs,Os,$t,Qn,or,y.ah.vertical,xt,Rs.lineStartIndex,Rs.lineLength,-1,xr),By=nt.icon.placedSymbolArray.length-1)}const J1=Object.keys(nr.horizontal);for(const kn of J1){const Di=nr.horizontal[kn];if(!Fs){Q1=Nu(Di.text);const fs=Zr.layout.get("text-rotate").evaluate(or,{},xr);Fs=new Tp(Ln,xt,Rn,Fn,Tr,Di,Hr,Sn,cn,fs)}const _l=Di.positionedLines.length===1;if(K1+=Z1(nt,xt,Di,Ki,Zr,cn,or,On,Rs,nr.vertical?y.ah.horizontal:y.ah.horizontalOnly,_l?J1:[kn],ca,Ny,fr,xr),_l)break}nr.vertical&&(Y1+=Z1(nt,xt,nr.vertical,Ki,Zr,cn,or,On,Rs,y.ah.vertical,["vertical"],ca,By,fr,xr));const iI=Fs?Fs.boxStartIndex:nt.collisionBoxArray.length,sI=Fs?Fs.boxEndIndex:nt.collisionBoxArray.length,aI=zi?zi.boxStartIndex:nt.collisionBoxArray.length,oI=zi?zi.boxEndIndex:nt.collisionBoxArray.length,lI=Yi?Yi.boxStartIndex:nt.collisionBoxArray.length,uI=Yi?Yi.boxEndIndex:nt.collisionBoxArray.length,cI=Yr?Yr.boxStartIndex:nt.collisionBoxArray.length,hI=Yr?Yr.boxEndIndex:nt.collisionBoxArray.length;let ds=-1;const Mp=(kn,Di)=>kn&&kn.circleDiameter?Math.max(kn.circleDiameter,Di):Di;ds=Mp(Fs,ds),ds=Mp(zi,ds),ds=Mp(Yi,ds),ds=Mp(Yr,ds);const ew=ds>-1?1:0;ew&&(ds*=Qu/jr),nt.glyphOffsetArray.length>=Xu.MAX_GLYPHS&&Pt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),or.sortKey!==void 0&&nt.addToSortKeyRanges(nt.symbolInstances.length,or.sortKey);const dI=q1(Zr,or,xr),[fI,pI]=function(kn,Di){const _l=kn.length,fs=Di==null?void 0:Di.values;if((fs==null?void 0:fs.length)>0)for(let vl=0;vl<fs.length;vl+=2){const Os=fs[vl+1];kn.emplaceBack(y.aq[fs[vl]],Os[0],Os[1])}return[_l,kn.length]}(nt.textAnchorOffsets,dI);nt.symbolInstances.emplaceBack(xt.x,xt.y,ca.right>=0?ca.right:-1,ca.center>=0?ca.center:-1,ca.left>=0?ca.left:-1,ca.vertical||-1,Ny,By,Q1,iI,sI,aI,oI,lI,uI,cI,hI,Rn,K1,Y1,ua,sd,ew,0,Hr,ds,fI,pI)}(i,ot,Ie,a,u,f,Je,i.layers[0],i.collisionBoxArray,n.index,n.sourceLayerIndex,i.index,Y,[_e,_e,_e,_e],We,S,xe,Te,mt,B,n,_,C,E,x)};if(He==="line")for(const Ie of R1(n.geometry,0,0,Or,Or)){const ot=YM(Ie,ue,De,a.vertical||V,u,24,ne,i.overscaling,Or);for(const nt of ot)V&&rI(i,V.text,qe,nt)||Ye(Ie,nt)}else if(He==="line-center"){for(const Ie of n.geometry)if(Ie.length>1){const ot=KM(Ie,De,a.vertical||V,u,24,ne);ot&&Ye(Ie,ot)}}else if(n.type==="Polygon")for(const Ie of pu(n.geometry,0)){const ot=JM(Ie,16);Ye(Ie[0],new lo(ot.x,ot.y,0))}else if(n.type==="LineString")for(const Ie of n.geometry)Ye(Ie,new lo(Ie[0].x,Ie[0].y,0));else if(n.type==="Point")for(const Ie of n.geometry)for(const ot of Ie)Ye([ot],new lo(ot.x,ot.y,0))}function Z1(i,n,a,u,f,_,x,w,S,C,E,A,F,B,V){const $=function(xe,ue,_e,Te,De,We,mt,He){const qe=Te.layout.get("text-rotate").evaluate(We,{})*Math.PI/180,st=[];for(const Je of ue.positionedLines)for(const Ye of Je.positionedGlyphs){if(!Ye.rect)continue;const Ie=Ye.rect||{};let ot=o1+1,nt=!0,xt=1,ir=0;const nr=(De||He)&&Ye.vertical,qr=Ye.metrics.advance*Ye.scale/2;if(He&&ue.verticalizable&&(ir=Je.lineOffset/2-(Ye.imageName?-(jr-Ye.metrics.width*Ye.scale)/2:(Ye.scale-1)*jr)),Ye.imageName){const $t=mt[Ye.imageName];nt=$t.sdf,xt=$t.pixelRatio,ot=Yn/xt}const Ki=De?[Ye.x+qr,Ye.y]:[0,0];let un=De?[0,0]:[Ye.x+qr+_e[0],Ye.y+_e[1]-ir],Zr=[0,0];nr&&(Zr=un,un=[0,0]);const Ln=Ye.metrics.isDoubleResolution?2:1,Rn=(Ye.metrics.left-ot)*Ye.scale-qr+un[0],Fn=(-Ye.metrics.top-ot)*Ye.scale+un[1],Tr=Rn+Ie.w/Ln*Ye.scale/xt,Hr=Fn+Ie.h/Ln*Ye.scale/xt,Sn=new z(Rn,Fn),cn=new z(Tr,Fn),On=new z(Rn,Hr),hn=new z(Tr,Hr);if(nr){const $t=new z(-qr,qr-Qh),or=-Math.PI/2,fr=jr/2-qr,di=new z(5-Qh-fr,-(Ye.imageName?fr:0)),xr=new z(...Zr);Sn._rotateAround(or,$t)._add(di)._add(xr),cn._rotateAround(or,$t)._add(di)._add(xr),On._rotateAround(or,$t)._add(di)._add(xr),hn._rotateAround(or,$t)._add(di)._add(xr)}if(qe){const $t=Math.sin(qe),or=Math.cos(qe),fr=[or,-$t,$t,or];Sn._matMult(fr),cn._matMult(fr),On._matMult(fr),hn._matMult(fr)}const Ai=new z(0,0),Qn=new z(0,0);st.push({tl:Sn,tr:cn,bl:On,br:hn,tex:Ie,writingMode:ue.writingMode,glyphOffset:Ki,sectionIndex:Ye.sectionIndex,isSDF:nt,pixelOffsetTL:Ai,pixelOffsetBR:Qn,minFontScaleX:0,minFontScaleY:0})}return st}(0,a,w,f,_,x,u,i.allowVerticalPlacement),Y=i.textSizeData;let ne=null;Y.kind==="source"?(ne=[Ls*f.layout.get("text-size").evaluate(x,{})],ne[0]>ao&&Pt(`${i.layerIds[0]}: Value for "text-size" is >= ${ed}. Reduce your "text-size".`)):Y.kind==="composite"&&(ne=[Ls*B.compositeTextSizes[0].evaluate(x,{},V),Ls*B.compositeTextSizes[1].evaluate(x,{},V)],(ne[0]>ao||ne[1]>ao)&&Pt(`${i.layerIds[0]}: Value for "text-size" is >= ${ed}. Reduce your "text-size".`)),i.addSymbols(i.text,$,ne,w,_,x,C,n,S.lineStartIndex,S.lineLength,F,V);for(const xe of E)A[xe]=i.text.placedSymbolArray.length-1;return 4*$.length}function H1(i){for(const n in i)return i[n];return null}function rI(i,n,a,u){const f=i.compareText;if(n in f){const _=f[n];for(let x=_.length-1;x>=0;x--)if(u.dist(_[x])<a)return!0}else f[n]=[];return f[n].push(u),!1}const G1=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ay{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,u]=new Uint8Array(n,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=u>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const _=G1[15&u];if(!_)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(n,2,1),[w]=new Uint32Array(n,4,1);return new Ay(w,x,_,n)}constructor(n,a=64,u=Float64Array,f){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=u,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const _=G1.indexOf(this.ArrayType),x=2*n*this.ArrayType.BYTES_PER_ELEMENT,w=n*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-w%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${u}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+w+S,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+x+w+S),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+w+S,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=n)}add(n,a){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=n,this.coords[this._pos++]=a,u}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return zy(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,a,u,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:x,nodeSize:w}=this,S=[0,_.length-1,0],C=[];for(;S.length;){const E=S.pop()||0,A=S.pop()||0,F=S.pop()||0;if(A-F<=w){for(let Y=F;Y<=A;Y++){const ne=x[2*Y],xe=x[2*Y+1];ne>=n&&ne<=u&&xe>=a&&xe<=f&&C.push(_[Y])}continue}const B=F+A>>1,V=x[2*B],$=x[2*B+1];V>=n&&V<=u&&$>=a&&$<=f&&C.push(_[B]),(E===0?n<=V:a<=$)&&(S.push(F),S.push(B-1),S.push(1-E)),(E===0?u>=V:f>=$)&&(S.push(B+1),S.push(A),S.push(1-E))}return C}within(n,a,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:_,nodeSize:x}=this,w=[0,f.length-1,0],S=[],C=u*u;for(;w.length;){const E=w.pop()||0,A=w.pop()||0,F=w.pop()||0;if(A-F<=x){for(let Y=F;Y<=A;Y++)X1(_[2*Y],_[2*Y+1],n,a)<=C&&S.push(f[Y]);continue}const B=F+A>>1,V=_[2*B],$=_[2*B+1];X1(V,$,n,a)<=C&&S.push(f[B]),(E===0?n-u<=V:a-u<=$)&&(w.push(F),w.push(B-1),w.push(1-E)),(E===0?n+u>=V:a+u>=$)&&(w.push(B+1),w.push(A),w.push(1-E))}return S}}function zy(i,n,a,u,f,_){if(f-u<=a)return;const x=u+f>>1;W1(i,n,x,u,f,_),zy(i,n,a,u,x-1,1-_),zy(i,n,a,x+1,f,1-_)}function W1(i,n,a,u,f,_){for(;f>u;){if(f-u>600){const C=f-u+1,E=a-u+1,A=Math.log(C),F=.5*Math.exp(2*A/3),B=.5*Math.sqrt(A*F*(C-F)/C)*(E-C/2<0?-1:1);W1(i,n,a,Math.max(u,Math.floor(a-E*F/C+B)),Math.min(f,Math.floor(a+(C-E)*F/C+B)),_)}const x=n[2*a+_];let w=u,S=f;for(nd(i,n,u,a),n[2*f+_]>x&&nd(i,n,u,f);w<S;){for(nd(i,n,w,S),w++,S--;n[2*w+_]<x;)w++;for(;n[2*S+_]>x;)S--}n[2*u+_]===x?nd(i,n,u,S):(S++,nd(i,n,S,f)),S<=a&&(u=S+1),a<=S&&(f=S-1)}}function nd(i,n,a,u){Dy(i,a,u),Dy(n,2*a,2*u),Dy(n,2*a+1,2*u+1)}function Dy(i,n,a){const u=i[n];i[n]=i[a],i[a]=u}function X1(i,n,a,u){const f=i-a,_=n-u;return f*f+_*_}var Ly;y.bg=void 0,(Ly=y.bg||(y.bg={})).create="create",Ly.load="load",Ly.fullLoad="fullLoad";let Cp=null,id=[];const Ry=1e3/60,Fy="loadTime",Oy="fullLoadTime",nI={mark(i){performance.mark(i)},frame(i){const n=i;Cp!=null&&id.push(n-Cp),Cp=n},clearMetrics(){Cp=null,id=[],performance.clearMeasures(Fy),performance.clearMeasures(Oy);for(const i in y.bg)performance.clearMarks(y.bg[i])},getPerformanceMetrics(){performance.measure(Fy,y.bg.create,y.bg.load),performance.measure(Oy,y.bg.create,y.bg.fullLoad);const i=performance.getEntriesByName(Fy)[0].duration,n=performance.getEntriesByName(Oy)[0].duration,a=id.length,u=1/(id.reduce((_,x)=>_+x,0)/a/1e3),f=id.filter(_=>_>Ry).reduce((_,x)=>_+(x-Ry)/Ry,0);return{loadTime:i,fullLoadTime:n,fps:u,percentDroppedFrames:f/(a+f)*100,totalFrames:a}}};y.$=class extends D{},y.A=$u,y.B=Zg,y.C=function(i){if(yn==null){const n=i.navigator?i.navigator.userAgent:null;yn=!!i.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return yn},y.D=tt,y.E=Lr,y.F=class{constructor(i,n){this.target=i,this.mapId=n,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new WM(()=>this.process()),this.subscription=function(a,u,f,_){return a.addEventListener(u,f,!1),{unsubscribe:()=>{a.removeEventListener(u,f,!1)}}}(this.target,"message",a=>this.receive(a)),this.globalScope=pr(self)?i:window}registerMessageHandler(i,n){this.messageHandlers[i]=n}sendAsync(i,n){return new Promise((a,u)=>{const f=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[f]={resolve:a,reject:u},n&&n.signal.addEventListener("abort",()=>{delete this.resolveRejects[f];const w={id:f,type:"<cancel>",origin:location.origin,targetMapId:i.targetMapId,sourceMapId:this.mapId};this.target.postMessage(w)},{once:!0});const _=[],x=Object.assign(Object.assign({},i),{id:f,sourceMapId:this.mapId,origin:location.origin,data:Wa(i.data,_)});this.target.postMessage(x,{transfer:_})})}receive(i){const n=i.data,a=n.id;if(!(n.origin!=="file://"&&location.origin!=="file://"&&n.origin!=="resource://android"&&location.origin!=="resource://android"&&n.origin!==location.origin||n.targetMapId&&this.mapId!==n.targetMapId)){if(n.type==="<cancel>"){delete this.tasks[a];const u=this.abortControllers[a];return delete this.abortControllers[a],void(u&&u.abort())}if(pr(self)||n.mustQueue)return this.tasks[a]=n,this.taskQueue.push(a),void this.invoker.trigger();this.processTask(a,n)}}process(){if(this.taskQueue.length===0)return;const i=this.taskQueue.shift(),n=this.tasks[i];delete this.tasks[i],this.taskQueue.length>0&&this.invoker.trigger(),n&&this.processTask(i,n)}processTask(i,n){return c(this,void 0,void 0,function*(){if(n.type==="<response>"){const f=this.resolveRejects[i];return delete this.resolveRejects[i],f?void(n.error?f.reject(Xa(n.error)):f.resolve(Xa(n.data))):void 0}if(!this.messageHandlers[n.type])return void this.completeTask(i,new Error(`Could not find a registered handler for ${n.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const a=Xa(n.data),u=new AbortController;this.abortControllers[i]=u;try{const f=yield this.messageHandlers[n.type](n.sourceMapId,a,u);this.completeTask(i,null,f)}catch(f){this.completeTask(i,f)}})}completeTask(i,n,a){const u=[];delete this.abortControllers[i];const f={id:i,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:n?Wa(n):null,data:Wa(a,u)};this.target.postMessage(f,{transfer:u})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},y.G=rn,y.H=function(){var i=new $u(16);return $u!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},y.I=_y,y.J=function(i,n,a){var u,f,_,x,w,S,C,E,A,F,B,V,$=a[0],Y=a[1],ne=a[2];return n===i?(i[12]=n[0]*$+n[4]*Y+n[8]*ne+n[12],i[13]=n[1]*$+n[5]*Y+n[9]*ne+n[13],i[14]=n[2]*$+n[6]*Y+n[10]*ne+n[14],i[15]=n[3]*$+n[7]*Y+n[11]*ne+n[15]):(f=n[1],_=n[2],x=n[3],w=n[4],S=n[5],C=n[6],E=n[7],A=n[8],F=n[9],B=n[10],V=n[11],i[0]=u=n[0],i[1]=f,i[2]=_,i[3]=x,i[4]=w,i[5]=S,i[6]=C,i[7]=E,i[8]=A,i[9]=F,i[10]=B,i[11]=V,i[12]=u*$+w*Y+A*ne+n[12],i[13]=f*$+S*Y+F*ne+n[13],i[14]=_*$+C*Y+B*ne+n[14],i[15]=x*$+E*Y+V*ne+n[15]),i},y.K=function(i,n,a){var u=a[0],f=a[1],_=a[2];return i[0]=n[0]*u,i[1]=n[1]*u,i[2]=n[2]*u,i[3]=n[3]*u,i[4]=n[4]*f,i[5]=n[5]*f,i[6]=n[6]*f,i[7]=n[7]*f,i[8]=n[8]*_,i[9]=n[9]*_,i[10]=n[10]*_,i[11]=n[11]*_,i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],i},y.L=Ex,y.M=function(i,n){const a={};for(let u=0;u<n.length;u++){const f=n[u];f in i&&(a[f]=i[f])}return a},y.N=oo,y.O=k1,y.P=z,y.Q=T1,y.R=Ei,y.S=Pi,y.T=Du,y.U=W,y.V=Q,y.W=yt,y.X=Or,y.Y=b,y.Z=td,y._=c,y.a=Vr,y.a$=function(i,n){var a=i[0],u=i[1],f=i[2],_=i[3],x=i[4],w=i[5],S=i[6],C=i[7],E=i[8],A=i[9],F=i[10],B=i[11],V=i[12],$=i[13],Y=i[14],ne=i[15],xe=n[0],ue=n[1],_e=n[2],Te=n[3],De=n[4],We=n[5],mt=n[6],He=n[7],qe=n[8],st=n[9],Je=n[10],Ye=n[11],Ie=n[12],ot=n[13],nt=n[14],xt=n[15];return Math.abs(a-xe)<=Dn*Math.max(1,Math.abs(a),Math.abs(xe))&&Math.abs(u-ue)<=Dn*Math.max(1,Math.abs(u),Math.abs(ue))&&Math.abs(f-_e)<=Dn*Math.max(1,Math.abs(f),Math.abs(_e))&&Math.abs(_-Te)<=Dn*Math.max(1,Math.abs(_),Math.abs(Te))&&Math.abs(x-De)<=Dn*Math.max(1,Math.abs(x),Math.abs(De))&&Math.abs(w-We)<=Dn*Math.max(1,Math.abs(w),Math.abs(We))&&Math.abs(S-mt)<=Dn*Math.max(1,Math.abs(S),Math.abs(mt))&&Math.abs(C-He)<=Dn*Math.max(1,Math.abs(C),Math.abs(He))&&Math.abs(E-qe)<=Dn*Math.max(1,Math.abs(E),Math.abs(qe))&&Math.abs(A-st)<=Dn*Math.max(1,Math.abs(A),Math.abs(st))&&Math.abs(F-Je)<=Dn*Math.max(1,Math.abs(F),Math.abs(Je))&&Math.abs(B-Ye)<=Dn*Math.max(1,Math.abs(B),Math.abs(Ye))&&Math.abs(V-Ie)<=Dn*Math.max(1,Math.abs(V),Math.abs(Ie))&&Math.abs($-ot)<=Dn*Math.max(1,Math.abs($),Math.abs(ot))&&Math.abs(Y-nt)<=Dn*Math.max(1,Math.abs(Y),Math.abs(nt))&&Math.abs(ne-xt)<=Dn*Math.max(1,Math.abs(ne),Math.abs(xt))},y.a0=Ot,y.a1=Iy,y.a2=Oe,y.a3=i=>{const n=window.document.createElement("video");return n.muted=!0,new Promise(a=>{n.onloadstart=()=>{a(n)};for(const u of i){const f=window.document.createElement("source");Tt(u)||(n.crossOrigin="Anonymous"),f.src=u,n.appendChild(f)}})},y.a4=function(){return Fe++},y.a5=Ge,y.a6=Xu,y.a7=wh,y.a8=gl,y.a9=A1,y.aA=function(i){if(i.type==="custom")return new GM(i);switch(i.type){case"background":return new qM(i);case"circle":return new AC(i);case"fill":return new WC(i);case"fill-extrusion":return new uM(i);case"heatmap":return new DC(i);case"hillshade":return new RC(i);case"line":return new yM(i);case"raster":return new HM(i);case"symbol":return new wp(i)}},y.aB=ht,y.aC=function(i,n){if(!i)return[{command:"setStyle",args:[n]}];let a=[];try{if(!qt(i.version,n.version))return[{command:"setStyle",args:[n]}];qt(i.center,n.center)||a.push({command:"setCenter",args:[n.center]}),qt(i.zoom,n.zoom)||a.push({command:"setZoom",args:[n.zoom]}),qt(i.bearing,n.bearing)||a.push({command:"setBearing",args:[n.bearing]}),qt(i.pitch,n.pitch)||a.push({command:"setPitch",args:[n.pitch]}),qt(i.sprite,n.sprite)||a.push({command:"setSprite",args:[n.sprite]}),qt(i.glyphs,n.glyphs)||a.push({command:"setGlyphs",args:[n.glyphs]}),qt(i.transition,n.transition)||a.push({command:"setTransition",args:[n.transition]}),qt(i.light,n.light)||a.push({command:"setLight",args:[n.light]}),qt(i.terrain,n.terrain)||a.push({command:"setTerrain",args:[n.terrain]}),qt(i.sky,n.sky)||a.push({command:"setSky",args:[n.sky]}),qt(i.projection,n.projection)||a.push({command:"setProjection",args:[n.projection]});const u={},f=[];(function(x,w,S,C){let E;for(E in w=w||{},x=x||{})Object.prototype.hasOwnProperty.call(x,E)&&(Object.prototype.hasOwnProperty.call(w,E)||Ms(E,S,C));for(E in w)Object.prototype.hasOwnProperty.call(w,E)&&(Object.prototype.hasOwnProperty.call(x,E)?qt(x[E],w[E])||(x[E].type==="geojson"&&w[E].type==="geojson"&&Pa(x,w,E)?_r(S,{command:"setGeoJSONSourceData",args:[E,w[E].data]}):os(E,w,S,C)):qo(E,w,S))})(i.sources,n.sources,f,u);const _=[];i.layers&&i.layers.forEach(x=>{"source"in x&&u[x.source]?a.push({command:"removeLayer",args:[x.id]}):_.push(x)}),a=a.concat(f),function(x,w,S){w=w||[];const C=(x=x||[]).map(Zo),E=w.map(Zo),A=x.reduce(Ho,{}),F=w.reduce(Ho,{}),B=C.slice(),V=Object.create(null);let $,Y,ne,xe,ue;for(let _e=0,Te=0;_e<C.length;_e++)$=C[_e],Object.prototype.hasOwnProperty.call(F,$)?Te++:(_r(S,{command:"removeLayer",args:[$]}),B.splice(B.indexOf($,Te),1));for(let _e=0,Te=0;_e<E.length;_e++)$=E[E.length-1-_e],B[B.length-1-_e]!==$&&(Object.prototype.hasOwnProperty.call(A,$)?(_r(S,{command:"removeLayer",args:[$]}),B.splice(B.lastIndexOf($,B.length-Te),1)):Te++,xe=B[B.length-_e],_r(S,{command:"addLayer",args:[F[$],xe]}),B.splice(B.length-_e,0,$),V[$]=!0);for(let _e=0;_e<E.length;_e++)if($=E[_e],Y=A[$],ne=F[$],!V[$]&&!qt(Y,ne))if(qt(Y.source,ne.source)&&qt(Y["source-layer"],ne["source-layer"])&&qt(Y.type,ne.type)){for(ue in ii(Y.layout,ne.layout,S,$,null,"setLayoutProperty"),ii(Y.paint,ne.paint,S,$,null,"setPaintProperty"),qt(Y.filter,ne.filter)||_r(S,{command:"setFilter",args:[$,ne.filter]}),qt(Y.minzoom,ne.minzoom)&&qt(Y.maxzoom,ne.maxzoom)||_r(S,{command:"setLayerZoomRange",args:[$,ne.minzoom,ne.maxzoom]}),Y)Object.prototype.hasOwnProperty.call(Y,ue)&&ue!=="layout"&&ue!=="paint"&&ue!=="filter"&&ue!=="metadata"&&ue!=="minzoom"&&ue!=="maxzoom"&&(ue.indexOf("paint.")===0?ii(Y[ue],ne[ue],S,$,ue.slice(6),"setPaintProperty"):qt(Y[ue],ne[ue])||_r(S,{command:"setLayerProperty",args:[$,ue,ne[ue]]}));for(ue in ne)Object.prototype.hasOwnProperty.call(ne,ue)&&!Object.prototype.hasOwnProperty.call(Y,ue)&&ue!=="layout"&&ue!=="paint"&&ue!=="filter"&&ue!=="metadata"&&ue!=="minzoom"&&ue!=="maxzoom"&&(ue.indexOf("paint.")===0?ii(Y[ue],ne[ue],S,$,ue.slice(6),"setPaintProperty"):qt(Y[ue],ne[ue])||_r(S,{command:"setLayerProperty",args:[$,ue,ne[ue]]}))}else _r(S,{command:"removeLayer",args:[$]}),xe=B[B.lastIndexOf($)+1],_r(S,{command:"addLayer",args:[ne,xe]})}(_,n.layers,a)}catch(u){console.warn("Unable to compute style diff:",u),a=[{command:"setStyle",args:[n]}]}return a},y.aD=function(i){const n=[],a=i.id;return a===void 0&&n.push({message:`layers.${a}: missing required property "id"`}),i.render===void 0&&n.push({message:`layers.${a}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&n.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),n},y.aE=function i(n,a){if(Array.isArray(n)){if(!Array.isArray(a)||n.length!==a.length)return!1;for(let u=0;u<n.length;u++)if(!i(n[u],a[u]))return!1;return!0}if(typeof n=="object"&&n!==null&&a!==null){if(typeof a!="object"||Object.keys(n).length!==Object.keys(a).length)return!1;for(const u in n)if(!i(n[u],a[u]))return!1;return!0}return n===a},y.aF=ct,y.aG=it,y.aH=class extends fl{constructor(i,n){super(i,n),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},y.aI=lp,y.aJ=class extends fl{constructor(i,n){super(i,n),this.current=SC}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let n=1;n<16;n++)if(i[n]!==this.current[n]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},y.aK=_x,y.aL=vx,y.aM=Jt,y.aN=class extends fl{constructor(i,n){super(i,n),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},y.aO=class extends fl{constructor(i,n){super(i,n),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},y.aP=function(i,n,a,u,f,_,x){var w=1/(n-a),S=1/(u-f),C=1/(_-x);return i[0]=-2*w,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*S,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*C,i[11]=0,i[12]=(n+a)*w,i[13]=(f+u)*S,i[14]=(x+_)*C,i[15]=1,i},y.aQ=PC,y.aR=class extends de{},y.aS=wM,y.aT=class extends we{},y.aU=ay,y.aV=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},y.aW=Lx,y.aX=an,y.aY=Ii,y.aZ=class extends rt{},y.a_=function(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]&&i[4]===n[4]&&i[5]===n[5]&&i[6]===n[6]&&i[7]===n[7]&&i[8]===n[8]&&i[9]===n[9]&&i[10]===n[10]&&i[11]===n[11]&&i[12]===n[12]&&i[13]===n[13]&&i[14]===n[14]&&i[15]===n[15]},y.aa=function(i){const n={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,u,f,_)=>{const x=f||_;return n[u]=!x||x.toLowerCase(),""}),n["max-age"]){const a=parseInt(n["max-age"],10);isNaN(a)?delete n["max-age"]:n["max-age"]=a}return n},y.ab=function(i,n){const a=[];for(const u in i)u in n||a.push(u);return a},y.ac=Me,y.ad=function(i,n,a){var u=Math.sin(a),f=Math.cos(a),_=n[0],x=n[1],w=n[2],S=n[3],C=n[4],E=n[5],A=n[6],F=n[7];return n!==i&&(i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[0]=_*f+C*u,i[1]=x*f+E*u,i[2]=w*f+A*u,i[3]=S*f+F*u,i[4]=C*f-_*u,i[5]=E*f-x*u,i[6]=A*f-w*u,i[7]=F*f-S*u,i},y.ae=function(i){var n=new $u(16);return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],n},y.af=dp,y.ag=function(i,n){let a=0,u=0;if(i.kind==="constant")u=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:f,minZoom:_,maxZoom:x}=i,w=f?Me(An.interpolationFactor(f,n,_,x),0,1):0;i.kind==="camera"?u=Pn.number(i.minSize,i.maxSize,w):a=w}return{uSizeT:a,uSize:u}},y.ai=function(i,{uSize:n,uSizeT:a},{lowerSize:u,upperSize:f}){return i.kind==="source"?u/Ls:i.kind==="composite"?Pn.number(u/Ls,f/Ls,a):n},y.aj=by,y.ak=function(i,n,a,u){const f=n.y-i.y,_=n.x-i.x,x=u.y-a.y,w=u.x-a.x,S=x*_-w*f;if(S===0)return null;const C=(w*(i.y-a.y)-x*(i.x-a.x))/S;return new z(i.x+C*_,i.y+C*f)},y.al=R1,y.am=Sx,y.an=ny,y.ao=function(i){let n=1/0,a=1/0,u=-1/0,f=-1/0;for(const _ of i)n=Math.min(n,_.x),a=Math.min(a,_.y),u=Math.max(u,_.x),f=Math.max(f,_.y);return[n,a,u,f]},y.ap=jr,y.ar=wy,y.as=function(i,n){var a=n[0],u=n[1],f=n[2],_=n[3],x=n[4],w=n[5],S=n[6],C=n[7],E=n[8],A=n[9],F=n[10],B=n[11],V=n[12],$=n[13],Y=n[14],ne=n[15],xe=a*w-u*x,ue=a*S-f*x,_e=a*C-_*x,Te=u*S-f*w,De=u*C-_*w,We=f*C-_*S,mt=E*$-A*V,He=E*Y-F*V,qe=E*ne-B*V,st=A*Y-F*$,Je=A*ne-B*$,Ye=F*ne-B*Y,Ie=xe*Ye-ue*Je+_e*st+Te*qe-De*He+We*mt;return Ie?(i[0]=(w*Ye-S*Je+C*st)*(Ie=1/Ie),i[1]=(f*Je-u*Ye-_*st)*Ie,i[2]=($*We-Y*De+ne*Te)*Ie,i[3]=(F*De-A*We-B*Te)*Ie,i[4]=(S*qe-x*Ye-C*He)*Ie,i[5]=(a*Ye-f*qe+_*He)*Ie,i[6]=(Y*_e-V*We-ne*ue)*Ie,i[7]=(E*We-F*_e+B*ue)*Ie,i[8]=(x*Je-w*qe+C*mt)*Ie,i[9]=(u*qe-a*Je-_*mt)*Ie,i[10]=(V*De-$*_e+ne*xe)*Ie,i[11]=(A*_e-E*De-B*xe)*Ie,i[12]=(w*He-x*st-S*mt)*Ie,i[13]=(a*st-u*He+f*mt)*Ie,i[14]=($*ue-V*Te-Y*xe)*Ie,i[15]=(E*Te-A*ue+F*xe)*Ie,i):null},y.at=Py,y.au=xy,y.av=Ay,y.aw=function(){const i={},n=be.$version;for(const a in be.$root){const u=be.$root[a];if(u.required){let f=null;f=a==="version"?n:u.type==="array"?[]:{},f!=null&&(i[a]=f)}}return i},y.ax=Rh,y.ay=qn,y.az=function(i){i=i.slice();const n=Object.create(null);for(let a=0;a<i.length;a++)n[i[a].id]=i[a];for(let a=0;a<i.length;a++)"ref"in i[a]&&(i[a]=Cs(i[a],n[i[a].ref]));return i},y.b=Mr,y.b0=function(i,n){return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],i},y.b1=function(i,n,a){return i[0]=n[0]*a[0],i[1]=n[1]*a[1],i[2]=n[2]*a[2],i[3]=n[3]*a[3],i},y.b2=function(i,n){return i[0]*n[0]+i[1]*n[1]+i[2]*n[2]+i[3]*n[3]},y.b3=Se,y.b4=I1,y.b5=C1,y.b6=function(i,n,a,u,f){var _,x=1/Math.tan(n/2);return i[0]=x/a,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=x,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,f!=null&&f!==1/0?(i[10]=(f+u)*(_=1/(u-f)),i[14]=2*f*u*_):(i[10]=-1,i[14]=-2*u),i},y.b7=function(i,n,a){var u=Math.sin(a),f=Math.cos(a),_=n[4],x=n[5],w=n[6],S=n[7],C=n[8],E=n[9],A=n[10],F=n[11];return n!==i&&(i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[4]=_*f+C*u,i[5]=x*f+E*u,i[6]=w*f+A*u,i[7]=S*f+F*u,i[8]=C*f-_*u,i[9]=E*f-x*u,i[10]=A*f-w*u,i[11]=F*f-S*u,i},y.b8=te,y.b9=oe,y.bA=e1,y.bB=function(i){return i.message===Wt},y.bC=Va,y.bD=Xn,y.ba=function(i){return i*Math.PI/180},y.bb=function(i,n){const{x:a,y:u}=td.fromLngLat(n);return!(i<0||i>25||u<0||u>=1||a<0||a>=1)},y.bc=function(i,n){return i[0]=n[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=n[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=n[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},y.bd=class extends P{},y.be=Cy,y.bf=nI,y.bh=Dr,y.bi=function(i,n){Vr.REGISTERED_PROTOCOLS[i]=n},y.bj=function(i){delete Vr.REGISTERED_PROTOCOLS[i]},y.bk=function(i,n){const a={};for(let f=0;f<i.length;f++){const _=n&&n[i[f].id]||Kf(i[f]);n&&(n[i[f].id]=_);let x=a[_];x||(x=a[_]=[]),x.push(i[f])}const u=[];for(const f in a)u.push(a[f]);return u},y.bl=Qe,y.bm=P1,y.bn=z1,y.bo=u1,y.bp=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=Or/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const n=i.bucket.layers[0],a=n.layout,u=n._unevaluatedLayout._values,f={layoutIconSize:u["icon-size"].possiblyEvaluate(new ur(i.bucket.zoom+1),i.canonical),layoutTextSize:u["text-size"].possiblyEvaluate(new ur(i.bucket.zoom+1),i.canonical),textMaxSize:u["text-size"].possiblyEvaluate(new ur(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:C,maxZoom:E}=i.bucket.textSizeData;f.compositeTextSizes=[u["text-size"].possiblyEvaluate(new ur(C),i.canonical),u["text-size"].possiblyEvaluate(new ur(E),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:C,maxZoom:E}=i.bucket.iconSizeData;f.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new ur(C),i.canonical),u["icon-size"].possiblyEvaluate(new ur(E),i.canonical)]}const _=a.get("text-line-height")*jr,x=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point",w=a.get("text-keep-upright"),S=a.get("text-size");for(const C of i.bucket.features){const E=a.get("text-font").evaluate(C,{},i.canonical).join(","),A=S.evaluate(C,{},i.canonical),F=f.layoutTextSize.evaluate(C,{},i.canonical),B=f.layoutIconSize.evaluate(C,{},i.canonical),V={horizontal:{},vertical:void 0},$=C.text;let Y,ne=[0,0];if($){const _e=$.toString(),Te=a.get("text-letter-spacing").evaluate(C,{},i.canonical)*jr,De=Hg(_e)?Te:0,We=a.get("text-anchor").evaluate(C,{},i.canonical),mt=q1(n,C,i.canonical);if(!mt){const Je=a.get("text-radial-offset").evaluate(C,{},i.canonical);ne=Je?$1(We,[Je*jr,Ey]):a.get("text-offset").evaluate(C,{},i.canonical).map(Ye=>Ye*jr)}let He=x?"center":a.get("text-justify").evaluate(C,{},i.canonical);const qe=a.get("symbol-placement")==="point"?a.get("text-max-width").evaluate(C,{},i.canonical)*jr:1/0,st=()=>{i.bucket.allowVerticalPlacement&&Fh(_e)&&(V.vertical=_p($,i.glyphMap,i.glyphPositions,i.imagePositions,E,qe,_,We,"left",De,ne,y.ah.vertical,!0,F,A))};if(!x&&mt){const Je=new Set;if(He==="auto")for(let Ie=0;Ie<mt.values.length;Ie+=2)Je.add(Py(mt.values[Ie]));else Je.add(He);let Ye=!1;for(const Ie of Je)if(!V.horizontal[Ie])if(Ye)V.horizontal[Ie]=V.horizontal[0];else{const ot=_p($,i.glyphMap,i.glyphPositions,i.imagePositions,E,qe,_,"center",Ie,De,ne,y.ah.horizontal,!1,F,A);ot&&(V.horizontal[Ie]=ot,Ye=ot.positionedLines.length===1)}st()}else{He==="auto"&&(He=Py(We));const Je=_p($,i.glyphMap,i.glyphPositions,i.imagePositions,E,qe,_,We,He,De,ne,y.ah.horizontal,!1,F,A);Je&&(V.horizontal[He]=Je),st(),Fh(_e)&&x&&w&&(V.vertical=_p($,i.glyphMap,i.glyphPositions,i.imagePositions,E,qe,_,We,He,De,ne,y.ah.vertical,!1,F,A))}}let xe=!1;if(C.icon&&C.icon.name){const _e=i.imageMap[C.icon.name];_e&&(Y=BM(i.imagePositions[C.icon.name],a.get("icon-offset").evaluate(C,{},i.canonical),a.get("icon-anchor").evaluate(C,{},i.canonical)),xe=!!_e.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=xe:i.bucket.sdfIcons!==xe&&Pt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(_e.pixelRatio!==i.bucket.pixelRatio||a.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const ue=H1(V.horizontal)||V.vertical;i.bucket.iconsInText=!!ue&&ue.iconsInText,(ue||Y)&&tI(i.bucket,C,V,Y,i.imageMap,f,F,B,ne,xe,i.canonical)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},y.bq=py,y.br=hy,y.bs=fy,y.bt=io,y.bu=gy,y.bv=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},y.bw=function(i,n,a,u,f){return c(this,void 0,void 0,function*(){if(Q())try{return yield yt(i,n,a,u,f)}catch{}return function(_,x,w,S,C){const E=_.width,A=_.height;ft&&Lt||(ft=new OffscreenCanvas(E,A),Lt=ft.getContext("2d",{willReadFrequently:!0})),ft.width=E,ft.height=A,Lt.drawImage(_,0,0,E,A);const F=Lt.getImageData(x,w,S,C);return Lt.clearRect(0,0,E,A),F.data}(i,n,a,u,f)})},y.bx=E1,y.by=M,y.bz=I,y.c=$n,y.d=i=>c(void 0,void 0,void 0,function*(){if(i.byteLength===0)return createImageBitmap(new ImageData(1,1));const n=new Blob([new Uint8Array(i)],{type:"image/png"});try{return createImageBitmap(n)}catch(a){throw new Error(`Could not load image because of ${a.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),y.e=ze,y.f=i=>new Promise((n,a)=>{const u=new Image;u.onload=()=>{n(u),URL.revokeObjectURL(u.src),u.onload=null,window.requestAnimationFrame(()=>{u.src=Ke})},u.onerror=()=>a(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const f=new Blob([new Uint8Array(i)],{type:"image/png"});u.src=i.byteLength?URL.createObjectURL(f):Ke}),y.g=tn,y.h=(i,n)=>et(ze(i,{type:"json"}),n),y.i=pr,y.j=Nt,y.k=yr,y.l=(i,n)=>et(ze(i,{type:"arrayBuffer"}),n),y.m=et,y.n=function(i){return new gy(i).readFields(zM,[])},y.o=Zh,y.p=l1,y.q=g,y.r=qg,y.s=Tt,y.t=Dh,y.u=sa,y.v=be,y.w=Pt,y.x=function([i,n,a]){return n+=90,n*=Math.PI/180,a*=Math.PI/180,{x:i*Math.cos(n)*Math.sin(a),y:i*Math.sin(n)*Math.sin(a),z:i*Math.cos(a)}},y.y=Pn,y.z=ur}),p("worker",["./shared"],function(y){class c{constructor(N){this.keyCache={},N&&this.replace(N)}replace(N){this._layerConfigs={},this._layers={},this.update(N,[])}update(N,O){for(const J of N){this._layerConfigs[J.id]=J;const ce=this._layers[J.id]=y.aA(J);ce._featureFilter=y.a7(ce.filter),this.keyCache[J.id]&&delete this.keyCache[J.id]}for(const J of O)delete this.keyCache[J],delete this._layerConfigs[J],delete this._layers[J];this.familiesBySource={};const q=y.bk(Object.values(this._layerConfigs),this.keyCache);for(const J of q){const ce=J.map(ke=>this._layers[ke.id]),fe=ce[0];if(fe.visibility==="none")continue;const ve=fe.source||"";let ae=this.familiesBySource[ve];ae||(ae=this.familiesBySource[ve]={});const Ce=fe.sourceLayer||"_geojsonTileLayer";let Ae=ae[Ce];Ae||(Ae=ae[Ce]=[]),Ae.push(ce)}}}class M{constructor(N){const O={},q=[];for(const ve in N){const ae=N[ve],Ce=O[ve]={};for(const Ae in ae){const ke=ae[+Ae];if(!ke||ke.bitmap.width===0||ke.bitmap.height===0)continue;const Be={x:0,y:0,w:ke.bitmap.width+2,h:ke.bitmap.height+2};q.push(Be),Ce[Ae]={rect:Be,metrics:ke.metrics}}}const{w:J,h:ce}=y.p(q),fe=new y.o({width:J||1,height:ce||1});for(const ve in N){const ae=N[ve];for(const Ce in ae){const Ae=ae[+Ce];if(!Ae||Ae.bitmap.width===0||Ae.bitmap.height===0)continue;const ke=O[ve][Ce].rect;y.o.copy(Ae.bitmap,fe,{x:0,y:0},{x:ke.x+1,y:ke.y+1},Ae.bitmap)}}this.image=fe,this.positions=O}}y.bl("GlyphAtlas",M);class I{constructor(N){this.tileID=new y.S(N.tileID.overscaledZ,N.tileID.wrap,N.tileID.canonical.z,N.tileID.canonical.x,N.tileID.canonical.y),this.uid=N.uid,this.zoom=N.zoom,this.pixelRatio=N.pixelRatio,this.tileSize=N.tileSize,this.source=N.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=N.showCollisionBoxes,this.collectResourceTiming=!!N.collectResourceTiming,this.returnDependencies=!!N.returnDependencies,this.promoteId=N.promoteId,this.inFlightDependencies=[]}parse(N,O,q,J){return y._(this,void 0,void 0,function*(){this.status="parsing",this.data=N,this.collisionBoxArray=new y.a5;const ce=new y.bm(Object.keys(N.layers).sort()),fe=new y.bn(this.tileID,this.promoteId);fe.bucketLayerIDs=[];const ve={},ae={featureIndex:fe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:q},Ce=O.familiesBySource[this.source];for(const It in Ce){const Qt=N.layers[It];if(!Qt)continue;Qt.version===1&&y.w(`Vector tile source "${this.source}" layer "${It}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const mr=ce.encode(It),$r=[];for(let Xr=0;Xr<Qt.length;Xr++){const xn=Qt.feature(Xr),Aa=fe.getId(xn,It);$r.push({feature:xn,id:Aa,index:Xr,sourceLayerIndex:mr})}for(const Xr of Ce[It]){const xn=Xr[0];xn.source!==this.source&&y.w(`layer.source = ${xn.source} does not equal this.source = ${this.source}`),xn.minzoom&&this.zoom<Math.floor(xn.minzoom)||xn.maxzoom&&this.zoom>=xn.maxzoom||xn.visibility!=="none"&&(j(Xr,this.zoom,q),(ve[xn.id]=xn.createBucket({index:fe.bucketLayerIDs.length,layers:Xr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:mr,sourceID:this.source})).populate($r,ae,this.tileID.canonical),fe.bucketLayerIDs.push(Xr.map(Aa=>Aa.id)))}}const Ae=y.aF(ae.glyphDependencies,It=>Object.keys(It).map(Number));this.inFlightDependencies.forEach(It=>It==null?void 0:It.abort()),this.inFlightDependencies=[];let ke=Promise.resolve({});if(Object.keys(Ae).length){const It=new AbortController;this.inFlightDependencies.push(It),ke=J.sendAsync({type:"GG",data:{stacks:Ae,source:this.source,tileID:this.tileID,type:"glyphs"}},It)}const Be=Object.keys(ae.iconDependencies);let lt=Promise.resolve({});if(Be.length){const It=new AbortController;this.inFlightDependencies.push(It),lt=J.sendAsync({type:"GI",data:{icons:Be,source:this.source,tileID:this.tileID,type:"icons"}},It)}const pt=Object.keys(ae.patternDependencies);let Bt=Promise.resolve({});if(pt.length){const It=new AbortController;this.inFlightDependencies.push(It),Bt=J.sendAsync({type:"GI",data:{icons:pt,source:this.source,tileID:this.tileID,type:"patterns"}},It)}const[kt,jt,At]=yield Promise.all([ke,lt,Bt]),Rr=new M(kt),vr=new y.bo(jt,At);for(const It in ve){const Qt=ve[It];Qt instanceof y.a6?(j(Qt.layers,this.zoom,q),y.bp({bucket:Qt,glyphMap:kt,glyphPositions:Rr.positions,imageMap:jt,imagePositions:vr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Qt.hasPattern&&(Qt instanceof y.bq||Qt instanceof y.br||Qt instanceof y.bs)&&(j(Qt.layers,this.zoom,q),Qt.addFeatures(ae,this.tileID.canonical,vr.patternPositions))}return this.status="done",{buckets:Object.values(ve).filter(It=>!It.isEmpty()),featureIndex:fe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Rr.image,imageAtlas:vr,glyphMap:this.returnDependencies?kt:null,iconMap:this.returnDependencies?jt:null,glyphPositions:this.returnDependencies?Rr.positions:null}})}}function j(re,N,O){const q=new y.z(N);for(const J of re)J.recalculate(q,O)}class z{constructor(N,O,q){this.actor=N,this.layerIndex=O,this.availableImages=q,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(N,O){return y._(this,void 0,void 0,function*(){const q=yield y.l(N.request,O);try{return{vectorTile:new y.bt.VectorTile(new y.bu(q.data)),rawData:q.data,cacheControl:q.cacheControl,expires:q.expires}}catch(J){const ce=new Uint8Array(q.data);let fe=`Unable to parse the tile at ${N.request.url}, `;throw fe+=ce[0]===31&&ce[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${J.message}`,new Error(fe)}})}loadTile(N){return y._(this,void 0,void 0,function*(){const O=N.uid,q=!!(N&&N.request&&N.request.collectResourceTiming)&&new y.bv(N.request),J=new I(N);this.loading[O]=J;const ce=new AbortController;J.abort=ce;try{const fe=yield this.loadVectorTile(N,ce);if(delete this.loading[O],!fe)return null;const ve=fe.rawData,ae={};fe.expires&&(ae.expires=fe.expires),fe.cacheControl&&(ae.cacheControl=fe.cacheControl);const Ce={};if(q){const ke=q.finish();ke&&(Ce.resourceTiming=JSON.parse(JSON.stringify(ke)))}J.vectorTile=fe.vectorTile;const Ae=J.parse(fe.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[O]=J,this.fetching[O]={rawTileData:ve,cacheControl:ae,resourceTiming:Ce};try{const ke=yield Ae;return y.e({rawTileData:ve.slice(0)},ke,ae,Ce)}finally{delete this.fetching[O]}}catch(fe){throw delete this.loading[O],J.status="done",this.loaded[O]=J,fe}})}reloadTile(N){return y._(this,void 0,void 0,function*(){const O=N.uid;if(!this.loaded||!this.loaded[O])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const q=this.loaded[O];if(q.showCollisionBoxes=N.showCollisionBoxes,q.status==="parsing"){const J=yield q.parse(q.vectorTile,this.layerIndex,this.availableImages,this.actor);let ce;if(this.fetching[O]){const{rawTileData:fe,cacheControl:ve,resourceTiming:ae}=this.fetching[O];delete this.fetching[O],ce=y.e({rawTileData:fe.slice(0)},J,ve,ae)}else ce=J;return ce}if(q.status==="done"&&q.vectorTile)return q.parse(q.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(N){return y._(this,void 0,void 0,function*(){const O=this.loading,q=N.uid;O&&O[q]&&O[q].abort&&(O[q].abort.abort(),delete O[q])})}removeTile(N){return y._(this,void 0,void 0,function*(){this.loaded&&this.loaded[N.uid]&&delete this.loaded[N.uid]})}}class R{constructor(){this.loaded={}}loadTile(N){return y._(this,void 0,void 0,function*(){const{uid:O,encoding:q,rawImageData:J,redFactor:ce,greenFactor:fe,blueFactor:ve,baseShift:ae}=N,Ce=J.width+2,Ae=J.height+2,ke=y.b(J)?new y.R({width:Ce,height:Ae},yield y.bw(J,-1,-1,Ce,Ae)):J,Be=new y.bx(O,ke,q,ce,fe,ve,ae);return this.loaded=this.loaded||{},this.loaded[O]=Be,Be})}removeTile(N){const O=this.loaded,q=N.uid;O&&O[q]&&delete O[q]}}function X(re,N){if(re.length!==0){me(re[0],N);for(var O=1;O<re.length;O++)me(re[O],!N)}}function me(re,N){for(var O=0,q=0,J=0,ce=re.length,fe=ce-1;J<ce;fe=J++){var ve=(re[J][0]-re[fe][0])*(re[fe][1]+re[J][1]),ae=O+ve;q+=Math.abs(O)>=Math.abs(ve)?O-ae+ve:ve-ae+O,O=ae}O+q>=0!=!!N&&re.reverse()}var he=y.by(function re(N,O){var q,J=N&&N.type;if(J==="FeatureCollection")for(q=0;q<N.features.length;q++)re(N.features[q],O);else if(J==="GeometryCollection")for(q=0;q<N.geometries.length;q++)re(N.geometries[q],O);else if(J==="Feature")re(N.geometry,O);else if(J==="Polygon")X(N.coordinates,O);else if(J==="MultiPolygon")for(q=0;q<N.coordinates.length;q++)X(N.coordinates[q],O);return N});const ge=y.bt.VectorTileFeature.prototype.toGeoJSON;var W={exports:{}},Q=y.bz,te=y.bt.VectorTileFeature,oe=Me;function Me(re,N){this.options=N||{},this.features=re,this.length=re.length}function Se(re,N){this.id=typeof re.id=="number"?re.id:void 0,this.type=re.type,this.rawGeometry=re.type===1?[re.geometry]:re.geometry,this.properties=re.tags,this.extent=N||4096}Me.prototype.feature=function(re){return new Se(this.features[re],this.options.extent)},Se.prototype.loadGeometry=function(){var re=this.rawGeometry;this.geometry=[];for(var N=0;N<re.length;N++){for(var O=re[N],q=[],J=0;J<O.length;J++)q.push(new Q(O[J][0],O[J][1]));this.geometry.push(q)}return this.geometry},Se.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var re=this.geometry,N=1/0,O=-1/0,q=1/0,J=-1/0,ce=0;ce<re.length;ce++)for(var fe=re[ce],ve=0;ve<fe.length;ve++){var ae=fe[ve];N=Math.min(N,ae.x),O=Math.max(O,ae.x),q=Math.min(q,ae.y),J=Math.max(J,ae.y)}return[N,q,O,J]},Se.prototype.toGeoJSON=te.prototype.toGeoJSON;var ze=y.bA,Fe=oe;function ct(re){var N=new ze;return function(O,q){for(var J in O.layers)q.writeMessage(3,it,O.layers[J])}(re,N),N.finish()}function it(re,N){var O;N.writeVarintField(15,re.version||1),N.writeStringField(1,re.name||""),N.writeVarintField(5,re.extent||4096);var q={keys:[],values:[],keycache:{},valuecache:{}};for(O=0;O<re.length;O++)q.feature=re.feature(O),N.writeMessage(2,ht,q);var J=q.keys;for(O=0;O<J.length;O++)N.writeStringField(3,J[O]);var ce=q.values;for(O=0;O<ce.length;O++)N.writeMessage(4,yn,ce[O])}function ht(re,N){var O=re.feature;O.id!==void 0&&N.writeVarintField(1,O.id),N.writeMessage(2,dt,re),N.writeVarintField(3,O.type),N.writeMessage(4,pr,O)}function dt(re,N){var O=re.feature,q=re.keys,J=re.values,ce=re.keycache,fe=re.valuecache;for(var ve in O.properties){var ae=O.properties[ve],Ce=ce[ve];if(ae!==null){Ce===void 0&&(q.push(ve),ce[ve]=Ce=q.length-1),N.writeVarint(Ce);var Ae=typeof ae;Ae!=="string"&&Ae!=="boolean"&&Ae!=="number"&&(ae=JSON.stringify(ae));var ke=Ae+":"+ae,Be=fe[ke];Be===void 0&&(J.push(ae),fe[ke]=Be=J.length-1),N.writeVarint(Be)}}}function Pt(re,N){return(N<<3)+(7&re)}function Dt(re){return re<<1^re>>31}function pr(re,N){for(var O=re.loadGeometry(),q=re.type,J=0,ce=0,fe=O.length,ve=0;ve<fe;ve++){var ae=O[ve],Ce=1;q===1&&(Ce=ae.length),N.writeVarint(Pt(1,Ce));for(var Ae=q===3?ae.length-1:ae.length,ke=0;ke<Ae;ke++){ke===1&&q!==1&&N.writeVarint(Pt(2,Ae-1));var Be=ae[ke].x-J,lt=ae[ke].y-ce;N.writeVarint(Dt(Be)),N.writeVarint(Dt(lt)),J+=Be,ce+=lt}q===3&&N.writeVarint(Pt(7,1))}}function yn(re,N){var O=typeof re;O==="string"?N.writeStringField(1,re):O==="boolean"?N.writeBooleanField(7,re):O==="number"&&(re%1!=0?N.writeDoubleField(3,re):re<0?N.writeSVarintField(6,re):N.writeVarintField(5,re))}W.exports=ct,W.exports.fromVectorTileJs=ct,W.exports.fromGeojsonVt=function(re,N){N=N||{};var O={};for(var q in re)O[q]=new Fe(re[q].features,N),O[q].name=q,O[q].version=N.version,O[q].extent=N.extent;return ct({layers:O})},W.exports.GeoJSONWrapper=Fe;var Mr=y.by(W.exports);const Ke={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:re=>re},yt=Math.fround||(ft=new Float32Array(1),re=>(ft[0]=+re,ft[0]));var ft;const Lt=3,Wt=5,$n=6;class Vr{constructor(N){this.options=Object.assign(Object.create(Ke),N),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(N){const{log:O,minZoom:q,maxZoom:J}=this.options;O&&console.time("total time");const ce=`prepare ${N.length} points`;O&&console.time(ce),this.points=N;const fe=[];for(let ae=0;ae<N.length;ae++){const Ce=N[ae];if(!Ce.geometry)continue;const[Ae,ke]=Ce.geometry.coordinates,Be=yt(Dr(Ae)),lt=yt(qn(ke));fe.push(Be,lt,1/0,ae,-1,1),this.options.reduce&&fe.push(0)}let ve=this.trees[J+1]=this._createTree(fe);O&&console.timeEnd(ce);for(let ae=J;ae>=q;ae--){const Ce=+Date.now();ve=this.trees[ae]=this._createTree(this._cluster(ve,ae)),O&&console.log("z%d: %d clusters in %dms",ae,ve.numItems,+Date.now()-Ce)}return O&&console.timeEnd("total time"),this}getClusters(N,O){let q=((N[0]+180)%360+360)%360-180;const J=Math.max(-90,Math.min(90,N[1]));let ce=N[2]===180?180:((N[2]+180)%360+360)%360-180;const fe=Math.max(-90,Math.min(90,N[3]));if(N[2]-N[0]>=360)q=-180,ce=180;else if(q>ce){const ke=this.getClusters([q,J,180,fe],O),Be=this.getClusters([-180,J,ce,fe],O);return ke.concat(Be)}const ve=this.trees[this._limitZoom(O)],ae=ve.range(Dr(q),qn(fe),Dr(ce),qn(J)),Ce=ve.data,Ae=[];for(const ke of ae){const Be=this.stride*ke;Ae.push(Ce[Be+Wt]>1?tn(Ce,Be,this.clusterProps):this.points[Ce[Be+Lt]])}return Ae}getChildren(N){const O=this._getOriginId(N),q=this._getOriginZoom(N),J="No cluster with the specified id.",ce=this.trees[q];if(!ce)throw new Error(J);const fe=ce.data;if(O*this.stride>=fe.length)throw new Error(J);const ve=this.options.radius/(this.options.extent*Math.pow(2,q-1)),ae=ce.within(fe[O*this.stride],fe[O*this.stride+1],ve),Ce=[];for(const Ae of ae){const ke=Ae*this.stride;fe[ke+4]===N&&Ce.push(fe[ke+Wt]>1?tn(fe,ke,this.clusterProps):this.points[fe[ke+Lt]])}if(Ce.length===0)throw new Error(J);return Ce}getLeaves(N,O,q){const J=[];return this._appendLeaves(J,N,O=O||10,q=q||0,0),J}getTile(N,O,q){const J=this.trees[this._limitZoom(N)],ce=Math.pow(2,N),{extent:fe,radius:ve}=this.options,ae=ve/fe,Ce=(q-ae)/ce,Ae=(q+1+ae)/ce,ke={features:[]};return this._addTileFeatures(J.range((O-ae)/ce,Ce,(O+1+ae)/ce,Ae),J.data,O,q,ce,ke),O===0&&this._addTileFeatures(J.range(1-ae/ce,Ce,1,Ae),J.data,ce,q,ce,ke),O===ce-1&&this._addTileFeatures(J.range(0,Ce,ae/ce,Ae),J.data,-1,q,ce,ke),ke.features.length?ke:null}getClusterExpansionZoom(N){let O=this._getOriginZoom(N)-1;for(;O<=this.options.maxZoom;){const q=this.getChildren(N);if(O++,q.length!==1)break;N=q[0].properties.cluster_id}return O}_appendLeaves(N,O,q,J,ce){const fe=this.getChildren(O);for(const ve of fe){const ae=ve.properties;if(ae&&ae.cluster?ce+ae.point_count<=J?ce+=ae.point_count:ce=this._appendLeaves(N,ae.cluster_id,q,J,ce):ce<J?ce++:N.push(ve),N.length===q)break}return ce}_createTree(N){const O=new y.av(N.length/this.stride|0,this.options.nodeSize,Float32Array);for(let q=0;q<N.length;q+=this.stride)O.add(N[q],N[q+1]);return O.finish(),O.data=N,O}_addTileFeatures(N,O,q,J,ce,fe){for(const ve of N){const ae=ve*this.stride,Ce=O[ae+Wt]>1;let Ae,ke,Be;if(Ce)Ae=rn(O,ae,this.clusterProps),ke=O[ae],Be=O[ae+1];else{const Bt=this.points[O[ae+Lt]];Ae=Bt.properties;const[kt,jt]=Bt.geometry.coordinates;ke=Dr(kt),Be=qn(jt)}const lt={type:1,geometry:[[Math.round(this.options.extent*(ke*ce-q)),Math.round(this.options.extent*(Be*ce-J))]],tags:Ae};let pt;pt=Ce||this.options.generateId?O[ae+Lt]:this.points[O[ae+Lt]].id,pt!==void 0&&(lt.id=pt),fe.features.push(lt)}}_limitZoom(N){return Math.max(this.options.minZoom,Math.min(Math.floor(+N),this.options.maxZoom+1))}_cluster(N,O){const{radius:q,extent:J,reduce:ce,minPoints:fe}=this.options,ve=q/(J*Math.pow(2,O)),ae=N.data,Ce=[],Ae=this.stride;for(let ke=0;ke<ae.length;ke+=Ae){if(ae[ke+2]<=O)continue;ae[ke+2]=O;const Be=ae[ke],lt=ae[ke+1],pt=N.within(ae[ke],ae[ke+1],ve),Bt=ae[ke+Wt];let kt=Bt;for(const jt of pt){const At=jt*Ae;ae[At+2]>O&&(kt+=ae[At+Wt])}if(kt>Bt&&kt>=fe){let jt,At=Be*Bt,Rr=lt*Bt,vr=-1;const It=((ke/Ae|0)<<5)+(O+1)+this.points.length;for(const Qt of pt){const mr=Qt*Ae;if(ae[mr+2]<=O)continue;ae[mr+2]=O;const $r=ae[mr+Wt];At+=ae[mr]*$r,Rr+=ae[mr+1]*$r,ae[mr+4]=It,ce&&(jt||(jt=this._map(ae,ke,!0),vr=this.clusterProps.length,this.clusterProps.push(jt)),ce(jt,this._map(ae,mr)))}ae[ke+4]=It,Ce.push(At/kt,Rr/kt,1/0,It,-1,kt),ce&&Ce.push(vr)}else{for(let jt=0;jt<Ae;jt++)Ce.push(ae[ke+jt]);if(kt>1)for(const jt of pt){const At=jt*Ae;if(!(ae[At+2]<=O)){ae[At+2]=O;for(let Rr=0;Rr<Ae;Rr++)Ce.push(ae[At+Rr])}}}}return Ce}_getOriginId(N){return N-this.points.length>>5}_getOriginZoom(N){return(N-this.points.length)%32}_map(N,O,q){if(N[O+Wt]>1){const fe=this.clusterProps[N[O+$n]];return q?Object.assign({},fe):fe}const J=this.points[N[O+Lt]].properties,ce=this.options.map(J);return q&&ce===J?Object.assign({},ce):ce}}function tn(re,N,O){return{type:"Feature",id:re[N+Lt],properties:rn(re,N,O),geometry:{type:"Point",coordinates:[(q=re[N],360*(q-.5)),et(re[N+1])]}};var q}function rn(re,N,O){const q=re[N+Wt],J=q>=1e4?`${Math.round(q/1e3)}k`:q>=1e3?Math.round(q/100)/10+"k":q,ce=re[N+$n],fe=ce===-1?{}:Object.assign({},O[ce]);return Object.assign(fe,{cluster:!0,cluster_id:re[N+Lt],point_count:q,point_count_abbreviated:J})}function Dr(re){return re/360+.5}function qn(re){const N=Math.sin(re*Math.PI/180),O=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return O<0?0:O>1?1:O}function et(re){const N=(180-360*re)*Math.PI/180;return 360*Math.atan(Math.exp(N))/Math.PI-90}function Tt(re,N,O,q){let J=q;const ce=N+(O-N>>1);let fe,ve=O-N;const ae=re[N],Ce=re[N+1],Ae=re[O],ke=re[O+1];for(let Be=N+3;Be<O;Be+=3){const lt=Rt(re[Be],re[Be+1],ae,Ce,Ae,ke);if(lt>J)fe=Be,J=lt;else if(lt===J){const pt=Math.abs(Be-ce);pt<ve&&(fe=Be,ve=pt)}}J>q&&(fe-N>3&&Tt(re,N,fe,q),re[fe+2]=J,O-fe>3&&Tt(re,fe,O,q))}function Rt(re,N,O,q,J,ce){let fe=J-O,ve=ce-q;if(fe!==0||ve!==0){const ae=((re-O)*fe+(N-q)*ve)/(fe*fe+ve*ve);ae>1?(O=J,q=ce):ae>0&&(O+=fe*ae,q+=ve*ae)}return fe=re-O,ve=N-q,fe*fe+ve*ve}function Le(re,N,O,q){const J={id:re??null,type:N,geometry:O,tags:q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(N==="Point"||N==="MultiPoint"||N==="LineString")yr(J,O);else if(N==="Polygon")yr(J,O[0]);else if(N==="MultiLineString")for(const ce of O)yr(J,ce);else if(N==="MultiPolygon")for(const ce of O)yr(J,ce[0]);return J}function yr(re,N){for(let O=0;O<N.length;O+=3)re.minX=Math.min(re.minX,N[O]),re.minY=Math.min(re.minY,N[O+1]),re.maxX=Math.max(re.maxX,N[O]),re.maxY=Math.max(re.maxY,N[O+1])}function Nt(re,N,O,q){if(!N.geometry)return;const J=N.geometry.coordinates;if(J&&J.length===0)return;const ce=N.geometry.type,fe=Math.pow(O.tolerance/((1<<O.maxZoom)*O.extent),2);let ve=[],ae=N.id;if(O.promoteId?ae=N.properties[O.promoteId]:O.generateId&&(ae=q||0),ce==="Point")Lr(J,ve);else if(ce==="MultiPoint")for(const Ce of J)Lr(Ce,ve);else if(ce==="LineString")be(J,ve,fe,!1);else if(ce==="MultiLineString"){if(O.lineMetrics){for(const Ce of J)ve=[],be(Ce,ve,fe,!1),re.push(Le(ae,"LineString",ve,N.properties));return}_n(J,ve,fe,!1)}else if(ce==="Polygon")_n(J,ve,fe,!0);else{if(ce!=="MultiPolygon"){if(ce==="GeometryCollection"){for(const Ce of N.geometry.geometries)Nt(re,{id:ae,geometry:Ce,properties:N.properties},O,q);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ce of J){const Ae=[];_n(Ce,Ae,fe,!0),ve.push(Ae)}}re.push(Le(ae,ce,ve,N.properties))}function Lr(re,N){N.push(Cs(re[0]),qt(re[1]),0)}function be(re,N,O,q){let J,ce,fe=0;for(let ae=0;ae<re.length;ae++){const Ce=Cs(re[ae][0]),Ae=qt(re[ae][1]);N.push(Ce,Ae,0),ae>0&&(fe+=q?(J*Ae-Ce*ce)/2:Math.sqrt(Math.pow(Ce-J,2)+Math.pow(Ae-ce,2))),J=Ce,ce=Ae}const ve=N.length-3;N[2]=1,Tt(N,0,ve,O),N[ve+2]=1,N.size=Math.abs(fe),N.start=0,N.end=N.size}function _n(re,N,O,q){for(let J=0;J<re.length;J++){const ce=[];be(re[J],ce,O,q),N.push(ce)}}function Cs(re){return re/360+.5}function qt(re){const N=Math.sin(re*Math.PI/180),O=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return O<0?0:O>1?1:O}function _r(re,N,O,q,J,ce,fe,ve){if(q/=N,ce>=(O/=N)&&fe<q)return re;if(fe<O||ce>=q)return null;const ae=[];for(const Ce of re){const Ae=Ce.geometry;let ke=Ce.type;const Be=J===0?Ce.minX:Ce.minY,lt=J===0?Ce.maxX:Ce.maxY;if(Be>=O&&lt<q){ae.push(Ce);continue}if(lt<O||Be>=q)continue;let pt=[];if(ke==="Point"||ke==="MultiPoint")qo(Ae,pt,O,q,J);else if(ke==="LineString")Ms(Ae,pt,O,q,J,!1,ve.lineMetrics);else if(ke==="MultiLineString")Pa(Ae,pt,O,q,J,!1);else if(ke==="Polygon")Pa(Ae,pt,O,q,J,!0);else if(ke==="MultiPolygon")for(const Bt of Ae){const kt=[];Pa(Bt,kt,O,q,J,!0),kt.length&&pt.push(kt)}if(pt.length){if(ve.lineMetrics&&ke==="LineString"){for(const Bt of pt)ae.push(Le(Ce.id,ke,Bt,Ce.tags));continue}ke!=="LineString"&&ke!=="MultiLineString"||(pt.length===1?(ke="LineString",pt=pt[0]):ke="MultiLineString"),ke!=="Point"&&ke!=="MultiPoint"||(ke=pt.length===3?"Point":"MultiPoint"),ae.push(Le(Ce.id,ke,pt,Ce.tags))}}return ae.length?ae:null}function qo(re,N,O,q,J){for(let ce=0;ce<re.length;ce+=3){const fe=re[ce+J];fe>=O&&fe<=q&&ii(N,re[ce],re[ce+1],re[ce+2])}}function Ms(re,N,O,q,J,ce,fe){let ve=os(re);const ae=J===0?Zo:Ho;let Ce,Ae,ke=re.start;for(let kt=0;kt<re.length-3;kt+=3){const jt=re[kt],At=re[kt+1],Rr=re[kt+2],vr=re[kt+3],It=re[kt+4],Qt=J===0?jt:At,mr=J===0?vr:It;let $r=!1;fe&&(Ce=Math.sqrt(Math.pow(jt-vr,2)+Math.pow(At-It,2))),Qt<O?mr>O&&(Ae=ae(ve,jt,At,vr,It,O),fe&&(ve.start=ke+Ce*Ae)):Qt>q?mr<q&&(Ae=ae(ve,jt,At,vr,It,q),fe&&(ve.start=ke+Ce*Ae)):ii(ve,jt,At,Rr),mr<O&&Qt>=O&&(Ae=ae(ve,jt,At,vr,It,O),$r=!0),mr>q&&Qt<=q&&(Ae=ae(ve,jt,At,vr,It,q),$r=!0),!ce&&$r&&(fe&&(ve.end=ke+Ce*Ae),N.push(ve),ve=os(re)),fe&&(ke+=Ce)}let Be=re.length-3;const lt=re[Be],pt=re[Be+1],Bt=J===0?lt:pt;Bt>=O&&Bt<=q&&ii(ve,lt,pt,re[Be+2]),Be=ve.length-3,ce&&Be>=3&&(ve[Be]!==ve[0]||ve[Be+1]!==ve[1])&&ii(ve,ve[0],ve[1],ve[2]),ve.length&&N.push(ve)}function os(re){const N=[];return N.size=re.size,N.start=re.start,N.end=re.end,N}function Pa(re,N,O,q,J,ce){for(const fe of re)Ms(fe,N,O,q,J,ce,!1)}function ii(re,N,O,q){re.push(N,O,q)}function Zo(re,N,O,q,J,ce){const fe=(ce-N)/(q-N);return ii(re,ce,O+(J-O)*fe,1),fe}function Ho(re,N,O,q,J,ce){const fe=(ce-O)/(J-O);return ii(re,N+(q-N)*fe,ce,1),fe}function Oe(re,N){const O=[];for(let q=0;q<re.length;q++){const J=re[q],ce=J.type;let fe;if(ce==="Point"||ce==="MultiPoint"||ce==="LineString")fe=Vi(J.geometry,N);else if(ce==="MultiLineString"||ce==="Polygon"){fe=[];for(const ve of J.geometry)fe.push(Vi(ve,N))}else if(ce==="MultiPolygon"){fe=[];for(const ve of J.geometry){const ae=[];for(const Ce of ve)ae.push(Vi(Ce,N));fe.push(ae)}}O.push(Le(J.id,ce,fe,J.tags))}return O}function Vi(re,N){const O=[];O.size=re.size,re.start!==void 0&&(O.start=re.start,O.end=re.end);for(let q=0;q<re.length;q+=3)O.push(re[q]+N,re[q+1],re[q+2]);return O}function vn(re,N){if(re.transformed)return re;const O=1<<re.z,q=re.x,J=re.y;for(const ce of re.features){const fe=ce.geometry,ve=ce.type;if(ce.geometry=[],ve===1)for(let ae=0;ae<fe.length;ae+=2)ce.geometry.push($i(fe[ae],fe[ae+1],N,O,q,J));else for(let ae=0;ae<fe.length;ae++){const Ce=[];for(let Ae=0;Ae<fe[ae].length;Ae+=2)Ce.push($i(fe[ae][Ae],fe[ae][Ae+1],N,O,q,J));ce.geometry.push(Ce)}}return re.transformed=!0,re}function $i(re,N,O,q,J,ce){return[Math.round(O*(re*q-J)),Math.round(O*(N*q-ce))]}function Is(re,N,O,q,J){const ce=N===J.maxZoom?0:J.tolerance/((1<<N)*J.extent),fe={features:[],numPoints:0,numSimplified:0,numFeatures:re.length,source:null,x:O,y:q,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ve of re)Ve(fe,ve,ce,J);return fe}function Ve(re,N,O,q){const J=N.geometry,ce=N.type,fe=[];if(re.minX=Math.min(re.minX,N.minX),re.minY=Math.min(re.minY,N.minY),re.maxX=Math.max(re.maxX,N.maxX),re.maxY=Math.max(re.maxY,N.maxY),ce==="Point"||ce==="MultiPoint")for(let ve=0;ve<J.length;ve+=3)fe.push(J[ve],J[ve+1]),re.numPoints++,re.numSimplified++;else if(ce==="LineString")Mt(fe,J,re,O,!1,!1);else if(ce==="MultiLineString"||ce==="Polygon")for(let ve=0;ve<J.length;ve++)Mt(fe,J[ve],re,O,ce==="Polygon",ve===0);else if(ce==="MultiPolygon")for(let ve=0;ve<J.length;ve++){const ae=J[ve];for(let Ce=0;Ce<ae.length;Ce++)Mt(fe,ae[Ce],re,O,!0,Ce===0)}if(fe.length){let ve=N.tags||null;if(ce==="LineString"&&q.lineMetrics){ve={};for(const Ce in N.tags)ve[Ce]=N.tags[Ce];ve.mapbox_clip_start=J.start/J.size,ve.mapbox_clip_end=J.end/J.size}const ae={geometry:fe,type:ce==="Polygon"||ce==="MultiPolygon"?3:ce==="LineString"||ce==="MultiLineString"?2:1,tags:ve};N.id!==null&&(ae.id=N.id),re.features.push(ae)}}function Mt(re,N,O,q,J,ce){const fe=q*q;if(q>0&&N.size<(J?fe:q))return void(O.numPoints+=N.length/3);const ve=[];for(let ae=0;ae<N.length;ae+=3)(q===0||N[ae+2]>fe)&&(O.numSimplified++,ve.push(N[ae],N[ae+1])),O.numPoints++;J&&function(ae,Ce){let Ae=0;for(let ke=0,Be=ae.length,lt=Be-2;ke<Be;lt=ke,ke+=2)Ae+=(ae[ke]-ae[lt])*(ae[ke+1]+ae[lt+1]);if(Ae>0===Ce)for(let ke=0,Be=ae.length;ke<Be/2;ke+=2){const lt=ae[ke],pt=ae[ke+1];ae[ke]=ae[Be-2-ke],ae[ke+1]=ae[Be-1-ke],ae[Be-2-ke]=lt,ae[Be-1-ke]=pt}}(ve,ce),re.push(ve)}const _t={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class En{constructor(N,O){const q=(O=this.options=function(ce,fe){for(const ve in fe)ce[ve]=fe[ve];return ce}(Object.create(_t),O)).debug;if(q&&console.time("preprocess data"),O.maxZoom<0||O.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(O.promoteId&&O.generateId)throw new Error("promoteId and generateId cannot be used together.");let J=function(ce,fe){const ve=[];if(ce.type==="FeatureCollection")for(let ae=0;ae<ce.features.length;ae++)Nt(ve,ce.features[ae],fe,ae);else Nt(ve,ce.type==="Feature"?ce:{geometry:ce},fe);return ve}(N,O);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",O.indexMaxZoom,O.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),J=function(ce,fe){const ve=fe.buffer/fe.extent;let ae=ce;const Ce=_r(ce,1,-1-ve,ve,0,-1,2,fe),Ae=_r(ce,1,1-ve,2+ve,0,-1,2,fe);return(Ce||Ae)&&(ae=_r(ce,1,-ve,1+ve,0,-1,2,fe)||[],Ce&&(ae=Oe(Ce,1).concat(ae)),Ae&&(ae=ae.concat(Oe(Ae,-1)))),ae}(J,O),J.length&&this.splitTile(J,0,0,0),q&&(J.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(N,O,q,J,ce,fe,ve){const ae=[N,O,q,J],Ce=this.options,Ae=Ce.debug;for(;ae.length;){J=ae.pop(),q=ae.pop(),O=ae.pop(),N=ae.pop();const ke=1<<O,Be=wi(O,q,J);let lt=this.tiles[Be];if(!lt&&(Ae>1&&console.time("creation"),lt=this.tiles[Be]=Is(N,O,q,J,Ce),this.tileCoords.push({z:O,x:q,y:J}),Ae)){Ae>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",O,q,J,lt.numFeatures,lt.numPoints,lt.numSimplified),console.timeEnd("creation"));const $r=`z${O}`;this.stats[$r]=(this.stats[$r]||0)+1,this.total++}if(lt.source=N,ce==null){if(O===Ce.indexMaxZoom||lt.numPoints<=Ce.indexMaxPoints)continue}else{if(O===Ce.maxZoom||O===ce)continue;if(ce!=null){const $r=ce-O;if(q!==fe>>$r||J!==ve>>$r)continue}}if(lt.source=null,N.length===0)continue;Ae>1&&console.time("clipping");const pt=.5*Ce.buffer/Ce.extent,Bt=.5-pt,kt=.5+pt,jt=1+pt;let At=null,Rr=null,vr=null,It=null,Qt=_r(N,ke,q-pt,q+kt,0,lt.minX,lt.maxX,Ce),mr=_r(N,ke,q+Bt,q+jt,0,lt.minX,lt.maxX,Ce);N=null,Qt&&(At=_r(Qt,ke,J-pt,J+kt,1,lt.minY,lt.maxY,Ce),Rr=_r(Qt,ke,J+Bt,J+jt,1,lt.minY,lt.maxY,Ce),Qt=null),mr&&(vr=_r(mr,ke,J-pt,J+kt,1,lt.minY,lt.maxY,Ce),It=_r(mr,ke,J+Bt,J+jt,1,lt.minY,lt.maxY,Ce),mr=null),Ae>1&&console.timeEnd("clipping"),ae.push(At||[],O+1,2*q,2*J),ae.push(Rr||[],O+1,2*q,2*J+1),ae.push(vr||[],O+1,2*q+1,2*J),ae.push(It||[],O+1,2*q+1,2*J+1)}}getTile(N,O,q){N=+N,O=+O,q=+q;const J=this.options,{extent:ce,debug:fe}=J;if(N<0||N>24)return null;const ve=1<<N,ae=wi(N,O=O+ve&ve-1,q);if(this.tiles[ae])return vn(this.tiles[ae],ce);fe>1&&console.log("drilling down to z%d-%d-%d",N,O,q);let Ce,Ae=N,ke=O,Be=q;for(;!Ce&&Ae>0;)Ae--,ke>>=1,Be>>=1,Ce=this.tiles[wi(Ae,ke,Be)];return Ce&&Ce.source?(fe>1&&(console.log("found parent tile z%d-%d-%d",Ae,ke,Be),console.time("drilling down")),this.splitTile(Ce.source,Ae,ke,Be,N,O,q),fe>1&&console.timeEnd("drilling down"),this.tiles[ae]?vn(this.tiles[ae],ce):null):null}}function wi(re,N,O){return 32*((1<<re)*O+N)+re}function St(re,N){return N?re.properties[N]:re.id}function qi(re,N){if(re==null)return!0;if(re.type==="Feature")return St(re,N)!=null;if(re.type==="FeatureCollection"){const O=new Set;for(const q of re.features){const J=St(q,N);if(J==null||O.has(J))return!1;O.add(J)}return!0}return!1}function ls(re,N){const O=new Map;if(re!=null)if(re.type==="Feature")O.set(St(re,N),re);else for(const q of re.features)O.set(St(q,N),q);return O}class Es extends z{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(N,O){return y._(this,void 0,void 0,function*(){const q=N.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const J=this._geoJSONIndex.getTile(q.z,q.x,q.y);if(!J)return null;const ce=new class{constructor(ve){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=y.X,this.length=ve.length,this._features=ve}feature(ve){return new class{constructor(ae){this._feature=ae,this.extent=y.X,this.type=ae.type,this.properties=ae.tags,"id"in ae&&!isNaN(ae.id)&&(this.id=parseInt(ae.id,10))}loadGeometry(){if(this._feature.type===1){const ae=[];for(const Ce of this._feature.geometry)ae.push([new y.P(Ce[0],Ce[1])]);return ae}{const ae=[];for(const Ce of this._feature.geometry){const Ae=[];for(const ke of Ce)Ae.push(new y.P(ke[0],ke[1]));ae.push(Ae)}return ae}}toGeoJSON(ae,Ce,Ae){return ge.call(this,ae,Ce,Ae)}}(this._features[ve])}}(J.features);let fe=Mr(ce);return fe.byteOffset===0&&fe.byteLength===fe.buffer.byteLength||(fe=new Uint8Array(fe)),{vectorTile:ce,rawData:fe.buffer}})}loadData(N){return y._(this,void 0,void 0,function*(){var O;(O=this._pendingRequest)===null||O===void 0||O.abort();const q=!!(N&&N.request&&N.request.collectResourceTiming)&&new y.bv(N.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(N,this._pendingRequest),this._geoJSONIndex=N.cluster?new Vr(function({superclusterOptions:fe,clusterProperties:ve}){if(!ve||!fe)return fe;const ae={},Ce={},Ae={accumulated:null,zoom:0},ke={properties:null},Be=Object.keys(ve);for(const lt of Be){const[pt,Bt]=ve[lt],kt=y.bC(Bt),jt=y.bC(typeof pt=="string"?[pt,["accumulated"],["get",lt]]:pt);ae[lt]=kt.value,Ce[lt]=jt.value}return fe.map=lt=>{ke.properties=lt;const pt={};for(const Bt of Be)pt[Bt]=ae[Bt].evaluate(Ae,ke);return pt},fe.reduce=(lt,pt)=>{ke.properties=pt;for(const Bt of Be)Ae.accumulated=lt[Bt],lt[Bt]=Ce[Bt].evaluate(Ae,ke)},fe}(N)).load((yield this._pendingData).features):(J=yield this._pendingData,new En(J,N.geojsonVtOptions)),this.loaded={};const ce={};if(q){const fe=q.finish();fe&&(ce.resourceTiming={},ce.resourceTiming[N.source]=JSON.parse(JSON.stringify(fe)))}return ce}catch(ce){if(delete this._pendingRequest,y.bB(ce))return{abandoned:!0};throw ce}var J})}getData(){return y._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(N){const O=this.loaded;return O&&O[N.uid]?super.reloadTile(N):this.loadTile(N)}loadAndProcessGeoJSON(N,O){return y._(this,void 0,void 0,function*(){let q=yield this.loadGeoJSON(N,O);if(delete this._pendingRequest,typeof q!="object")throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`);if(he(q,!0),N.filter){const J=y.bC(N.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(J.result==="error")throw new Error(J.value.map(fe=>`${fe.key}: ${fe.message}`).join(", "));q={type:"FeatureCollection",features:q.features.filter(fe=>J.value.evaluate({zoom:0},fe))}}return q})}loadGeoJSON(N,O){return y._(this,void 0,void 0,function*(){const{promoteId:q}=N;if(N.request){const J=yield y.h(N.request,O);return this._dataUpdateable=qi(J.data,q)?ls(J.data,q):void 0,J.data}if(typeof N.data=="string")try{const J=JSON.parse(N.data);return this._dataUpdateable=qi(J,q)?ls(J,q):void 0,J}catch{throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`)}if(!N.dataDiff)throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${N.source}`);return function(J,ce,fe){var ve,ae,Ce,Ae;if(ce.removeAll&&J.clear(),ce.remove)for(const ke of ce.remove)J.delete(ke);if(ce.add)for(const ke of ce.add){const Be=St(ke,fe);Be!=null&&J.set(Be,ke)}if(ce.update)for(const ke of ce.update){let Be=J.get(ke.id);if(Be==null)continue;const lt=!ke.removeAllProperties&&(((ve=ke.removeProperties)===null||ve===void 0?void 0:ve.length)>0||((ae=ke.addOrUpdateProperties)===null||ae===void 0?void 0:ae.length)>0);if((ke.newGeometry||ke.removeAllProperties||lt)&&(Be=Object.assign({},Be),J.set(ke.id,Be),lt&&(Be.properties=Object.assign({},Be.properties))),ke.newGeometry&&(Be.geometry=ke.newGeometry),ke.removeAllProperties)Be.properties={};else if(((Ce=ke.removeProperties)===null||Ce===void 0?void 0:Ce.length)>0)for(const pt of ke.removeProperties)Object.prototype.hasOwnProperty.call(Be.properties,pt)&&delete Be.properties[pt];if(((Ae=ke.addOrUpdateProperties)===null||Ae===void 0?void 0:Ae.length)>0)for(const{key:pt,value:Bt}of ke.addOrUpdateProperties)Be.properties[pt]=Bt}}(this._dataUpdateable,N.dataDiff,q),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(N){return y._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(N){return this._geoJSONIndex.getClusterExpansionZoom(N.clusterId)}getClusterChildren(N){return this._geoJSONIndex.getChildren(N.clusterId)}getClusterLeaves(N){return this._geoJSONIndex.getLeaves(N.clusterId,N.limit,N.offset)}}class Zi{constructor(N){this.self=N,this.actor=new y.F(N),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(O,q)=>{if(this.externalWorkerSourceTypes[O])throw new Error(`Worker source with name "${O}" already registered.`);this.externalWorkerSourceTypes[O]=q},this.self.addProtocol=y.bi,this.self.removeProtocol=y.bj,this.self.registerRTLTextPlugin=O=>{if(y.bD.isParsed())throw new Error("RTL text plugin already registered.");y.bD.setMethods(O)},this.actor.registerMessageHandler("LDT",(O,q)=>this._getDEMWorkerSource(O,q.source).loadTile(q)),this.actor.registerMessageHandler("RDT",(O,q)=>y._(this,void 0,void 0,function*(){this._getDEMWorkerSource(O,q.source).removeTile(q)})),this.actor.registerMessageHandler("GCEZ",(O,q)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(O,q.type,q.source).getClusterExpansionZoom(q)})),this.actor.registerMessageHandler("GCC",(O,q)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(O,q.type,q.source).getClusterChildren(q)})),this.actor.registerMessageHandler("GCL",(O,q)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(O,q.type,q.source).getClusterLeaves(q)})),this.actor.registerMessageHandler("LD",(O,q)=>this._getWorkerSource(O,q.type,q.source).loadData(q)),this.actor.registerMessageHandler("GD",(O,q)=>this._getWorkerSource(O,q.type,q.source).getData()),this.actor.registerMessageHandler("LT",(O,q)=>this._getWorkerSource(O,q.type,q.source).loadTile(q)),this.actor.registerMessageHandler("RT",(O,q)=>this._getWorkerSource(O,q.type,q.source).reloadTile(q)),this.actor.registerMessageHandler("AT",(O,q)=>this._getWorkerSource(O,q.type,q.source).abortTile(q)),this.actor.registerMessageHandler("RMT",(O,q)=>this._getWorkerSource(O,q.type,q.source).removeTile(q)),this.actor.registerMessageHandler("RS",(O,q)=>y._(this,void 0,void 0,function*(){if(!this.workerSources[O]||!this.workerSources[O][q.type]||!this.workerSources[O][q.type][q.source])return;const J=this.workerSources[O][q.type][q.source];delete this.workerSources[O][q.type][q.source],J.removeSource!==void 0&&J.removeSource(q)})),this.actor.registerMessageHandler("RM",O=>y._(this,void 0,void 0,function*(){delete this.layerIndexes[O],delete this.availableImages[O],delete this.workerSources[O],delete this.demWorkerSources[O]})),this.actor.registerMessageHandler("SR",(O,q)=>y._(this,void 0,void 0,function*(){this.referrer=q})),this.actor.registerMessageHandler("SRPS",(O,q)=>this._syncRTLPluginState(O,q)),this.actor.registerMessageHandler("IS",(O,q)=>y._(this,void 0,void 0,function*(){this.self.importScripts(q)})),this.actor.registerMessageHandler("SI",(O,q)=>this._setImages(O,q)),this.actor.registerMessageHandler("UL",(O,q)=>y._(this,void 0,void 0,function*(){this._getLayerIndex(O).update(q.layers,q.removedIds)})),this.actor.registerMessageHandler("SL",(O,q)=>y._(this,void 0,void 0,function*(){this._getLayerIndex(O).replace(q)}))}_setImages(N,O){return y._(this,void 0,void 0,function*(){this.availableImages[N]=O;for(const q in this.workerSources[N]){const J=this.workerSources[N][q];for(const ce in J)J[ce].availableImages=O}})}_syncRTLPluginState(N,O){return y._(this,void 0,void 0,function*(){if(y.bD.isParsed())return y.bD.getState();if(O.pluginStatus!=="loading")return y.bD.setState(O),O;const q=O.pluginURL;if(this.self.importScripts(q),y.bD.isParsed()){const J={pluginStatus:"loaded",pluginURL:q};return y.bD.setState(J),J}throw y.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${q}`)})}_getAvailableImages(N){let O=this.availableImages[N];return O||(O=[]),O}_getLayerIndex(N){let O=this.layerIndexes[N];return O||(O=this.layerIndexes[N]=new c),O}_getWorkerSource(N,O,q){if(this.workerSources[N]||(this.workerSources[N]={}),this.workerSources[N][O]||(this.workerSources[N][O]={}),!this.workerSources[N][O][q]){const J={sendAsync:(ce,fe)=>(ce.targetMapId=N,this.actor.sendAsync(ce,fe))};switch(O){case"vector":this.workerSources[N][O][q]=new z(J,this._getLayerIndex(N),this._getAvailableImages(N));break;case"geojson":this.workerSources[N][O][q]=new Es(J,this._getLayerIndex(N),this._getAvailableImages(N));break;default:this.workerSources[N][O][q]=new this.externalWorkerSourceTypes[O](J,this._getLayerIndex(N),this._getAvailableImages(N))}}return this.workerSources[N][O][q]}_getDEMWorkerSource(N,O){return this.demWorkerSources[N]||(this.demWorkerSources[N]={}),this.demWorkerSources[N][O]||(this.demWorkerSources[N][O]=new R),this.demWorkerSources[N][O]}}return y.i(self)&&(self.worker=new Zi(self)),Zi}),p("index",["exports","./shared"],function(y,c){var M="4.7.1";let I,j;const z={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:g=>new Promise((r,o)=>{const h=requestAnimationFrame(r);g.signal.addEventListener("abort",()=>{cancelAnimationFrame(h),o(c.c())})}),getImageData(g,r=0){return this.getImageCanvasContext(g).getImageData(-r,-r,g.width+2*r,g.height+2*r)},getImageCanvasContext(g){const r=window.document.createElement("canvas"),o=r.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return r.width=g.width,r.height=g.height,o.drawImage(g,0,0,g.width,g.height),o},resolveURL:g=>(I||(I=document.createElement("a")),I.href=g,I.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(j==null&&(j=matchMedia("(prefers-reduced-motion: reduce)")),j.matches)}};class R{static testProp(r){if(!R.docStyle)return r[0];for(let o=0;o<r.length;o++)if(r[o]in R.docStyle)return r[o];return r[0]}static create(r,o,h){const d=window.document.createElement(r);return o!==void 0&&(d.className=o),h&&h.appendChild(d),d}static createNS(r,o){return window.document.createElementNS(r,o)}static disableDrag(){R.docStyle&&R.selectProp&&(R.userSelect=R.docStyle[R.selectProp],R.docStyle[R.selectProp]="none")}static enableDrag(){R.docStyle&&R.selectProp&&(R.docStyle[R.selectProp]=R.userSelect)}static setTransform(r,o){r.style[R.transformProp]=o}static addEventListener(r,o,h,d={}){r.addEventListener(o,h,"passive"in d?d:d.capture)}static removeEventListener(r,o,h,d={}){r.removeEventListener(o,h,"passive"in d?d:d.capture)}static suppressClickInternal(r){r.preventDefault(),r.stopPropagation(),window.removeEventListener("click",R.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",R.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",R.suppressClickInternal,!0)},0)}static getScale(r){const o=r.getBoundingClientRect();return{x:o.width/r.offsetWidth||1,y:o.height/r.offsetHeight||1,boundingClientRect:o}}static getPoint(r,o,h){const d=o.boundingClientRect;return new c.P((h.clientX-d.left)/o.x-r.clientLeft,(h.clientY-d.top)/o.y-r.clientTop)}static mousePos(r,o){const h=R.getScale(r);return R.getPoint(r,h,o)}static touchPos(r,o){const h=[],d=R.getScale(r);for(let m=0;m<o.length;m++)h.push(R.getPoint(r,d,o[m]));return h}static mouseButton(r){return r.button}static remove(r){r.parentNode&&r.parentNode.removeChild(r)}}R.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,R.selectProp=R.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),R.transformProp=R.testProp(["transform","WebkitTransform"]);const X={supported:!1,testSupport:function(g){!ge&&he&&(W?Q(g):me=g)}};let me,he,ge=!1,W=!1;function Q(g){const r=g.createTexture();g.bindTexture(g.TEXTURE_2D,r);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,he),g.isContextLost())return;X.supported=!0}catch{}g.deleteTexture(r),ge=!0}var te;typeof document<"u"&&(he=document.createElement("img"),he.onload=()=>{me&&Q(me),me=null,W=!0},he.onerror=()=>{ge=!0,me=null},he.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(g){let r,o,h,d;g.resetRequestQueue=()=>{r=[],o=0,h=0,d={}},g.addThrottleControl=T=>{const P=h++;return d[P]=T,P},g.removeThrottleControl=T=>{delete d[T],b()},g.getImage=(T,P,D=!0)=>new Promise((L,U)=>{X.supported&&(T.headers||(T.headers={}),T.headers.accept="image/webp,*/*"),c.e(T,{type:"image"}),r.push({abortController:P,requestParameters:T,supportImageRefresh:D,state:"queued",onError:Z=>{U(Z)},onSuccess:Z=>{L(Z)}}),b()});const m=T=>c._(this,void 0,void 0,function*(){T.state="running";const{requestParameters:P,supportImageRefresh:D,onError:L,onSuccess:U,abortController:Z}=T,H=D===!1&&!c.i(self)&&!c.g(P.url)&&(!P.headers||Object.keys(P.headers).reduce((se,le)=>se&&le==="accept",!0));o++;const ee=H?k(P,Z):c.m(P,Z);try{const se=yield ee;delete T.abortController,T.state="completed",se.data instanceof HTMLImageElement||c.b(se.data)?U(se):se.data&&U({data:yield(ie=se.data,typeof createImageBitmap=="function"?c.d(ie):c.f(ie)),cacheControl:se.cacheControl,expires:se.expires})}catch(se){delete T.abortController,L(se)}finally{o--,b()}var ie}),b=()=>{const T=(()=>{for(const P of Object.keys(d))if(d[P]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let P=o;P<T&&r.length>0;P++){const D=r.shift();D.abortController.signal.aborted?P--:m(D)}},k=(T,P)=>new Promise((D,L)=>{const U=new Image,Z=T.url,H=T.credentials;H&&H==="include"?U.crossOrigin="use-credentials":(H&&H==="same-origin"||!c.s(Z))&&(U.crossOrigin="anonymous"),P.signal.addEventListener("abort",()=>{U.src="",L(c.c())}),U.fetchPriority="high",U.onload=()=>{U.onerror=U.onload=null,D({data:U})},U.onerror=()=>{U.onerror=U.onload=null,P.signal.aborted||L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},U.src=Z})}(te||(te={})),te.resetRequestQueue();class oe{constructor(r){this._transformRequestFn=r}transformRequest(r,o){return this._transformRequestFn&&this._transformRequestFn(r,o)||{url:r}}setTransformRequest(r){this._transformRequestFn=r}}function Me(g){var r=new c.A(3);return r[0]=g[0],r[1]=g[1],r[2]=g[2],r}var Se,ze=function(g,r,o){return g[0]=r[0]-o[0],g[1]=r[1]-o[1],g[2]=r[2]-o[2],g};Se=new c.A(3),c.A!=Float32Array&&(Se[0]=0,Se[1]=0,Se[2]=0);var Fe=function(g){var r=g[0],o=g[1];return r*r+o*o};function ct(g){const r=[];if(typeof g=="string")r.push({id:"default",url:g});else if(g&&g.length>0){const o=[];for(const{id:h,url:d}of g){const m=`${h}${d}`;o.indexOf(m)===-1&&(o.push(m),r.push({id:h,url:d}))}}return r}function it(g,r,o){const h=g.split("?");return h[0]+=`${r}${o}`,h.join("?")}(function(){var g=new c.A(2);c.A!=Float32Array&&(g[0]=0,g[1]=0)})();class ht{constructor(r,o,h,d){this.context=r,this.format=h,this.texture=r.gl.createTexture(),this.update(o,d)}update(r,o,h){const{width:d,height:m}=r,b=!(this.size&&this.size[0]===d&&this.size[1]===m||h),{context:k}=this,{gl:T}=k;if(this.useMipmap=!!(o&&o.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),k.pixelStoreUnpackFlipY.set(!1),k.pixelStoreUnpack.set(1),k.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!o||o.premultiply!==!1)),b)this.size=[d,m],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||c.b(r)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,r):T.texImage2D(T.TEXTURE_2D,0,this.format,d,m,0,this.format,T.UNSIGNED_BYTE,r.data);else{const{x:P,y:D}=h||{x:0,y:0};r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||c.b(r)?T.texSubImage2D(T.TEXTURE_2D,0,P,D,T.RGBA,T.UNSIGNED_BYTE,r):T.texSubImage2D(T.TEXTURE_2D,0,P,D,d,m,T.RGBA,T.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D)}bind(r,o,h){const{context:d}=this,{gl:m}=d;m.bindTexture(m.TEXTURE_2D,this.texture),h!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(h=m.LINEAR),r!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,r),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,h||r),this.filter=r),o!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,o),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}function dt(g){const{userImage:r}=g;return!!(r&&r.render&&r.render())&&(g.data.replace(new Uint8Array(r.data.buffer)),!0)}class Pt extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:o,promiseResolve:h}of this.requestors)h(this._getImagesForIds(o));this.requestors=[]}}getImage(r){const o=this.images[r];if(o&&!o.data&&o.spriteData){const h=o.spriteData;o.data=new c.R({width:h.width,height:h.height},h.context.getImageData(h.x,h.y,h.width,h.height).data),o.spriteData=null}return o}addImage(r,o){if(this.images[r])throw new Error(`Image id ${r} already exist, use updateImage instead`);this._validate(r,o)&&(this.images[r]=o)}_validate(r,o){let h=!0;const d=o.data||o.spriteData;return this._validateStretch(o.stretchX,d&&d.width)||(this.fire(new c.j(new Error(`Image "${r}" has invalid "stretchX" value`))),h=!1),this._validateStretch(o.stretchY,d&&d.height)||(this.fire(new c.j(new Error(`Image "${r}" has invalid "stretchY" value`))),h=!1),this._validateContent(o.content,o)||(this.fire(new c.j(new Error(`Image "${r}" has invalid "content" value`))),h=!1),h}_validateStretch(r,o){if(!r)return!0;let h=0;for(const d of r){if(d[0]<h||d[1]<d[0]||o<d[1])return!1;h=d[1]}return!0}_validateContent(r,o){if(!r)return!0;if(r.length!==4)return!1;const h=o.spriteData,d=h&&h.width||o.data.width,m=h&&h.height||o.data.height;return!(r[0]<0||d<r[0]||r[1]<0||m<r[1]||r[2]<0||d<r[2]||r[3]<0||m<r[3]||r[2]<r[0]||r[3]<r[1])}updateImage(r,o,h=!0){const d=this.getImage(r);if(h&&(d.data.width!==o.data.width||d.data.height!==o.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=d.version+1,this.images[r]=o,this.updatedImages[r]=!0}removeImage(r){const o=this.images[r];delete this.images[r],delete this.patterns[r],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r){return new Promise((o,h)=>{let d=!0;if(!this.isLoaded())for(const m of r)this.images[m]||(d=!1);this.isLoaded()||d?o(this._getImagesForIds(r)):this.requestors.push({ids:r,promiseResolve:o})})}_getImagesForIds(r){const o={};for(const h of r){let d=this.getImage(h);d||(this.fire(new c.k("styleimagemissing",{id:h})),d=this.getImage(h)),d?o[h]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,textFitWidth:d.textFitWidth,textFitHeight:d.textFitHeight,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:c.w(`Image "${h}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return o}getPixelSize(){const{width:r,height:o}=this.atlasImage;return{width:r,height:o}}getPattern(r){const o=this.patterns[r],h=this.getImage(r);if(!h)return null;if(o&&o.position.version===h.version)return o.position;if(o)o.position.version=h.version;else{const d={w:h.data.width+2,h:h.data.height+2,x:0,y:0},m=new c.I(d,h);this.patterns[r]={bin:d,position:m}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const o=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ht(r,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const m in this.patterns)r.push(this.patterns[m].bin);const{w:o,h}=c.p(r),d=this.atlasImage;d.resize({width:o||1,height:h||1});for(const m in this.patterns){const{bin:b}=this.patterns[m],k=b.x+1,T=b.y+1,P=this.getImage(m).data,D=P.width,L=P.height;c.R.copy(P,d,{x:0,y:0},{x:k,y:T},{width:D,height:L}),c.R.copy(P,d,{x:0,y:L-1},{x:k,y:T-1},{width:D,height:1}),c.R.copy(P,d,{x:0,y:0},{x:k,y:T+L},{width:D,height:1}),c.R.copy(P,d,{x:D-1,y:0},{x:k-1,y:T},{width:1,height:L}),c.R.copy(P,d,{x:0,y:0},{x:k+D,y:T},{width:1,height:L})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const o of r){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const h=this.getImage(o);h||c.w(`Image with ID: "${o}" was not found`),dt(h)&&this.updateImage(o,h)}}}const Dt=1e20;function pr(g,r,o,h,d,m,b,k,T){for(let P=r;P<r+h;P++)yn(g,o*m+P,m,d,b,k,T);for(let P=o;P<o+d;P++)yn(g,P*m+r,1,h,b,k,T)}function yn(g,r,o,h,d,m,b){m[0]=0,b[0]=-Dt,b[1]=Dt,d[0]=g[r];for(let k=1,T=0,P=0;k<h;k++){d[k]=g[r+k*o];const D=k*k;do{const L=m[T];P=(d[k]-d[L]+D-L*L)/(k-L)/2}while(P<=b[T]&&--T>-1);T++,m[T]=k,b[T]=P,b[T+1]=Dt}for(let k=0,T=0;k<h;k++){for(;b[T+1]<k;)T++;const P=m[T],D=k-P;g[r+k*o]=d[P]+D*D}}class Mr{constructor(r,o){this.requestManager=r,this.localIdeographFontFamily=o,this.entries={}}setURL(r){this.url=r}getGlyphs(r){return c._(this,void 0,void 0,function*(){const o=[];for(const m in r)for(const b of r[m])o.push(this._getAndCacheGlyphsPromise(m,b));const h=yield Promise.all(o),d={};for(const{stack:m,id:b,glyph:k}of h)d[m]||(d[m]={}),d[m][b]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics};return d})}_getAndCacheGlyphsPromise(r,o){return c._(this,void 0,void 0,function*(){let h=this.entries[r];h||(h=this.entries[r]={glyphs:{},requests:{},ranges:{}});let d=h.glyphs[o];if(d!==void 0)return{stack:r,id:o,glyph:d};if(d=this._tinySDF(h,r,o),d)return h.glyphs[o]=d,{stack:r,id:o,glyph:d};const m=Math.floor(o/256);if(256*m>65535)throw new Error("glyphs > 65535 not supported");if(h.ranges[m])return{stack:r,id:o,glyph:d};if(!this.url)throw new Error("glyphsUrl is not set");if(!h.requests[m]){const k=Mr.loadGlyphRange(r,m,this.url,this.requestManager);h.requests[m]=k}const b=yield h.requests[m];for(const k in b)this._doesCharSupportLocalGlyph(+k)||(h.glyphs[+k]=b[+k]);return h.ranges[m]=!0,{stack:r,id:o,glyph:b[o]||null}})}_doesCharSupportLocalGlyph(r){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(r))}_tinySDF(r,o,h){const d=this.localIdeographFontFamily;if(!d||!this._doesCharSupportLocalGlyph(h))return;let m=r.tinySDF;if(!m){let k="400";/bold/i.test(o)?k="900":/medium/i.test(o)?k="500":/light/i.test(o)&&(k="200"),m=r.tinySDF=new Mr.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:k})}const b=m.draw(String.fromCharCode(h));return{id:h,bitmap:new c.o({width:b.width||60,height:b.height||60},b.data),metrics:{width:b.glyphWidth/2||24,height:b.glyphHeight/2||24,left:b.glyphLeft/2+.5||0,top:b.glyphTop/2-27.5||-8,advance:b.glyphAdvance/2||24,isDoubleResolution:!0}}}}Mr.loadGlyphRange=function(g,r,o,h){return c._(this,void 0,void 0,function*(){const d=256*r,m=d+255,b=h.transformRequest(o.replace("{fontstack}",g).replace("{range}",`${d}-${m}`),"Glyphs"),k=yield c.l(b,new AbortController);if(!k||!k.data)throw new Error(`Could not load glyph range. range: ${r}, ${d}-${m}`);const T={};for(const P of c.n(k.data))T[P.id]=P;return T})},Mr.TinySDF=class{constructor({fontSize:g=24,buffer:r=3,radius:o=8,cutoff:h=.25,fontFamily:d="sans-serif",fontWeight:m="normal",fontStyle:b="normal"}={}){this.buffer=r,this.cutoff=h,this.radius=o;const k=this.size=g+4*r,T=this._createCanvas(k),P=this.ctx=T.getContext("2d",{willReadFrequently:!0});P.font=`${b} ${m} ${g}px ${d}`,P.textBaseline="alphabetic",P.textAlign="left",P.fillStyle="black",this.gridOuter=new Float64Array(k*k),this.gridInner=new Float64Array(k*k),this.f=new Float64Array(k),this.z=new Float64Array(k+1),this.v=new Uint16Array(k)}_createCanvas(g){const r=document.createElement("canvas");return r.width=r.height=g,r}draw(g){const{width:r,actualBoundingBoxAscent:o,actualBoundingBoxDescent:h,actualBoundingBoxLeft:d,actualBoundingBoxRight:m}=this.ctx.measureText(g),b=Math.ceil(o),k=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-d))),T=Math.min(this.size-this.buffer,b+Math.ceil(h)),P=k+2*this.buffer,D=T+2*this.buffer,L=Math.max(P*D,0),U=new Uint8ClampedArray(L),Z={data:U,width:P,height:D,glyphWidth:k,glyphHeight:T,glyphTop:b,glyphLeft:0,glyphAdvance:r};if(k===0||T===0)return Z;const{ctx:H,buffer:ee,gridInner:ie,gridOuter:se}=this;H.clearRect(ee,ee,k,T),H.fillText(g,ee,ee+b);const le=H.getImageData(ee,ee,k,T);se.fill(Dt,0,L),ie.fill(0,0,L);for(let K=0;K<T;K++)for(let de=0;de<k;de++){const ye=le.data[4*(K*k+de)+3]/255;if(ye===0)continue;const we=(K+ee)*P+de+ee;if(ye===1)se[we]=0,ie[we]=Dt;else{const Ee=.5-ye;se[we]=Ee>0?Ee*Ee:0,ie[we]=Ee<0?Ee*Ee:0}}pr(se,0,0,P,D,P,this.f,this.v,this.z),pr(ie,ee,ee,k,T,P,this.f,this.v,this.z);for(let K=0;K<L;K++){const de=Math.sqrt(se[K])-Math.sqrt(ie[K]);U[K]=Math.round(255-255*(de/this.radius+this.cutoff))}return Z}};class Ke{constructor(){this.specification=c.v.light.position}possiblyEvaluate(r,o){return c.x(r.expression.evaluate(o))}interpolate(r,o,h){return{x:c.y.number(r.x,o.x,h),y:c.y.number(r.y,o.y,h),z:c.y.number(r.z,o.z,h)}}}let yt;class ft extends c.E{constructor(r){super(),yt=yt||new c.q({anchor:new c.D(c.v.light.anchor),position:new Ke,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(yt),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,o={}){if(!this._validate(c.r,r,o))for(const h in r){const d=r[h];h.endsWith("-transition")?this._transitionable.setTransition(h.slice(0,-11),d):this._transitionable.setValue(h,d)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,o,h){return(!h||h.validate!==!1)&&c.t(this,r.call(c.u,{value:o,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const Lt=new c.q({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class Wt extends c.E{constructor(r){super(),this._transitionable=new c.T(Lt),this.setSky(r),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.z(0))}setSky(r,o={}){if(!this._validate(c.B,r,o)){r||(r={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const h in r){const d=r[h];h.endsWith("-transition")?this._transitionable.setTransition(h.slice(0,-11),d):this._transitionable.setValue(h,d)}}}getSky(){return this._transitionable.serialize()}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,o,h={}){return(h==null?void 0:h.validate)!==!1&&c.t(this,r.call(c.u,c.e({value:o,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(r){return r<60?0:r<70?(r-60)/10:1}}class $n{constructor(r,o){this.width=r,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(r,o){const h=r.join(",")+String(o);return this.dashEntry[h]||(this.dashEntry[h]=this.addDash(r,o)),this.dashEntry[h]}getDashRanges(r,o,h){const d=[];let m=r.length%2==1?-r[r.length-1]*h:0,b=r[0]*h,k=!0;d.push({left:m,right:b,isDash:k,zeroLength:r[0]===0});let T=r[0];for(let P=1;P<r.length;P++){k=!k;const D=r[P];m=T*h,T+=D,b=T*h,d.push({left:m,right:b,isDash:k,zeroLength:D===0})}return d}addRoundDash(r,o,h){const d=o/2;for(let m=-h;m<=h;m++){const b=this.width*(this.nextRow+h+m);let k=0,T=r[k];for(let P=0;P<this.width;P++){P/T.right>1&&(T=r[++k]);const D=Math.abs(P-T.left),L=Math.abs(P-T.right),U=Math.min(D,L);let Z;const H=m/h*(d+1);if(T.isDash){const ee=d-Math.abs(H);Z=Math.sqrt(U*U+ee*ee)}else Z=d-Math.sqrt(U*U+H*H);this.data[b+P]=Math.max(0,Math.min(255,Z+128))}}}addRegularDash(r){for(let k=r.length-1;k>=0;--k){const T=r[k],P=r[k+1];T.zeroLength?r.splice(k,1):P&&P.isDash===T.isDash&&(P.left=T.left,r.splice(k,1))}const o=r[0],h=r[r.length-1];o.isDash===h.isDash&&(o.left=h.left-this.width,h.right=o.right+this.width);const d=this.width*this.nextRow;let m=0,b=r[m];for(let k=0;k<this.width;k++){k/b.right>1&&(b=r[++m]);const T=Math.abs(k-b.left),P=Math.abs(k-b.right),D=Math.min(T,P);this.data[d+k]=Math.max(0,Math.min(255,(b.isDash?D:-D)+128))}}addDash(r,o){const h=o?7:0,d=2*h+1;if(this.nextRow+d>this.height)return c.w("LineAtlas out of space"),null;let m=0;for(let k=0;k<r.length;k++)m+=r[k];if(m!==0){const k=this.width/m,T=this.getDashRanges(r,this.width,k);o?this.addRoundDash(T,k,h):this.addRegularDash(T)}const b={y:(this.nextRow+h+.5)/this.height,height:2*h/this.height,width:m};return this.nextRow+=d,this.dirty=!0,b}bind(r){const o=r.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}const Vr="maplibre_preloaded_worker_pool";class tn{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<tn.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Vr]}numActive(){return Object.keys(this.active).length}}const rn=Math.floor(z.hardwareConcurrency/2);let Dr,qn;function et(){return Dr||(Dr=new tn),Dr}tn.workerCount=c.C(globalThis)?Math.max(Math.min(rn,3),1):1;class Tt{constructor(r,o){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=o;const h=this.workerPool.acquire(o);for(let d=0;d<h.length;d++){const m=new c.F(h[d],o);m.name=`Worker ${d}`,this.actors.push(m)}if(!this.actors.length)throw new Error("No actors found")}broadcast(r,o){const h=[];for(const d of this.actors)h.push(d.sendAsync({type:r,data:o}));return Promise.all(h)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(r=!0){this.actors.forEach(o=>{o.remove()}),this.actors=[],r&&this.workerPool.release(this.id)}registerMessageHandler(r,o){for(const h of this.actors)h.registerMessageHandler(r,o)}}function Rt(){return qn||(qn=new Tt(et(),c.G),qn.registerMessageHandler("GR",(g,r,o)=>c.m(r,o))),qn}function Le(g,r){const o=c.H();return c.J(o,o,[1,1,0]),c.K(o,o,[.5*g.width,.5*g.height,1]),c.L(o,o,g.calculatePosMatrix(r.toUnwrapped()))}function yr(g,r,o,h,d,m){const b=function(L,U,Z){if(L)for(const H of L){const ee=U[H];if(ee&&ee.source===Z&&ee.type==="fill-extrusion")return!0}else for(const H in U){const ee=U[H];if(ee.source===Z&&ee.type==="fill-extrusion")return!0}return!1}(d&&d.layers,r,g.id),k=m.maxPitchScaleFactor(),T=g.tilesIn(h,k,b);T.sort(Nt);const P=[];for(const L of T)P.push({wrappedTileID:L.tileID.wrapped().key,queryResults:L.tile.queryRenderedFeatures(r,o,g._state,L.queryGeometry,L.cameraQueryGeometry,L.scale,d,m,k,Le(g.transform,L.tileID))});const D=function(L){const U={},Z={};for(const H of L){const ee=H.queryResults,ie=H.wrappedTileID,se=Z[ie]=Z[ie]||{};for(const le in ee){const K=ee[le],de=se[le]=se[le]||{},ye=U[le]=U[le]||[];for(const we of K)de[we.featureIndex]||(de[we.featureIndex]=!0,ye.push(we))}}return U}(P);for(const L in D)D[L].forEach(U=>{const Z=U.feature,H=g.getFeatureState(Z.layer["source-layer"],Z.id);Z.source=Z.layer.source,Z.layer["source-layer"]&&(Z.sourceLayer=Z.layer["source-layer"]),Z.state=H});return D}function Nt(g,r){const o=g.tileID,h=r.tileID;return o.overscaledZ-h.overscaledZ||o.canonical.y-h.canonical.y||o.wrap-h.wrap||o.canonical.x-h.canonical.x}function Lr(g,r,o){return c._(this,void 0,void 0,function*(){let h=g;if(g.url?h=(yield c.h(r.transformRequest(g.url,"Source"),o)).data:yield z.frameAsync(o),!h)return null;const d=c.M(c.e(h,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in h&&h.vector_layers&&(d.vectorLayerIds=h.vector_layers.map(m=>m.id)),d})}class be{constructor(r,o){r&&(o?this.setSouthWest(r).setNorthEast(o):Array.isArray(r)&&(r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1])))}setNorthEast(r){return this._ne=r instanceof c.N?new c.N(r.lng,r.lat):c.N.convert(r),this}setSouthWest(r){return this._sw=r instanceof c.N?new c.N(r.lng,r.lat):c.N.convert(r),this}extend(r){const o=this._sw,h=this._ne;let d,m;if(r instanceof c.N)d=r,m=r;else{if(!(r instanceof be))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(be.convert(r)):this.extend(c.N.convert(r)):r&&("lng"in r||"lon"in r)&&"lat"in r?this.extend(c.N.convert(r)):this;if(d=r._sw,m=r._ne,!d||!m)return this}return o||h?(o.lng=Math.min(d.lng,o.lng),o.lat=Math.min(d.lat,o.lat),h.lng=Math.max(m.lng,h.lng),h.lat=Math.max(m.lat,h.lat)):(this._sw=new c.N(d.lng,d.lat),this._ne=new c.N(m.lng,m.lat)),this}getCenter(){return new c.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.N(this.getWest(),this.getNorth())}getSouthEast(){return new c.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:o,lat:h}=c.N.convert(r);let d=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&d}static convert(r){return r instanceof be?r:r&&new be(r)}static fromLngLat(r,o=0){const h=360*o/40075017,d=h/Math.cos(Math.PI/180*r.lat);return new be(new c.N(r.lng-d,r.lat-h),new c.N(r.lng+d,r.lat+h))}adjustAntiMeridian(){const r=new c.N(this._sw.lng,this._sw.lat),o=new c.N(this._ne.lng,this._ne.lat);return new be(r,r.lng>o.lng?new c.N(o.lng+360,o.lat):o)}}class _n{constructor(r,o,h){this.bounds=be.convert(this.validateBounds(r)),this.minzoom=o||0,this.maxzoom=h||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const o=Math.pow(2,r.z),h=Math.floor(c.O(this.bounds.getWest())*o),d=Math.floor(c.Q(this.bounds.getNorth())*o),m=Math.ceil(c.O(this.bounds.getEast())*o),b=Math.ceil(c.Q(this.bounds.getSouth())*o);return r.x>=h&&r.x<m&&r.y>=d&&r.y<b}}class Cs extends c.E{constructor(r,o,h,d){if(super(),this.id=r,this.dispatcher=h,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.M(o,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield Lr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),r&&(c.e(this,r),r.bounds&&(this.tileBounds=new _n(r.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(r){this._tileJSONRequest=null,this.fire(new c.j(r))}})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}setSourceProperty(r){this._tileJSONRequest&&this._tileJSONRequest.abort(),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(r){return c._(this,void 0,void 0,function*(){const o=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h={request:this.map._requestManager.transformRequest(o,"Tile"),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};h.request.collectResourceTiming=this._collectResourceTiming;let d="RT";if(r.actor&&r.state!=="expired"){if(r.state==="loading")return new Promise((m,b)=>{r.reloadPromise={resolve:m,reject:b}})}else r.actor=this.dispatcher.getActor(),d="LT";r.abortController=new AbortController;try{const m=yield r.actor.sendAsync({type:d,data:h},r.abortController);if(delete r.abortController,r.aborted)return;this._afterTileLoadWorkerResponse(r,m)}catch(m){if(delete r.abortController,r.aborted)return;if(m&&m.status!==404)throw m;this._afterTileLoadWorkerResponse(r,null)}})}_afterTileLoadWorkerResponse(r,o){if(o&&o.resourceTiming&&(r.resourceTiming=o.resourceTiming),o&&this.map._refreshExpiredTiles&&r.setExpiryData(o),r.loadVectorData(o,this.map.painter),r.reloadPromise){const h=r.reloadPromise;r.reloadPromise=null,this.loadTile(r).then(h.resolve).catch(h.reject)}}abortTile(r){return c._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController),r.actor&&(yield r.actor.sendAsync({type:"AT",data:{uid:r.uid,type:this.type,source:this.id}}))})}unloadTile(r){return c._(this,void 0,void 0,function*(){r.unloadVectorData(),r.actor&&(yield r.actor.sendAsync({type:"RMT",data:{uid:r.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class qt extends c.E{constructor(r,o,h,d){super(),this.id=r,this.dispatcher=h,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},o),c.e(this,c.M(o,["url","scheme","tileSize"]))}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield Lr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,r&&(c.e(this,r),r.bounds&&(this.tileBounds=new _n(r.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(r){this._tileJSONRequest=null,this.fire(new c.j(r))}})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(r){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}serialize(){return c.e({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r){return c._(this,void 0,void 0,function*(){const o=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);r.abortController=new AbortController;try{const h=yield te.getImage(this.map._requestManager.transformRequest(o,"Tile"),r.abortController,this.map._refreshExpiredTiles);if(delete r.abortController,r.aborted)return void(r.state="unloaded");if(h&&h.data){this.map._refreshExpiredTiles&&h.cacheControl&&h.expires&&r.setExpiryData({cacheControl:h.cacheControl,expires:h.expires});const d=this.map.painter.context,m=d.gl,b=h.data;r.texture=this.map.painter.getTileTexture(b.width),r.texture?r.texture.update(b,{useMipmap:!0}):(r.texture=new ht(d,b,m.RGBA,{useMipmap:!0}),r.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST)),r.state="loaded"}}catch(h){if(delete r.abortController,r.aborted)r.state="unloaded";else if(h)throw r.state="errored",h}})}abortTile(r){return c._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController)})}unloadTile(r){return c._(this,void 0,void 0,function*(){r.texture&&this.map.painter.saveTileTexture(r.texture)})}hasTransition(){return!1}}class _r extends qt{constructor(r,o,h,d){super(r,o,h,d),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox",this.redFactor=o.redFactor,this.greenFactor=o.greenFactor,this.blueFactor=o.blueFactor,this.baseShift=o.baseShift}loadTile(r){return c._(this,void 0,void 0,function*(){const o=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h=this.map._requestManager.transformRequest(o,"Tile");r.neighboringTiles=this._getNeighboringTiles(r.tileID),r.abortController=new AbortController;try{const d=yield te.getImage(h,r.abortController,this.map._refreshExpiredTiles);if(delete r.abortController,r.aborted)return void(r.state="unloaded");if(d&&d.data){const m=d.data;this.map._refreshExpiredTiles&&d.cacheControl&&d.expires&&r.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const b=c.b(m)&&c.U()?m:yield this.readImageNow(m),k={type:this.type,uid:r.uid,source:this.id,rawImageData:b,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!r.actor||r.state==="expired"){r.actor=this.dispatcher.getActor();const T=yield r.actor.sendAsync({type:"LDT",data:k});r.dem=T,r.needsHillshadePrepare=!0,r.needsTerrainPrepare=!0,r.state="loaded"}}}catch(d){if(delete r.abortController,r.aborted)r.state="unloaded";else if(d)throw r.state="errored",d}})}readImageNow(r){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.V()){const o=r.width+2,h=r.height+2;try{return new c.R({width:o,height:h},yield c.W(r,-1,-1,o,h))}catch{}}return z.getImageData(r,1)})}_getNeighboringTiles(r){const o=r.canonical,h=Math.pow(2,o.z),d=(o.x-1+h)%h,m=o.x===0?r.wrap-1:r.wrap,b=(o.x+1+h)%h,k=o.x+1===h?r.wrap+1:r.wrap,T={};return T[new c.S(r.overscaledZ,m,o.z,d,o.y).key]={backfilled:!1},T[new c.S(r.overscaledZ,k,o.z,b,o.y).key]={backfilled:!1},o.y>0&&(T[new c.S(r.overscaledZ,m,o.z,d,o.y-1).key]={backfilled:!1},T[new c.S(r.overscaledZ,r.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},T[new c.S(r.overscaledZ,k,o.z,b,o.y-1).key]={backfilled:!1}),o.y+1<h&&(T[new c.S(r.overscaledZ,m,o.z,d,o.y+1).key]={backfilled:!1},T[new c.S(r.overscaledZ,r.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},T[new c.S(r.overscaledZ,k,o.z,b,o.y+1).key]={backfilled:!1}),T}unloadTile(r){return c._(this,void 0,void 0,function*(){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.fbo&&(r.fbo.destroy(),delete r.fbo),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded",r.actor&&(yield r.actor.sendAsync({type:"RDT",data:{type:this.type,uid:r.uid,source:this.id}}))})}}class qo extends c.E{constructor(r,o,h,d){super(),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=h.getActor(),this.setEventedParent(d),this._data=o.data,this._options=c.e({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const m=c.X/this.tileSize;o.clusterMaxZoom!==void 0&&this.maxzoom<=o.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${o.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*m,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*m,extent:c.X,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:c.X,radius:(o.clusterRadius||50)*m,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(r){this.map=r,this.load()}setData(r){return this._data=r,this._updateWorkerData(),this}updateData(r){return this._updateWorkerData(r),this}getData(){return c._(this,void 0,void 0,function*(){const r=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:r})})}setClusterOptions(r){return this.workerOptions.cluster=r.cluster,r&&(r.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=r.clusterRadius),r.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=r.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(r){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:r,source:this.id}})}getClusterChildren(r){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:r,source:this.id}})}getClusterLeaves(r,o,h){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:r,limit:o,offset:h}})}_updateWorkerData(r){return c._(this,void 0,void 0,function*(){const o=c.e({type:this.type},this.workerOptions);r?o.dataDiff=r:typeof this._data=="string"?(o.request=this.map._requestManager.transformRequest(z.resolveURL(this._data),"Source"),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.k("dataloading",{dataType:"source"}));try{const h=yield this.actor.sendAsync({type:"LD",data:o});if(this._pendingLoads--,this._removed||h.abandoned)return void this.fire(new c.k("dataabort",{dataType:"source"}));let d=null;h.resourceTiming&&h.resourceTiming[this.id]&&(d=h.resourceTiming[this.id].slice(0));const m={dataType:"source"};this._collectResourceTiming&&d&&d.length>0&&c.e(m,{resourceTiming:d}),this.fire(new c.k("data",Object.assign(Object.assign({},m),{sourceDataType:"metadata"}))),this.fire(new c.k("data",Object.assign(Object.assign({},m),{sourceDataType:"content"})))}catch(h){if(this._pendingLoads--,this._removed)return void this.fire(new c.k("dataabort",{dataType:"source"}));this.fire(new c.j(h))}})}loaded(){return this._pendingLoads===0}loadTile(r){return c._(this,void 0,void 0,function*(){const o=r.actor?"RT":"LT";r.actor=this.actor;const h={type:this.type,uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.abortController=new AbortController;const d=yield this.actor.sendAsync({type:o,data:h},r.abortController);delete r.abortController,r.unloadVectorData(),r.aborted||r.loadVectorData(d,this.map.painter,o==="RT")})}abortTile(r){return c._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController),r.aborted=!0})}unloadTile(r){return c._(this,void 0,void 0,function*(){r.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:r.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Ms=c.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class os extends c.E{constructor(r,o,h,d){super(),this.id=r,this.dispatcher=h,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=o}load(r){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const o=yield te.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,o&&o.data&&(this.image=o.data,r&&(this.coordinates=r),this._finishLoading())}catch(o){this._request=null,this._loaded=!0,this.fire(new c.j(o))}})}loaded(){return this._loaded}updateImage(r){return r.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=r.url,this.load(r.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(r){this.coordinates=r;const o=r.map(c.Z.fromLngLat);this.tileID=function(d){let m=1/0,b=1/0,k=-1/0,T=-1/0;for(const U of d)m=Math.min(m,U.x),b=Math.min(b,U.y),k=Math.max(k,U.x),T=Math.max(T,U.y);const P=Math.max(k-m,T-b),D=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),L=Math.pow(2,D);return new c.a1(D,Math.floor((m+k)/2*L),Math.floor((b+T)/2*L))}(o),this.minzoom=this.maxzoom=this.tileID.z;const h=o.map(d=>this.tileID.getTilePoint(d)._round());return this._boundsArray=new c.$,this._boundsArray.emplaceBack(h[0].x,h[0].y,0,0),this._boundsArray.emplaceBack(h[1].x,h[1].y,c.X,0),this._boundsArray.emplaceBack(h[3].x,h[3].y,0,c.X),this._boundsArray.emplaceBack(h[2].x,h[2].y,c.X,c.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,o=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,Ms.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ht(r,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let h=!1;for(const d in this.tiles){const m=this.tiles[d];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,h=!0)}h&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(r){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={}):r.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Pa extends os{constructor(r,o,h,d){super(r,o,h,d),this.roundZoom=!0,this.type="video",this.options=o}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const r=this.options;this.urls=[];for(const o of r.urls)this.urls.push(this.map._requestManager.transformRequest(o,"Source").url);try{const o=yield c.a3(this.urls);if(this._loaded=!0,!o)return;this.video=o,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(o){this.fire(new c.j(o))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(r){if(this.video){const o=this.video.seekable;r<o.start(0)||r>o.end(0)?this.fire(new c.j(new c.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=r}}getVideo(){return this.video}onAdd(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const r=this.map.painter.context,o=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,Ms.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new ht(r,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let h=!1;for(const d in this.tiles){const m=this.tiles[d];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,h=!0)}h&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ii extends os{constructor(r,o,h,d){super(r,o,h,d),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(m=>!Array.isArray(m)||m.length!==2||m.some(b=>typeof b!="number"))||this.fire(new c.j(new c.a2(`sources.${r}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.j(new c.a2(`sources.${r}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new c.j(new c.a2(`sources.${r}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new c.j(new c.a2(`sources.${r}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.j(new c.a2(`sources.${r}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let r=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,r=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,r=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context,h=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Ms.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?(r||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ht(o,this.canvas,h.RGBA,{premultiply:!0});let d=!1;for(const m in this.tiles){const b=this.tiles[m];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture,d=!0)}d&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const r of[this.canvas.width,this.canvas.height])if(isNaN(r)||r<=0)return!0;return!1}}const Zo={},Ho=g=>{switch(g){case"geojson":return qo;case"image":return os;case"raster":return qt;case"raster-dem":return _r;case"vector":return Cs;case"video":return Pa;case"canvas":return ii}return Zo[g]},Oe="RTLPluginLoaded";class Vi extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Rt()}_syncState(r){return this.status=r,this.dispatcher.broadcast("SRPS",{pluginStatus:r,pluginURL:this.url}).catch(o=>{throw this.status="error",o})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(r){return c._(this,arguments,void 0,function*(o,h=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=z.resolveURL(o),!this.url)throw new Error(`requested url ${o} is invalid`);if(this.status==="unavailable"){if(!h)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.k(Oe))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let vn=null;function $i(){return vn||(vn=new Vi),vn}class Is{constructor(r,o){this.timeAdded=0,this.fadeEndTime=0,this.tileID=r,this.uid=c.a4(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(r){const o=r+this.timeAdded;o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(r){this.demTexture&&r.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(r,o,h){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(d,m){const b={};if(!m)return b;for(const k of d){const T=k.layerIds.map(P=>m.getLayer(P)).filter(Boolean);if(T.length!==0){k.layers=T,k.stateDependentLayerIds&&(k.stateDependentLayers=k.stateDependentLayerIds.map(P=>T.filter(D=>D.id===P)[0]));for(const P of T)b[P.id]=k}}return b}(r.buckets,o.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const m=this.buckets[d];if(m instanceof c.a6){if(this.hasSymbolBuckets=!0,!h)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const m=this.buckets[d];if(m instanceof c.a6&&m.hasRTLText){this.hasRTLText=!0,$i().lazyLoad();break}}this.queryPadding=0;for(const d in this.buckets){const m=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(d).queryRadius(m))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new c.a5}unloadVectorData(){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(r){return this.buckets[r.id]}upload(r){for(const h in this.buckets){const d=this.buckets[h];d.uploadPending()&&d.upload(r)}const o=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ht(r,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ht(r,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,o,h,d,m,b,k,T,P,D){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:m,scale:b,tileSize:this.tileSize,pixelPosMatrix:D,transform:T,params:k,queryPadding:this.queryPadding*P},r,o,h):{}}querySourceFeatures(r,o){const h=this.latestFeatureIndex;if(!h||!h.rawTileData)return;const d=h.loadVTLayers(),m=o&&o.sourceLayer?o.sourceLayer:"",b=d._geojsonTileLayer||d[m];if(!b)return;const k=c.a7(o&&o.filter),{z:T,x:P,y:D}=this.tileID.canonical,L={z:T,x:P,y:D};for(let U=0;U<b.length;U++){const Z=b.feature(U);if(k.needGeometry){const ie=c.a8(Z,!0);if(!k.filter(new c.z(this.tileID.overscaledZ),ie,this.tileID.canonical))continue}else if(!k.filter(new c.z(this.tileID.overscaledZ),Z))continue;const H=h.getId(Z,m),ee=new c.a9(Z,T,P,D,H);ee.tile=L,r.push(ee)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const o=this.expirationTime;if(r.cacheControl){const h=c.aa(r.cacheControl);h["max-age"]&&(this.expirationTime=Date.now()+1e3*h["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const h=Date.now();let d=!1;if(this.expirationTime>h)d=!1;else if(o)if(this.expirationTime<o)d=!0;else{const m=this.expirationTime-o;m?this.expirationTime=h+Math.max(m,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(r).length===0)return;const h=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!o.style.hasLayer(d))continue;const m=this.buckets[d],b=m.layers[0].sourceLayer||"_geojsonTileLayer",k=h[b],T=r[b];if(!k||!T||Object.keys(T).length===0)continue;m.update(T,k,this.imageAtlas&&this.imageAtlas.patternPositions||{});const P=o&&o.style&&o.style.getLayer(d);P&&(this.queryPadding=Math.max(this.queryPadding,P.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<z.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=z.now()+r}setDependencies(r,o){const h={};for(const d of o)h[d]=!0;this.dependencies[r]=h}hasDependency(r,o){for(const h of r){const d=this.dependencies[h];if(d){for(const m of o)if(d[m])return!0}}return!1}}class Ve{constructor(r,o){this.max=r,this.onRemove=o,this.reset()}reset(){for(const r in this.data)for(const o of this.data[r])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(r,o,h){const d=r.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const m={value:o,timeout:void 0};if(h!==void 0&&(m.timeout=setTimeout(()=>{this.remove(r,m)},h)),this.data[d].push(m),this.order.push(d),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const o=this.data[r].shift();return o.timeout&&clearTimeout(o.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),o.value}getByKey(r){const o=this.data[r];return o?o[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,o){if(!this.has(r))return this;const h=r.wrapped().key,d=o===void 0?0:this.data[h].indexOf(o),m=this.data[h][d];return this.data[h].splice(d,1),m.timeout&&clearTimeout(m.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(m.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(r){const o=[];for(const h in this.data)for(const d of this.data[h])r(d.value)||o.push(d);for(const h of o)this.remove(h.value.tileID,h)}}class Mt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,o,h){const d=String(o);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][d]=this.stateChanges[r][d]||{},c.e(this.stateChanges[r][d],h),this.deletedStates[r]===null){this.deletedStates[r]={};for(const m in this.state[r])m!==d&&(this.deletedStates[r][m]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][d]===null){this.deletedStates[r][d]={};for(const m in this.state[r][d])h[m]||(this.deletedStates[r][d][m]=null)}else for(const m in h)this.deletedStates[r]&&this.deletedStates[r][d]&&this.deletedStates[r][d][m]===null&&delete this.deletedStates[r][d][m]}removeFeatureState(r,o,h){if(this.deletedStates[r]===null)return;const d=String(o);if(this.deletedStates[r]=this.deletedStates[r]||{},h&&o!==void 0)this.deletedStates[r][d]!==null&&(this.deletedStates[r][d]=this.deletedStates[r][d]||{},this.deletedStates[r][d][h]=null);else if(o!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][d])for(h in this.deletedStates[r][d]={},this.stateChanges[r][d])this.deletedStates[r][d][h]=null;else this.deletedStates[r][d]=null;else this.deletedStates[r]=null}getState(r,o){const h=String(o),d=c.e({},(this.state[r]||{})[h],(this.stateChanges[r]||{})[h]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const m=this.deletedStates[r][o];if(m===null)return{};for(const b in m)delete d[b]}return d}initializeTileState(r,o){r.setFeatureState(this.state,o)}coalesceChanges(r,o){const h={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const m={};for(const b in this.stateChanges[d])this.state[d][b]||(this.state[d][b]={}),c.e(this.state[d][b],this.stateChanges[d][b]),m[b]=this.state[d][b];h[d]=m}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const m={};if(this.deletedStates[d]===null)for(const b in this.state[d])m[b]={},this.state[d][b]={};else for(const b in this.deletedStates[d]){if(this.deletedStates[d][b]===null)this.state[d][b]={};else for(const k of Object.keys(this.deletedStates[d][b]))delete this.state[d][b][k];m[b]=this.state[d][b]}h[d]=h[d]||{},c.e(h[d],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(h).length!==0)for(const d in r)r[d].setFeatureState(h,o)}}class _t extends c.E{constructor(r,o,h){super(),this.id=r,this.dispatcher=h,this.on("data",d=>this._dataHandler(d)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((d,m,b,k)=>{const T=new(Ho(m.type))(d,m,b,k);if(T.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${T.id}`);return T})(r,o,h,this),this._tiles={},this._cache=new Ve(0,d=>this._unloadTile(d)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Mt,this._didEmitContent=!1,this._updated=!1}onAdd(r){this.map=r,this._maxTileCacheSize=r?r._maxTileCacheSize:null,this._maxTileCacheZoomLevels=r?r._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(r)}onRemove(r){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(r)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const r in this._tiles){const o=this._tiles[r];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(r,o,h){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(r),this._tileLoaded(r,o,h)}catch(d){r.state="errored",d.status!==404?this._source.fire(new c.j(d,{tile:r})):this.update(this.transform,this.terrain)}})}_unloadTile(r){this._source.unloadTile&&this._source.unloadTile(r)}_abortTile(r){this._source.abortTile&&this._source.abortTile(r),this._source.fire(new c.k("dataabort",{tile:r,coord:r.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const h=this._tiles[o];h.upload(r),h.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(r=>r.tileID).sort(En).map(r=>r.key)}getRenderableIds(r){const o=[];for(const h in this._tiles)this._isIdRenderable(h,r)&&o.push(this._tiles[h]);return r?o.sort((h,d)=>{const m=h.tileID,b=d.tileID,k=new c.P(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),T=new c.P(b.canonical.x,b.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-b.overscaledZ||T.y-k.y||T.x-k.x}).map(h=>h.tileID.key):o.map(h=>h.tileID).sort(En).map(h=>h.key)}hasRenderableParent(r){const o=this.findLoadedParent(r,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(r,o){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(o||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(r,"reloading")}}_reloadTile(r,o){return c._(this,void 0,void 0,function*(){const h=this._tiles[r];h&&(h.state!=="loading"&&(h.state=o),yield this._loadTile(h,r,o))})}_tileLoaded(r,o,h){r.timeAdded=z.now(),h==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(o,r),this.getSource().type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),r.aborted||this._source.fire(new c.k("data",{dataType:"source",tile:r,coord:r.tileID}))}_backfillDEM(r){const o=this.getRenderableIds();for(let d=0;d<o.length;d++){const m=o[d];if(r.neighboringTiles&&r.neighboringTiles[m]){const b=this.getTileByID(m);h(r,b),h(b,r)}}function h(d,m){d.needsHillshadePrepare=!0,d.needsTerrainPrepare=!0;let b=m.tileID.canonical.x-d.tileID.canonical.x;const k=m.tileID.canonical.y-d.tileID.canonical.y,T=Math.pow(2,d.tileID.canonical.z),P=m.tileID.key;b===0&&k===0||Math.abs(k)>1||(Math.abs(b)>1&&(Math.abs(b+T)===1?b+=T:Math.abs(b-T)===1&&(b-=T)),m.dem&&d.dem&&(d.dem.backfillBorder(m.dem,b,k),d.neighboringTiles&&d.neighboringTiles[P]&&(d.neighboringTiles[P].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,o,h,d){for(const m in this._tiles){let b=this._tiles[m];if(d[m]||!b.hasData()||b.tileID.overscaledZ<=o||b.tileID.overscaledZ>h)continue;let k=b.tileID;for(;b&&b.tileID.overscaledZ>o+1;){const P=b.tileID.scaledTo(b.tileID.overscaledZ-1);b=this._tiles[P.key],b&&b.hasData()&&(k=P)}let T=k;for(;T.overscaledZ>o;)if(T=T.scaledTo(T.overscaledZ-1),r[T.key]){d[k.key]=k;break}}}findLoadedParent(r,o){if(r.key in this._loadedParentTiles){const h=this._loadedParentTiles[r.key];return h&&h.tileID.overscaledZ>=o?h:null}for(let h=r.overscaledZ-1;h>=o;h--){const d=r.scaledTo(h),m=this._getLoadedTile(d);if(m)return m}}findLoadedSibling(r){return this._getLoadedTile(r)}_getLoadedTile(r){const o=this._tiles[r.key];return o&&o.hasData()?o:this._cache.getByKey(r.wrapped().key)}updateCacheSize(r){const o=Math.ceil(r.width/this._source.tileSize)+1,h=Math.ceil(r.height/this._source.tileSize)+1,d=Math.floor(o*h*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(m)}handleWrapJump(r){const o=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,o){const h={};for(const d in this._tiles){const m=this._tiles[d];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+o),h[m.tileID.key]=m}this._tiles=h;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(d,this._tiles[d])}}_updateCoveredAndRetainedTiles(r,o,h,d,m,b){const k={},T={},P=Object.keys(r),D=z.now();for(const L of P){const U=r[L],Z=this._tiles[L];if(!Z||Z.fadeEndTime!==0&&Z.fadeEndTime<=D)continue;const H=this.findLoadedParent(U,o),ee=this.findLoadedSibling(U),ie=H||ee||null;ie&&(this._addTile(ie.tileID),k[ie.tileID.key]=ie.tileID),T[L]=U}this._retainLoadedChildren(T,d,h,r);for(const L in k)r[L]||(this._coveredTiles[L]=!0,r[L]=k[L]);if(b){const L={},U={};for(const Z of m)this._tiles[Z.key].hasData()?L[Z.key]=Z:U[Z.key]=Z;for(const Z in U){const H=U[Z].children(this._source.maxzoom);this._tiles[H[0].key]&&this._tiles[H[1].key]&&this._tiles[H[2].key]&&this._tiles[H[3].key]&&(L[H[0].key]=r[H[0].key]=H[0],L[H[1].key]=r[H[1].key]=H[1],L[H[2].key]=r[H[2].key]=H[2],L[H[3].key]=r[H[3].key]=H[3],delete U[Z])}for(const Z in U){const H=U[Z],ee=this.findLoadedParent(H,this._source.minzoom),ie=this.findLoadedSibling(H),se=ee||ie||null;if(se){L[se.tileID.key]=r[se.tileID.key]=se.tileID;for(const le in L)L[le].isChildOf(se.tileID)&&delete L[le]}}for(const Z in this._tiles)L[Z]||(this._coveredTiles[Z]=!0)}}update(r,o){if(!this._sourceLoaded||this._paused)return;let h;this.transform=r,this.terrain=o,this.updateCacheSize(r),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(D=>new c.S(D.canonical.z,D.wrap,D.canonical.z,D.canonical.x,D.canonical.y)):(h=r.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o}),this._source.hasTile&&(h=h.filter(D=>this._source.hasTile(D)))):h=[];const d=r.coveringZoomLevel(this._source),m=Math.max(d-_t.maxOverzooming,this._source.minzoom),b=Math.max(d+_t.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const D={};for(const L of h)if(L.canonical.z>this._source.minzoom){const U=L.scaledTo(L.canonical.z-1);D[U.key]=U;const Z=L.scaledTo(Math.max(this._source.minzoom,Math.min(L.canonical.z,5)));D[Z.key]=Z}h=h.concat(Object.values(D))}const k=h.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,k&&this.fire(new c.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const T=this._updateRetainedTiles(h,d);wi(this._source.type)&&this._updateCoveredAndRetainedTiles(T,m,b,d,h,o);for(const D in T)this._tiles[D].clearFadeHold();const P=c.ab(this._tiles,T);for(const D of P){const L=this._tiles[D];L.hasSymbolBuckets&&!L.holdingForFade()?L.setHoldDuration(this.map._fadeDuration):L.hasSymbolBuckets&&!L.symbolFadeFinished()||this._removeTile(D)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(r)}_updateRetainedTiles(r,o){var h;const d={},m={},b=Math.max(o-_t.maxOverzooming,this._source.minzoom),k=Math.max(o+_t.maxUnderzooming,this._source.minzoom),T={};for(const P of r){const D=this._addTile(P);d[P.key]=P,D.hasData()||o<this._source.maxzoom&&(T[P.key]=P)}this._retainLoadedChildren(T,o,k,d);for(const P of r){let D=this._tiles[P.key];if(D.hasData())continue;if(o+1>this._source.maxzoom){const U=P.children(this._source.maxzoom)[0],Z=this.getTile(U);if(Z&&Z.hasData()){d[U.key]=U;continue}}else{const U=P.children(this._source.maxzoom);if(d[U[0].key]&&d[U[1].key]&&d[U[2].key]&&d[U[3].key])continue}let L=D.wasRequested();for(let U=P.overscaledZ-1;U>=b;--U){const Z=P.scaledTo(U);if(m[Z.key])break;if(m[Z.key]=!0,D=this.getTile(Z),!D&&L&&(D=this._addTile(Z)),D){const H=D.hasData();if((H||!(!((h=this.map)===null||h===void 0)&&h.cancelPendingTileRequestsWhileZooming)||L)&&(d[Z.key]=Z),L=D.wasRequested(),H)break}}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const o=[];let h,d=this._tiles[r].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){h=this._loadedParentTiles[d.key];break}o.push(d.key);const m=d.scaledTo(d.overscaledZ-1);if(h=this._getLoadedTile(m),h)break;d=m}for(const m of o)this._loadedParentTiles[m]=h}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const r in this._tiles){const o=this._tiles[r].tileID,h=this._getLoadedTile(o);this._loadedSiblingTiles[o.key]=h}}_addTile(r){let o=this._tiles[r.key];if(o)return o;o=this._cache.getAndRemove(r),o&&(this._setTileReloadTimer(r.key,o),o.tileID=r,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,o)));const h=o;return o||(o=new Is(r,this._source.tileSize*r.overscaleFactor()),this._loadTile(o,r.key,o.state)),o.uses++,this._tiles[r.key]=o,h||this._source.fire(new c.k("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(r,o){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const h=o.getExpiryTimeout();h&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},h))}_removeTile(r){const o=this._tiles[r];o&&(o.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}_dataHandler(r){const o=r.sourceDataType;r.dataType==="source"&&o==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&r.dataType==="source"&&o==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(r);this._cache.reset()}tilesIn(r,o,h){const d=[],m=this.transform;if(!m)return d;const b=h?m.getCameraQueryGeometry(r):r,k=r.map(H=>m.pointCoordinate(H,this.terrain)),T=b.map(H=>m.pointCoordinate(H,this.terrain)),P=this.getIds();let D=1/0,L=1/0,U=-1/0,Z=-1/0;for(const H of T)D=Math.min(D,H.x),L=Math.min(L,H.y),U=Math.max(U,H.x),Z=Math.max(Z,H.y);for(let H=0;H<P.length;H++){const ee=this._tiles[P[H]];if(ee.holdingForFade())continue;const ie=ee.tileID,se=Math.pow(2,m.zoom-ee.tileID.overscaledZ),le=o*ee.queryPadding*c.X/ee.tileSize/se,K=[ie.getTilePoint(new c.Z(D,L)),ie.getTilePoint(new c.Z(U,Z))];if(K[0].x-le<c.X&&K[0].y-le<c.X&&K[1].x+le>=0&&K[1].y+le>=0){const de=k.map(we=>ie.getTilePoint(we)),ye=T.map(we=>ie.getTilePoint(we));d.push({tile:ee,tileID:ie,queryGeometry:de,cameraQueryGeometry:ye,scale:se})}}return d}getVisibleCoordinates(r){const o=this.getRenderableIds(r).map(h=>this._tiles[h].tileID);for(const h of o)h.posMatrix=this.transform.calculatePosMatrix(h.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if(wi(this._source.type)){const r=z.now();for(const o in this._tiles)if(this._tiles[o].fadeEndTime>=r)return!0}return!1}setFeatureState(r,o,h){this._state.updateState(r=r||"_geojsonTileLayer",o,h)}removeFeatureState(r,o,h){this._state.removeFeatureState(r=r||"_geojsonTileLayer",o,h)}getFeatureState(r,o){return this._state.getState(r=r||"_geojsonTileLayer",o)}setDependencies(r,o,h){const d=this._tiles[r];d&&d.setDependencies(o,h)}reloadTilesForDependencies(r,o){for(const h in this._tiles)this._tiles[h].hasDependency(r,o)&&this._reloadTile(h,"reloading");this._cache.filter(h=>!h.hasDependency(r,o))}}function En(g,r){const o=Math.abs(2*g.wrap)-+(g.wrap<0),h=Math.abs(2*r.wrap)-+(r.wrap<0);return g.overscaledZ-r.overscaledZ||h-o||r.canonical.y-g.canonical.y||r.canonical.x-g.canonical.x}function wi(g){return g==="raster"||g==="image"||g==="video"}_t.maxOverzooming=10,_t.maxUnderzooming=3;class St{constructor(r,o){this.reset(r,o)}reset(r,o){this.points=r||[],this._distances=[0];for(let h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=c.ac(r,0,1);let o=1,h=this._distances[o];const d=r*this.paddedLength+this.padding;for(;h<d&&o<this._distances.length;)h=this._distances[++o];const m=o-1,b=this._distances[m],k=h-b,T=k>0?(d-b)/k:0;return this.points[m].mult(1-T).add(this.points[o].mult(T))}}function qi(g,r){let o=!0;return g==="always"||g!=="never"&&r!=="never"||(o=!1),o}class ls{constructor(r,o,h){const d=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(r/h),this.yCellCount=Math.ceil(o/h);for(let b=0;b<this.xCellCount*this.yCellCount;b++)d.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=o,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,o,h,d,m){this._forEachCell(o,h,d,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(o),this.bboxes.push(h),this.bboxes.push(d),this.bboxes.push(m)}insertCircle(r,o,h,d){this._forEachCell(o-d,h-d,o+d,h+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(o),this.circles.push(h),this.circles.push(d)}_insertBoxCell(r,o,h,d,m,b){this.boxCells[m].push(b)}_insertCircleCell(r,o,h,d,m,b){this.circleCells[m].push(b)}_query(r,o,h,d,m,b,k){if(h<0||r>this.width||d<0||o>this.height)return[];const T=[];if(r<=0&&o<=0&&this.width<=h&&this.height<=d){if(m)return[{key:null,x1:r,y1:o,x2:h,y2:d}];for(let P=0;P<this.boxKeys.length;P++)T.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(let P=0;P<this.circleKeys.length;P++){const D=this.circles[3*P],L=this.circles[3*P+1],U=this.circles[3*P+2];T.push({key:this.circleKeys[P],x1:D-U,y1:L-U,x2:D+U,y2:L+U})}}else this._forEachCell(r,o,h,d,this._queryCell,T,{hitTest:m,overlapMode:b,seenUids:{box:{},circle:{}}},k);return T}query(r,o,h,d){return this._query(r,o,h,d,!1,null)}hitTest(r,o,h,d,m,b){return this._query(r,o,h,d,!0,m,b).length>0}hitTestCircle(r,o,h,d,m){const b=r-h,k=r+h,T=o-h,P=o+h;if(k<0||b>this.width||P<0||T>this.height)return!1;const D=[];return this._forEachCell(b,T,k,P,this._queryCellCircle,D,{hitTest:!0,overlapMode:d,circle:{x:r,y:o,radius:h},seenUids:{box:{},circle:{}}},m),D.length>0}_queryCell(r,o,h,d,m,b,k,T){const{seenUids:P,hitTest:D,overlapMode:L}=k,U=this.boxCells[m];if(U!==null){const H=this.bboxes;for(const ee of U)if(!P.box[ee]){P.box[ee]=!0;const ie=4*ee,se=this.boxKeys[ee];if(r<=H[ie+2]&&o<=H[ie+3]&&h>=H[ie+0]&&d>=H[ie+1]&&(!T||T(se))&&(!D||!qi(L,se.overlapMode))&&(b.push({key:se,x1:H[ie],y1:H[ie+1],x2:H[ie+2],y2:H[ie+3]}),D))return!0}}const Z=this.circleCells[m];if(Z!==null){const H=this.circles;for(const ee of Z)if(!P.circle[ee]){P.circle[ee]=!0;const ie=3*ee,se=this.circleKeys[ee];if(this._circleAndRectCollide(H[ie],H[ie+1],H[ie+2],r,o,h,d)&&(!T||T(se))&&(!D||!qi(L,se.overlapMode))){const le=H[ie],K=H[ie+1],de=H[ie+2];if(b.push({key:se,x1:le-de,y1:K-de,x2:le+de,y2:K+de}),D)return!0}}}return!1}_queryCellCircle(r,o,h,d,m,b,k,T){const{circle:P,seenUids:D,overlapMode:L}=k,U=this.boxCells[m];if(U!==null){const H=this.bboxes;for(const ee of U)if(!D.box[ee]){D.box[ee]=!0;const ie=4*ee,se=this.boxKeys[ee];if(this._circleAndRectCollide(P.x,P.y,P.radius,H[ie+0],H[ie+1],H[ie+2],H[ie+3])&&(!T||T(se))&&!qi(L,se.overlapMode))return b.push(!0),!0}}const Z=this.circleCells[m];if(Z!==null){const H=this.circles;for(const ee of Z)if(!D.circle[ee]){D.circle[ee]=!0;const ie=3*ee,se=this.circleKeys[ee];if(this._circlesCollide(H[ie],H[ie+1],H[ie+2],P.x,P.y,P.radius)&&(!T||T(se))&&!qi(L,se.overlapMode))return b.push(!0),!0}}}_forEachCell(r,o,h,d,m,b,k,T){const P=this._convertToXCellCoord(r),D=this._convertToYCellCoord(o),L=this._convertToXCellCoord(h),U=this._convertToYCellCoord(d);for(let Z=P;Z<=L;Z++)for(let H=D;H<=U;H++)if(m.call(this,r,o,h,d,this.xCellCount*H+Z,b,k,T))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,o,h,d,m,b){const k=d-r,T=m-o,P=h+b;return P*P>k*k+T*T}_circleAndRectCollide(r,o,h,d,m,b,k){const T=(b-d)/2,P=Math.abs(r-(d+T));if(P>T+h)return!1;const D=(k-m)/2,L=Math.abs(o-(m+D));if(L>D+h)return!1;if(P<=T||L<=D)return!0;const U=P-T,Z=L-D;return U*U+Z*Z<=h*h}}function Es(g,r,o,h,d){const m=c.H();return r?(c.K(m,m,[1/d,1/d,1]),o||c.ad(m,m,h.angle)):c.L(m,h.labelPlaneMatrix,g),m}function Zi(g,r,o,h,d){if(r){const m=c.ae(g);return c.K(m,m,[d,d,1]),o||c.ad(m,m,-h.angle),m}return h.glCoordMatrix}function re(g,r,o,h){let d;h?(d=[g,r,h(g,r),1],c.af(d,d,o)):(d=[g,r,0,1],Bt(d,d,o));const m=d[3];return{point:new c.P(d[0]/m,d[1]/m),signedDistanceFromCamera:m,isOccluded:!1}}function N(g,r){return .5+g/r*.5}function O(g,r){return g.x>=-r[0]&&g.x<=r[0]&&g.y>=-r[1]&&g.y<=r[1]}function q(g,r,o,h,d,m,b,k,T,P,D,L,U,Z,H){const ee=h?g.textSizeData:g.iconSizeData,ie=c.ag(ee,o.transform.zoom),se=[256/o.width*2+1,256/o.height*2+1],le=h?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;le.clear();const K=g.lineVertexArray,de=h?g.text.placedSymbolArray:g.icon.placedSymbolArray,ye=o.transform.width/o.transform.height;let we=!1;for(let Ee=0;Ee<de.length;Ee++){const Re=de.get(Ee);if(Re.hidden||Re.writingMode===c.ah.vertical&&!we){pt(Re.numGlyphs,le);continue}we=!1;const Ze=re(Re.anchorX,Re.anchorY,r,H);if(!O(Ze.point,se)){pt(Re.numGlyphs,le);continue}const Xe=N(o.transform.cameraToCenterDistance,Ze.signedDistanceFromCamera),Ue=c.ai(ee,ie,Re),je=b?Ue/Xe:Ue*Xe,rt={getElevation:H,labelPlaneMatrix:d,lineVertexArray:K,pitchWithMap:b,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:P,tileAnchorPoint:new c.P(Re.anchorX,Re.anchorY),unwrappedTileID:D,width:L,height:U,translation:Z},wt=fe(rt,Re,je,!1,k,r,m,g.glyphOffsetArray,le,ye,T);we=wt.useVertical,(wt.notEnoughRoom||we||wt.needsFlipping&&fe(rt,Re,je,!0,k,r,m,g.glyphOffsetArray,le,ye,T).notEnoughRoom)&&pt(Re.numGlyphs,le)}h?g.text.dynamicLayoutVertexBuffer.updateData(le):g.icon.dynamicLayoutVertexBuffer.updateData(le)}function J(g,r,o,h,d,m,b,k){const T=m.glyphStartIndex+m.numGlyphs,P=m.lineStartIndex,D=m.lineStartIndex+m.lineLength,L=r.getoffsetX(m.glyphStartIndex),U=r.getoffsetX(T-1),Z=Be(g*L,o,h,d,m.segment,P,D,k,b);if(!Z)return null;const H=Be(g*U,o,h,d,m.segment,P,D,k,b);return H?k.projectionCache.anyProjectionOccluded?null:{first:Z,last:H}:null}function ce(g,r,o,h){return g===c.ah.horizontal&&Math.abs(o.y-r.y)>Math.abs(o.x-r.x)*h?{useVertical:!0}:(g===c.ah.vertical?r.y<o.y:r.x>o.x)?{needsFlipping:!0}:null}function fe(g,r,o,h,d,m,b,k,T,P,D){const L=o/24,U=r.lineOffsetX*L,Z=r.lineOffsetY*L;let H;if(r.numGlyphs>1){const ee=r.glyphStartIndex+r.numGlyphs,ie=r.lineStartIndex,se=r.lineStartIndex+r.lineLength,le=J(L,k,U,Z,h,r,D,g);if(!le)return{notEnoughRoom:!0};const K=re(le.first.point.x,le.first.point.y,b,g.getElevation).point,de=re(le.last.point.x,le.last.point.y,b,g.getElevation).point;if(d&&!h){const ye=ce(r.writingMode,K,de,P);if(ye)return ye}H=[le.first];for(let ye=r.glyphStartIndex+1;ye<ee-1;ye++)H.push(Be(L*k.getoffsetX(ye),U,Z,h,r.segment,ie,se,g,D));H.push(le.last)}else{if(d&&!h){const ie=re(g.tileAnchorPoint.x,g.tileAnchorPoint.y,m,g.getElevation).point,se=r.lineStartIndex+r.segment+1,le=new c.P(g.lineVertexArray.getx(se),g.lineVertexArray.gety(se)),K=re(le.x,le.y,m,g.getElevation),de=K.signedDistanceFromCamera>0?K.point:function(we,Ee,Re,Ze,Xe,Ue){return ve(we,Ee,Re,1,Xe,Ue)}(g.tileAnchorPoint,le,ie,0,m,g),ye=ce(r.writingMode,ie,de,P);if(ye)return ye}const ee=Be(L*k.getoffsetX(r.glyphStartIndex),U,Z,h,r.segment,r.lineStartIndex,r.lineStartIndex+r.lineLength,g,D);if(!ee||g.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};H=[ee]}for(const ee of H)c.aj(T,ee.point,ee.angle);return{}}function ve(g,r,o,h,d,m){const b=g.add(g.sub(r)._unit()),k=d!==void 0?re(b.x,b.y,d,m.getElevation).point:Ce(b.x,b.y,m).point,T=o.sub(k);return o.add(T._mult(h/T.mag()))}function ae(g,r,o){const h=r.projectionCache;if(h.projections[g])return h.projections[g];const d=new c.P(r.lineVertexArray.getx(g),r.lineVertexArray.gety(g)),m=Ce(d.x,d.y,r);if(m.signedDistanceFromCamera>0)return h.projections[g]=m.point,h.anyProjectionOccluded=h.anyProjectionOccluded||m.isOccluded,m.point;const b=g-o.direction;return function(k,T,P,D,L){return ve(k,T,P,D,void 0,L)}(o.distanceFromAnchor===0?r.tileAnchorPoint:new c.P(r.lineVertexArray.getx(b),r.lineVertexArray.gety(b)),d,o.previousVertex,o.absOffsetX-o.distanceFromAnchor+1,r)}function Ce(g,r,o){const h=g+o.translation[0],d=r+o.translation[1];let m;return!o.pitchWithMap&&o.projection.useSpecialProjectionForSymbols?(m=o.projection.projectTileCoordinates(h,d,o.unwrappedTileID,o.getElevation),m.point.x=(.5*m.point.x+.5)*o.width,m.point.y=(.5*-m.point.y+.5)*o.height):(m=re(h,d,o.labelPlaneMatrix,o.getElevation),m.isOccluded=!1),m}function Ae(g,r,o){return g._unit()._perp()._mult(r*o)}function ke(g,r,o,h,d,m,b,k,T){if(k.projectionCache.offsets[g])return k.projectionCache.offsets[g];const P=o.add(r);if(g+T.direction<h||g+T.direction>=d)return k.projectionCache.offsets[g]=P,P;const D=ae(g+T.direction,k,T),L=Ae(D.sub(o),b,T.direction),U=o.add(L),Z=D.add(L);return k.projectionCache.offsets[g]=c.ak(m,P,U,Z)||P,k.projectionCache.offsets[g]}function Be(g,r,o,h,d,m,b,k,T){const P=h?g-r:g+r;let D=P>0?1:-1,L=0;h&&(D*=-1,L=Math.PI),D<0&&(L+=Math.PI);let U,Z=D>0?m+d:m+d+1;k.projectionCache.cachedAnchorPoint?U=k.projectionCache.cachedAnchorPoint:(U=Ce(k.tileAnchorPoint.x,k.tileAnchorPoint.y,k).point,k.projectionCache.cachedAnchorPoint=U);let H,ee,ie=U,se=U,le=0,K=0;const de=Math.abs(P),ye=[];let we;for(;le+K<=de;){if(Z+=D,Z<m||Z>=b)return null;le+=K,se=ie,ee=H;const Ze={absOffsetX:de,direction:D,distanceFromAnchor:le,previousVertex:se};if(ie=ae(Z,k,Ze),o===0)ye.push(se),we=ie.sub(se);else{let Xe;const Ue=ie.sub(se);Xe=Ue.mag()===0?Ae(ae(Z+D,k,Ze).sub(ie),o,D):Ae(Ue,o,D),ee||(ee=se.add(Xe)),H=ke(Z,Xe,ie,m,b,ee,o,k,Ze),ye.push(ee),we=H.sub(ee)}K=we.mag()}const Ee=we._mult((de-le)/K)._add(ee||se),Re=L+Math.atan2(ie.y-se.y,ie.x-se.x);return ye.push(Ee),{point:Ee,angle:T?Re:0,path:ye}}const lt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function pt(g,r){for(let o=0;o<g;o++){const h=r.length;r.resize(h+4),r.float32.set(lt,3*h)}}function Bt(g,r,o){const h=r[0],d=r[1];return g[0]=o[0]*h+o[4]*d+o[12],g[1]=o[1]*h+o[5]*d+o[13],g[3]=o[3]*h+o[7]*d+o[15],g}const kt=100;class jt{constructor(r,o,h=new ls(r.width+200,r.height+200,25),d=new ls(r.width+200,r.height+200,25)){this.transform=r,this.mapProjection=o,this.grid=h,this.ignoredGrid=d,this.pitchFactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+kt,this.screenBottomBoundary=r.height+kt,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(r,o,h,d,m,b,k,T,P,D,L){const U=r.anchorPointX+T[0],Z=r.anchorPointY+T[1],H=this.projectAndGetPerspectiveRatio(d,U,Z,m,D),ee=h*H.perspectiveRatio;let ie;if(b||k)ie=this._projectCollisionBox(r,ee,d,m,b,k,T,H,D,L);else{const ye=H.point.x+(L?L.x*ee:0),we=H.point.y+(L?L.y*ee:0);ie={allPointsOccluded:!1,box:[ye+r.x1*ee,we+r.y1*ee,ye+r.x2*ee,we+r.y2*ee]}}const[se,le,K,de]=ie.box;return this.mapProjection.useSpecialProjectionForSymbols&&(b?ie.allPointsOccluded:this.mapProjection.isOccluded(U,Z,m))||H.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(se,le,K,de)||o!=="always"&&this.grid.hitTest(se,le,K,de,o,P)?{box:[se,le,K,de],placeable:!1,offscreen:!1}:{box:[se,le,K,de],placeable:!0,offscreen:this.isOffscreen(se,le,K,de)}}placeCollisionCircles(r,o,h,d,m,b,k,T,P,D,L,U,Z,H,ee,ie){const se=[],le=new c.P(o.anchorX,o.anchorY),K=this.getPerspectiveRatio(b,le.x,le.y,k,ie),de=(L?m/K:m*K)/c.ap,ye={getElevation:ie,labelPlaneMatrix:T,lineVertexArray:h,pitchWithMap:L,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:le,unwrappedTileID:k,width:this.transform.width,height:this.transform.height,translation:ee},we=J(de,d,o.lineOffsetX*de,o.lineOffsetY*de,!1,o,!1,ye);let Ee=!1,Re=!1,Ze=!0;if(we){const Xe=.5*Z*K+H,Ue=new c.P(-100,-100),je=new c.P(this.screenRightBoundary,this.screenBottomBoundary),rt=new St,wt=we.first,$e=we.last;let Ge=[];for(let Ct=wt.path.length-1;Ct>=1;Ct--)Ge.push(wt.path[Ct]);for(let Ct=1;Ct<$e.path.length;Ct++)Ge.push($e.path[Ct]);const vt=2.5*Xe;if(P){const Ct=this.projectPathToScreenSpace(Ge,ye,P);Ge=Ct.some(zt=>zt.signedDistanceFromCamera<=0)?[]:Ct.map(zt=>zt.point)}let cr=[];if(Ge.length>0){const Ct=Ge[0].clone(),zt=Ge[0].clone();for(let hr=1;hr<Ge.length;hr++)Ct.x=Math.min(Ct.x,Ge[hr].x),Ct.y=Math.min(Ct.y,Ge[hr].y),zt.x=Math.max(zt.x,Ge[hr].x),zt.y=Math.max(zt.y,Ge[hr].y);cr=Ct.x>=Ue.x&&zt.x<=je.x&&Ct.y>=Ue.y&&zt.y<=je.y?[Ge]:zt.x<Ue.x||Ct.x>je.x||zt.y<Ue.y||Ct.y>je.y?[]:c.al([Ge],Ue.x,Ue.y,je.x,je.y)}for(const Ct of cr){rt.reset(Ct,.25*Xe);let zt=0;zt=rt.length<=.5*Xe?1:Math.ceil(rt.paddedLength/vt)+1;for(let hr=0;hr<zt;hr++){const sn=hr/Math.max(zt-1,1),Mi=rt.lerp(sn),dr=Mi.x+kt,zn=Mi.y+kt;se.push(dr,zn,Xe,0);const wn=dr-Xe,an=zn-Xe,bn=dr+Xe,Xi=zn+Xe;if(Ze=Ze&&this.isOffscreen(wn,an,bn,Xi),Re=Re||this.isInsideGrid(wn,an,bn,Xi),r!=="always"&&this.grid.hitTestCircle(dr,zn,Xe,r,U)&&(Ee=!0,!D))return{circles:[],offscreen:!1,collisionDetected:Ee}}}}return{circles:!D&&Ee||!Re||K<this.perspectiveRatioCutoff?[]:se,offscreen:Ze,collisionDetected:Ee}}projectPathToScreenSpace(r,o,h){return r.map(d=>re(d.x,d.y,h,o.getElevation))}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[];let h=1/0,d=1/0,m=-1/0,b=-1/0;for(const D of r){const L=new c.P(D.x+kt,D.y+kt);h=Math.min(h,L.x),d=Math.min(d,L.y),m=Math.max(m,L.x),b=Math.max(b,L.y),o.push(L)}const k=this.grid.query(h,d,m,b).concat(this.ignoredGrid.query(h,d,m,b)),T={},P={};for(const D of k){const L=D.key;if(T[L.bucketInstanceId]===void 0&&(T[L.bucketInstanceId]={}),T[L.bucketInstanceId][L.featureIndex])continue;const U=[new c.P(D.x1,D.y1),new c.P(D.x2,D.y1),new c.P(D.x2,D.y2),new c.P(D.x1,D.y2)];c.am(o,U)&&(T[L.bucketInstanceId][L.featureIndex]=!0,P[L.bucketInstanceId]===void 0&&(P[L.bucketInstanceId]=[]),P[L.bucketInstanceId].push(L.featureIndex))}return P}insertCollisionBox(r,o,h,d,m,b){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:m,collisionGroupID:b,overlapMode:o},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,o,h,d,m,b){const k=h?this.ignoredGrid:this.grid,T={bucketInstanceId:d,featureIndex:m,collisionGroupID:b,overlapMode:o};for(let P=0;P<r.length;P+=4)k.insertCircle(T,r[P],r[P+1],r[P+2])}projectAndGetPerspectiveRatio(r,o,h,d,m){let b;m?(b=[o,h,m(o,h),1],c.af(b,b,r)):(b=[o,h,0,1],Bt(b,b,r));const k=b[3];return{point:new c.P((b[0]/k+1)/2*this.transform.width+kt,(-b[1]/k+1)/2*this.transform.height+kt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/k*.5,isOccluded:!1,signedDistanceFromCamera:k}}getPerspectiveRatio(r,o,h,d,m){const b=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(o,h,d,m):re(o,h,r,m);return .5+this.transform.cameraToCenterDistance/b.signedDistanceFromCamera*.5}isOffscreen(r,o,h,d){return h<kt||r>=this.screenRightBoundary||d<kt||o>this.screenBottomBoundary}isInsideGrid(r,o,h,d){return h>=0&&r<this.gridRightBoundary&&d>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const r=c.an([]);return c.J(r,r,[-100,-100,0]),r}_projectCollisionBox(r,o,h,d,m,b,k,T,P,D){let L=new c.P(1,0),U=new c.P(0,1);const Z=new c.P(r.anchorPointX+k[0],r.anchorPointY+k[1]);if(b&&!m){const Ze=this.projectAndGetPerspectiveRatio(h,Z.x+1,Z.y,d,P).point.sub(T.point).unit(),Xe=Math.atan(Ze.y/Ze.x)+(Ze.x<0?Math.PI:0),Ue=Math.sin(Xe),je=Math.cos(Xe);L=new c.P(je,Ue),U=new c.P(-Ue,je)}else if(!b&&m){const Ze=-this.transform.angle,Xe=Math.sin(Ze),Ue=Math.cos(Ze);L=new c.P(Ue,Xe),U=new c.P(-Xe,Ue)}let H=T.point,ee=o;if(m){H=Z;const Ze=this.transform.zoom-Math.floor(this.transform.zoom);ee=Math.pow(2,-Ze),ee*=this.mapProjection.getPitchedTextCorrection(this.transform,Z,d),D||(ee*=c.ac(.5+T.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}D&&(H=H.add(L.mult(D.x*ee)).add(U.mult(D.y*ee)));const ie=r.x1*ee,se=r.x2*ee,le=(ie+se)/2,K=r.y1*ee,de=r.y2*ee,ye=(K+de)/2,we=[{offsetX:ie,offsetY:K},{offsetX:le,offsetY:K},{offsetX:se,offsetY:K},{offsetX:se,offsetY:ye},{offsetX:se,offsetY:de},{offsetX:le,offsetY:de},{offsetX:ie,offsetY:de},{offsetX:ie,offsetY:ye}];let Ee=[];for(const{offsetX:Ze,offsetY:Xe}of we)Ee.push(new c.P(H.x+L.x*Ze+U.x*Xe,H.y+L.y*Ze+U.y*Xe));let Re=!1;if(m){const Ze=Ee.map(Xe=>this.projectAndGetPerspectiveRatio(h,Xe.x,Xe.y,d,P));Re=Ze.some(Xe=>!Xe.isOccluded),Ee=Ze.map(Xe=>Xe.point)}else Re=!0;return{box:c.ao(Ee),allPointsOccluded:!Re}}}function At(g,r,o){return r*(c.X/(g.tileSize*Math.pow(2,o-g.tileID.overscaledZ)))}class Rr{constructor(r,o,h,d){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?o:-o))):d&&h?1:0,this.placed=h}isHidden(){return this.opacity===0&&!this.placed}}class vr{constructor(r,o,h,d,m){this.text=new Rr(r?r.text:null,o,h,m),this.icon=new Rr(r?r.icon:null,o,d,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class It{constructor(r,o,h){this.text=r,this.icon=o,this.skipFade=h}}class Qt{constructor(){this.invProjMatrix=c.H(),this.viewportMatrix=c.H(),this.circles=[]}}class mr{constructor(r,o,h,d,m){this.bucketInstanceId=r,this.featureIndex=o,this.sourceLayerIndex=h,this.bucketIndex=d,this.tileID=m}}class $r{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const o=++this.maxGroupID;this.collisionGroups[r]={ID:o,predicate:h=>h.collisionGroupID===o}}return this.collisionGroups[r]}}function Xr(g,r,o,h,d){const{horizontalAlign:m,verticalAlign:b}=c.au(g);return new c.P(-(m-.5)*r+h[0]*d,-(b-.5)*o+h[1]*d)}class xn{constructor(r,o,h,d,m,b){this.transform=r.clone(),this.terrain=h,this.collisionIndex=new jt(this.transform,o),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new $r(m),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(r){const o=this.terrain;return o?(h,d)=>o.getElevation(r,h,d):null}getBucketParts(r,o,h,d){const m=h.getBucket(o),b=h.latestFeatureIndex;if(!m||!b||o.id!==m.layerIds[0])return;const k=h.collisionBoxArray,T=m.layers[0].layout,P=m.layers[0].paint,D=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),L=h.tileSize/c.X,U=h.tileID.toUnwrapped(),Z=this.transform.calculatePosMatrix(U),H=T.get("text-pitch-alignment")==="map",ee=T.get("text-rotation-alignment")==="map",ie=At(h,1,this.transform.zoom),se=this.collisionIndex.mapProjection.translatePosition(this.transform,h,P.get("text-translate"),P.get("text-translate-anchor")),le=this.collisionIndex.mapProjection.translatePosition(this.transform,h,P.get("icon-translate"),P.get("icon-translate-anchor")),K=Es(Z,H,ee,this.transform,ie);let de=null;if(H){const we=Zi(Z,H,ee,this.transform,ie);de=c.L([],this.transform.labelPlaneMatrix,we)}this.retainedQueryData[m.bucketInstanceId]=new mr(m.bucketInstanceId,b,m.sourceLayerIndex,m.index,h.tileID);const ye={bucket:m,layout:T,translationText:se,translationIcon:le,posMatrix:Z,unwrappedTileID:U,textLabelPlaneMatrix:K,labelToScreenMatrix:de,scale:D,textPixelRatio:L,holdingForFade:h.holdingForFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:c.ag(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(d)for(const we of m.sortKeyRanges){const{sortKey:Ee,symbolInstanceStart:Re,symbolInstanceEnd:Ze}=we;r.push({sortKey:Ee,symbolInstanceStart:Re,symbolInstanceEnd:Ze,parameters:ye})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:ye})}attemptAnchorPlacement(r,o,h,d,m,b,k,T,P,D,L,U,Z,H,ee,ie,se,le,K){const de=c.aq[r.textAnchor],ye=[r.textOffset0,r.textOffset1],we=Xr(de,h,d,ye,m),Ee=this.collisionIndex.placeCollisionBox(o,U,T,P,D,k,b,ie,L.predicate,K,we);if((!le||this.collisionIndex.placeCollisionBox(le,U,T,P,D,k,b,se,L.predicate,K,we).placeable)&&Ee.placeable){let Re;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID].text&&(Re=this.prevPlacement.variableOffsets[Z.crossTileID].anchor),Z.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Z.crossTileID]={textOffset:ye,width:h,height:d,anchor:de,textBoxScale:m,prevAnchor:Re},this.markUsedJustification(H,de,Z,ee),H.allowVerticalPlacement&&(this.markUsedOrientation(H,ee,Z),this.placedOrientations[Z.crossTileID]=ee),{shift:we,placedGlyphBoxes:Ee}}}placeLayerBucketPart(r,o,h){const{bucket:d,layout:m,translationText:b,translationIcon:k,posMatrix:T,unwrappedTileID:P,textLabelPlaneMatrix:D,labelToScreenMatrix:L,textPixelRatio:U,holdingForFade:Z,collisionBoxArray:H,partiallyEvaluatedTextSize:ee,collisionGroup:ie}=r.parameters,se=m.get("text-optional"),le=m.get("icon-optional"),K=c.ar(m,"text-overlap","text-allow-overlap"),de=K==="always",ye=c.ar(m,"icon-overlap","icon-allow-overlap"),we=ye==="always",Ee=m.get("text-rotation-alignment")==="map",Re=m.get("text-pitch-alignment")==="map",Ze=m.get("icon-text-fit")!=="none",Xe=m.get("symbol-z-order")==="viewport-y",Ue=de&&(we||!d.hasIconData()||le),je=we&&(de||!d.hasTextData()||se);!d.collisionArrays&&H&&d.deserializeCollisionBoxes(H);const rt=this._getTerrainElevationFunc(this.retainedQueryData[d.bucketInstanceId].tileID),wt=($e,Ge,vt)=>{var cr,Ct;if(o[$e.crossTileID])return;if(Z)return void(this.placements[$e.crossTileID]=new It(!1,!1,!1));let zt=!1,hr=!1,sn=!0,Mi=null,dr={box:null,placeable:!1,offscreen:null},zn={placeable:!1},wn=null,an=null,bn=null,Xi=0,Qa=0,Fu=0;Ge.textFeatureIndex?Xi=Ge.textFeatureIndex:$e.useRuntimeCollisionCircles&&(Xi=$e.featureIndex),Ge.verticalTextFeatureIndex&&(Qa=Ge.verticalTextFeatureIndex);const Ja=Ge.textBox;if(Ja){const ci=Kr=>{let on=c.ah.horizontal;if(d.allowVerticalPlacement&&!Kr&&this.prevPlacement){const Kn=this.prevPlacement.placedOrientations[$e.crossTileID];Kn&&(this.placedOrientations[$e.crossTileID]=Kn,on=Kn,this.markUsedOrientation(d,on,$e))}return on},hi=(Kr,on)=>{if(d.allowVerticalPlacement&&$e.numVerticalGlyphVertices>0&&Ge.verticalTextBox){for(const Kn of d.writingModes)if(Kn===c.ah.vertical?(dr=on(),zn=dr):dr=Kr(),dr&&dr.placeable)break}else dr=Kr()},zs=$e.textAnchorOffsetStartIndex,Ii=$e.textAnchorOffsetEndIndex;if(Ii===zs){const Kr=(on,Kn)=>{const Ot=this.collisionIndex.placeCollisionBox(on,K,U,T,P,Re,Ee,b,ie.predicate,rt);return Ot&&Ot.placeable&&(this.markUsedOrientation(d,Kn,$e),this.placedOrientations[$e.crossTileID]=Kn),Ot};hi(()=>Kr(Ja,c.ah.horizontal),()=>{const on=Ge.verticalTextBox;return d.allowVerticalPlacement&&$e.numVerticalGlyphVertices>0&&on?Kr(on,c.ah.vertical):{box:null,offscreen:null}}),ci(dr&&dr.placeable)}else{let Kr=c.aq[(Ct=(cr=this.prevPlacement)===null||cr===void 0?void 0:cr.variableOffsets[$e.crossTileID])===null||Ct===void 0?void 0:Ct.anchor];const on=(Ot,aa,eo)=>{const to=Ot.x2-Ot.x1,sp=Ot.y2-Ot.y1,Yg=$e.textBoxScale,ap=Ze&&ye==="never"?aa:null;let Ds=null,op=K==="never"?1:2,Nu="never";Kr&&op++;for(let dl=0;dl<op;dl++){for(let Bu=zs;Bu<Ii;Bu++){const ju=d.textAnchorOffsets.get(Bu);if(Kr&&ju.textAnchor!==Kr)continue;const ro=this.attemptAnchorPlacement(ju,Ot,to,sp,Yg,Ee,Re,U,T,P,ie,Nu,$e,d,eo,b,k,ap,rt);if(ro&&(Ds=ro.placedGlyphBoxes,Ds&&Ds.placeable))return zt=!0,Mi=ro.shift,Ds}Kr?Kr=null:Nu=K}return h&&!Ds&&(Ds={box:this.collisionIndex.placeCollisionBox(Ja,"always",U,T,P,Re,Ee,b,ie.predicate,rt,new c.P(0,0)).box,offscreen:!1,placeable:!1}),Ds};hi(()=>on(Ja,Ge.iconBox,c.ah.horizontal),()=>{const Ot=Ge.verticalTextBox;return d.allowVerticalPlacement&&(!dr||!dr.placeable)&&$e.numVerticalGlyphVertices>0&&Ot?on(Ot,Ge.verticalIconBox,c.ah.vertical):{box:null,occluded:!0,offscreen:null}}),dr&&(zt=dr.placeable,sn=dr.offscreen);const Kn=ci(dr&&dr.placeable);if(!zt&&this.prevPlacement){const Ot=this.prevPlacement.variableOffsets[$e.crossTileID];Ot&&(this.variableOffsets[$e.crossTileID]=Ot,this.markUsedJustification(d,Ot.anchor,$e,Kn))}}}if(wn=dr,zt=wn&&wn.placeable,sn=wn&&wn.offscreen,$e.useRuntimeCollisionCircles){const ci=d.text.placedSymbolArray.get($e.centerJustifiedTextSymbolIndex),hi=c.ai(d.textSizeData,ee,ci),zs=m.get("text-padding");an=this.collisionIndex.placeCollisionCircles(K,ci,d.lineVertexArray,d.glyphOffsetArray,hi,T,P,D,L,h,Re,ie.predicate,$e.collisionCircleDiameter,zs,b,rt),an.circles.length&&an.collisionDetected&&!h&&c.w("Collisions detected, but collision boxes are not shown"),zt=de||an.circles.length>0&&!an.collisionDetected,sn=sn&&an.offscreen}if(Ge.iconFeatureIndex&&(Fu=Ge.iconFeatureIndex),Ge.iconBox){const ci=hi=>this.collisionIndex.placeCollisionBox(hi,ye,U,T,P,Re,Ee,k,ie.predicate,rt,Ze&&Mi?Mi:void 0);zn&&zn.placeable&&Ge.verticalIconBox?(bn=ci(Ge.verticalIconBox),hr=bn.placeable):(bn=ci(Ge.iconBox),hr=bn.placeable),sn=sn&&bn.offscreen}const ui=se||$e.numHorizontalGlyphVertices===0&&$e.numVerticalGlyphVertices===0,Ou=le||$e.numIconVertices===0;ui||Ou?Ou?ui||(hr=hr&&zt):zt=hr&&zt:hr=zt=hr&&zt;const Uh=hr&&bn.placeable;if(zt&&wn.placeable&&this.collisionIndex.insertCollisionBox(wn.box,K,m.get("text-ignore-placement"),d.bucketInstanceId,zn&&zn.placeable&&Qa?Qa:Xi,ie.ID),Uh&&this.collisionIndex.insertCollisionBox(bn.box,ye,m.get("icon-ignore-placement"),d.bucketInstanceId,Fu,ie.ID),an&&zt&&this.collisionIndex.insertCollisionCircles(an.circles,K,m.get("text-ignore-placement"),d.bucketInstanceId,Xi,ie.ID),h&&this.storeCollisionData(d.bucketInstanceId,vt,Ge,wn,bn,an),$e.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[$e.crossTileID]=new It(zt||Ue,hr||je,sn||d.justReloaded),o[$e.crossTileID]=!0};if(Xe){if(r.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const $e=d.getSortedSymbolIndexes(this.transform.angle);for(let Ge=$e.length-1;Ge>=0;--Ge){const vt=$e[Ge];wt(d.symbolInstances.get(vt),d.collisionArrays[vt],vt)}}else for(let $e=r.symbolInstanceStart;$e<r.symbolInstanceEnd;$e++)wt(d.symbolInstances.get($e),d.collisionArrays[$e],$e);if(h&&d.bucketInstanceId in this.collisionCircleArrays){const $e=this.collisionCircleArrays[d.bucketInstanceId];c.as($e.invProjMatrix,T),$e.viewportMatrix=this.collisionIndex.getViewportMatrix()}d.justReloaded=!1}storeCollisionData(r,o,h,d,m,b){if(h.textBox||h.iconBox){let k,T;this.collisionBoxArrays.has(r)?k=this.collisionBoxArrays.get(r):(k=new Map,this.collisionBoxArrays.set(r,k)),k.has(o)?T=k.get(o):(T={text:null,icon:null},k.set(o,T)),h.textBox&&(T.text=d.box),h.iconBox&&(T.icon=m.box)}if(b){let k=this.collisionCircleArrays[r];k===void 0&&(k=this.collisionCircleArrays[r]=new Qt);for(let T=0;T<b.circles.length;T+=4)k.circles.push(b.circles[T+0]),k.circles.push(b.circles[T+1]),k.circles.push(b.circles[T+2]),k.circles.push(b.collisionDetected?1:0)}}markUsedJustification(r,o,h,d){let m;m=d===c.ah.vertical?h.verticalPlacedTextSymbolIndex:{left:h.leftJustifiedTextSymbolIndex,center:h.centerJustifiedTextSymbolIndex,right:h.rightJustifiedTextSymbolIndex}[c.at(o)];const b=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex,h.verticalPlacedTextSymbolIndex];for(const k of b)k>=0&&(r.text.placedSymbolArray.get(k).crossTileID=m>=0&&k!==m?0:h.crossTileID)}markUsedOrientation(r,o,h){const d=o===c.ah.horizontal||o===c.ah.horizontalOnly?o:0,m=o===c.ah.vertical?o:0,b=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex];for(const k of b)r.text.placedSymbolArray.get(k).placedOrientation=d;h.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(h.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let h=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const d=o?o.symbolFadeChange(r):1,m=o?o.opacities:{},b=o?o.variableOffsets:{},k=o?o.placedOrientations:{};for(const T in this.placements){const P=this.placements[T],D=m[T];D?(this.opacities[T]=new vr(D,d,P.text,P.icon),h=h||P.text!==D.text.placed||P.icon!==D.icon.placed):(this.opacities[T]=new vr(null,d,P.text,P.icon,P.skipFade),h=h||P.text||P.icon)}for(const T in m){const P=m[T];if(!this.opacities[T]){const D=new vr(P,d,!1,!1);D.isHidden()||(this.opacities[T]=D,h=h||P.text.placed||P.icon.placed)}}for(const T in b)this.variableOffsets[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.variableOffsets[T]=b[T]);for(const T in k)this.placedOrientations[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.placedOrientations[T]=k[T]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");h?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:r)}updateLayerOpacities(r,o){const h={};for(const d of o){const m=d.getBucket(r);m&&d.latestFeatureIndex&&r.id===m.layerIds[0]&&this.updateBucketOpacities(m,d.tileID,h,d.collisionBoxArray)}}updateBucketOpacities(r,o,h,d){r.hasTextData()&&(r.text.opacityVertexArray.clear(),r.text.hasVisibleVertices=!1),r.hasIconData()&&(r.icon.opacityVertexArray.clear(),r.icon.hasVisibleVertices=!1),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const m=r.layers[0],b=m.layout,k=new vr(null,0,!1,!1,!0),T=b.get("text-allow-overlap"),P=b.get("icon-allow-overlap"),D=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),L=b.get("text-rotation-alignment")==="map",U=b.get("text-pitch-alignment")==="map",Z=b.get("icon-text-fit")!=="none",H=new vr(null,0,T&&(P||!r.hasIconData()||b.get("icon-optional")),P&&(T||!r.hasTextData()||b.get("text-optional")),!0);!r.collisionArrays&&d&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(d);const ee=(se,le,K)=>{for(let de=0;de<le/4;de++)se.opacityVertexArray.emplaceBack(K);se.hasVisibleVertices=se.hasVisibleVertices||K!==za},ie=this.collisionBoxArrays.get(r.bucketInstanceId);for(let se=0;se<r.symbolInstances.length;se++){const le=r.symbolInstances.get(se),{numHorizontalGlyphVertices:K,numVerticalGlyphVertices:de,crossTileID:ye}=le;let we=this.opacities[ye];h[ye]?we=k:we||(we=H,this.opacities[ye]=we),h[ye]=!0;const Ee=le.numIconVertices>0,Re=this.placedOrientations[le.crossTileID],Ze=Re===c.ah.vertical,Xe=Re===c.ah.horizontal||Re===c.ah.horizontalOnly;if(K>0||de>0){const je=Gn(we.text);ee(r.text,K,Ze?za:je),ee(r.text,de,Xe?za:je);const rt=we.text.isHidden();[le.rightJustifiedTextSymbolIndex,le.centerJustifiedTextSymbolIndex,le.leftJustifiedTextSymbolIndex].forEach(Ge=>{Ge>=0&&(r.text.placedSymbolArray.get(Ge).hidden=rt||Ze?1:0)}),le.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(le.verticalPlacedTextSymbolIndex).hidden=rt||Xe?1:0);const wt=this.variableOffsets[le.crossTileID];wt&&this.markUsedJustification(r,wt.anchor,le,Re);const $e=this.placedOrientations[le.crossTileID];$e&&(this.markUsedJustification(r,"left",le,$e),this.markUsedOrientation(r,$e,le))}if(Ee){const je=Gn(we.icon),rt=!(Z&&le.verticalPlacedIconSymbolIndex&&Ze);le.placedIconSymbolIndex>=0&&(ee(r.icon,le.numIconVertices,rt?je:za),r.icon.placedSymbolArray.get(le.placedIconSymbolIndex).hidden=we.icon.isHidden()),le.verticalPlacedIconSymbolIndex>=0&&(ee(r.icon,le.numVerticalIconVertices,rt?za:je),r.icon.placedSymbolArray.get(le.verticalPlacedIconSymbolIndex).hidden=we.icon.isHidden())}const Ue=ie&&ie.has(se)?ie.get(se):{text:null,icon:null};if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const je=r.collisionArrays[se];if(je){let rt=new c.P(0,0);if(je.textBox||je.verticalTextBox){let wt=!0;if(D){const $e=this.variableOffsets[ye];$e?(rt=Xr($e.anchor,$e.width,$e.height,$e.textOffset,$e.textBoxScale),L&&rt._rotate(U?this.transform.angle:-this.transform.angle)):wt=!1}if(je.textBox||je.verticalTextBox){let $e;je.textBox&&($e=Ze),je.verticalTextBox&&($e=Xe),Aa(r.textCollisionBox.collisionVertexArray,we.text.placed,!wt||$e,Ue.text,rt.x,rt.y)}}if(je.iconBox||je.verticalIconBox){const wt=!!(!Xe&&je.verticalIconBox);let $e;je.iconBox&&($e=wt),je.verticalIconBox&&($e=!wt),Aa(r.iconCollisionBox.collisionVertexArray,we.icon.placed,$e,Ue.icon,Z?rt.x:0,Z?rt.y:0)}}}}if(r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.text.opacityVertexArray.length!==r.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${r.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${r.text.layoutVertexArray.length}) / 4`);if(r.icon.opacityVertexArray.length!==r.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${r.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${r.icon.layoutVertexArray.length}) / 4`);if(r.bucketInstanceId in this.collisionCircleArrays){const se=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=se.invProjMatrix,r.placementViewportMatrix=se.viewportMatrix,r.collisionCircleArray=se.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,o){const h=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*h>r}setStale(){this.stale=!0}}function Aa(g,r,o,h,d,m){h&&h.length!==0||(h=[0,0,0,0]);const b=h[0]-kt,k=h[1]-kt,T=h[2]-kt,P=h[3]-kt;g.emplaceBack(r?1:0,o?1:0,d||0,m||0,b,k),g.emplaceBack(r?1:0,o?1:0,d||0,m||0,T,k),g.emplaceBack(r?1:0,o?1:0,d||0,m||0,T,P),g.emplaceBack(r?1:0,o?1:0,d||0,m||0,b,P)}const Jt=Math.pow(2,25),Qc=Math.pow(2,24),Jc=Math.pow(2,17),Zn=Math.pow(2,16),Hn=Math.pow(2,9),Tg=Math.pow(2,8),si=Math.pow(2,1);function Gn(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const r=g.placed?1:0,o=Math.floor(127*g.opacity);return o*Jt+r*Qc+o*Jc+r*Zn+o*Hn+r*Tg+o*si+r}const za=0;function Ws(){return{isOccluded:(g,r,o)=>!1,getPitchedTextCorrection:(g,r,o)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(g,r,o,h){throw new Error("Not implemented.")},translatePosition:(g,r,o,h)=>function(d,m,b,k,T=!1){if(!b[0]&&!b[1])return[0,0];const P=T?k==="map"?d.angle:0:k==="viewport"?-d.angle:0;if(P){const D=Math.sin(P),L=Math.cos(P);b=[b[0]*L-b[1]*D,b[0]*D+b[1]*L]}return[T?b[0]:At(m,b[0],d.zoom),T?b[1]:At(m,b[1],d.zoom)]}(g,r,o,h),getCircleRadiusCorrection:g=>1}}class Fr{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&!r.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,o,h,d,m){const b=this._bucketParts;for(;this._currentTileIndex<r.length;)if(o.getBucketParts(b,d,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,b.sort((k,T)=>k.sortKey-T.sortKey));this._currentPartIndex<b.length;)if(o.placeLayerBucketPart(b[this._currentPartIndex],this._seenCrossTileIDs,h),this._currentPartIndex++,m())return!0;return!1}}class Go{constructor(r,o,h,d,m,b,k,T){this.placement=new xn(r,Ws(),o,b,k,T),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(r,o,h){const d=z.now(),m=()=>!this._forceFullPlacement&&z.now()-d>2;for(;this._currentPlacementIndex>=0;){const b=o[r[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(b.type==="symbol"&&(!b.minzoom||b.minzoom<=k)&&(!b.maxzoom||b.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new Fr(b)),this._inProgressLayer.continuePlacement(h[b.source],this.placement,this._showCollisionBoxes,b,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const bi=512/c.X/2;class Ir{constructor(r,o,h){this.tileID=r,this.bucketInstanceId=h,this._symbolsByKey={};const d=new Map;for(let m=0;m<o.length;m++){const b=o.get(m),k=b.key,T=d.get(k);T?T.push(b):d.set(k,[b])}for(const[m,b]of d){const k={positions:b.map(T=>({x:Math.floor(T.anchorX*bi),y:Math.floor(T.anchorY*bi)})),crossTileIDs:b.map(T=>T.crossTileID)};if(k.positions.length>128){const T=new c.av(k.positions.length,16,Uint16Array);for(const{x:P,y:D}of k.positions)T.add(P,D);T.finish(),delete k.positions,k.index=T}this._symbolsByKey[m]=k}}getScaledCoordinates(r,o){const{x:h,y:d,z:m}=this.tileID.canonical,{x:b,y:k,z:T}=o.canonical,P=bi/Math.pow(2,T-m),D=(k*c.X+r.anchorY)*P,L=d*c.X*bi;return{x:Math.floor((b*c.X+r.anchorX)*P-h*c.X*bi),y:Math.floor(D-L)}}findMatches(r,o,h){const d=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let m=0;m<r.length;m++){const b=r.get(m);if(b.crossTileID)continue;const k=this._symbolsByKey[b.key];if(!k)continue;const T=this.getScaledCoordinates(b,o);if(k.index){const P=k.index.range(T.x-d,T.y-d,T.x+d,T.y+d).sort();for(const D of P){const L=k.crossTileIDs[D];if(!h[L]){h[L]=!0,b.crossTileID=L;break}}}else if(k.positions)for(let P=0;P<k.positions.length;P++){const D=k.positions[P],L=k.crossTileIDs[P];if(Math.abs(D.x-T.x)<=d&&Math.abs(D.y-T.y)<=d&&!h[L]){h[L]=!0,b.crossTileID=L;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:r})=>r)}}class su{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Si{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const o=Math.round((r-this.lng)/360);if(o!==0)for(const h in this.indexes){const d=this.indexes[h],m={};for(const b in d){const k=d[b];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+o),m[k.tileID.key]=k}this.indexes[h]=m}this.lng=r}addBucket(r,o,h){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let m=0;m<o.symbolInstances.length;m++)o.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const d=this.usedCrossTileIDs[r.overscaledZ];for(const m in this.indexes){const b=this.indexes[m];if(Number(m)>r.overscaledZ)for(const k in b){const T=b[k];T.tileID.isChildOf(r)&&T.findMatches(o.symbolInstances,r,d)}else{const k=b[r.scaledTo(Number(m)).key];k&&k.findMatches(o.symbolInstances,r,d)}}for(let m=0;m<o.symbolInstances.length;m++){const b=o.symbolInstances.get(m);b.crossTileID||(b.crossTileID=h.generate(),d[b.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Ir(r,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(r,o){for(const h of o.getCrossTileIDsLists())for(const d of h)delete this.usedCrossTileIDs[r][d]}removeStaleBuckets(r){let o=!1;for(const h in this.indexes){const d=this.indexes[h];for(const m in d)r[d[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,d[m]),delete d[m],o=!0)}return o}}class eh{constructor(){this.layerIndexes={},this.crossTileIDs=new su,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,o,h){let d=this.layerIndexes[r.id];d===void 0&&(d=this.layerIndexes[r.id]=new Si);let m=!1;const b={};d.handleWrapJump(h);for(const k of o){const T=k.getBucket(r);T&&r.id===T.layerIds[0]&&(T.bucketInstanceId||(T.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(k.tileID,T,this.crossTileIDs)&&(m=!0),b[T.bucketInstanceId]=!0)}return d.removeStaleBuckets(b)&&(m=!0),m}pruneUnusedLayers(r){const o={};r.forEach(h=>{o[h]=!0});for(const h in this.layerIndexes)o[h]||delete this.layerIndexes[h]}}const ki=(g,r)=>c.t(g,r&&r.filter(o=>o.identifier!=="source.canvas")),Cg=c.aw();class au extends c.E{constructor(r,o={}){super(),this._rtlPluginLoaded=()=>{for(const h in this.sourceCaches){const d=this.sourceCaches[h].getSource().type;d!=="vector"&&d!=="geojson"||this.sourceCaches[h].reload()}},this.map=r,this.dispatcher=new Tt(et(),r._getMapId()),this.dispatcher.registerMessageHandler("GG",(h,d)=>this.getGlyphs(h,d)),this.dispatcher.registerMessageHandler("GI",(h,d)=>this.getImages(h,d)),this.imageManager=new Pt,this.imageManager.setEventedParent(this),this.glyphManager=new Mr(r._requestManager,o.localIdeographFontFamily),this.lineAtlas=new $n(256,512),this.crossTileSymbolIndex=new eh,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.ay()),$i().on(Oe,this._rtlPluginLoaded),this.on("data",h=>{if(h.dataType!=="source"||h.sourceDataType!=="metadata")return;const d=this.sourceCaches[h.sourceId];if(!d)return;const m=d.getSource();if(m&&m.vectorLayerIds)for(const b in this._layers){const k=this._layers[b];k.source===m.id&&this._validateLayer(k)}})}loadURL(r,o={},h){this.fire(new c.k("dataloading",{dataType:"style"})),o.validate=typeof o.validate!="boolean"||o.validate;const d=this.map._requestManager.transformRequest(r,"Style");this._loadStyleRequest=new AbortController;const m=this._loadStyleRequest;c.h(d,this._loadStyleRequest).then(b=>{this._loadStyleRequest=null,this._load(b.data,o,h)}).catch(b=>{this._loadStyleRequest=null,b&&!m.signal.aborted&&this.fire(new c.j(b))})}loadJSON(r,o={},h){this.fire(new c.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,z.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,o.validate=o.validate!==!1,this._load(r,o,h)}).catch(()=>{})}loadEmpty(){this.fire(new c.k("dataloading",{dataType:"style"})),this._load(Cg,{validate:!1})}_load(r,o,h){var d;const m=o.transformStyle?o.transformStyle(h,r):r;if(!o.validate||!ki(this,c.u(m))){this._loaded=!0,this.stylesheet=m;for(const b in m.sources)this.addSource(b,m.sources[b],{validate:!1});m.sprite?this._loadSprite(m.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(m.glyphs),this._createLayers(),this.light=new ft(this.stylesheet.light),this.sky=new Wt(this.stylesheet.sky),this.map.setTerrain((d=this.stylesheet.terrain)!==null&&d!==void 0?d:null),this.fire(new c.k("data",{dataType:"style"})),this.fire(new c.k("style.load"))}}_createLayers(){const r=c.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",r),this._order=r.map(o=>o.id),this._layers={},this._serializedLayers=null;for(const o of r){const h=c.aA(o);h.setEventedParent(this,{layer:{id:o.id}}),this._layers[o.id]=h}}_loadSprite(r,o=!1,h=void 0){let d;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(m,b,k,T){return c._(this,void 0,void 0,function*(){const P=ct(m),D=k>1?"@2x":"",L={},U={};for(const{id:Z,url:H}of P){const ee=b.transformRequest(it(H,D,".json"),"SpriteJSON");L[Z]=c.h(ee,T);const ie=b.transformRequest(it(H,D,".png"),"SpriteImage");U[Z]=te.getImage(ie,T)}return yield Promise.all([...Object.values(L),...Object.values(U)]),function(Z,H){return c._(this,void 0,void 0,function*(){const ee={};for(const ie in Z){ee[ie]={};const se=z.getImageCanvasContext((yield H[ie]).data),le=(yield Z[ie]).data;for(const K in le){const{width:de,height:ye,x:we,y:Ee,sdf:Re,pixelRatio:Ze,stretchX:Xe,stretchY:Ue,content:je,textFitWidth:rt,textFitHeight:wt}=le[K];ee[ie][K]={data:null,pixelRatio:Ze,sdf:Re,stretchX:Xe,stretchY:Ue,content:je,textFitWidth:rt,textFitHeight:wt,spriteData:{width:de,height:ye,x:we,y:Ee,context:se}}}}return ee})}(L,U)})}(r,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(m=>{if(this._spriteRequest=null,m)for(const b in m){this._spritesImagesIds[b]=[];const k=this._spritesImagesIds[b]?this._spritesImagesIds[b].filter(T=>!(T in m)):[];for(const T of k)this.imageManager.removeImage(T),this._changedImages[T]=!0;for(const T in m[b]){const P=b==="default"?T:`${b}:${T}`;this._spritesImagesIds[b].push(P),P in this.imageManager.images?this.imageManager.updateImage(P,m[b][T],!1):this.imageManager.addImage(P,m[b][T]),o&&(this._changedImages[P]=!0)}}}).catch(m=>{this._spriteRequest=null,d=m,this.fire(new c.j(d))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),o&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"})),h&&h(d)})}_unloadSprite(){for(const r of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(r),this._changedImages[r]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}_validateLayer(r){const o=this.sourceCaches[r.source];if(!o)return;const h=r.sourceLayer;if(!h)return;const d=o.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(h)===-1)&&this.fire(new c.j(new Error(`Source layer "${h}" does not exist on source "${d.id}" as specified by style layer "${r.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this.sourceCaches)if(!this.sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(r,o=!1){const h=this._serializedAllLayers();if(!r||r.length===0)return Object.values(o?c.aB(h):h);const d=[];for(const m of r)if(h[m]){const b=o?c.aB(h[m]):h[m];d.push(b)}return d}_serializedAllLayers(){let r=this._serializedLayers;if(r)return r;r=this._serializedLayers={};const o=Object.keys(this._layers);for(const h of o){const d=this._layers[h];d.type!=="custom"&&(r[h]=d.serialize())}return r}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const r in this.sourceCaches)if(this.sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(r){if(!this._loaded)return;const o=this._changed;if(o){const d=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(d.length||m.length)&&this._updateWorkerLayers(d,m);for(const b in this._updatedSources){const k=this._updatedSources[b];if(k==="reload")this._reloadSource(b);else{if(k!=="clear")throw new Error(`Invalid action ${k}`);this._clearSource(b)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const b in this._updatedPaintProps)this._layers[b].updateTransitions(r);this.light.updateTransitions(r),this.sky.updateTransitions(r),this._resetUpdates()}const h={};for(const d in this.sourceCaches){const m=this.sourceCaches[d];h[d]=m.used,m.used=!1}for(const d of this._order){const m=this._layers[d];m.recalculate(r,this._availableImages),!m.isHidden(r.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const d in h){const m=this.sourceCaches[d];!!h[d]!=!!m.used&&m.fire(new c.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(r),this.sky.recalculate(r),this.z=r.zoom,o&&this.fire(new c.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(r,o){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(r,!1),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(r,o={}){var h;this._checkLoaded();const d=this.serialize();if(r=o.transformStyle?o.transformStyle(d,r):r,((h=o.validate)===null||h===void 0||h)&&ki(this,c.u(r)))return!1;(r=c.aB(r)).layers=c.az(r.layers);const m=c.aC(d,r),b=this._getOperationsToPerform(m);if(b.unimplemented.length>0)throw new Error(`Unimplemented: ${b.unimplemented.join(", ")}.`);if(b.operations.length===0)return!1;for(const k of b.operations)k();return this.stylesheet=r,this._serializedLayers=null,!0}_getOperationsToPerform(r){const o=[],h=[];for(const d of r)switch(d.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":o.push(()=>this.addLayer.apply(this,d.args));break;case"removeLayer":o.push(()=>this.removeLayer.apply(this,d.args));break;case"setPaintProperty":o.push(()=>this.setPaintProperty.apply(this,d.args));break;case"setLayoutProperty":o.push(()=>this.setLayoutProperty.apply(this,d.args));break;case"setFilter":o.push(()=>this.setFilter.apply(this,d.args));break;case"addSource":o.push(()=>this.addSource.apply(this,d.args));break;case"removeSource":o.push(()=>this.removeSource.apply(this,d.args));break;case"setLayerZoomRange":o.push(()=>this.setLayerZoomRange.apply(this,d.args));break;case"setLight":o.push(()=>this.setLight.apply(this,d.args));break;case"setGeoJSONSourceData":o.push(()=>this.setGeoJSONSourceData.apply(this,d.args));break;case"setGlyphs":o.push(()=>this.setGlyphs.apply(this,d.args));break;case"setSprite":o.push(()=>this.setSprite.apply(this,d.args));break;case"setSky":o.push(()=>this.setSky.apply(this,d.args));break;case"setTerrain":o.push(()=>this.map.setTerrain.apply(this,d.args));break;case"setTransition":o.push(()=>{});break;default:h.push(d.command)}return{operations:o,unimplemented:h}}addImage(r,o){if(this.getImage(r))return this.fire(new c.j(new Error(`An image named "${r}" already exists.`)));this.imageManager.addImage(r,o),this._afterImageUpdated(r)}updateImage(r,o){this.imageManager.updateImage(r,o)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){if(!this.getImage(r))return this.fire(new c.j(new Error(`An image named "${r}" does not exist.`)));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(r,o,h={}){if(this._checkLoaded(),this.sourceCaches[r]!==void 0)throw new Error(`Source "${r}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(c.u.source,`sources.${r}`,o,null,h))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const d=this.sourceCaches[r]=new _t(r,o,this.dispatcher);d.style=this,d.setEventedParent(this,()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:r})),d.onAdd(this.map),this._changed=!0}removeSource(r){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error("There is no source with this ID");for(const h in this._layers)if(this._layers[h].source===r)return this.fire(new c.j(new Error(`Source "${r}" cannot be removed while layer "${h}" is using it.`)));const o=this.sourceCaches[r];delete this.sourceCaches[r],delete this._updatedSources[r],o.fire(new c.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:r})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(r,o){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error(`There is no source with this ID=${r}`);const h=this.sourceCaches[r].getSource();if(h.type!=="geojson")throw new Error(`geojsonSource.type is ${h.type}, which is !== 'geojson`);h.setData(o),this._changed=!0}getSource(r){return this.sourceCaches[r]&&this.sourceCaches[r].getSource()}addLayer(r,o,h={}){this._checkLoaded();const d=r.id;if(this.getLayer(d))return void this.fire(new c.j(new Error(`Layer "${d}" already exists on this map.`)));let m;if(r.type==="custom"){if(ki(this,c.aD(r)))return;m=c.aA(r)}else{if("source"in r&&typeof r.source=="object"&&(this.addSource(d,r.source),r=c.aB(r),r=c.e(r,{source:d})),this._validate(c.u.layer,`layers.${d}`,r,{arrayIndex:-1},h))return;m=c.aA(r),this._validateLayer(m),m.setEventedParent(this,{layer:{id:d}})}const b=o?this._order.indexOf(o):this._order.length;if(o&&b===-1)this.fire(new c.j(new Error(`Cannot add layer "${d}" before non-existing layer "${o}".`)));else{if(this._order.splice(b,0,d),this._layerOrderChanged=!0,this._layers[d]=m,this._removedLayers[d]&&m.source&&m.type!=="custom"){const k=this._removedLayers[d];delete this._removedLayers[d],k.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(r,o){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new c.j(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===o)return;const h=this._order.indexOf(r);this._order.splice(h,1);const d=o?this._order.indexOf(o):this._order.length;o&&d===-1?this.fire(new c.j(new Error(`Cannot move layer "${r}" before non-existing layer "${o}".`))):(this._order.splice(d,0,r),this._layerOrderChanged=!0)}removeLayer(r){this._checkLoaded();const o=this._layers[r];if(!o)return void this.fire(new c.j(new Error(`Cannot remove non-existing layer "${r}".`)));o.setEventedParent(null);const h=this._order.indexOf(r);this._order.splice(h,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=o,delete this._layers[r],this._serializedLayers&&delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],o.onRemove&&o.onRemove(this.map)}getLayer(r){return this._layers[r]}getLayersOrder(){return[...this._order]}hasLayer(r){return r in this._layers}setLayerZoomRange(r,o,h){this._checkLoaded();const d=this.getLayer(r);d?d.minzoom===o&&d.maxzoom===h||(o!=null&&(d.minzoom=o),h!=null&&(d.maxzoom=h),this._updateLayer(d)):this.fire(new c.j(new Error(`Cannot set the zoom range of non-existing layer "${r}".`)))}setFilter(r,o,h={}){this._checkLoaded();const d=this.getLayer(r);if(d){if(!c.aE(d.filter,o))return o==null?(d.filter=void 0,void this._updateLayer(d)):void(this._validate(c.u.filter,`layers.${d.id}.filter`,o,null,h)||(d.filter=c.aB(o),this._updateLayer(d)))}else this.fire(new c.j(new Error(`Cannot filter non-existing layer "${r}".`)))}getFilter(r){return c.aB(this.getLayer(r).filter)}setLayoutProperty(r,o,h,d={}){this._checkLoaded();const m=this.getLayer(r);m?c.aE(m.getLayoutProperty(o),h)||(m.setLayoutProperty(o,h,d),this._updateLayer(m)):this.fire(new c.j(new Error(`Cannot style non-existing layer "${r}".`)))}getLayoutProperty(r,o){const h=this.getLayer(r);if(h)return h.getLayoutProperty(o);this.fire(new c.j(new Error(`Cannot get style of non-existing layer "${r}".`)))}setPaintProperty(r,o,h,d={}){this._checkLoaded();const m=this.getLayer(r);m?c.aE(m.getPaintProperty(o),h)||(m.setPaintProperty(o,h,d)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[r]=!0,this._serializedLayers=null):this.fire(new c.j(new Error(`Cannot style non-existing layer "${r}".`)))}getPaintProperty(r,o){return this.getLayer(r).getPaintProperty(o)}setFeatureState(r,o){this._checkLoaded();const h=r.source,d=r.sourceLayer,m=this.sourceCaches[h];if(m===void 0)return void this.fire(new c.j(new Error(`The source '${h}' does not exist in the map's style.`)));const b=m.getSource().type;b==="geojson"&&d?this.fire(new c.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):b!=="vector"||d?(r.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),m.setFeatureState(d,r.id,o)):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(r,o){this._checkLoaded();const h=r.source,d=this.sourceCaches[h];if(d===void 0)return void this.fire(new c.j(new Error(`The source '${h}' does not exist in the map's style.`)));const m=d.getSource().type,b=m==="vector"?r.sourceLayer:void 0;m!=="vector"||b?o&&typeof r.id!="string"&&typeof r.id!="number"?this.fire(new c.j(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(b,r.id,o):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(r){this._checkLoaded();const o=r.source,h=r.sourceLayer,d=this.sourceCaches[o];if(d!==void 0)return d.getSource().type!=="vector"||h?(r.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),d.getFeatureState(h,r.id)):void this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.j(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const r=c.aF(this.sourceCaches,m=>m.serialize()),o=this._serializeByIds(this._order,!0),h=this.map.getTerrain()||void 0,d=this.stylesheet;return c.aG({version:d.version,name:d.name,metadata:d.metadata,light:d.light,sky:d.sky,center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,sprite:d.sprite,glyphs:d.glyphs,transition:d.transition,sources:r,layers:o,terrain:h},m=>m!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0,r.source&&!this._updatedSources[r.source]&&this.sourceCaches[r.source].getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(r){const o=b=>this._layers[b].type==="fill-extrusion",h={},d=[];for(let b=this._order.length-1;b>=0;b--){const k=this._order[b];if(o(k)){h[k]=b;for(const T of r){const P=T[k];if(P)for(const D of P)d.push(D)}}}d.sort((b,k)=>k.intersectionZ-b.intersectionZ);const m=[];for(let b=this._order.length-1;b>=0;b--){const k=this._order[b];if(o(k))for(let T=d.length-1;T>=0;T--){const P=d[T].feature;if(h[P.layer.id]<b)break;m.push(P),d.pop()}else for(const T of r){const P=T[k];if(P)for(const D of P)m.push(D.feature)}}return m}queryRenderedFeatures(r,o,h){o&&o.filter&&this._validate(c.u.filter,"queryRenderedFeatures.filter",o.filter,null,o);const d={};if(o&&o.layers){if(!Array.isArray(o.layers))return this.fire(new c.j(new Error("parameters.layers must be an Array."))),[];for(const k of o.layers){const T=this._layers[k];if(!T)return this.fire(new c.j(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];d[T.source]=!0}}const m=[];o.availableImages=this._availableImages;const b=this._serializedAllLayers();for(const k in this.sourceCaches)o.layers&&!d[k]||m.push(yr(this.sourceCaches[k],this._layers,b,r,o,h));return this.placement&&m.push(function(k,T,P,D,L,U,Z){const H={},ee=U.queryRenderedSymbols(D),ie=[];for(const se of Object.keys(ee).map(Number))ie.push(Z[se]);ie.sort(Nt);for(const se of ie){const le=se.featureIndex.lookupSymbolFeatures(ee[se.bucketInstanceId],T,se.bucketIndex,se.sourceLayerIndex,L.filter,L.layers,L.availableImages,k);for(const K in le){const de=H[K]=H[K]||[],ye=le[K];ye.sort((we,Ee)=>{const Re=se.featureSortOrder;if(Re){const Ze=Re.indexOf(we.featureIndex);return Re.indexOf(Ee.featureIndex)-Ze}return Ee.featureIndex-we.featureIndex});for(const we of ye)de.push(we)}}for(const se in H)H[se].forEach(le=>{const K=le.feature,de=P[k[se].source].getFeatureState(K.layer["source-layer"],K.id);K.source=K.layer.source,K.layer["source-layer"]&&(K.sourceLayer=K.layer["source-layer"]),K.state=de});return H}(this._layers,b,this.sourceCaches,r,o,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(r,o){o&&o.filter&&this._validate(c.u.filter,"querySourceFeatures.filter",o.filter,null,o);const h=this.sourceCaches[r];return h?function(d,m){const b=d.getRenderableIds().map(P=>d.getTileByID(P)),k=[],T={};for(let P=0;P<b.length;P++){const D=b[P],L=D.tileID.canonical.key;T[L]||(T[L]=!0,D.querySourceFeatures(k,m))}return k}(h,o):[]}getLight(){return this.light.getLight()}setLight(r,o={}){this._checkLoaded();const h=this.light.getLight();let d=!1;for(const b in r)if(!c.aE(r[b],h[b])){d=!0;break}if(!d)return;const m={now:z.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,o),this.light.updateTransitions(m)}getSky(){var r;return(r=this.stylesheet)===null||r===void 0?void 0:r.sky}setSky(r,o={}){const h=this.getSky();let d=!1;if(!r&&!h)return;if(r&&!h)d=!0;else if(!r&&h)d=!0;else for(const b in r)if(!c.aE(r[b],h[b])){d=!0;break}if(!d)return;const m={now:z.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=r,this.sky.setSky(r,o),this.sky.updateTransitions(m)}_validate(r,o,h,d,m={}){return(!m||m.validate!==!1)&&ki(this,r.call(c.u,c.e({key:o,style:this.serialize(),value:h,styleSpec:c.v},d)))}_remove(r=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),$i().off(Oe,this._rtlPluginLoaded);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const h=this.sourceCaches[o];h.setEventedParent(null),h.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),r&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(r)}_clearSource(r){this.sourceCaches[r].clearTiles()}_reloadSource(r){this.sourceCaches[r].resume(),this.sourceCaches[r].reload()}_updateSources(r){for(const o in this.sourceCaches)this.sourceCaches[o].update(r,this.map.terrain)}_generateCollisionBoxes(){for(const r in this.sourceCaches)this._reloadSource(r)}_updatePlacement(r,o,h,d,m=!1){let b=!1,k=!1;const T={};for(const P of this._order){const D=this._layers[P];if(D.type!=="symbol")continue;if(!T[D.source]){const U=this.sourceCaches[D.source];T[D.source]=U.getRenderableIds(!0).map(Z=>U.getTileByID(Z)).sort((Z,H)=>H.tileID.overscaledZ-Z.tileID.overscaledZ||(Z.tileID.isLessThan(H.tileID)?-1:1))}const L=this.crossTileSymbolIndex.addLayer(D,T[D.source],r.center.lng);b=b||L}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||h===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(z.now(),r.zoom))&&(this.pauseablePlacement=new Go(r,this.map.terrain,this._order,m,o,h,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,T),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(z.now()),k=!0),b&&this.pauseablePlacement.placement.setStale()),k||b)for(const P of this._order){const D=this._layers[P];D.type==="symbol"&&this.placement.updateLayerOpacities(D,T[D.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(z.now())}_releaseSymbolFadeTiles(){for(const r in this.sourceCaches)this.sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,o){return c._(this,void 0,void 0,function*(){const h=yield this.imageManager.getImages(o.icons);this._updateTilesForChangedImages();const d=this.sourceCaches[o.source];return d&&d.setDependencies(o.tileID.key,o.type,o.icons),h})}getGlyphs(r,o){return c._(this,void 0,void 0,function*(){const h=yield this.glyphManager.getGlyphs(o.stacks),d=this.sourceCaches[o.source];return d&&d.setDependencies(o.tileID.key,o.type,[""]),h})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(r,o={}){this._checkLoaded(),r&&this._validate(c.u.glyphs,"glyphs",r,null,o)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=r,this.glyphManager.entries={},this.glyphManager.setURL(r))}addSprite(r,o,h={},d){this._checkLoaded();const m=[{id:r,url:o}],b=[...ct(this.stylesheet.sprite),...m];this._validate(c.u.sprite,"sprite",b,null,h)||(this.stylesheet.sprite=b,this._loadSprite(m,!0,d))}removeSprite(r){this._checkLoaded();const o=ct(this.stylesheet.sprite);if(o.find(h=>h.id===r)){if(this._spritesImagesIds[r])for(const h of this._spritesImagesIds[r])this.imageManager.removeImage(h),this._changedImages[h]=!0;o.splice(o.findIndex(h=>h.id===r),1),this.stylesheet.sprite=o.length>0?o:void 0,delete this._spritesImagesIds[r],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}else this.fire(new c.j(new Error(`Sprite "${r}" doesn't exists on this map.`)))}getSprite(){return ct(this.stylesheet.sprite)}setSprite(r,o={},h){this._checkLoaded(),r&&this._validate(c.u.sprite,"sprite",r,null,o)||(this.stylesheet.sprite=r,r?this._loadSprite(r,!0,h):(this._unloadSprite(),h&&h(null)))}}var Xs=c.Y([{name:"a_pos",type:"Int16",components:2}]);const Ps={prelude:Zt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Zt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Zt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Zt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Zt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Zt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:Zt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Zt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Zt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Zt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Zt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Zt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Zt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Zt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Zt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Zt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Zt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Zt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Zt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Zt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Zt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Zt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Zt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Zt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Zt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Zt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Zt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Zt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Zt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:Zt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Zt(g,r){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,h=r.match(/attribute ([\w]+) ([\w]+)/g),d=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=r.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=m?m.concat(d):d,k={};return{fragmentSource:g=g.replace(o,(T,P,D,L,U)=>(k[U]=!0,P==="define"?`
#ifndef HAS_UNIFORM_u_${U}
varying ${D} ${L} ${U};
#else
uniform ${D} ${L} u_${U};
#endif
`:`
#ifdef HAS_UNIFORM_u_${U}
    ${D} ${L} ${U} = u_${U};
#endif
`)),vertexSource:r=r.replace(o,(T,P,D,L,U)=>{const Z=L==="float"?"vec2":"vec4",H=U.match(/color/)?"color":Z;return k[U]?P==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
attribute ${D} ${Z} a_${U};
varying ${D} ${L} ${U};
#else
uniform ${D} ${L} u_${U};
#endif
`:H==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = a_${U};
#else
    ${D} ${L} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = unpack_mix_${H}(a_${U}, u_${U}_t);
#else
    ${D} ${L} ${U} = u_${U};
#endif
`:P==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
attribute ${D} ${Z} a_${U};
#else
uniform ${D} ${L} u_${U};
#endif
`:H==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${D} ${L} ${U} = a_${U};
#else
    ${D} ${L} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${D} ${L} ${U} = unpack_mix_${H}(a_${U}, u_${U}_t);
#else
    ${D} ${L} ${U} = u_${U};
#endif
`}),staticAttributes:h,staticUniforms:b}}class th{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(r,o,h,d,m,b,k,T,P){this.context=r;let D=this.boundPaintVertexBuffers.length!==d.length;for(let L=0;!D&&L<d.length;L++)this.boundPaintVertexBuffers[L]!==d[L]&&(D=!0);!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==h||D||this.boundIndexBuffer!==m||this.boundVertexOffset!==b||this.boundDynamicVertexBuffer!==k||this.boundDynamicVertexBuffer2!==T||this.boundDynamicVertexBuffer3!==P?this.freshBind(o,h,d,m,b,k,T,P):(r.bindVertexArray.set(this.vao),k&&k.bind(),m&&m.dynamicDraw&&m.bind(),T&&T.bind(),P&&P.bind())}freshBind(r,o,h,d,m,b,k,T){const P=r.numAttributes,D=this.context,L=D.gl;this.vao&&this.destroy(),this.vao=D.createVertexArray(),D.bindVertexArray.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=d,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=b,this.boundDynamicVertexBuffer2=k,this.boundDynamicVertexBuffer3=T,o.enableAttributes(L,r);for(const U of h)U.enableAttributes(L,r);b&&b.enableAttributes(L,r),k&&k.enableAttributes(L,r),T&&T.enableAttributes(L,r),o.bind(),o.setVertexAttribPointers(L,r,m);for(const U of h)U.bind(),U.setVertexAttribPointers(L,r,m);b&&(b.bind(),b.setVertexAttribPointers(L,r,m)),d&&d.bind(),k&&(k.bind(),k.setVertexAttribPointers(L,r,m)),T&&(T.bind(),T.setVertexAttribPointers(L,r,m)),D.currentNumAttributes=P}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const rh=(g,r,o,h,d)=>({u_matrix:g,u_texture:0,u_ele_delta:r,u_fog_matrix:o,u_fog_color:h?h.properties.get("fog-color"):c.aM.white,u_fog_ground_blend:h?h.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:h?h.calculateFogBlendOpacity(d):0,u_horizon_color:h?h.properties.get("horizon-color"):c.aM.white,u_horizon_fog_blend:h?h.properties.get("horizon-fog-blend"):1});function Da(g){const r=[];for(let o=0;o<g.length;o++){if(g[o]===null)continue;const h=g[o].split(" ");r.push(h.pop())}return r}class nh{constructor(r,o,h,d,m,b){const k=r.gl;this.program=k.createProgram();const T=Da(o.staticAttributes),P=h?h.getBinderAttributes():[],D=T.concat(P),L=Ps.prelude.staticUniforms?Da(Ps.prelude.staticUniforms):[],U=o.staticUniforms?Da(o.staticUniforms):[],Z=h?h.getBinderUniforms():[],H=L.concat(U).concat(Z),ee=[];for(const we of H)ee.indexOf(we)<0&&ee.push(we);const ie=h?h.defines():[];m&&ie.push("#define OVERDRAW_INSPECTOR;"),b&&ie.push("#define TERRAIN3D;");const se=ie.concat(Ps.prelude.fragmentSource,o.fragmentSource).join(`
`),le=ie.concat(Ps.prelude.vertexSource,o.vertexSource).join(`
`),K=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(K,se),k.compileShader(K),!k.getShaderParameter(K,k.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${k.getShaderInfoLog(K)}`);k.attachShader(this.program,K);const de=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(de,le),k.compileShader(de),!k.getShaderParameter(de,k.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${k.getShaderInfoLog(de)}`);k.attachShader(this.program,de),this.attributes={};const ye={};this.numAttributes=D.length;for(let we=0;we<this.numAttributes;we++)D[we]&&(k.bindAttribLocation(this.program,we,D[we]),this.attributes[D[we]]=we);if(k.linkProgram(this.program),!k.getProgramParameter(this.program,k.LINK_STATUS))throw new Error(`Program failed to link: ${k.getProgramInfoLog(this.program)}`);k.deleteShader(de),k.deleteShader(K);for(let we=0;we<ee.length;we++){const Ee=ee[we];if(Ee&&!ye[Ee]){const Re=k.getUniformLocation(this.program,Ee);Re&&(ye[Ee]=Re)}}this.fixedUniforms=d(r,ye),this.terrainUniforms=((we,Ee)=>({u_depth:new c.aH(we,Ee.u_depth),u_terrain:new c.aH(we,Ee.u_terrain),u_terrain_dim:new c.aI(we,Ee.u_terrain_dim),u_terrain_matrix:new c.aJ(we,Ee.u_terrain_matrix),u_terrain_unpack:new c.aK(we,Ee.u_terrain_unpack),u_terrain_exaggeration:new c.aI(we,Ee.u_terrain_exaggeration)}))(r,ye),this.binderUniforms=h?h.getUniforms(r,ye):[]}draw(r,o,h,d,m,b,k,T,P,D,L,U,Z,H,ee,ie,se,le){const K=r.gl;if(this.failedToCreate)return;if(r.program.set(this.program),r.setDepthMode(h),r.setStencilMode(d),r.setColorMode(m),r.setCullFace(b),T){r.activeTexture.set(K.TEXTURE2),K.bindTexture(K.TEXTURE_2D,T.depthTexture),r.activeTexture.set(K.TEXTURE3),K.bindTexture(K.TEXTURE_2D,T.texture);for(const ye in this.terrainUniforms)this.terrainUniforms[ye].set(T[ye])}for(const ye in this.fixedUniforms)this.fixedUniforms[ye].set(k[ye]);ee&&ee.setUniforms(r,this.binderUniforms,Z,{zoom:H});let de=0;switch(o){case K.LINES:de=2;break;case K.TRIANGLES:de=3;break;case K.LINE_STRIP:de=1}for(const ye of U.get()){const we=ye.vaos||(ye.vaos={});(we[P]||(we[P]=new th)).bind(r,this,D,ee?ee.getPaintVertexBuffers():[],L,ye.vertexOffset,ie,se,le),K.drawElements(o,ye.primitiveLength*de,K.UNSIGNED_SHORT,ye.primitiveOffset*de*2)}}}function ou(g,r,o){const h=1/At(o,1,r.transform.tileZoom),d=Math.pow(2,o.tileID.overscaledZ),m=o.tileSize*Math.pow(2,r.transform.tileZoom)/d,b=m*(o.tileID.canonical.x+o.tileID.wrap*d),k=m*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[h,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[b>>16,k>>16],u_pixel_coord_lower:[65535&b,65535&k]}}const Wo=(g,r,o,h)=>{const d=r.style.light,m=d.properties.get("position"),b=[m.x,m.y,m.z],k=function(){var P=new c.A(9);return c.A!=Float32Array&&(P[1]=0,P[2]=0,P[3]=0,P[5]=0,P[6]=0,P[7]=0),P[0]=1,P[4]=1,P[8]=1,P}();d.properties.get("anchor")==="viewport"&&function(P,D){var L=Math.sin(D),U=Math.cos(D);P[0]=U,P[1]=L,P[2]=0,P[3]=-L,P[4]=U,P[5]=0,P[6]=0,P[7]=0,P[8]=1}(k,-r.transform.angle),function(P,D,L){var U=D[0],Z=D[1],H=D[2];P[0]=U*L[0]+Z*L[3]+H*L[6],P[1]=U*L[1]+Z*L[4]+H*L[7],P[2]=U*L[2]+Z*L[5]+H*L[8]}(b,b,k);const T=d.properties.get("color");return{u_matrix:g,u_lightpos:b,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[T.r,T.g,T.b],u_vertical_gradient:+o,u_opacity:h}},lu=(g,r,o,h,d,m,b)=>c.e(Wo(g,r,o,h),ou(m,r,b),{u_height_factor:-Math.pow(2,d.overscaledZ)/b.tileSize/8}),La=g=>({u_matrix:g}),Cf=(g,r,o,h)=>c.e(La(g),ou(o,r,h)),Mg=(g,r)=>({u_matrix:g,u_world:r}),Mf=(g,r,o,h,d)=>c.e(Cf(g,r,o,h),{u_world:d}),Ig=(g,r,o,h)=>{const d=g.transform;let m,b;if(h.paint.get("circle-pitch-alignment")==="map"){const k=At(o,1,d.zoom);m=!0,b=[k,k]}else m=!1,b=d.pixelsToGLUnits;return{u_camera_to_center_distance:d.cameraToCenterDistance,u_scale_with_map:+(h.paint.get("circle-pitch-scale")==="map"),u_matrix:g.translatePosMatrix(r.posMatrix,o,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_pitch_with_map:+m,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:b}},Ks=(g,r,o)=>({u_matrix:g,u_inv_matrix:r,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}),Xo=(g,r,o=1)=>({u_matrix:g,u_color:r,u_overlay:0,u_overlay_scale:o}),Pn=g=>({u_matrix:g}),An=(g,r,o,h)=>({u_matrix:g,u_extrude_scale:At(r,1,o),u_intensity:h}),uu=(g,r,o,h)=>{const d=c.H();c.aP(d,0,g.width,g.height,0,0,1);const m=g.context.gl;return{u_matrix:d,u_world:[m.drawingBufferWidth,m.drawingBufferHeight],u_image:o,u_color_ramp:h,u_opacity:r.paint.get("heatmap-opacity")}};function cu(g,r){const o=Math.pow(2,r.canonical.z),h=r.canonical.y;return[new c.Z(0,h/o).toLngLat().lat,new c.Z(0,(h+1)/o).toLngLat().lat]}const hu=(g,r,o,h)=>{const d=g.transform;return{u_matrix:Pf(g,r,o,h),u_ratio:1/At(r,1,d.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},If=(g,r,o,h,d)=>c.e(hu(g,r,o,d),{u_image:0,u_image_height:h}),Ra=(g,r,o,h,d)=>{const m=g.transform,b=Ef(r,m);return{u_matrix:Pf(g,r,o,d),u_texsize:r.imageAtlasTexture.size,u_ratio:1/At(r,1,m.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[b,h.fromScale,h.toScale],u_fade:h.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Eg=(g,r,o,h,d,m)=>{const b=g.lineAtlas,k=Ef(r,g.transform),T=o.layout.get("line-cap")==="round",P=b.getDash(h.from,T),D=b.getDash(h.to,T),L=P.width*d.fromScale,U=D.width*d.toScale;return c.e(hu(g,r,o,m),{u_patternscale_a:[k/L,-P.height/2],u_patternscale_b:[k/U,-D.height/2],u_sdfgamma:b.width/(256*Math.min(L,U)*g.pixelRatio)/2,u_image:0,u_tex_y_a:P.y,u_tex_y_b:D.y,u_mix:d.t})};function Ef(g,r){return 1/At(g,1,r.tileZoom)}function Pf(g,r,o,h){return g.translatePosMatrix(h?h.posMatrix:r.tileID.posMatrix,r,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const Pg=(g,r,o,h,d)=>{return{u_matrix:g,u_tl_parent:r,u_scale_parent:o,u_buffer_scale:1,u_fade_t:h.mix,u_opacity:h.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(b=d.paint.get("raster-saturation"),b>0?1-1/(1.001-b):-b),u_contrast_factor:(m=d.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:Ag(d.paint.get("raster-hue-rotate"))};var m,b};function Ag(g){g*=Math.PI/180;const r=Math.sin(g),o=Math.cos(g);return[(2*o+1)/3,(-Math.sqrt(3)*r-o+1)/3,(Math.sqrt(3)*r-o+1)/3]}const Af=(g,r,o,h,d,m,b,k,T,P,D,L,U,Z)=>{const H=b.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:H.cameraToCenterDistance,u_pitch:H.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:H.width/H.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:k,u_label_plane_matrix:T,u_coord_matrix:P,u_is_text:+L,u_pitch_with_map:+h,u_is_along_line:d,u_is_variable_anchor:m,u_texsize:U,u_texture:0,u_translation:D,u_pitched_scale:Z}},Ko=(g,r,o,h,d,m,b,k,T,P,D,L,U,Z,H)=>{const ee=b.transform;return c.e(Af(g,r,o,h,d,m,b,k,T,P,D,L,U,H),{u_gamma_scale:h?Math.cos(ee._pitch)*ee.cameraToCenterDistance:1,u_device_pixel_ratio:b.pixelRatio,u_is_halo:1})},ih=(g,r,o,h,d,m,b,k,T,P,D,L,U,Z)=>c.e(Ko(g,r,o,h,d,m,b,k,T,P,D,!0,L,!0,Z),{u_texsize_icon:U,u_texture_icon:1}),du=(g,r,o)=>({u_matrix:g,u_opacity:r,u_color:o}),sh=(g,r,o,h,d,m)=>c.e(function(b,k,T,P){const D=T.imageManager.getPattern(b.from.toString()),L=T.imageManager.getPattern(b.to.toString()),{width:U,height:Z}=T.imageManager.getPixelSize(),H=Math.pow(2,P.tileID.overscaledZ),ee=P.tileSize*Math.pow(2,T.transform.tileZoom)/H,ie=ee*(P.tileID.canonical.x+P.tileID.wrap*H),se=ee*P.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:D.tl,u_pattern_br_a:D.br,u_pattern_tl_b:L.tl,u_pattern_br_b:L.br,u_texsize:[U,Z],u_mix:k.t,u_pattern_size_a:D.displaySize,u_pattern_size_b:L.displaySize,u_scale_a:k.fromScale,u_scale_b:k.toScale,u_tile_units_to_pixels:1/At(P,1,T.transform.tileZoom),u_pixel_coord_upper:[ie>>16,se>>16],u_pixel_coord_lower:[65535&ie,65535&se]}}(h,m,o,d),{u_matrix:g,u_opacity:r}),ah={fillExtrusion:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_lightpos:new c.aN(g,r.u_lightpos),u_lightintensity:new c.aI(g,r.u_lightintensity),u_lightcolor:new c.aN(g,r.u_lightcolor),u_vertical_gradient:new c.aI(g,r.u_vertical_gradient),u_opacity:new c.aI(g,r.u_opacity)}),fillExtrusionPattern:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_lightpos:new c.aN(g,r.u_lightpos),u_lightintensity:new c.aI(g,r.u_lightintensity),u_lightcolor:new c.aN(g,r.u_lightcolor),u_vertical_gradient:new c.aI(g,r.u_vertical_gradient),u_height_factor:new c.aI(g,r.u_height_factor),u_image:new c.aH(g,r.u_image),u_texsize:new c.aO(g,r.u_texsize),u_pixel_coord_upper:new c.aO(g,r.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(g,r.u_pixel_coord_lower),u_scale:new c.aN(g,r.u_scale),u_fade:new c.aI(g,r.u_fade),u_opacity:new c.aI(g,r.u_opacity)}),fill:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix)}),fillPattern:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_image:new c.aH(g,r.u_image),u_texsize:new c.aO(g,r.u_texsize),u_pixel_coord_upper:new c.aO(g,r.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(g,r.u_pixel_coord_lower),u_scale:new c.aN(g,r.u_scale),u_fade:new c.aI(g,r.u_fade)}),fillOutline:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_world:new c.aO(g,r.u_world)}),fillOutlinePattern:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_world:new c.aO(g,r.u_world),u_image:new c.aH(g,r.u_image),u_texsize:new c.aO(g,r.u_texsize),u_pixel_coord_upper:new c.aO(g,r.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(g,r.u_pixel_coord_lower),u_scale:new c.aN(g,r.u_scale),u_fade:new c.aI(g,r.u_fade)}),circle:(g,r)=>({u_camera_to_center_distance:new c.aI(g,r.u_camera_to_center_distance),u_scale_with_map:new c.aH(g,r.u_scale_with_map),u_pitch_with_map:new c.aH(g,r.u_pitch_with_map),u_extrude_scale:new c.aO(g,r.u_extrude_scale),u_device_pixel_ratio:new c.aI(g,r.u_device_pixel_ratio),u_matrix:new c.aJ(g,r.u_matrix)}),collisionBox:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_pixel_extrude_scale:new c.aO(g,r.u_pixel_extrude_scale)}),collisionCircle:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_inv_matrix:new c.aJ(g,r.u_inv_matrix),u_camera_to_center_distance:new c.aI(g,r.u_camera_to_center_distance),u_viewport_size:new c.aO(g,r.u_viewport_size)}),debug:(g,r)=>({u_color:new c.aL(g,r.u_color),u_matrix:new c.aJ(g,r.u_matrix),u_overlay:new c.aH(g,r.u_overlay),u_overlay_scale:new c.aI(g,r.u_overlay_scale)}),clippingMask:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix)}),heatmap:(g,r)=>({u_extrude_scale:new c.aI(g,r.u_extrude_scale),u_intensity:new c.aI(g,r.u_intensity),u_matrix:new c.aJ(g,r.u_matrix)}),heatmapTexture:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_world:new c.aO(g,r.u_world),u_image:new c.aH(g,r.u_image),u_color_ramp:new c.aH(g,r.u_color_ramp),u_opacity:new c.aI(g,r.u_opacity)}),hillshade:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_image:new c.aH(g,r.u_image),u_latrange:new c.aO(g,r.u_latrange),u_light:new c.aO(g,r.u_light),u_shadow:new c.aL(g,r.u_shadow),u_highlight:new c.aL(g,r.u_highlight),u_accent:new c.aL(g,r.u_accent)}),hillshadePrepare:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_image:new c.aH(g,r.u_image),u_dimension:new c.aO(g,r.u_dimension),u_zoom:new c.aI(g,r.u_zoom),u_unpack:new c.aK(g,r.u_unpack)}),line:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_ratio:new c.aI(g,r.u_ratio),u_device_pixel_ratio:new c.aI(g,r.u_device_pixel_ratio),u_units_to_pixels:new c.aO(g,r.u_units_to_pixels)}),lineGradient:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_ratio:new c.aI(g,r.u_ratio),u_device_pixel_ratio:new c.aI(g,r.u_device_pixel_ratio),u_units_to_pixels:new c.aO(g,r.u_units_to_pixels),u_image:new c.aH(g,r.u_image),u_image_height:new c.aI(g,r.u_image_height)}),linePattern:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_texsize:new c.aO(g,r.u_texsize),u_ratio:new c.aI(g,r.u_ratio),u_device_pixel_ratio:new c.aI(g,r.u_device_pixel_ratio),u_image:new c.aH(g,r.u_image),u_units_to_pixels:new c.aO(g,r.u_units_to_pixels),u_scale:new c.aN(g,r.u_scale),u_fade:new c.aI(g,r.u_fade)}),lineSDF:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_ratio:new c.aI(g,r.u_ratio),u_device_pixel_ratio:new c.aI(g,r.u_device_pixel_ratio),u_units_to_pixels:new c.aO(g,r.u_units_to_pixels),u_patternscale_a:new c.aO(g,r.u_patternscale_a),u_patternscale_b:new c.aO(g,r.u_patternscale_b),u_sdfgamma:new c.aI(g,r.u_sdfgamma),u_image:new c.aH(g,r.u_image),u_tex_y_a:new c.aI(g,r.u_tex_y_a),u_tex_y_b:new c.aI(g,r.u_tex_y_b),u_mix:new c.aI(g,r.u_mix)}),raster:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_tl_parent:new c.aO(g,r.u_tl_parent),u_scale_parent:new c.aI(g,r.u_scale_parent),u_buffer_scale:new c.aI(g,r.u_buffer_scale),u_fade_t:new c.aI(g,r.u_fade_t),u_opacity:new c.aI(g,r.u_opacity),u_image0:new c.aH(g,r.u_image0),u_image1:new c.aH(g,r.u_image1),u_brightness_low:new c.aI(g,r.u_brightness_low),u_brightness_high:new c.aI(g,r.u_brightness_high),u_saturation_factor:new c.aI(g,r.u_saturation_factor),u_contrast_factor:new c.aI(g,r.u_contrast_factor),u_spin_weights:new c.aN(g,r.u_spin_weights)}),symbolIcon:(g,r)=>({u_is_size_zoom_constant:new c.aH(g,r.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(g,r.u_is_size_feature_constant),u_size_t:new c.aI(g,r.u_size_t),u_size:new c.aI(g,r.u_size),u_camera_to_center_distance:new c.aI(g,r.u_camera_to_center_distance),u_pitch:new c.aI(g,r.u_pitch),u_rotate_symbol:new c.aH(g,r.u_rotate_symbol),u_aspect_ratio:new c.aI(g,r.u_aspect_ratio),u_fade_change:new c.aI(g,r.u_fade_change),u_matrix:new c.aJ(g,r.u_matrix),u_label_plane_matrix:new c.aJ(g,r.u_label_plane_matrix),u_coord_matrix:new c.aJ(g,r.u_coord_matrix),u_is_text:new c.aH(g,r.u_is_text),u_pitch_with_map:new c.aH(g,r.u_pitch_with_map),u_is_along_line:new c.aH(g,r.u_is_along_line),u_is_variable_anchor:new c.aH(g,r.u_is_variable_anchor),u_texsize:new c.aO(g,r.u_texsize),u_texture:new c.aH(g,r.u_texture),u_translation:new c.aO(g,r.u_translation),u_pitched_scale:new c.aI(g,r.u_pitched_scale)}),symbolSDF:(g,r)=>({u_is_size_zoom_constant:new c.aH(g,r.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(g,r.u_is_size_feature_constant),u_size_t:new c.aI(g,r.u_size_t),u_size:new c.aI(g,r.u_size),u_camera_to_center_distance:new c.aI(g,r.u_camera_to_center_distance),u_pitch:new c.aI(g,r.u_pitch),u_rotate_symbol:new c.aH(g,r.u_rotate_symbol),u_aspect_ratio:new c.aI(g,r.u_aspect_ratio),u_fade_change:new c.aI(g,r.u_fade_change),u_matrix:new c.aJ(g,r.u_matrix),u_label_plane_matrix:new c.aJ(g,r.u_label_plane_matrix),u_coord_matrix:new c.aJ(g,r.u_coord_matrix),u_is_text:new c.aH(g,r.u_is_text),u_pitch_with_map:new c.aH(g,r.u_pitch_with_map),u_is_along_line:new c.aH(g,r.u_is_along_line),u_is_variable_anchor:new c.aH(g,r.u_is_variable_anchor),u_texsize:new c.aO(g,r.u_texsize),u_texture:new c.aH(g,r.u_texture),u_gamma_scale:new c.aI(g,r.u_gamma_scale),u_device_pixel_ratio:new c.aI(g,r.u_device_pixel_ratio),u_is_halo:new c.aH(g,r.u_is_halo),u_translation:new c.aO(g,r.u_translation),u_pitched_scale:new c.aI(g,r.u_pitched_scale)}),symbolTextAndIcon:(g,r)=>({u_is_size_zoom_constant:new c.aH(g,r.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(g,r.u_is_size_feature_constant),u_size_t:new c.aI(g,r.u_size_t),u_size:new c.aI(g,r.u_size),u_camera_to_center_distance:new c.aI(g,r.u_camera_to_center_distance),u_pitch:new c.aI(g,r.u_pitch),u_rotate_symbol:new c.aH(g,r.u_rotate_symbol),u_aspect_ratio:new c.aI(g,r.u_aspect_ratio),u_fade_change:new c.aI(g,r.u_fade_change),u_matrix:new c.aJ(g,r.u_matrix),u_label_plane_matrix:new c.aJ(g,r.u_label_plane_matrix),u_coord_matrix:new c.aJ(g,r.u_coord_matrix),u_is_text:new c.aH(g,r.u_is_text),u_pitch_with_map:new c.aH(g,r.u_pitch_with_map),u_is_along_line:new c.aH(g,r.u_is_along_line),u_is_variable_anchor:new c.aH(g,r.u_is_variable_anchor),u_texsize:new c.aO(g,r.u_texsize),u_texsize_icon:new c.aO(g,r.u_texsize_icon),u_texture:new c.aH(g,r.u_texture),u_texture_icon:new c.aH(g,r.u_texture_icon),u_gamma_scale:new c.aI(g,r.u_gamma_scale),u_device_pixel_ratio:new c.aI(g,r.u_device_pixel_ratio),u_is_halo:new c.aH(g,r.u_is_halo),u_translation:new c.aO(g,r.u_translation),u_pitched_scale:new c.aI(g,r.u_pitched_scale)}),background:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_opacity:new c.aI(g,r.u_opacity),u_color:new c.aL(g,r.u_color)}),backgroundPattern:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_opacity:new c.aI(g,r.u_opacity),u_image:new c.aH(g,r.u_image),u_pattern_tl_a:new c.aO(g,r.u_pattern_tl_a),u_pattern_br_a:new c.aO(g,r.u_pattern_br_a),u_pattern_tl_b:new c.aO(g,r.u_pattern_tl_b),u_pattern_br_b:new c.aO(g,r.u_pattern_br_b),u_texsize:new c.aO(g,r.u_texsize),u_mix:new c.aI(g,r.u_mix),u_pattern_size_a:new c.aO(g,r.u_pattern_size_a),u_pattern_size_b:new c.aO(g,r.u_pattern_size_b),u_scale_a:new c.aI(g,r.u_scale_a),u_scale_b:new c.aI(g,r.u_scale_b),u_pixel_coord_upper:new c.aO(g,r.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(g,r.u_pixel_coord_lower),u_tile_units_to_pixels:new c.aI(g,r.u_tile_units_to_pixels)}),terrain:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_texture:new c.aH(g,r.u_texture),u_ele_delta:new c.aI(g,r.u_ele_delta),u_fog_matrix:new c.aJ(g,r.u_fog_matrix),u_fog_color:new c.aL(g,r.u_fog_color),u_fog_ground_blend:new c.aI(g,r.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.aI(g,r.u_fog_ground_blend_opacity),u_horizon_color:new c.aL(g,r.u_horizon_color),u_horizon_fog_blend:new c.aI(g,r.u_horizon_fog_blend)}),terrainDepth:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_ele_delta:new c.aI(g,r.u_ele_delta)}),terrainCoords:(g,r)=>({u_matrix:new c.aJ(g,r.u_matrix),u_texture:new c.aH(g,r.u_texture),u_terrain_coords_id:new c.aI(g,r.u_terrain_coords_id),u_ele_delta:new c.aI(g,r.u_ele_delta)}),sky:(g,r)=>({u_sky_color:new c.aL(g,r.u_sky_color),u_horizon_color:new c.aL(g,r.u_horizon_color),u_horizon:new c.aI(g,r.u_horizon),u_sky_horizon_blend:new c.aI(g,r.u_sky_horizon_blend)})};class Hi{constructor(r,o,h){this.context=r;const d=r.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!h,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const zg={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class oh{constructor(r,o,h,d){this.length=o.length,this.attributes=h,this.itemSize=o.bytesPerElement,this.dynamicDraw=d,this.context=r;const m=r.gl;this.buffer=m.createBuffer(),r.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){if(r.length!==this.length)throw new Error(`Length of new data is ${r.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,o){for(let h=0;h<this.attributes.length;h++){const d=o.attributes[this.attributes[h].name];d!==void 0&&r.enableVertexAttribArray(d)}}setVertexAttribPointers(r,o,h){for(let d=0;d<this.attributes.length;d++){const m=this.attributes[d],b=o.attributes[m.name];b!==void 0&&r.vertexAttribPointer(b,m.components,r[zg[m.type]],!1,this.itemSize,m.offset+this.itemSize*(h||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ys=new WeakMap;function As(g){var r;if(Ys.has(g))return Ys.get(g);{const o=(r=g.getParameter(g.VERSION))===null||r===void 0?void 0:r.startsWith("WebGL 2.0");return Ys.set(g,o),o}}class Xt{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class fu extends Xt{getDefault(){return c.aM.transparent}set(r){const o=this.current;(r.r!==o.r||r.g!==o.g||r.b!==o.b||r.a!==o.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Dg extends Xt{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Fa extends Xt{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Lg extends Xt{getDefault(){return[!0,!0,!0,!0]}set(r){const o=this.current;(r[0]!==o[0]||r[1]!==o[1]||r[2]!==o[2]||r[3]!==o[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class zf extends Xt{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Rg extends Xt{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class Df extends Xt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const o=this.current;(r.func!==o.func||r.ref!==o.ref||r.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class lh extends Xt{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const o=this.current;(r[0]!==o[0]||r[1]!==o[1]||r[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class Lf extends Xt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;r?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=r,this.dirty=!1}}class Rf extends Xt{getDefault(){return[0,1]}set(r){const o=this.current;(r[0]!==o[0]||r[1]!==o[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class Ff extends Xt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;r?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=r,this.dirty=!1}}class Of extends Xt{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Qs extends Xt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;r?o.enable(o.BLEND):o.disable(o.BLEND),this.current=r,this.dirty=!1}}class Nf extends Xt{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const o=this.current;(r[0]!==o[0]||r[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class Fg extends Xt{getDefault(){return c.aM.transparent}set(r){const o=this.current;(r.r!==o.r||r.g!==o.g||r.b!==o.b||r.a!==o.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Bf extends Xt{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class Yo extends Xt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;r?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=r,this.dirty=!1}}class Og extends Xt{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class pu extends Xt{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class Ng extends Xt{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class Bg extends Xt{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class jf extends Xt{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const o=this.current;(r[0]!==o[0]||r[1]!==o[1]||r[2]!==o[2]||r[3]!==o[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Uf extends Xt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Vf extends Xt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class uh extends Xt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class $f extends Xt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class mu extends Xt{getDefault(){return null}set(r){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class us extends Xt{getDefault(){return null}set(r){var o;if(r===this.current&&!this.dirty)return;const h=this.gl;As(h)?h.bindVertexArray(r):(o=h.getExtension("OES_vertex_array_object"))===null||o===void 0||o.bindVertexArrayOES(r),this.current=r,this.dirty=!1}}class ch extends Xt{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class hh extends Xt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class dh extends Xt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class gu extends Xt{constructor(r,o){super(r),this.context=r,this.parent=o}getDefault(){return null}}class fh extends gu{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Js extends gu{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class ph extends gu{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class jg{constructor(r,o,h,d,m){this.context=r,this.width=o,this.height=h;const b=r.gl,k=this.framebuffer=b.createFramebuffer();if(this.colorAttachment=new fh(r,k),d)this.depthAttachment=m?new ph(r,k):new Js(r,k);else if(m)throw new Error("Stencil cannot be set without depth");if(b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const r=this.context.gl,o=this.colorAttachment.get();if(o&&r.deleteTexture(o),this.depthAttachment){const h=this.depthAttachment.get();h&&r.deleteRenderbuffer(h)}r.deleteFramebuffer(this.framebuffer)}}class Sr{constructor(r,o,h){this.blendFunction=r,this.blendColor=o,this.mask=h}}Sr.Replace=[1,0],Sr.disabled=new Sr(Sr.Replace,c.aM.transparent,[!1,!1,!1,!1]),Sr.unblended=new Sr(Sr.Replace,c.aM.transparent,[!0,!0,!0,!0]),Sr.alphaBlended=new Sr([1,771],c.aM.transparent,[!0,!0,!0,!0]);class Ug{constructor(r){var o,h;if(this.gl=r,this.clearColor=new fu(this),this.clearDepth=new Dg(this),this.clearStencil=new Fa(this),this.colorMask=new Lg(this),this.depthMask=new zf(this),this.stencilMask=new Rg(this),this.stencilFunc=new Df(this),this.stencilOp=new lh(this),this.stencilTest=new Lf(this),this.depthRange=new Rf(this),this.depthTest=new Ff(this),this.depthFunc=new Of(this),this.blend=new Qs(this),this.blendFunc=new Nf(this),this.blendColor=new Fg(this),this.blendEquation=new Bf(this),this.cullFace=new Yo(this),this.cullFaceSide=new Og(this),this.frontFace=new pu(this),this.program=new Ng(this),this.activeTexture=new Bg(this),this.viewport=new jf(this),this.bindFramebuffer=new Uf(this),this.bindRenderbuffer=new Vf(this),this.bindTexture=new uh(this),this.bindVertexBuffer=new $f(this),this.bindElementBuffer=new mu(this),this.bindVertexArray=new us(this),this.pixelStoreUnpack=new ch(this),this.pixelStoreUnpackPremultiplyAlpha=new hh(this),this.pixelStoreUnpackFlipY=new dh(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),As(r)){this.HALF_FLOAT=r.HALF_FLOAT;const d=r.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(o=r.RGBA16F)!==null&&o!==void 0?o:d==null?void 0:d.RGBA16F_EXT,this.RGB16F=(h=r.RGB16F)!==null&&h!==void 0?h:d==null?void 0:d.RGB16F_EXT,r.getExtension("EXT_color_buffer_float")}else{r.getExtension("EXT_color_buffer_half_float"),r.getExtension("OES_texture_half_float_linear");const d=r.getExtension("OES_texture_half_float");this.HALF_FLOAT=d==null?void 0:d.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,o){return new Hi(this,r,o)}createVertexBuffer(r,o,h){return new oh(this,r,o,h)}createRenderbuffer(r,o,h){const d=this.gl,m=d.createRenderbuffer();return this.bindRenderbuffer.set(m),d.renderbufferStorage(d.RENDERBUFFER,r,o,h),this.bindRenderbuffer.set(null),m}createFramebuffer(r,o,h,d){return new jg(this,r,o,h,d)}clear({color:r,depth:o,stencil:h}){const d=this.gl;let m=0;r&&(m|=d.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(m|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),h!==void 0&&(m|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(h),this.stencilMask.set(255)),d.clear(m)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){c.aE(r.blendFunction,Sr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}createVertexArray(){var r;return As(this.gl)?this.gl.createVertexArray():(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.createVertexArrayOES()}deleteVertexArray(r){var o;return As(this.gl)?this.gl.deleteVertexArray(r):(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.deleteVertexArrayOES(r)}unbindVAO(){this.bindVertexArray.set(null)}}class Et{constructor(r,o,h){this.func=r,this.mask=o,this.range=h}}Et.ReadOnly=!1,Et.ReadWrite=!0,Et.disabled=new Et(519,Et.ReadOnly,[0,1]);const yu=7680;class ar{constructor(r,o,h,d,m,b){this.test=r,this.ref=o,this.mask=h,this.fail=d,this.depthFail=m,this.pass=b}}ar.disabled=new ar({func:519,mask:0},0,0,yu,yu,yu);class tr{constructor(r,o,h){this.enable=r,this.mode=o,this.frontFace=h}}let ea;function Qo(g,r,o,h,d){const m=g.context,b=m.gl,k=g.useProgram("collisionBox"),T=[];let P=0,D=0;for(let se=0;se<h.length;se++){const le=h[se],K=r.getTile(le).getBucket(o);if(!K)continue;const de=d?K.textCollisionBox:K.iconCollisionBox,ye=K.collisionCircleArray;if(ye.length>0){const we=c.H();c.aQ(we,K.placementInvProjMatrix,g.transform.glCoordMatrix),c.aQ(we,we,K.placementViewportMatrix),T.push({circleArray:ye,circleOffset:D,transform:le.posMatrix,invTransform:we,coord:le}),P+=ye.length/4,D=P}de&&k.draw(m,b.LINES,Et.disabled,ar.disabled,g.colorModeForRenderPass(),tr.disabled,{u_matrix:le.posMatrix,u_pixel_extrude_scale:[1/(L=g.transform).width,1/L.height]},g.style.map.terrain&&g.style.map.terrain.getTerrainData(le),o.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,null,g.transform.zoom,null,null,de.collisionVertexBuffer)}var L;if(!d||!T.length)return;const U=g.useProgram("collisionCircle"),Z=new c.aR;Z.resize(4*P),Z._trim();let H=0;for(const se of T)for(let le=0;le<se.circleArray.length/4;le++){const K=4*le,de=se.circleArray[K+0],ye=se.circleArray[K+1],we=se.circleArray[K+2],Ee=se.circleArray[K+3];Z.emplace(H++,de,ye,we,Ee,0),Z.emplace(H++,de,ye,we,Ee,1),Z.emplace(H++,de,ye,we,Ee,2),Z.emplace(H++,de,ye,we,Ee,3)}(!ea||ea.length<2*P)&&(ea=function(se){const le=2*se,K=new c.aT;K.resize(le),K._trim();for(let de=0;de<le;de++){const ye=6*de;K.uint16[ye+0]=4*de+0,K.uint16[ye+1]=4*de+1,K.uint16[ye+2]=4*de+2,K.uint16[ye+3]=4*de+2,K.uint16[ye+4]=4*de+3,K.uint16[ye+5]=4*de+0}return K}(P));const ee=m.createIndexBuffer(ea,!0),ie=m.createVertexBuffer(Z,c.aS.members,!0);for(const se of T){const le=Ks(se.transform,se.invTransform,g.transform);U.draw(m,b.TRIANGLES,Et.disabled,ar.disabled,g.colorModeForRenderPass(),tr.disabled,le,g.style.map.terrain&&g.style.map.terrain.getTerrainData(se.coord),o.id,ie,ee,c.a0.simpleSegment(0,2*se.circleOffset,se.circleArray.length,se.circleArray.length/2),null,g.transform.zoom,null,null,null)}ie.destroy(),ee.destroy()}tr.disabled=new tr(!1,1029,2305),tr.backCCW=new tr(!0,1029,2305);const Jo=c.an(new Float32Array(16));function mh(g,r,o,h,d,m){const{horizontalAlign:b,verticalAlign:k}=c.au(g);return new c.P((-(b-.5)*r/d+h[0])*m,(-(k-.5)*o/d+h[1])*m)}function ta(g,r,o,h,d,m){const b=r.tileAnchorPoint.add(new c.P(r.translation[0],r.translation[1]));if(r.pitchWithMap){let k=h.mult(m);o||(k=k.rotate(-d));const T=b.add(k);return re(T.x,T.y,r.labelPlaneMatrix,r.getElevation).point}if(o){const k=Ce(r.tileAnchorPoint.x+1,r.tileAnchorPoint.y,r).point.sub(g),T=Math.atan(k.y/k.x)+(k.x<0?Math.PI:0);return g.add(h.rotate(T))}return g.add(h)}function Oa(g,r,o,h,d,m,b,k,T,P,D,L,U,Z){const H=g.text.placedSymbolArray,ee=g.text.dynamicLayoutVertexArray,ie=g.icon.dynamicLayoutVertexArray,se={};ee.clear();for(let le=0;le<H.length;le++){const K=H.get(le),de=K.hidden||!K.crossTileID||g.allowVerticalPlacement&&!K.placedOrientation?null:h[K.crossTileID];if(de){const ye=new c.P(K.anchorX,K.anchorY),we={getElevation:Z,width:d.width,height:d.height,labelPlaneMatrix:m,pitchWithMap:o,projection:D,tileAnchorPoint:ye,translation:L,unwrappedTileID:U},Ee=o?re(ye.x,ye.y,b,Z):Ce(ye.x,ye.y,we),Re=N(d.cameraToCenterDistance,Ee.signedDistanceFromCamera);let Ze=c.ai(g.textSizeData,T,K)*Re/c.ap;o&&(Ze*=g.tilePixelRatio/k);const{width:Xe,height:Ue,anchor:je,textOffset:rt,textBoxScale:wt}=de,$e=mh(je,Xe,Ue,rt,wt,Ze),Ge=D.getPitchedTextCorrection(d,ye.add(new c.P(L[0],L[1])),U),vt=ta(Ee.point,we,r,$e,d.angle,Ge),cr=g.allowVerticalPlacement&&K.placedOrientation===c.ah.vertical?Math.PI/2:0;for(let Ct=0;Ct<K.numGlyphs;Ct++)c.aj(ee,vt,cr);P&&K.associatedIconIndex>=0&&(se[K.associatedIconIndex]={shiftedAnchor:vt,angle:cr})}else pt(K.numGlyphs,ee)}if(P){ie.clear();const le=g.icon.placedSymbolArray;for(let K=0;K<le.length;K++){const de=le.get(K);if(de.hidden)pt(de.numGlyphs,ie);else{const ye=se[K];if(ye)for(let we=0;we<de.numGlyphs;we++)c.aj(ie,ye.shiftedAnchor,ye.angle);else pt(de.numGlyphs,ie)}}g.icon.dynamicLayoutVertexBuffer.updateData(ie)}g.text.dynamicLayoutVertexBuffer.updateData(ee)}function ai(g,r,o){return o.iconsInText&&r?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function gh(g,r,o,h,d,m,b,k,T,P,D,L){const U=g.context,Z=U.gl,H=g.transform,ee=Ws(),ie=k==="map",se=T==="map",le=k!=="viewport"&&o.layout.get("symbol-placement")!=="point",K=ie&&!se&&!le,de=!se&&le,ye=!o.layout.get("symbol-sort-key").isConstant();let we=!1;const Ee=g.depthModeForSublayer(0,Et.ReadOnly),Re=o._unevaluatedLayout.hasValue("text-variable-anchor")||o._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ze=[],Xe=ee.getCircleRadiusCorrection(H);for(const Ue of h){const je=r.getTile(Ue),rt=je.getBucket(o);if(!rt)continue;const wt=d?rt.text:rt.icon;if(!wt||!wt.segments.get().length||!wt.hasVisibleVertices)continue;const $e=wt.programConfigurations.get(o.id),Ge=d||rt.sdfIcons,vt=d?rt.textSizeData:rt.iconSizeData,cr=se||H.pitch!==0,Ct=g.useProgram(ai(Ge,d,rt),$e),zt=c.ag(vt,H.zoom),hr=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Ue);let sn,Mi,dr,zn,wn=[0,0],an=null;if(d)Mi=je.glyphAtlasTexture,dr=Z.LINEAR,sn=je.glyphAtlasTexture.size,rt.iconsInText&&(wn=je.imageAtlasTexture.size,an=je.imageAtlasTexture,zn=cr||g.options.rotating||g.options.zooming||vt.kind==="composite"||vt.kind==="camera"?Z.LINEAR:Z.NEAREST);else{const Ot=o.layout.get("icon-size").constantOr(0)!==1||rt.iconsNeedLinear;Mi=je.imageAtlasTexture,dr=Ge||g.options.rotating||g.options.zooming||Ot||cr?Z.LINEAR:Z.NEAREST,sn=je.imageAtlasTexture.size}const bn=At(je,1,g.transform.zoom),Xi=de?Ue.posMatrix:Jo,Qa=Es(Xi,se,ie,g.transform,bn),Fu=Zi(Xi,se,ie,g.transform,bn),Ja=Zi(Ue.posMatrix,se,ie,g.transform,bn),ui=ee.translatePosition(g.transform,je,m,b),Ou=Re&&rt.hasTextData(),Uh=o.layout.get("icon-text-fit")!=="none"&&Ou&&rt.hasIconData();if(le){const Ot=g.style.map.terrain?(eo,to)=>g.style.map.terrain.getElevation(Ue,eo,to):null,aa=o.layout.get("text-rotation-alignment")==="map";q(rt,Ue.posMatrix,g,d,Qa,Ja,se,P,aa,ee,Ue.toUnwrapped(),H.width,H.height,ui,Ot)}const ci=Ue.posMatrix,hi=d&&Re||Uh,zs=le||hi?Jo:Qa,Ii=Fu,Kr=Ge&&o.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let on;on=Ge?rt.iconsInText?ih(vt.kind,zt,K,se,le,hi,g,ci,zs,Ii,ui,sn,wn,Xe):Ko(vt.kind,zt,K,se,le,hi,g,ci,zs,Ii,ui,d,sn,!0,Xe):Af(vt.kind,zt,K,se,le,hi,g,ci,zs,Ii,ui,d,sn,Xe);const Kn={program:Ct,buffers:wt,uniformValues:on,atlasTexture:Mi,atlasTextureIcon:an,atlasInterpolation:dr,atlasInterpolationIcon:zn,isSDF:Ge,hasHalo:Kr};if(ye&&rt.canOverlap){we=!0;const Ot=wt.segments.get();for(const aa of Ot)Ze.push({segments:new c.a0([aa]),sortKey:aa.sortKey,state:Kn,terrainData:hr})}else Ze.push({segments:wt.segments,sortKey:0,state:Kn,terrainData:hr})}we&&Ze.sort((Ue,je)=>Ue.sortKey-je.sortKey);for(const Ue of Ze){const je=Ue.state;if(U.activeTexture.set(Z.TEXTURE0),je.atlasTexture.bind(je.atlasInterpolation,Z.CLAMP_TO_EDGE),je.atlasTextureIcon&&(U.activeTexture.set(Z.TEXTURE1),je.atlasTextureIcon&&je.atlasTextureIcon.bind(je.atlasInterpolationIcon,Z.CLAMP_TO_EDGE)),je.isSDF){const rt=je.uniformValues;je.hasHalo&&(rt.u_is_halo=1,yh(je.buffers,Ue.segments,o,g,je.program,Ee,D,L,rt,Ue.terrainData)),rt.u_is_halo=0}yh(je.buffers,Ue.segments,o,g,je.program,Ee,D,L,je.uniformValues,Ue.terrainData)}}function yh(g,r,o,h,d,m,b,k,T,P){const D=h.context;d.draw(D,D.gl.TRIANGLES,m,b,k,tr.disabled,T,P,o.id,g.layoutVertexBuffer,g.indexBuffer,r,o.paint,h.transform.zoom,g.programConfigurations.get(o.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function _h(g,r,o,h){const d=g.context,m=d.gl,b=ar.disabled,k=new Sr([m.ONE,m.ONE],c.aM.transparent,[!0,!0,!0,!0]),T=r.getBucket(o);if(!T)return;const P=h.key;let D=o.heatmapFbos.get(P);D||(D=el(d,r.tileSize,r.tileSize),o.heatmapFbos.set(P,D)),d.bindFramebuffer.set(D.framebuffer),d.viewport.set([0,0,r.tileSize,r.tileSize]),d.clear({color:c.aM.transparent});const L=T.programConfigurations.get(o.id),U=g.useProgram("heatmap",L),Z=g.style.map.terrain.getTerrainData(h);U.draw(d,m.TRIANGLES,Et.disabled,b,k,tr.disabled,An(h.posMatrix,r,g.transform.zoom,o.paint.get("heatmap-intensity")),Z,o.id,T.layoutVertexBuffer,T.indexBuffer,T.segments,o.paint,g.transform.zoom,L)}function ra(g,r,o){const h=g.context,d=h.gl;h.setColorMode(g.colorModeForRenderPass());const m=tl(h,r),b=o.key,k=r.heatmapFbos.get(b);k&&(h.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,k.colorAttachment.get()),h.activeTexture.set(d.TEXTURE1),m.bind(d.LINEAR,d.CLAMP_TO_EDGE),g.useProgram("heatmapTexture").draw(h,d.TRIANGLES,Et.disabled,ar.disabled,g.colorModeForRenderPass(),tr.disabled,uu(g,r,0,1),null,r.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments,r.paint,g.transform.zoom),k.destroy(),r.heatmapFbos.delete(b))}function el(g,r,o){var h,d;const m=g.gl,b=m.createTexture();m.bindTexture(m.TEXTURE_2D,b),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR);const k=(h=g.HALF_FLOAT)!==null&&h!==void 0?h:m.UNSIGNED_BYTE,T=(d=g.RGBA16F)!==null&&d!==void 0?d:m.RGBA;m.texImage2D(m.TEXTURE_2D,0,T,r,o,0,m.RGBA,k,null);const P=g.createFramebuffer(r,o,!1,!1);return P.colorAttachment.set(b),P}function tl(g,r){return r.colorRampTexture||(r.colorRampTexture=new ht(g,r.colorRamp,g.gl.RGBA)),r.colorRampTexture}function Na(g,r,o,h,d){if(!o||!h||!h.imageAtlas)return;const m=h.imageAtlas.patternPositions;let b=m[o.to.toString()],k=m[o.from.toString()];if(!b&&k&&(b=k),!k&&b&&(k=b),!b||!k){const T=d.getPaintProperty(r);b=m[T],k=m[T]}b&&k&&g.setConstantPatternPositions(b,k)}function rl(g,r,o,h,d,m,b){const k=g.context.gl,T="fill-pattern",P=o.paint.get(T),D=P&&P.constantOr(1),L=o.getCrossfadeParameters();let U,Z,H,ee,ie;b?(Z=D&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",U=k.LINES):(Z=D?"fillPattern":"fill",U=k.TRIANGLES);const se=P.constantOr(null);for(const le of h){const K=r.getTile(le);if(D&&!K.patternsLoaded())continue;const de=K.getBucket(o);if(!de)continue;const ye=de.programConfigurations.get(o.id),we=g.useProgram(Z,ye),Ee=g.style.map.terrain&&g.style.map.terrain.getTerrainData(le);D&&(g.context.activeTexture.set(k.TEXTURE0),K.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),ye.updatePaintBuffers(L)),Na(ye,T,se,K,o);const Re=Ee?le:null,Ze=g.translatePosMatrix(Re?Re.posMatrix:le.posMatrix,K,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(b){ee=de.indexBuffer2,ie=de.segments2;const Xe=[k.drawingBufferWidth,k.drawingBufferHeight];H=Z==="fillOutlinePattern"&&D?Mf(Ze,g,L,K,Xe):Mg(Ze,Xe)}else ee=de.indexBuffer,ie=de.segments,H=D?Cf(Ze,g,L,K):La(Ze);we.draw(g.context,U,d,g.stencilModeForClipping(le),m,tr.disabled,H,Ee,o.id,de.layoutVertexBuffer,ee,ie,o.paint,g.transform.zoom,ye)}}function _u(g,r,o,h,d,m,b){const k=g.context,T=k.gl,P="fill-extrusion-pattern",D=o.paint.get(P),L=D.constantOr(1),U=o.getCrossfadeParameters(),Z=o.paint.get("fill-extrusion-opacity"),H=D.constantOr(null);for(const ee of h){const ie=r.getTile(ee),se=ie.getBucket(o);if(!se)continue;const le=g.style.map.terrain&&g.style.map.terrain.getTerrainData(ee),K=se.programConfigurations.get(o.id),de=g.useProgram(L?"fillExtrusionPattern":"fillExtrusion",K);L&&(g.context.activeTexture.set(T.TEXTURE0),ie.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),K.updatePaintBuffers(U)),Na(K,P,H,ie,o);const ye=g.translatePosMatrix(ee.posMatrix,ie,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),we=o.paint.get("fill-extrusion-vertical-gradient"),Ee=L?lu(ye,g,we,Z,ee,U,ie):Wo(ye,g,we,Z);de.draw(k,k.gl.TRIANGLES,d,m,b,tr.backCCW,Ee,le,o.id,se.layoutVertexBuffer,se.indexBuffer,se.segments,o.paint,g.transform.zoom,K,g.style.map.terrain&&se.centroidVertexBuffer)}}function Ba(g,r,o,h,d,m,b){const k=g.context,T=k.gl,P=o.fbo;if(!P)return;const D=g.useProgram("hillshade"),L=g.style.map.terrain&&g.style.map.terrain.getTerrainData(r);k.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,P.colorAttachment.get()),D.draw(k,T.TRIANGLES,d,m,b,tr.disabled,((U,Z,H,ee)=>{const ie=H.paint.get("hillshade-shadow-color"),se=H.paint.get("hillshade-highlight-color"),le=H.paint.get("hillshade-accent-color");let K=H.paint.get("hillshade-illumination-direction")*(Math.PI/180);H.paint.get("hillshade-illumination-anchor")==="viewport"&&(K-=U.transform.angle);const de=!U.options.moving;return{u_matrix:ee?ee.posMatrix:U.transform.calculatePosMatrix(Z.tileID.toUnwrapped(),de),u_image:0,u_latrange:cu(0,Z.tileID),u_light:[H.paint.get("hillshade-exaggeration"),K],u_shadow:ie,u_highlight:se,u_accent:le}})(g,o,h,L?r:null),L,h.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments)}function ja(g,r,o,h,d,m){const b=g.context,k=b.gl,T=r.dem;if(T&&T.data){const P=T.dim,D=T.stride,L=T.getPixels();if(b.activeTexture.set(k.TEXTURE1),b.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||g.getTileTexture(D),r.demTexture){const Z=r.demTexture;Z.update(L,{premultiply:!1}),Z.bind(k.NEAREST,k.CLAMP_TO_EDGE)}else r.demTexture=new ht(b,L,k.RGBA,{premultiply:!1}),r.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);b.activeTexture.set(k.TEXTURE0);let U=r.fbo;if(!U){const Z=new ht(b,{width:P,height:P,data:null},k.RGBA);Z.bind(k.LINEAR,k.CLAMP_TO_EDGE),U=r.fbo=b.createFramebuffer(P,P,!0,!1),U.colorAttachment.set(Z.texture)}b.bindFramebuffer.set(U.framebuffer),b.viewport.set([0,0,P,P]),g.useProgram("hillshadePrepare").draw(b,k.TRIANGLES,h,d,m,tr.disabled,((Z,H)=>{const ee=H.stride,ie=c.H();return c.aP(ie,0,c.X,-c.X,0,0,1),c.J(ie,ie,[0,-c.X,0]),{u_matrix:ie,u_image:1,u_dimension:[ee,ee],u_zoom:Z.overscaledZ,u_unpack:H.getUnpackVector()}})(r.tileID,T),null,o.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function qf(g,r,o,h,d,m){const b=h.paint.get("raster-fade-duration");if(!m&&b>0){const k=z.now(),T=(k-g.timeAdded)/b,P=r?(k-r.timeAdded)/b:-1,D=o.getSource(),L=d.coveringZoomLevel({tileSize:D.tileSize,roundZoom:D.roundZoom}),U=!r||Math.abs(r.tileID.overscaledZ-L)>Math.abs(g.tileID.overscaledZ-L),Z=U&&g.refreshedUponExpiration?1:c.ac(U?T:1-P,0,1);return g.refreshedUponExpiration&&T>=1&&(g.refreshedUponExpiration=!1),r?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}const vh=new c.aM(1,0,0,1),Vt=new c.aM(0,1,0,1),vu=new c.aM(0,0,1,1),Vg=new c.aM(1,0,1,1),Zf=new c.aM(0,1,1,1);function Ua(g,r,o,h){xu(g,0,r+o/2,g.transform.width,o,h)}function Hf(g,r,o,h){xu(g,r-o/2,0,o,g.transform.height,h)}function xu(g,r,o,h,d,m){const b=g.context,k=b.gl;k.enable(k.SCISSOR_TEST),k.scissor(r*g.pixelRatio,o*g.pixelRatio,h*g.pixelRatio,d*g.pixelRatio),b.clear({color:m}),k.disable(k.SCISSOR_TEST)}function Gf(g,r,o){const h=g.context,d=h.gl,m=o.posMatrix,b=g.useProgram("debug"),k=Et.disabled,T=ar.disabled,P=g.colorModeForRenderPass(),D="$debug",L=g.style.map.terrain&&g.style.map.terrain.getTerrainData(o);h.activeTexture.set(d.TEXTURE0);const U=r.getTileByID(o.key).latestRawTileData,Z=Math.floor((U&&U.byteLength||0)/1024),H=r.getTile(o).tileSize,ee=512/Math.min(H,512)*(o.overscaledZ/g.transform.zoom)*.5;let ie=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(ie+=` => ${o.overscaledZ}`),function(se,le){se.initDebugOverlayCanvas();const K=se.debugOverlayCanvas,de=se.context.gl,ye=se.debugOverlayCanvas.getContext("2d");ye.clearRect(0,0,K.width,K.height),ye.shadowColor="white",ye.shadowBlur=2,ye.lineWidth=1.5,ye.strokeStyle="white",ye.textBaseline="top",ye.font="bold 36px Open Sans, sans-serif",ye.fillText(le,5,5),ye.strokeText(le,5,5),se.debugOverlayTexture.update(K),se.debugOverlayTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE)}(g,`${ie} ${Z}kB`),b.draw(h,d.TRIANGLES,k,T,Sr.alphaBlended,tr.disabled,Xo(m,c.aM.transparent,ee),null,D,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),b.draw(h,d.LINE_STRIP,k,T,P,tr.disabled,Xo(m,c.aM.red),L,D,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function Wf(g,r,o){const h=g.context,d=h.gl,m=g.colorModeForRenderPass(),b=new Et(d.LEQUAL,Et.ReadWrite,g.depthRangeFor3D),k=g.useProgram("terrain"),T=r.getTerrainMesh();h.bindFramebuffer.set(null),h.viewport.set([0,0,g.width,g.height]);for(const P of o){const D=g.renderToTexture.getTexture(P),L=r.getTerrainData(P.tileID);h.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,D.texture);const U=g.transform.calculatePosMatrix(P.tileID.toUnwrapped()),Z=r.getMeshFrameDelta(g.transform.zoom),H=g.transform.calculateFogMatrix(P.tileID.toUnwrapped()),ee=rh(U,Z,H,g.style.sky,g.transform.pitch);k.draw(h,d.TRIANGLES,b,ar.disabled,m,tr.backCCW,ee,L,"terrain",T.vertexBuffer,T.indexBuffer,T.segments)}}class wu{constructor(r,o,h){this.vertexBuffer=r,this.indexBuffer=o,this.segments=h}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class bu{constructor(r,o){this.context=new Ug(r),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=_t.maxUnderzooming+_t.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new eh}resize(r,o,h){if(this.width=Math.floor(r*h),this.height=Math.floor(o*h),this.pixelRatio=h,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const r=this.context,o=new c.aX;o.emplaceBack(0,0),o.emplaceBack(c.X,0),o.emplaceBack(0,c.X),o.emplaceBack(c.X,c.X),this.tileExtentBuffer=r.createVertexBuffer(o,Xs.members),this.tileExtentSegments=c.a0.simpleSegment(0,0,4,2);const h=new c.aX;h.emplaceBack(0,0),h.emplaceBack(c.X,0),h.emplaceBack(0,c.X),h.emplaceBack(c.X,c.X),this.debugBuffer=r.createVertexBuffer(h,Xs.members),this.debugSegments=c.a0.simpleSegment(0,0,4,5);const d=new c.$;d.emplaceBack(0,0,0,0),d.emplaceBack(c.X,0,c.X,0),d.emplaceBack(0,c.X,0,c.X),d.emplaceBack(c.X,c.X,c.X,c.X),this.rasterBoundsBuffer=r.createVertexBuffer(d,Ms.members),this.rasterBoundsSegments=c.a0.simpleSegment(0,0,4,2);const m=new c.aX;m.emplaceBack(0,0),m.emplaceBack(1,0),m.emplaceBack(0,1),m.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(m,Xs.members),this.viewportSegments=c.a0.simpleSegment(0,0,4,2);const b=new c.aZ;b.emplaceBack(0),b.emplaceBack(1),b.emplaceBack(3),b.emplaceBack(2),b.emplaceBack(0),this.tileBorderIndexBuffer=r.createIndexBuffer(b);const k=new c.aY;k.emplaceBack(0,1,2),k.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(k);const T=this.context.gl;this.stencilClearMode=new ar({func:T.ALWAYS,mask:0},0,255,T.ZERO,T.ZERO,T.ZERO)}clearStencil(){const r=this.context,o=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const h=c.H();c.aP(h,0,this.width,this.height,0,0,1),c.K(h,h,[o.drawingBufferWidth,o.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(r,o.TRIANGLES,Et.disabled,this.stencilClearMode,Sr.disabled,tr.disabled,Pn(h),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(r,o){if(this.currentStencilSource===r.source||!r.isTileClipped()||!o||!o.length)return;this.currentStencilSource=r.source;const h=this.context,d=h.gl;this.nextStencilID+o.length>256&&this.clearStencil(),h.setColorMode(Sr.disabled),h.setDepthMode(Et.disabled);const m=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const b of o){const k=this._tileClippingMaskIDs[b.key]=this.nextStencilID++,T=this.style.map.terrain&&this.style.map.terrain.getTerrainData(b);m.draw(h,d.TRIANGLES,Et.disabled,new ar({func:d.ALWAYS,mask:0},k,255,d.KEEP,d.KEEP,d.REPLACE),Sr.disabled,tr.disabled,Pn(b.posMatrix),T,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,o=this.context.gl;return new ar({func:o.NOTEQUAL,mask:255},r,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(r){const o=this.context.gl;return new ar({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,o.KEEP,o.KEEP,o.REPLACE)}stencilConfigForOverlap(r){const o=this.context.gl,h=r.sort((b,k)=>k.overscaledZ-b.overscaledZ),d=h[h.length-1].overscaledZ,m=h[0].overscaledZ-d+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const b={};for(let k=0;k<m;k++)b[k+d]=new ar({func:o.GEQUAL,mask:255},k+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=m,[b,h]}return[{[d]:ar.disabled},h]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Sr([r.CONSTANT_COLOR,r.ONE],new c.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Sr.unblended:Sr.alphaBlended}depthModeForSublayer(r,o,h){if(!this.opaquePassEnabledForLayer())return Et.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new Et(h||this.context.gl.LEQUAL,o,[d,d])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,o){this.style=r,this.options=o,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(z.now()),this.imageManager.beginFrame();const h=this.style._order,d=this.style.sourceCaches,m={},b={},k={};for(const T in d){const P=d[T];P.used&&P.prepare(this.context),m[T]=P.getVisibleCoordinates(),b[T]=m[T].slice().reverse(),k[T]=P.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let T=0;T<h.length;T++)if(this.style._layers[h[T]].is3D()){this.opaquePassCutoff=T;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const T of h){const P=this.style._layers[T];if(!P.hasOffscreenPass()||P.isHidden(this.transform.zoom))continue;const D=b[P.source];(P.type==="custom"||D.length)&&this.renderLayer(this,d[P.source],P,D)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?c.aM.black:c.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(T,P){const D=T.context,L=D.gl,U=((se,le,K)=>({u_sky_color:se.properties.get("sky-color"),u_horizon_color:se.properties.get("horizon-color"),u_horizon:(le.height/2+le.getHorizon())*K,u_sky_horizon_blend:se.properties.get("sky-horizon-blend")*le.height/2*K}))(P,T.style.map.transform,T.pixelRatio),Z=new Et(L.LEQUAL,Et.ReadWrite,[0,1]),H=ar.disabled,ee=T.colorModeForRenderPass(),ie=T.useProgram("sky");if(!P.mesh){const se=new c.aX;se.emplaceBack(-1,-1),se.emplaceBack(1,-1),se.emplaceBack(1,1),se.emplaceBack(-1,1);const le=new c.aY;le.emplaceBack(0,1,2),le.emplaceBack(0,2,3),P.mesh=new wu(D.createVertexBuffer(se,Xs.members),D.createIndexBuffer(le),c.a0.simpleSegment(0,0,se.length,le.length))}ie.draw(D,L.TRIANGLES,Z,H,ee,tr.disabled,U,void 0,"sky",P.mesh.vertexBuffer,P.mesh.indexBuffer,P.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(r._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=h.length-1;this.currentLayer>=0;this.currentLayer--){const T=this.style._layers[h[this.currentLayer]],P=d[T.source],D=m[T.source];this._renderTileClippingMasks(T,D),this.renderLayer(this,P,T,D)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<h.length;this.currentLayer++){const T=this.style._layers[h[this.currentLayer]],P=d[T.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(T))continue;const D=(T.type==="symbol"?k:b)[T.source];this._renderTileClippingMasks(T,m[T.source]),this.renderLayer(this,P,T,D)}if(this.options.showTileBoundaries){const T=function(P,D){let L=null;const U=Object.values(P._layers).flatMap(ie=>ie.source&&!ie.isHidden(D)?[P.sourceCaches[ie.source]]:[]),Z=U.filter(ie=>ie.getSource().type==="vector"),H=U.filter(ie=>ie.getSource().type!=="vector"),ee=ie=>{(!L||L.getSource().maxzoom<ie.getSource().maxzoom)&&(L=ie)};return Z.forEach(ie=>ee(ie)),L||H.forEach(ie=>ee(ie)),L}(this.style,this.transform.zoom);T&&function(P,D,L){for(let U=0;U<L.length;U++)Gf(P,D,L[U])}(this,T,T.getVisibleCoordinates())}this.options.showPadding&&function(T){const P=T.transform.padding;Ua(T,T.transform.height-(P.top||0),3,vh),Ua(T,P.bottom||0,3,Vt),Hf(T,P.left||0,3,vu),Hf(T,T.transform.width-(P.right||0),3,Vg);const D=T.transform.centerPoint;(function(L,U,Z,H){xu(L,U-1,Z-10,2,20,H),xu(L,U-10,Z-1,20,2,H)})(T,D.x,T.transform.height-D.y,Zf)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(r){if(!this.style||!this.style.map||!this.style.map.terrain)return;const o=this.terrainFacilitator.matrix,h=this.transform.modelViewProjectionMatrix;let d=this.terrainFacilitator.dirty;d||(d=r?!c.a_(o,h):!c.a$(o,h)),d||(d=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),d&&(c.b0(o,h),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(m,b){const k=m.context,T=k.gl,P=Sr.unblended,D=new Et(T.LEQUAL,Et.ReadWrite,[0,1]),L=b.getTerrainMesh(),U=b.sourceCache.getRenderableTiles(),Z=m.useProgram("terrainDepth");k.bindFramebuffer.set(b.getFramebuffer("depth").framebuffer),k.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),k.clear({color:c.aM.transparent,depth:1});for(const H of U){const ee=b.getTerrainData(H.tileID),ie={u_matrix:m.transform.calculatePosMatrix(H.tileID.toUnwrapped()),u_ele_delta:b.getMeshFrameDelta(m.transform.zoom)};Z.draw(k,T.TRIANGLES,D,ar.disabled,P,tr.backCCW,ie,ee,"terrain",L.vertexBuffer,L.indexBuffer,L.segments)}k.bindFramebuffer.set(null),k.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain),function(m,b){const k=m.context,T=k.gl,P=Sr.unblended,D=new Et(T.LEQUAL,Et.ReadWrite,[0,1]),L=b.getTerrainMesh(),U=b.getCoordsTexture(),Z=b.sourceCache.getRenderableTiles(),H=m.useProgram("terrainCoords");k.bindFramebuffer.set(b.getFramebuffer("coords").framebuffer),k.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),k.clear({color:c.aM.transparent,depth:1}),b.coordsIndex=[];for(const ee of Z){const ie=b.getTerrainData(ee.tileID);k.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,U.texture);const se={u_matrix:m.transform.calculatePosMatrix(ee.tileID.toUnwrapped()),u_terrain_coords_id:(255-b.coordsIndex.length)/255,u_texture:0,u_ele_delta:b.getMeshFrameDelta(m.transform.zoom)};H.draw(k,T.TRIANGLES,D,ar.disabled,P,tr.backCCW,se,ie,"terrain",L.vertexBuffer,L.indexBuffer,L.segments),b.coordsIndex.push(ee.tileID.key)}k.bindFramebuffer.set(null),k.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain))}renderLayer(r,o,h,d){if(!h.isHidden(this.transform.zoom)&&(h.type==="background"||h.type==="custom"||(d||[]).length))switch(this.id=h.id,h.type){case"symbol":(function(m,b,k,T,P){if(m.renderPass!=="translucent")return;const D=ar.disabled,L=m.colorModeForRenderPass();(k._unevaluatedLayout.hasValue("text-variable-anchor")||k._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(U,Z,H,ee,ie,se,le,K,de){const ye=Z.transform,we=Ws(),Ee=ie==="map",Re=se==="map";for(const Ze of U){const Xe=ee.getTile(Ze),Ue=Xe.getBucket(H);if(!Ue||!Ue.text||!Ue.text.segments.get().length)continue;const je=c.ag(Ue.textSizeData,ye.zoom),rt=At(Xe,1,Z.transform.zoom),wt=Es(Ze.posMatrix,Re,Ee,Z.transform,rt),$e=H.layout.get("icon-text-fit")!=="none"&&Ue.hasIconData();if(je){const Ge=Math.pow(2,ye.zoom-Xe.tileID.overscaledZ),vt=Z.style.map.terrain?(Ct,zt)=>Z.style.map.terrain.getElevation(Ze,Ct,zt):null,cr=we.translatePosition(ye,Xe,le,K);Oa(Ue,Ee,Re,de,ye,wt,Ze.posMatrix,Ge,je,$e,we,cr,Ze.toUnwrapped(),vt)}}}(T,m,k,b,k.layout.get("text-rotation-alignment"),k.layout.get("text-pitch-alignment"),k.paint.get("text-translate"),k.paint.get("text-translate-anchor"),P),k.paint.get("icon-opacity").constantOr(1)!==0&&gh(m,b,k,T,!1,k.paint.get("icon-translate"),k.paint.get("icon-translate-anchor"),k.layout.get("icon-rotation-alignment"),k.layout.get("icon-pitch-alignment"),k.layout.get("icon-keep-upright"),D,L),k.paint.get("text-opacity").constantOr(1)!==0&&gh(m,b,k,T,!0,k.paint.get("text-translate"),k.paint.get("text-translate-anchor"),k.layout.get("text-rotation-alignment"),k.layout.get("text-pitch-alignment"),k.layout.get("text-keep-upright"),D,L),b.map.showCollisionBoxes&&(Qo(m,b,k,T,!0),Qo(m,b,k,T,!1))})(r,o,h,d,this.style.placement.variableOffsets);break;case"circle":(function(m,b,k,T){if(m.renderPass!=="translucent")return;const P=k.paint.get("circle-opacity"),D=k.paint.get("circle-stroke-width"),L=k.paint.get("circle-stroke-opacity"),U=!k.layout.get("circle-sort-key").isConstant();if(P.constantOr(1)===0&&(D.constantOr(1)===0||L.constantOr(1)===0))return;const Z=m.context,H=Z.gl,ee=m.depthModeForSublayer(0,Et.ReadOnly),ie=ar.disabled,se=m.colorModeForRenderPass(),le=[];for(let K=0;K<T.length;K++){const de=T[K],ye=b.getTile(de),we=ye.getBucket(k);if(!we)continue;const Ee=we.programConfigurations.get(k.id),Re=m.useProgram("circle",Ee),Ze=we.layoutVertexBuffer,Xe=we.indexBuffer,Ue=m.style.map.terrain&&m.style.map.terrain.getTerrainData(de),je={programConfiguration:Ee,program:Re,layoutVertexBuffer:Ze,indexBuffer:Xe,uniformValues:Ig(m,de,ye,k),terrainData:Ue};if(U){const rt=we.segments.get();for(const wt of rt)le.push({segments:new c.a0([wt]),sortKey:wt.sortKey,state:je})}else le.push({segments:we.segments,sortKey:0,state:je})}U&&le.sort((K,de)=>K.sortKey-de.sortKey);for(const K of le){const{programConfiguration:de,program:ye,layoutVertexBuffer:we,indexBuffer:Ee,uniformValues:Re,terrainData:Ze}=K.state;ye.draw(Z,H.TRIANGLES,ee,ie,se,tr.disabled,Re,Ze,k.id,we,Ee,K.segments,k.paint,m.transform.zoom,de)}})(r,o,h,d);break;case"heatmap":(function(m,b,k,T){if(k.paint.get("heatmap-opacity")===0)return;const P=m.context;if(m.style.map.terrain){for(const D of T){const L=b.getTile(D);b.hasRenderableParent(D)||(m.renderPass==="offscreen"?_h(m,L,k,D):m.renderPass==="translucent"&&ra(m,k,D))}P.viewport.set([0,0,m.width,m.height])}else m.renderPass==="offscreen"?function(D,L,U,Z){const H=D.context,ee=H.gl,ie=ar.disabled,se=new Sr([ee.ONE,ee.ONE],c.aM.transparent,[!0,!0,!0,!0]);(function(le,K,de){const ye=le.gl;le.activeTexture.set(ye.TEXTURE1),le.viewport.set([0,0,K.width/4,K.height/4]);let we=de.heatmapFbos.get(c.aU);we?(ye.bindTexture(ye.TEXTURE_2D,we.colorAttachment.get()),le.bindFramebuffer.set(we.framebuffer)):(we=el(le,K.width/4,K.height/4),de.heatmapFbos.set(c.aU,we))})(H,D,U),H.clear({color:c.aM.transparent});for(let le=0;le<Z.length;le++){const K=Z[le];if(L.hasRenderableParent(K))continue;const de=L.getTile(K),ye=de.getBucket(U);if(!ye)continue;const we=ye.programConfigurations.get(U.id),Ee=D.useProgram("heatmap",we),{zoom:Re}=D.transform;Ee.draw(H,ee.TRIANGLES,Et.disabled,ie,se,tr.disabled,An(K.posMatrix,de,Re,U.paint.get("heatmap-intensity")),null,U.id,ye.layoutVertexBuffer,ye.indexBuffer,ye.segments,U.paint,D.transform.zoom,we)}H.viewport.set([0,0,D.width,D.height])}(m,b,k,T):m.renderPass==="translucent"&&function(D,L){const U=D.context,Z=U.gl;U.setColorMode(D.colorModeForRenderPass());const H=L.heatmapFbos.get(c.aU);H&&(U.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,H.colorAttachment.get()),U.activeTexture.set(Z.TEXTURE1),tl(U,L).bind(Z.LINEAR,Z.CLAMP_TO_EDGE),D.useProgram("heatmapTexture").draw(U,Z.TRIANGLES,Et.disabled,ar.disabled,D.colorModeForRenderPass(),tr.disabled,uu(D,L,0,1),null,L.id,D.viewportBuffer,D.quadTriangleIndexBuffer,D.viewportSegments,L.paint,D.transform.zoom))}(m,k)})(r,o,h,d);break;case"line":(function(m,b,k,T){if(m.renderPass!=="translucent")return;const P=k.paint.get("line-opacity"),D=k.paint.get("line-width");if(P.constantOr(1)===0||D.constantOr(1)===0)return;const L=m.depthModeForSublayer(0,Et.ReadOnly),U=m.colorModeForRenderPass(),Z=k.paint.get("line-dasharray"),H=k.paint.get("line-pattern"),ee=H.constantOr(1),ie=k.paint.get("line-gradient"),se=k.getCrossfadeParameters(),le=ee?"linePattern":Z?"lineSDF":ie?"lineGradient":"line",K=m.context,de=K.gl;let ye=!0;for(const we of T){const Ee=b.getTile(we);if(ee&&!Ee.patternsLoaded())continue;const Re=Ee.getBucket(k);if(!Re)continue;const Ze=Re.programConfigurations.get(k.id),Xe=m.context.program.get(),Ue=m.useProgram(le,Ze),je=ye||Ue.program!==Xe,rt=m.style.map.terrain&&m.style.map.terrain.getTerrainData(we),wt=H.constantOr(null);if(wt&&Ee.imageAtlas){const vt=Ee.imageAtlas,cr=vt.patternPositions[wt.to.toString()],Ct=vt.patternPositions[wt.from.toString()];cr&&Ct&&Ze.setConstantPatternPositions(cr,Ct)}const $e=rt?we:null,Ge=ee?Ra(m,Ee,k,se,$e):Z?Eg(m,Ee,k,Z,se,$e):ie?If(m,Ee,k,Re.lineClipsArray.length,$e):hu(m,Ee,k,$e);if(ee)K.activeTexture.set(de.TEXTURE0),Ee.imageAtlasTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE),Ze.updatePaintBuffers(se);else if(Z&&(je||m.lineAtlas.dirty))K.activeTexture.set(de.TEXTURE0),m.lineAtlas.bind(K);else if(ie){const vt=Re.gradients[k.id];let cr=vt.texture;if(k.gradientVersion!==vt.version){let Ct=256;if(k.stepInterpolant){const zt=b.getSource().maxzoom,hr=we.canonical.z===zt?Math.ceil(1<<m.transform.maxZoom-we.canonical.z):1;Ct=c.ac(c.aV(Re.maxLineLength/c.X*1024*hr),256,K.maxTextureSize)}vt.gradient=c.aW({expression:k.gradientExpression(),evaluationKey:"lineProgress",resolution:Ct,image:vt.gradient||void 0,clips:Re.lineClipsArray}),vt.texture?vt.texture.update(vt.gradient):vt.texture=new ht(K,vt.gradient,de.RGBA),vt.version=k.gradientVersion,cr=vt.texture}K.activeTexture.set(de.TEXTURE0),cr.bind(k.stepInterpolant?de.NEAREST:de.LINEAR,de.CLAMP_TO_EDGE)}Ue.draw(K,de.TRIANGLES,L,m.stencilModeForClipping(we),U,tr.disabled,Ge,rt,k.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,k.paint,m.transform.zoom,Ze,Re.layoutVertexBuffer2),ye=!1}})(r,o,h,d);break;case"fill":(function(m,b,k,T){const P=k.paint.get("fill-color"),D=k.paint.get("fill-opacity");if(D.constantOr(1)===0)return;const L=m.colorModeForRenderPass(),U=k.paint.get("fill-pattern"),Z=m.opaquePassEnabledForLayer()&&!U.constantOr(1)&&P.constantOr(c.aM.transparent).a===1&&D.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===Z){const H=m.depthModeForSublayer(1,m.renderPass==="opaque"?Et.ReadWrite:Et.ReadOnly);rl(m,b,k,T,H,L,!1)}if(m.renderPass==="translucent"&&k.paint.get("fill-antialias")){const H=m.depthModeForSublayer(k.getPaintProperty("fill-outline-color")?2:0,Et.ReadOnly);rl(m,b,k,T,H,L,!0)}})(r,o,h,d);break;case"fill-extrusion":(function(m,b,k,T){const P=k.paint.get("fill-extrusion-opacity");if(P!==0&&m.renderPass==="translucent"){const D=new Et(m.context.gl.LEQUAL,Et.ReadWrite,m.depthRangeFor3D);if(P!==1||k.paint.get("fill-extrusion-pattern").constantOr(1))_u(m,b,k,T,D,ar.disabled,Sr.disabled),_u(m,b,k,T,D,m.stencilModeFor3D(),m.colorModeForRenderPass());else{const L=m.colorModeForRenderPass();_u(m,b,k,T,D,ar.disabled,L)}}})(r,o,h,d);break;case"hillshade":(function(m,b,k,T){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const P=m.context,D=m.depthModeForSublayer(0,Et.ReadOnly),L=m.colorModeForRenderPass(),[U,Z]=m.renderPass==="translucent"?m.stencilConfigForOverlap(T):[{},T];for(const H of Z){const ee=b.getTile(H);ee.needsHillshadePrepare!==void 0&&ee.needsHillshadePrepare&&m.renderPass==="offscreen"?ja(m,ee,k,D,ar.disabled,L):m.renderPass==="translucent"&&Ba(m,H,ee,k,D,U[H.overscaledZ],L)}P.viewport.set([0,0,m.width,m.height])})(r,o,h,d);break;case"raster":(function(m,b,k,T){if(m.renderPass!=="translucent"||k.paint.get("raster-opacity")===0||!T.length)return;const P=m.context,D=P.gl,L=b.getSource(),U=m.useProgram("raster"),Z=m.colorModeForRenderPass(),[H,ee]=L instanceof os?[{},T]:m.stencilConfigForOverlap(T),ie=ee[ee.length-1].overscaledZ,se=!m.options.moving;for(const le of ee){const K=m.depthModeForSublayer(le.overscaledZ-ie,k.paint.get("raster-opacity")===1?Et.ReadWrite:Et.ReadOnly,D.LESS),de=b.getTile(le);de.registerFadeDuration(k.paint.get("raster-fade-duration"));const ye=b.findLoadedParent(le,0),we=b.findLoadedSibling(le),Ee=qf(de,ye||we||null,b,k,m.transform,m.style.map.terrain);let Re,Ze;const Xe=k.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;P.activeTexture.set(D.TEXTURE0),de.texture.bind(Xe,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),P.activeTexture.set(D.TEXTURE1),ye?(ye.texture.bind(Xe,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),Re=Math.pow(2,ye.tileID.overscaledZ-de.tileID.overscaledZ),Ze=[de.tileID.canonical.x*Re%1,de.tileID.canonical.y*Re%1]):de.texture.bind(Xe,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),de.texture.useMipmap&&P.extTextureFilterAnisotropic&&m.transform.pitch>20&&D.texParameterf(D.TEXTURE_2D,P.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,P.extTextureFilterAnisotropicMax);const Ue=m.style.map.terrain&&m.style.map.terrain.getTerrainData(le),je=Ue?le:null,rt=je?je.posMatrix:m.transform.calculatePosMatrix(le.toUnwrapped(),se),wt=Pg(rt,Ze||[0,0],Re||1,Ee,k);L instanceof os?U.draw(P,D.TRIANGLES,K,ar.disabled,Z,tr.disabled,wt,Ue,k.id,L.boundsBuffer,m.quadTriangleIndexBuffer,L.boundsSegments):U.draw(P,D.TRIANGLES,K,H[le.overscaledZ],Z,tr.disabled,wt,Ue,k.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}})(r,o,h,d);break;case"background":(function(m,b,k,T){const P=k.paint.get("background-color"),D=k.paint.get("background-opacity");if(D===0)return;const L=m.context,U=L.gl,Z=m.transform,H=Z.tileSize,ee=k.paint.get("background-pattern");if(m.isPatternMissing(ee))return;const ie=!ee&&P.a===1&&D===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==ie)return;const se=ar.disabled,le=m.depthModeForSublayer(0,ie==="opaque"?Et.ReadWrite:Et.ReadOnly),K=m.colorModeForRenderPass(),de=m.useProgram(ee?"backgroundPattern":"background"),ye=T||Z.coveringTiles({tileSize:H,terrain:m.style.map.terrain});ee&&(L.activeTexture.set(U.TEXTURE0),m.imageManager.bind(m.context));const we=k.getCrossfadeParameters();for(const Ee of ye){const Re=T?Ee.posMatrix:m.transform.calculatePosMatrix(Ee.toUnwrapped()),Ze=ee?sh(Re,D,m,ee,{tileID:Ee,tileSize:H},we):du(Re,D,P),Xe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Ee);de.draw(L,U.TRIANGLES,le,se,K,tr.disabled,Ze,Xe,k.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}})(r,0,h,d);break;case"custom":(function(m,b,k){const T=m.context,P=k.implementation;if(m.renderPass==="offscreen"){const D=P.prerender;D&&(m.setCustomLayerDefaults(),T.setColorMode(m.colorModeForRenderPass()),D.call(P,T.gl,m.transform.customLayerMatrix()),T.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),T.setColorMode(m.colorModeForRenderPass()),T.setStencilMode(ar.disabled);const D=P.renderingMode==="3d"?new Et(m.context.gl.LEQUAL,Et.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,Et.ReadOnly);T.setDepthMode(D),P.render(T.gl,m.transform.customLayerMatrix(),{farZ:m.transform.farZ,nearZ:m.transform.nearZ,fov:m.transform._fov,modelViewProjectionMatrix:m.transform.modelViewProjectionMatrix,projectionMatrix:m.transform.projectionMatrix}),T.setDirty(),m.setBaseState(),T.bindFramebuffer.set(null)}})(r,0,h)}}translatePosMatrix(r,o,h,d,m){if(!h[0]&&!h[1])return r;const b=m?d==="map"?this.transform.angle:0:d==="viewport"?-this.transform.angle:0;if(b){const P=Math.sin(b),D=Math.cos(b);h=[h[0]*D-h[1]*P,h[0]*P+h[1]*D]}const k=[m?h[0]:At(o,h[0],this.transform.zoom),m?h[1]:At(o,h[1],this.transform.zoom),0],T=new Float32Array(16);return c.J(T,r,k),T}saveTileTexture(r){const o=this._tileTextures[r.size[0]];o?o.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const o=this._tileTextures[r];return o&&o.length>0?o.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const o=this.imageManager.getPattern(r.from.toString()),h=this.imageManager.getPattern(r.to.toString());return!o||!h}useProgram(r,o){this.cache=this.cache||{};const h=r+(o?o.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[h]||(this.cache[h]=new nh(this.context,Ps[r],o,ah[r],this._showOverdrawInspector,this.style.map.terrain)),this.cache[h]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ht(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:r,drawingBufferHeight:o}=this.context.gl;return this.width!==r||this.height!==o}}class Va{constructor(r,o){this.points=r,this.planes=o}static fromInvProjectionMatrix(r,o,h){const d=Math.pow(2,h),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(k=>{const T=1/(k=c.af([],k,r))[3]/o*d;return c.b1(k,k,[T,T,1/k[3],T])}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(k=>{const T=function(U,Z){var H=Z[0],ee=Z[1],ie=Z[2],se=H*H+ee*ee+ie*ie;return se>0&&(se=1/Math.sqrt(se)),U[0]=Z[0]*se,U[1]=Z[1]*se,U[2]=Z[2]*se,U}([],function(U,Z,H){var ee=Z[0],ie=Z[1],se=Z[2],le=H[0],K=H[1],de=H[2];return U[0]=ie*de-se*K,U[1]=se*le-ee*de,U[2]=ee*K-ie*le,U}([],ze([],m[k[0]],m[k[1]]),ze([],m[k[2]],m[k[1]]))),P=-((D=T)[0]*(L=m[k[1]])[0]+D[1]*L[1]+D[2]*L[2]);var D,L;return T.concat(P)});return new Va(m,b)}}class $a{constructor(r,o){this.min=r,this.max=o,this.center=function(h,d,m){return h[0]=.5*d[0],h[1]=.5*d[1],h[2]=.5*d[2],h}([],function(h,d,m){return h[0]=d[0]+m[0],h[1]=d[1]+m[1],h[2]=d[2]+m[2],h}([],this.min,this.max))}quadrant(r){const o=[r%2==0,r<2],h=Me(this.min),d=Me(this.max);for(let m=0;m<o.length;m++)h[m]=o[m]?this.min[m]:this.center[m],d[m]=o[m]?this.center[m]:this.max[m];return d[2]=this.max[2],new $a(h,d)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}intersects(r){const o=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let h=!0;for(let d=0;d<r.planes.length;d++){const m=r.planes[d];let b=0;for(let k=0;k<o.length;k++)c.b2(m,o[k])>=0&&b++;if(b===0)return 0;b!==o.length&&(h=!1)}if(h)return 2;for(let d=0;d<3;d++){let m=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(let k=0;k<r.points.length;k++){const T=r.points[k][d]-this.min[d];m=Math.min(m,T),b=Math.max(b,T)}if(b<0||m>this.max[d]-this.min[d])return 0}return 1}}class qa{constructor(r=0,o=0,h=0,d=0){if(isNaN(r)||r<0||isNaN(o)||o<0||isNaN(h)||h<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=o,this.left=h,this.right=d}interpolate(r,o,h){return o.top!=null&&r.top!=null&&(this.top=c.y.number(r.top,o.top,h)),o.bottom!=null&&r.bottom!=null&&(this.bottom=c.y.number(r.bottom,o.bottom,h)),o.left!=null&&r.left!=null&&(this.left=c.y.number(r.left,o.left,h)),o.right!=null&&r.right!=null&&(this.right=c.y.number(r.right,o.right,h)),this}getCenter(r,o){const h=c.ac((this.left+r-this.right)/2,0,r),d=c.ac((this.top+o-this.bottom)/2,0,o);return new c.P(h,d)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new qa(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const xh=85.051129;class Za{constructor(r,o,h,d,m){this.tileSize=512,this._renderWorldCopies=m===void 0||!!m,this._minZoom=r||0,this._maxZoom=o||22,this._minPitch=h??0,this._maxPitch=d??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new qa,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const r=new Za(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r.apply(this),r}apply(r){this.tileSize=r.tileSize,this.latRange=r.latRange,this.lngRange=r.lngRange,this.width=r.width,this.height=r.height,this._center=r._center,this._elevation=r._elevation,this.minElevationForCurrentTile=r.minElevationForCurrentTile,this.zoom=r.zoom,this.angle=r.angle,this._fov=r._fov,this._pitch=r._pitch,this._unmodified=r._unmodified,this._edgeInsets=r._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(r){const o=-c.b3(r,-180,180)*Math.PI/180;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=function(){var h=new c.A(4);return c.A!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h}(),function(h,d,m){var b=d[0],k=d[1],T=d[2],P=d[3],D=Math.sin(m),L=Math.cos(m);h[0]=b*L+T*D,h[1]=k*L+P*D,h[2]=b*-D+T*L,h[3]=k*-D+P*L}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const o=c.ac(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(r){const o=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this.tileZoom=Math.max(0,Math.floor(o)),this.scale=this.zoomScale(o),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(r){r!==this._elevation&&(this._elevation=r,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,o,h){this._unmodified=!1,this._edgeInsets.interpolate(r,o,h),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const o=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,o)}getVisibleUnwrappedCoordinates(r){const o=[new c.b4(0,r)];if(this._renderWorldCopies){const h=this.pointCoordinate(new c.P(0,0)),d=this.pointCoordinate(new c.P(this.width,0)),m=this.pointCoordinate(new c.P(this.width,this.height)),b=this.pointCoordinate(new c.P(0,this.height)),k=Math.floor(Math.min(h.x,d.x,m.x,b.x)),T=Math.floor(Math.max(h.x,d.x,m.x,b.x)),P=1;for(let D=k-P;D<=T+P;D++)D!==0&&o.push(new c.b4(D,r))}return o}coveringTiles(r){var o,h;let d=this.coveringZoomLevel(r);const m=d;if(r.minzoom!==void 0&&d<r.minzoom)return[];r.maxzoom!==void 0&&d>r.maxzoom&&(d=r.maxzoom);const b=this.pointCoordinate(this.getCameraPoint()),k=c.Z.fromLngLat(this.center),T=Math.pow(2,d),P=[T*b.x,T*b.y,0],D=[T*k.x,T*k.y,0],L=Va.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,d);let U=r.minzoom||0;!r.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(U=d);const Z=r.terrain?2/Math.min(this.tileSize,r.tileSize)*this.tileSize:3,H=K=>({aabb:new $a([K*T,0,0],[(K+1)*T,T,0]),zoom:0,x:0,y:0,wrap:K,fullyVisible:!1}),ee=[],ie=[],se=d,le=r.reparseOverscaled?m:d;if(this._renderWorldCopies)for(let K=1;K<=3;K++)ee.push(H(-K)),ee.push(H(K));for(ee.push(H(0));ee.length>0;){const K=ee.pop(),de=K.x,ye=K.y;let we=K.fullyVisible;if(!we){const Ue=K.aabb.intersects(L);if(Ue===0)continue;we=Ue===2}const Ee=r.terrain?P:D,Re=K.aabb.distanceX(Ee),Ze=K.aabb.distanceY(Ee),Xe=Math.max(Math.abs(Re),Math.abs(Ze));if(K.zoom===se||Xe>Z+(1<<se-K.zoom)-2&&K.zoom>=U){const Ue=se-K.zoom,je=P[0]-.5-(de<<Ue),rt=P[1]-.5-(ye<<Ue);ie.push({tileID:new c.S(K.zoom===se?le:K.zoom,K.wrap,K.zoom,de,ye),distanceSq:Fe([D[0]-.5-de,D[1]-.5-ye]),tileDistanceToCamera:Math.sqrt(je*je+rt*rt)})}else for(let Ue=0;Ue<4;Ue++){const je=(de<<1)+Ue%2,rt=(ye<<1)+(Ue>>1),wt=K.zoom+1;let $e=K.aabb.quadrant(Ue);if(r.terrain){const Ge=new c.S(wt,K.wrap,wt,je,rt),vt=r.terrain.getMinMaxElevation(Ge),cr=(o=vt.minElevation)!==null&&o!==void 0?o:this.elevation,Ct=(h=vt.maxElevation)!==null&&h!==void 0?h:this.elevation;$e=new $a([$e.min[0],$e.min[1],cr],[$e.max[0],$e.max[1],Ct])}ee.push({aabb:$e,zoom:wt,x:je,y:rt,wrap:K.wrap,fullyVisible:we})}}return ie.sort((K,de)=>K.distanceSq-de.distanceSq).map(K=>K.tileID)}resize(r,o){this.width=r,this.height=o,this.pixelsToGLUnits=[2/r,-2/o],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const o=c.ac(r.lat,-85.051129,xh);return new c.P(c.O(r.lng)*this.worldSize,c.Q(o)*this.worldSize)}unproject(r){return new c.Z(r.x/this.worldSize,r.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(r){const o=this.elevation,h=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,d=this.pointLocation(this.centerPoint,r),m=r.getElevationForLngLatZoom(d,this.tileZoom);if(!(this.elevation-m))return;const b=h+o-m,k=Math.cos(this._pitch)*this.cameraToCenterDistance/b/c.b5(1,d.lat),T=this.scaleZoom(k/this.tileSize);this._elevation=m,this._center=d,this.zoom=T}setLocationAtPoint(r,o){const h=this.pointCoordinate(o),d=this.pointCoordinate(this.centerPoint),m=this.locationCoordinate(r),b=new c.Z(m.x-(h.x-d.x),m.y-(h.y-d.y));this.center=this.coordinateLocation(b),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(r,o){return o?this.coordinatePoint(this.locationCoordinate(r),o.getElevationForLngLatZoom(r,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(r))}pointLocation(r,o){return this.coordinateLocation(this.pointCoordinate(r,o))}locationCoordinate(r){return c.Z.fromLngLat(r)}coordinateLocation(r){return r&&r.toLngLat()}pointCoordinate(r,o){if(o){const U=o.pointCoordinate(r);if(U!=null)return U}const h=[r.x,r.y,0,1],d=[r.x,r.y,1,1];c.af(h,h,this.pixelMatrixInverse),c.af(d,d,this.pixelMatrixInverse);const m=h[3],b=d[3],k=h[1]/m,T=d[1]/b,P=h[2]/m,D=d[2]/b,L=P===D?0:(0-P)/(D-P);return new c.Z(c.y.number(h[0]/m,d[0]/b,L)/this.worldSize,c.y.number(k,T,L)/this.worldSize)}coordinatePoint(r,o=0,h=this.pixelMatrix){const d=[r.x*this.worldSize,r.y*this.worldSize,o,1];return c.af(d,d,h),new c.P(d[0]/d[3],d[1]/d[3])}getBounds(){const r=Math.max(0,this.height/2-this.getHorizon());return new be().extend(this.pointLocation(new c.P(0,r))).extend(this.pointLocation(new c.P(this.width,r))).extend(this.pointLocation(new c.P(this.width,this.height))).extend(this.pointLocation(new c.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new be([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(r){r?(this.lngRange=[r.getWest(),r.getEast()],this.latRange=[r.getSouth(),r.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,xh])}calculateTileMatrix(r){const o=r.canonical,h=this.worldSize/this.zoomScale(o.z),d=o.x+Math.pow(2,o.z)*r.wrap,m=c.an(new Float64Array(16));return c.J(m,m,[d*h,o.y*h,0]),c.K(m,m,[h/c.X,h/c.X,1]),m}calculatePosMatrix(r,o=!1){const h=r.key,d=o?this._alignedPosMatrixCache:this._posMatrixCache;if(d[h])return d[h];const m=this.calculateTileMatrix(r);return c.L(m,o?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,m),d[h]=new Float32Array(m),d[h]}calculateFogMatrix(r){const o=r.key,h=this._fogMatrixCache;if(h[o])return h[o];const d=this.calculateTileMatrix(r);return c.L(d,this.fogMatrix,d),h[o]=new Float32Array(d),h[o]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(r,o){o=c.ac(+o,this.minZoom,this.maxZoom);const h={center:new c.N(r.lng,r.lat),zoom:o};let d=this.lngRange;if(!this._renderWorldCopies&&d===null){const K=179.9999999999;d=[-K,K]}const m=this.tileSize*this.zoomScale(h.zoom);let b=0,k=m,T=0,P=m,D=0,L=0;const{x:U,y:Z}=this.size;if(this.latRange){const K=this.latRange;b=c.Q(K[1])*m,k=c.Q(K[0])*m,k-b<Z&&(D=Z/(k-b))}d&&(T=c.b3(c.O(d[0])*m,0,m),P=c.b3(c.O(d[1])*m,0,m),P<T&&(P+=m),P-T<U&&(L=U/(P-T)));const{x:H,y:ee}=this.project.call({worldSize:m},r);let ie,se;const le=Math.max(L||0,D||0);if(le){const K=new c.P(L?(P+T)/2:H,D?(k+b)/2:ee);return h.center=this.unproject.call({worldSize:m},K).wrap(),h.zoom+=this.scaleZoom(le),h}if(this.latRange){const K=Z/2;ee-K<b&&(se=b+K),ee+K>k&&(se=k-K)}if(d){const K=(T+P)/2;let de=H;this._renderWorldCopies&&(de=c.b3(H,K-m/2,K+m/2));const ye=U/2;de-ye<T&&(ie=T+ye),de+ye>P&&(ie=P-ye)}if(ie!==void 0||se!==void 0){const K=new c.P(ie??H,se??ee);h.center=this.unproject.call({worldSize:m},K).wrap()}return h}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this._unmodified,{center:o,zoom:h}=this.getConstrained(this.center,this.zoom);this.center=o,this.zoom=h,this._unmodified=r,this._constraining=!1}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,o=this.point.x,h=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.b5(1,this.center.lat)*this.worldSize;let d=c.an(new Float64Array(16));c.K(d,d,[this.width/2,-this.height/2,1]),c.J(d,d,[1,-1,0]),this.labelPlaneMatrix=d,d=c.an(new Float64Array(16)),c.K(d,d,[1,-1,1]),c.J(d,d,[-1,-1,0]),c.K(d,d,[2/this.width,2/this.height,1]),this.glCoordMatrix=d;const m=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),b=Math.min(this.elevation,this.minElevationForCurrentTile),k=m-b*this._pixelPerMeter/Math.cos(this._pitch),T=b<0?k:m,P=Math.PI/2+this._pitch,D=this._fov*(.5+r.y/this.height),L=Math.sin(D)*T/Math.sin(c.ac(Math.PI-P-D,.01,Math.PI-.01)),U=this.getHorizon(),Z=2*Math.atan(U/this.cameraToCenterDistance)*(.5+r.y/(2*U)),H=Math.sin(Z)*T/Math.sin(c.ac(Math.PI-P-Z,.01,Math.PI-.01)),ee=Math.min(L,H);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*ee+T),this.nearZ=this.height/50,d=new Float64Array(16),c.b6(d,this._fov,this.width/this.height,this.nearZ,this.farZ),d[8]=2*-r.x/this.width,d[9]=2*r.y/this.height,this.projectionMatrix=c.ae(d),c.K(d,d,[1,-1,1]),c.J(d,d,[0,0,-this.cameraToCenterDistance]),c.b7(d,d,this._pitch),c.ad(d,d,this.angle),c.J(d,d,[-o,-h,0]),this.mercatorMatrix=c.K([],d,[this.worldSize,this.worldSize,this.worldSize]),c.K(d,d,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.L(new Float64Array(16),this.labelPlaneMatrix,d),c.J(d,d,[0,0,-this.elevation]),this.modelViewProjectionMatrix=d,this.invModelViewProjectionMatrix=c.as([],d),this.fogMatrix=new Float64Array(16),c.b6(this.fogMatrix,this._fov,this.width/this.height,m,this.farZ),this.fogMatrix[8]=2*-r.x/this.width,this.fogMatrix[9]=2*r.y/this.height,c.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b7(this.fogMatrix,this.fogMatrix,this._pitch),c.ad(this.fogMatrix,this.fogMatrix,this.angle),c.J(this.fogMatrix,this.fogMatrix,[-o,-h,0]),c.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=c.L(new Float64Array(16),this.labelPlaneMatrix,d);const ie=this.width%2/2,se=this.height%2/2,le=Math.cos(this.angle),K=Math.sin(this.angle),de=o-Math.round(o)+le*ie+K*se,ye=h-Math.round(h)+le*se+K*ie,we=new Float64Array(d);if(c.J(we,we,[de>.5?de-1:de,ye>.5?ye-1:ye,0]),this.alignedModelViewProjectionMatrix=we,d=c.as(new Float64Array(16),this.pixelMatrix),!d)throw new Error("failed to invert matrix");this.pixelMatrixInverse=d,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const r=this.pointCoordinate(new c.P(0,0)),o=[r.x*this.worldSize,r.y*this.worldSize,0,1];return c.af(o,o,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(0,r))}getCameraQueryGeometry(r){const o=this.getCameraPoint();if(r.length===1)return[r[0],o];{let h=o.x,d=o.y,m=o.x,b=o.y;for(const k of r)h=Math.min(h,k.x),d=Math.min(d,k.y),m=Math.max(m,k.x),b=Math.max(b,k.y);return[new c.P(h,d),new c.P(m,d),new c.P(m,b),new c.P(h,b),new c.P(h,d)]}}lngLatToCameraDepth(r,o){const h=this.locationCoordinate(r),d=[h.x*this.worldSize,h.y*this.worldSize,o,1];return c.af(d,d,this.modelViewProjectionMatrix),d[2]/d[3]}}function nl(g,r){let o,h=!1,d=null,m=null;const b=()=>{d=null,h&&(g.apply(m,o),d=setTimeout(b,r),h=!1)};return(...k)=>(h=!0,m=this,o=k,d||b(),d)}class Su{constructor(r){this._getCurrentHash=()=>{const o=window.location.hash.replace("#","");if(this._hashName){let h;return o.split("&").map(d=>d.split("=")).forEach(d=>{d[0]===this._hashName&&(h=d)}),(h&&h[1]||"").split("/")}return o.split("/")},this._onHashChange=()=>{const o=this._getCurrentHash();if(o.length>=3&&!o.some(h=>isNaN(h))){const h=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:h,pitch:+(o[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const o=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,o)},this._removeHash=()=>{const o=this._getCurrentHash();if(o.length===0)return;const h=o.join("/");let d=h;d.split("&").length>0&&(d=d.split("&")[0]),this._hashName&&(d=`${this._hashName}=${h}`);let m=window.location.hash.replace(d,"");m.startsWith("#&")?m=m.slice(0,1)+m.slice(2):m==="#"&&(m="");let b=window.location.href.replace(/(#.+)?$/,m);b=b.replace("&&","&"),window.history.replaceState(window.history.state,null,b)},this._updateHash=nl(this._updateHashUnthrottled,300),this._hashName=r&&encodeURIComponent(r)}addTo(r){return this._map=r,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(r){const o=this._map.getCenter(),h=Math.round(100*this._map.getZoom())/100,d=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,d),b=Math.round(o.lng*m)/m,k=Math.round(o.lat*m)/m,T=this._map.getBearing(),P=this._map.getPitch();let D="";if(D+=r?`/${b}/${k}/${h}`:`${h}/${k}/${b}`,(T||P)&&(D+="/"+Math.round(10*T)/10),P&&(D+=`/${Math.round(P)}`),this._hashName){const L=this._hashName;let U=!1;const Z=window.location.hash.slice(1).split("&").map(H=>{const ee=H.split("=")[0];return ee===L?(U=!0,`${ee}=${D}`):H}).filter(H=>H);return U||Z.push(`${L}=${D}`),`#${Z.join("&")}`}return`#${D}`}}const ku={linearity:.3,easing:c.b8(0,0,.3,1)},wh=c.e({deceleration:2500,maxSpeed:1400},ku),$g=c.e({deceleration:20,maxSpeed:1400},ku),Xf=c.e({deceleration:1e3,maxSpeed:360},ku),Tu=c.e({deceleration:1e3,maxSpeed:90},ku);class bh{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:z.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,o=z.now();for(;r.length>0&&o-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)o.zoom+=m.zoomDelta||0,o.bearing+=m.bearingDelta||0,o.pitch+=m.pitchDelta||0,m.panDelta&&o.pan._add(m.panDelta),m.around&&(o.around=m.around),m.pinchAround&&(o.pinchAround=m.pinchAround);const h=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(o.pan.mag()){const m=sl(o.pan.mag(),h,c.e({},wh,r||{}));d.offset=o.pan.mult(m.amount/o.pan.mag()),d.center=this._map.transform.center,il(d,m)}if(o.zoom){const m=sl(o.zoom,h,$g);d.zoom=this._map.transform.zoom+m.amount,il(d,m)}if(o.bearing){const m=sl(o.bearing,h,Xf);d.bearing=this._map.transform.bearing+c.ac(m.amount,-179,179),il(d,m)}if(o.pitch){const m=sl(o.pitch,h,Tu);d.pitch=this._map.transform.pitch+m.amount,il(d,m)}if(d.zoom||d.bearing){const m=o.pinchAround===void 0?o.around:o.pinchAround;d.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),c.e(d,{noMoveStart:!0})}}function il(g,r){(!g.duration||g.duration<r.duration)&&(g.duration=r.duration,g.easing=r.easing)}function sl(g,r,o){const{maxSpeed:h,linearity:d,deceleration:m}=o,b=c.ac(g*d/(r/1e3),-h,h),k=Math.abs(b)/(m*d);return{easing:o.easing,duration:1e3*k,amount:b*(k/2)}}class nn extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,o,h,d={}){const m=R.mousePos(o.getCanvas(),h),b=o.unproject(m);super(r,c.e({point:m,lngLat:b,originalEvent:h},d)),this._defaultPrevented=!1,this.target=o}}class na extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,o,h){const d=r==="touchend"?h.changedTouches:h.touches,m=R.touchPos(o.getCanvasContainer(),d),b=m.map(T=>o.unproject(T)),k=m.reduce((T,P,D,L)=>T.add(P.div(L.length)),new c.P(0,0));super(r,{points:m,point:k,lngLats:b,lngLat:o.unproject(k),originalEvent:h}),this._defaultPrevented=!1}}class Kf extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,o,h){super(r,{originalEvent:h}),this._defaultPrevented=!1}}class Yf{constructor(r,o){this._map=r,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(r){return this._firePreventable(new Kf(r.type,this._map,r))}mousedown(r,o){return this._mousedownPos=o,this._firePreventable(new nn(r.type,this._map,r))}mouseup(r){this._map.fire(new nn(r.type,this._map,r))}click(r,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new nn(r.type,this._map,r))}dblclick(r){return this._firePreventable(new nn(r.type,this._map,r))}mouseover(r){this._map.fire(new nn(r.type,this._map,r))}mouseout(r){this._map.fire(new nn(r.type,this._map,r))}touchstart(r){return this._firePreventable(new na(r.type,this._map,r))}touchmove(r){this._map.fire(new na(r.type,this._map,r))}touchend(r){this._map.fire(new na(r.type,this._map,r))}touchcancel(r){this._map.fire(new na(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class kr{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(r){this._map.fire(new nn(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new nn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._ignoreContextMenu||this._map.fire(new nn(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ti{constructor(r){this._map=r}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(r){return this.transform.pointLocation(c.P.convert(r),this._map.terrain)}}class Wn{constructor(r,o){this._map=r,this._tr=new Ti(r),this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,o){this.isEnabled()&&r.shiftKey&&r.button===0&&(R.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(r,o){if(!this._active)return;const h=o;if(this._lastPos.equals(h)||!this._box&&h.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=h,this._box||(this._box=R.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",r));const m=Math.min(d.x,h.x),b=Math.max(d.x,h.x),k=Math.min(d.y,h.y),T=Math.max(d.y,h.y);R.setTransform(this._box,`translate(${m}px,${k}px)`),this._box.style.width=b-m+"px",this._box.style.height=T-k+"px"}mouseupWindow(r,o){if(!this._active||r.button!==0)return;const h=this._startPos,d=o;if(this.reset(),R.suppressClick(),h.x!==d.x||h.y!==d.y)return this._map.fire(new c.k("boxzoomend",{originalEvent:r})),{cameraAnimation:m=>m.fitScreenCoordinates(h,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(R.remove(this._box),this._box=null),R.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,o){return this._map.fire(new c.k(r,{originalEvent:o}))}}function al(g,r){if(g.length!==r.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${r.length}`);const o={};for(let h=0;h<g.length;h++)o[g[h].identifier]=r[h];return o}class Sh{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,o,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),h.length===this.numTouches&&(this.centroid=function(d){const m=new c.P(0,0);for(const b of d)m._add(b);return m.div(d.length)}(o),this.touches=al(h,o)))}touchmove(r,o,h){if(this.aborted||!this.centroid)return;const d=al(h,o);for(const m in this.touches){const b=d[m];(!b||b.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(r,o,h){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),h.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class Cu{constructor(r){this.singleTap=new Sh(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(r,o,h){this.singleTap.touchstart(r,o,h)}touchmove(r,o,h){this.singleTap.touchmove(r,o,h)}touchend(r,o,h){const d=this.singleTap.touchend(r,o,h);if(d){const m=r.timeStamp-this.lastTime<500,b=!this.lastTap||this.lastTap.dist(d)<30;if(m&&b||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class Ha{constructor(r){this._tr=new Ti(r),this._zoomIn=new Cu({numTouches:1,numTaps:2}),this._zoomOut=new Cu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,o,h){this._zoomIn.touchstart(r,o,h),this._zoomOut.touchstart(r,o,h)}touchmove(r,o,h){this._zoomIn.touchmove(r,o,h),this._zoomOut.touchmove(r,o,h)}touchend(r,o,h){const d=this._zoomIn.touchend(r,o,h),m=this._zoomOut.touchend(r,o,h),b=this._tr;return d?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:b.zoom+1,around:b.unproject(d)},{originalEvent:r})}):m?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:b.zoom-1,around:b.unproject(m)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cs{constructor(r){this._enabled=!!r.enable,this._moveStateManager=r.moveStateManager,this._clickTolerance=r.clickTolerance||1,this._moveFunction=r.move,this._activateOnStart=!!r.activateOnStart,r.assignEvents(this),this.reset()}reset(r){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(r)}_move(...r){const o=this._moveFunction(...r);if(o.bearingDelta||o.pitchDelta||o.around||o.panDelta)return this._active=!0,o}dragStart(r,o){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(r)&&(this._moveStateManager.startMove(r),this._lastPoint=o.length?o[0]:o,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(r,o){if(!this.isEnabled())return;const h=this._lastPoint;if(!h)return;if(r.preventDefault(),!this._moveStateManager.isValidMoveEvent(r))return void this.reset(r);const d=o.length?o[0]:o;return!this._moved&&d.dist(h)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(h,d))}dragEnd(r){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(r)&&(this._moved&&R.suppressClick(),this.reset(r))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const kh={0:1,2:2};class Mu{constructor(r){this._correctEvent=r.checkCorrectEvent}startMove(r){const o=R.mouseButton(r);this._eventButton=o}endMove(r){delete this._eventButton}isValidStartEvent(r){return this._correctEvent(r)}isValidMoveEvent(r){return!function(o,h){const d=kh[h];return o.buttons===void 0||(o.buttons&d)!==d}(r,this._eventButton)}isValidEndEvent(r){return R.mouseButton(r)===this._eventButton}}class Th{constructor(){this._firstTouch=void 0}_isOneFingerTouch(r){return r.targetTouches.length===1}_isSameTouchEvent(r){return r.targetTouches[0].identifier===this._firstTouch}startMove(r){this._firstTouch=r.targetTouches[0].identifier}endMove(r){delete this._firstTouch}isValidStartEvent(r){return this._isOneFingerTouch(r)}isValidMoveEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}isValidEndEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}}const Iu=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=r=>{r.preventDefault()}},Ch=({enable:g,clickTolerance:r,bearingDegreesPerPixelMoved:o=.8})=>{const h=new Mu({checkCorrectEvent:d=>R.mouseButton(d)===0&&d.ctrlKey||R.mouseButton(d)===2});return new cs({clickTolerance:r,move:(d,m)=>({bearingDelta:(m.x-d.x)*o}),moveStateManager:h,enable:g,assignEvents:Iu})},Mh=({enable:g,clickTolerance:r,pitchDegreesPerPixelMoved:o=-.5})=>{const h=new Mu({checkCorrectEvent:d=>R.mouseButton(d)===0&&d.ctrlKey||R.mouseButton(d)===2});return new cs({clickTolerance:r,move:(d,m)=>({pitchDelta:(m.y-d.y)*o}),moveStateManager:h,enable:g,assignEvents:Iu})};class ia{constructor(r,o){this._clickTolerance=r.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(r){return r<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(r,o,h){return this._calculateTransform(r,o,h)}touchmove(r,o,h){if(this._active){if(!this._shouldBePrevented(h.length))return r.preventDefault(),this._calculateTransform(r,o,h);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",r)}}touchend(r,o,h){this._calculateTransform(r,o,h),this._active&&this._shouldBePrevented(h.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,o,h){h.length>0&&(this._active=!0);const d=al(h,o),m=new c.P(0,0),b=new c.P(0,0);let k=0;for(const P in d){const D=d[P],L=this._touches[P];L&&(m._add(D),b._add(D.sub(L)),k++,d[P]=D)}if(this._touches=d,this._shouldBePrevented(k)||!b.mag())return;const T=b.div(k);return this._sum._add(T),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(k),panDelta:T}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Eu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(r,o,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([o[0],o[1]]))}touchmove(r,o,h){if(!this._firstTwoTouches)return;r.preventDefault();const[d,m]=this._firstTwoTouches,b=ol(h,o,d),k=ol(h,o,m);if(!b||!k)return;const T=this._aroundCenter?null:b.add(k).div(2);return this._move([b,k],T,r)}touchend(r,o,h){if(!this._firstTwoTouches)return;const[d,m]=this._firstTwoTouches,b=ol(h,o,d),k=ol(h,o,m);b&&k||(this._active&&R.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function ol(g,r,o){for(let h=0;h<g.length;h++)if(g[h].identifier===o)return r[h]}function Ih(g,r){return Math.log(g/r)/Math.LN2}class Eh extends Eu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,o){const h=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(Ih(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ih(this._distance,h),pinchAround:o}}}function Ph(g,r){return 180*g.angleWith(r)/Math.PI}class Ah extends Eu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,o,h){const d=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ph(this._vector,d),pinchAround:o}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const o=25/(Math.PI*this._minDiameter)*360,h=Ph(r,this._startVector);return Math.abs(h)<o}}function Pu(g){return Math.abs(g.y)>Math.abs(g.x)}class ll extends Eu{constructor(r){super(),this._currentTouchCount=0,this._map=r}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(r,o,h){super.touchstart(r,o,h),this._currentTouchCount=h.length}_start(r){this._lastPoints=r,Pu(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,o,h){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const d=r[0].sub(this._lastPoints[0]),m=r[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,m,h.timeStamp),this._valid?(this._lastPoints=r,this._active=!0,{pitchDelta:(d.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(r,o,h){if(this._valid!==void 0)return this._valid;const d=r.mag()>=2,m=o.mag()>=2;if(!d&&!m)return;if(!d||!m)return this._firstMove===void 0&&(this._firstMove=h),h-this._firstMove<100&&void 0;const b=r.y>0==o.y>0;return Pu(r)&&Pu(o)&&b}}const Qf={panStep:100,bearingStep:15,pitchStep:10};class oi{constructor(r){this._tr=new Ti(r);const o=Qf;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let o=0,h=0,d=0,m=0,b=0;switch(r.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:r.shiftKey?h=-1:(r.preventDefault(),m=-1);break;case 39:r.shiftKey?h=1:(r.preventDefault(),m=1);break;case 38:r.shiftKey?d=1:(r.preventDefault(),b=-1);break;case 40:r.shiftKey?d=-1:(r.preventDefault(),b=1);break;default:return}return this._rotationDisabled&&(h=0,d=0),{cameraAnimation:k=>{const T=this._tr;k.easeTo({duration:300,easeId:"keyboardHandler",easing:Gi,zoom:o?Math.round(T.zoom)+o*(r.shiftKey?2:1):T.zoom,bearing:T.bearing+h*this._bearingStep,pitch:T.pitch+d*this._pitchStep,offset:[-m*this._panStep,-b*this._panStep],center:T.center},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Gi(g){return g*(2-g)}const zh=4.000244140625;class Ci{constructor(r,o){this._onTimeout=h=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(h)},this._map=r,this._tr=new Ti(r),this._triggerRenderFrame=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(r){return!!this._map.cooperativeGestures.isEnabled()&&!(r.ctrlKey||this._map.cooperativeGestures.isBypassed(r))}wheel(r){if(!this.isEnabled())return;if(this._shouldBePrevented(r))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",r);let o=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const h=z.now(),d=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,o!==0&&o%zh==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(d*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),r.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=r,this._delta-=o,this._active||this._start(r)),r.preventDefault()}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=R.mousePos(this._map.getCanvas(),r),h=this._tr;this._around=o.y>h.transform.height/2-h.transform.getHorizon()?c.N.convert(this._aroundCenter?h.center:h.unproject(o)):c.N.convert(h.center),this._aroundPoint=h.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._tr.transform;if(this._delta!==0){const T=this._type==="wheel"&&Math.abs(this._delta)>zh?this._wheelZoomRate:this._defaultZoomRate;let P=2/(1+Math.exp(-Math.abs(this._delta*T)));this._delta<0&&P!==0&&(P=1/P);const D=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(D*P))),this._type==="wheel"&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom=="number"?this._targetZoom:r.zoom,h=this._startZoom,d=this._easing;let m,b=!1;const k=z.now()-this._lastWheelEventTime;if(this._type==="wheel"&&h&&d&&k){const T=Math.min(k/200,1),P=d(T);m=c.y.number(h,o,P),T<1?this._frameId||(this._frameId=!0):b=!0}else m=o,b=!0;return this._active=!0,b&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!b,zoomDelta:m-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let o=c.b9;if(this._prevEase){const h=this._prevEase,d=(z.now()-h.start)/h.duration,m=h.easing(d+.01)-h.easing(d),b=.27/Math.sqrt(m*m+1e-4)*.01,k=Math.sqrt(.0729-b*b);o=c.b8(b,k,.25,1)}return this._prevEase={start:z.now(),duration:r,easing:o},o}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class sa{constructor(r,o){this._clickZoom=r,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class qg{constructor(r){this._tr=new Ti(r),this.reset()}reset(){this._active=!1}dblclick(r,o){return r.preventDefault(),{cameraAnimation:h=>{h.easeTo({duration:300,zoom:this._tr.zoom+(r.shiftKey?-1:1),around:this._tr.unproject(o)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Zg{constructor(){this._tap=new Cu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(r,o,h){if(!this._swipePoint)if(this._tapTime){const d=o[0],m=r.timeStamp-this._tapTime<500,b=this._tapPoint.dist(d)<30;m&&b?h.length>0&&(this._swipePoint=d,this._swipeTouch=h[0].identifier):this.reset()}else this._tap.touchstart(r,o,h)}touchmove(r,o,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;const d=o[0],m=d.y-this._swipePoint.y;return this._swipePoint=d,r.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(r,o,h)}touchend(r,o,h){if(this._tapTime)this._swipePoint&&h.length===0&&this.reset();else{const d=this._tap.touchend(r,o,h);d&&(this._tapTime=r.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jf{constructor(r,o,h){this._el=r,this._mousePan=o,this._touchPan=h}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ep{constructor(r,o,h){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=o,this._mousePitch=h}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Dh{constructor(r,o,h,d){this._el=r,this._touchZoom=o,this._touchRotate=h,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Ga{constructor(r,o){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=r,this._options=o,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const r=this._map.getCanvasContainer();r.classList.add("maplibregl-cooperative-gestures"),this._container=R.create("div","maplibregl-cooperative-gesture-screen",r);let o=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(o=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const h=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),d=document.createElement("div");d.className="maplibregl-desktop-message",d.textContent=o,this._container.appendChild(d);const m=document.createElement("div");m.className="maplibregl-mobile-message",m.textContent=h,this._container.appendChild(m),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(R.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(r){return r[this._bypassKey]}notifyGestureBlocked(r,o){this._enabled&&(this._map.fire(new c.k("cooperativegestureprevented",{gestureType:r,originalEvent:o})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const li=g=>g.zoom||g.drag||g.pitch||g.rotate;class Qe extends c.k{}function Au(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class Lh{constructor(r,o){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,m)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const b=d.type==="renderFrame"?void 0:d,k={needsRenderFrame:!1},T={},P={},D=d.touches,L=D?this._getMapTouches(D):void 0,U=L?R.touchPos(this._map.getCanvas(),L):R.mousePos(this._map.getCanvas(),d);for(const{handlerName:ee,handler:ie,allowed:se}of this._handlers){if(!ie.isEnabled())continue;let le;this._blockedByActive(P,se,ee)?ie.reset():ie[m||d.type]&&(le=ie[m||d.type](d,U,L),this.mergeHandlerResult(k,T,le,ee,b),le&&le.needsRenderFrame&&this._triggerRenderFrame()),(le||ie.isActive())&&(P[ee]=ie)}const Z={};for(const ee in this._previousActiveHandlers)P[ee]||(Z[ee]=b);this._previousActiveHandlers=P,(Object.keys(Z).length||Au(k))&&(this._changes.push([k,T,Z]),this._triggerRenderFrame()),(Object.keys(P).length||Au(k))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:H}=k;H&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],H(this._map))},this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new bh(r),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o);const h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[window,"blur",void 0]];for(const[d,m,b]of this._listeners)R.addEventListener(d,m,d===document?this.handleWindowEvent:this.handleEvent,b)}destroy(){for(const[r,o,h]of this._listeners)R.removeEventListener(r,o,r===document?this.handleWindowEvent:this.handleEvent,h)}_addDefaultHandlers(r){const o=this._map,h=o.getCanvasContainer();this._add("mapEvent",new Yf(o,r));const d=o.boxZoom=new Wn(o,r);this._add("boxZoom",d),r.interactive&&r.boxZoom&&d.enable();const m=o.cooperativeGestures=new Ga(o,r.cooperativeGestures);this._add("cooperativeGestures",m),r.cooperativeGestures&&m.enable();const b=new Ha(o),k=new qg(o);o.doubleClickZoom=new sa(k,b),this._add("tapZoom",b),this._add("clickZoom",k),r.interactive&&r.doubleClickZoom&&o.doubleClickZoom.enable();const T=new Zg;this._add("tapDragZoom",T);const P=o.touchPitch=new ll(o);this._add("touchPitch",P),r.interactive&&r.touchPitch&&o.touchPitch.enable(r.touchPitch);const D=Ch(r),L=Mh(r);o.dragRotate=new ep(r,D,L),this._add("mouseRotate",D,["mousePitch"]),this._add("mousePitch",L,["mouseRotate"]),r.interactive&&r.dragRotate&&o.dragRotate.enable();const U=(({enable:le,clickTolerance:K})=>{const de=new Mu({checkCorrectEvent:ye=>R.mouseButton(ye)===0&&!ye.ctrlKey});return new cs({clickTolerance:K,move:(ye,we)=>({around:we,panDelta:we.sub(ye)}),activateOnStart:!0,moveStateManager:de,enable:le,assignEvents:Iu})})(r),Z=new ia(r,o);o.dragPan=new Jf(h,U,Z),this._add("mousePan",U),this._add("touchPan",Z,["touchZoom","touchRotate"]),r.interactive&&r.dragPan&&o.dragPan.enable(r.dragPan);const H=new Ah,ee=new Eh;o.touchZoomRotate=new Dh(h,ee,H,T),this._add("touchRotate",H,["touchPan","touchZoom"]),this._add("touchZoom",ee,["touchPan","touchRotate"]),r.interactive&&r.touchZoomRotate&&o.touchZoomRotate.enable(r.touchZoomRotate);const ie=o.scrollZoom=new Ci(o,()=>this._triggerRenderFrame());this._add("scrollZoom",ie,["mousePan"]),r.interactive&&r.scrollZoom&&o.scrollZoom.enable(r.scrollZoom);const se=o.keyboard=new oi(o);this._add("keyboard",se),r.interactive&&r.keyboard&&o.keyboard.enable(),this._add("blockableMapEvent",new kr(o))}_add(r,o,h){this._handlers.push({handlerName:r,handler:o,allowed:h}),this._handlersById[r]=o}stop(r){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!li(this._eventsInProgress)||this.isZooming()}_blockedByActive(r,o,h){for(const d in r)if(d!==h&&(!o||o.indexOf(d)<0))return!0;return!1}_getMapTouches(r){const o=[];for(const h of r)this._el.contains(h.target)&&o.push(h);return o}mergeHandlerResult(r,o,h,d,m){if(!h)return;c.e(r,h);const b={handlerName:d,originalEvent:h.originalEvent||m};h.zoomDelta!==void 0&&(o.zoom=b),h.panDelta!==void 0&&(o.drag=b),h.pitchDelta!==void 0&&(o.pitch=b),h.bearingDelta!==void 0&&(o.rotate=b)}_applyChanges(){const r={},o={},h={};for(const[d,m,b]of this._changes)d.panDelta&&(r.panDelta=(r.panDelta||new c.P(0,0))._add(d.panDelta)),d.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+d.pitchDelta),d.around!==void 0&&(r.around=d.around),d.pinchAround!==void 0&&(r.pinchAround=d.pinchAround),d.noInertia&&(r.noInertia=d.noInertia),c.e(o,m),c.e(h,b);this._updateMapTransform(r,o,h),this._changes=[]}_updateMapTransform(r,o,h){const d=this._map,m=d._getTransformForUpdate(),b=d.terrain;if(!(Au(r)||b&&this._terrainMovement))return this._fireEvents(o,h,!0);let{panDelta:k,zoomDelta:T,bearingDelta:P,pitchDelta:D,around:L,pinchAround:U}=r;U!==void 0&&(L=U),d._stop(!0),L=L||d.transform.centerPoint;const Z=m.pointLocation(k?L.sub(k):L);P&&(m.bearing+=P),D&&(m.pitch+=D),T&&(m.zoom+=T),b?this._terrainMovement||!o.drag&&!o.zoom?o.drag&&this._terrainMovement?m.center=m.pointLocation(m.centerPoint.sub(k)):m.setLocationAtPoint(Z,L):(this._terrainMovement=!0,this._map._elevationFreeze=!0,m.setLocationAtPoint(Z,L)):m.setLocationAtPoint(Z,L),d._applyUpdatedTransform(m),this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(o,h,!0)}_fireEvents(r,o,h){const d=li(this._eventsInProgress),m=li(r),b={};for(const L in r){const{originalEvent:U}=r[L];this._eventsInProgress[L]||(b[`${L}start`]=U),this._eventsInProgress[L]=r[L]}!d&&m&&this._fireEvent("movestart",m.originalEvent);for(const L in b)this._fireEvent(L,b[L]);m&&this._fireEvent("move",m.originalEvent);for(const L in r){const{originalEvent:U}=r[L];this._fireEvent(L,U)}const k={};let T;for(const L in this._eventsInProgress){const{handlerName:U,originalEvent:Z}=this._eventsInProgress[L];this._handlersById[U].isActive()||(delete this._eventsInProgress[L],T=o[U]||Z,k[`${L}end`]=T)}for(const L in k)this._fireEvent(L,k[L]);const P=li(this._eventsInProgress),D=(d||m)&&!P;if(D&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const L=this._map._getTransformForUpdate();L.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(L)}if(h&&D){this._updatingCamera=!0;const L=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),U=Z=>Z!==0&&-this._bearingSnap<Z&&Z<this._bearingSnap;!L||!L.essential&&z.prefersReducedMotion?(this._map.fire(new c.k("moveend",{originalEvent:T})),U(this._map.getBearing())&&this._map.resetNorth()):(U(L.bearing||this._map.getBearing())&&(L.bearing=0),L.freezeElevation=!0,this._map.easeTo(L,{originalEvent:T})),this._updatingCamera=!1}}_fireEvent(r,o){this._map.fire(new c.k(r,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{delete this._frameId,this.handleEvent(new Qe("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class tp extends c.E{constructor(r,o){super(),this._renderFrameCallback=()=>{const h=Math.min((z.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=o.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new c.N(this.transform.center.lng,this.transform.center.lat)}setCenter(r,o){return this.jumpTo({center:r},o)}panBy(r,o,h){return r=c.P.convert(r).mult(-1),this.panTo(this.transform.center,c.e({offset:r},o),h)}panTo(r,o,h){return this.easeTo(c.e({center:r},o),h)}getZoom(){return this.transform.zoom}setZoom(r,o){return this.jumpTo({zoom:r},o),this}zoomTo(r,o,h){return this.easeTo(c.e({zoom:r},o),h)}zoomIn(r,o){return this.zoomTo(this.getZoom()+1,r,o),this}zoomOut(r,o){return this.zoomTo(this.getZoom()-1,r,o),this}getBearing(){return this.transform.bearing}setBearing(r,o){return this.jumpTo({bearing:r},o),this}getPadding(){return this.transform.padding}setPadding(r,o){return this.jumpTo({padding:r},o),this}rotateTo(r,o,h){return this.easeTo(c.e({bearing:r},o),h)}resetNorth(r,o){return this.rotateTo(0,c.e({duration:1e3},r),o),this}resetNorthPitch(r,o){return this.easeTo(c.e({bearing:0,pitch:0,duration:1e3},r),o),this}snapToNorth(r,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,o):this}getPitch(){return this.transform.pitch}setPitch(r,o){return this.jumpTo({pitch:r},o),this}cameraForBounds(r,o){r=be.convert(r).adjustAntiMeridian();const h=o&&o.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),h,o)}_cameraForBoxAndBearing(r,o,h,d){const m={top:0,bottom:0,right:0,left:0};if(typeof(d=c.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const Ue=d.padding;d.padding={top:Ue,bottom:Ue,right:Ue,left:Ue}}d.padding=c.e(m,d.padding);const b=this.transform,k=b.padding,T=new be(r,o),P=b.project(T.getNorthWest()),D=b.project(T.getNorthEast()),L=b.project(T.getSouthEast()),U=b.project(T.getSouthWest()),Z=c.ba(-h),H=P.rotate(Z),ee=D.rotate(Z),ie=L.rotate(Z),se=U.rotate(Z),le=new c.P(Math.max(H.x,ee.x,se.x,ie.x),Math.max(H.y,ee.y,se.y,ie.y)),K=new c.P(Math.min(H.x,ee.x,se.x,ie.x),Math.min(H.y,ee.y,se.y,ie.y)),de=le.sub(K),ye=(b.width-(k.left+k.right+d.padding.left+d.padding.right))/de.x,we=(b.height-(k.top+k.bottom+d.padding.top+d.padding.bottom))/de.y;if(we<0||ye<0)return void c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Ee=Math.min(b.scaleZoom(b.scale*Math.min(ye,we)),d.maxZoom),Re=c.P.convert(d.offset),Ze=new c.P((d.padding.left-d.padding.right)/2,(d.padding.top-d.padding.bottom)/2).rotate(c.ba(h)),Xe=Re.add(Ze).mult(b.scale/b.zoomScale(Ee));return{center:b.unproject(P.add(L).div(2).sub(Xe)),zoom:Ee,bearing:h}}fitBounds(r,o,h){return this._fitInternal(this.cameraForBounds(r,o),o,h)}fitScreenCoordinates(r,o,h,d,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.P.convert(r)),this.transform.pointLocation(c.P.convert(o)),h,d),d,m)}_fitInternal(r,o,h){return r?(delete(o=c.e(r,o)).padding,o.linear?this.easeTo(o,h):this.flyTo(o,h)):this}jumpTo(r,o){this.stop();const h=this._getTransformForUpdate();let d=!1,m=!1,b=!1;return"zoom"in r&&h.zoom!==+r.zoom&&(d=!0,h.zoom=+r.zoom),r.center!==void 0&&(h.center=c.N.convert(r.center)),"bearing"in r&&h.bearing!==+r.bearing&&(m=!0,h.bearing=+r.bearing),"pitch"in r&&h.pitch!==+r.pitch&&(b=!0,h.pitch=+r.pitch),r.padding==null||h.isPaddingEqual(r.padding)||(h.padding=r.padding),this._applyUpdatedTransform(h),this.fire(new c.k("movestart",o)).fire(new c.k("move",o)),d&&this.fire(new c.k("zoomstart",o)).fire(new c.k("zoom",o)).fire(new c.k("zoomend",o)),m&&this.fire(new c.k("rotatestart",o)).fire(new c.k("rotate",o)).fire(new c.k("rotateend",o)),b&&this.fire(new c.k("pitchstart",o)).fire(new c.k("pitch",o)).fire(new c.k("pitchend",o)),this.fire(new c.k("moveend",o))}calculateCameraOptionsFromTo(r,o,h,d=0){const m=c.Z.fromLngLat(r,o),b=c.Z.fromLngLat(h,d),k=b.x-m.x,T=b.y-m.y,P=b.z-m.z,D=Math.hypot(k,T,P);if(D===0)throw new Error("Can't calculate camera options with same From and To");const L=Math.hypot(k,T),U=this.transform.scaleZoom(this.transform.cameraToCenterDistance/D/this.transform.tileSize),Z=180*Math.atan2(k,-T)/Math.PI;let H=180*Math.acos(L/D)/Math.PI;return H=P<0?90-H:90+H,{center:b.toLngLat(),zoom:U,pitch:H,bearing:Z}}easeTo(r,o){var h;this._stop(!1,r.easeId),((r=c.e({offset:[0,0],duration:500,easing:c.b9},r)).animate===!1||!r.essential&&z.prefersReducedMotion)&&(r.duration=0);const d=this._getTransformForUpdate(),m=d.zoom,b=d.bearing,k=d.pitch,T=d.padding,P="bearing"in r?this._normalizeBearing(r.bearing,b):b,D="pitch"in r?+r.pitch:k,L="padding"in r?r.padding:d.padding,U=c.P.convert(r.offset);let Z=d.centerPoint.add(U);const H=d.pointLocation(Z),{center:ee,zoom:ie}=d.getConstrained(c.N.convert(r.center||H),(h=r.zoom)!==null&&h!==void 0?h:m);this._normalizeCenter(ee,d);const se=d.project(H),le=d.project(ee).sub(se),K=d.zoomScale(ie-m);let de,ye;r.around&&(de=c.N.convert(r.around),ye=d.locationPoint(de));const we={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ie!==m,this._rotating=this._rotating||b!==P,this._pitching=this._pitching||D!==k,this._padding=!d.isPaddingEqual(L),this._easeId=r.easeId,this._prepareEase(o,r.noMoveStart,we),this.terrain&&this._prepareElevation(ee),this._ease(Ee=>{if(this._zooming&&(d.zoom=c.y.number(m,ie,Ee)),this._rotating&&(d.bearing=c.y.number(b,P,Ee)),this._pitching&&(d.pitch=c.y.number(k,D,Ee)),this._padding&&(d.interpolatePadding(T,L,Ee),Z=d.centerPoint.add(U)),this.terrain&&!r.freezeElevation&&this._updateElevation(Ee),de)d.setLocationAtPoint(de,ye);else{const Re=d.zoomScale(d.zoom-m),Ze=ie>m?Math.min(2,K):Math.max(.5,K),Xe=Math.pow(Ze,1-Ee),Ue=d.unproject(se.add(le.mult(Ee*Xe)).mult(Re));d.setLocationAtPoint(d.renderWorldCopies?Ue.wrap():Ue,Z)}this._applyUpdatedTransform(d),this._fireMoveEvents(o)},Ee=>{this.terrain&&r.freezeElevation&&this._finalizeElevation(),this._afterEase(o,Ee)},r),this}_prepareEase(r,o,h={}){this._moving=!0,o||h.moving||this.fire(new c.k("movestart",r)),this._zooming&&!h.zooming&&this.fire(new c.k("zoomstart",r)),this._rotating&&!h.rotating&&this.fire(new c.k("rotatestart",r)),this._pitching&&!h.pitching&&this.fire(new c.k("pitchstart",r))}_prepareElevation(r){this._elevationCenter=r,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(r){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const o=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(r<1&&o!==this._elevationTarget){const h=this._elevationTarget-this._elevationStart;this._elevationStart+=r*(h-(o-(h*r+this._elevationStart))/(1-r)),this._elevationTarget=o}this.transform.elevation=c.y.number(this._elevationStart,this._elevationTarget,r)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(r){const o=r.getCameraPosition(),h=this.terrain.getElevationForLngLatZoom(o.lngLat,r.zoom);if(o.altitude<h){const d=this.calculateCameraOptionsFromTo(o.lngLat,h,r.center,r.elevation);return{pitch:d.pitch,zoom:d.zoom}}return{}}_applyUpdatedTransform(r){const o=[];if(this.terrain&&o.push(d=>this._elevateCameraIfInsideTerrain(d)),this.transformCameraUpdate&&o.push(d=>this.transformCameraUpdate(d)),!o.length)return;const h=r.clone();for(const d of o){const m=h.clone(),{center:b,zoom:k,pitch:T,bearing:P,elevation:D}=d(m);b&&(m.center=b),k!==void 0&&(m.zoom=k),T!==void 0&&(m.pitch=T),P!==void 0&&(m.bearing=P),D!==void 0&&(m.elevation=D),h.apply(m)}this.transform.apply(h)}_fireMoveEvents(r){this.fire(new c.k("move",r)),this._zooming&&this.fire(new c.k("zoom",r)),this._rotating&&this.fire(new c.k("rotate",r)),this._pitching&&this.fire(new c.k("pitch",r))}_afterEase(r,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId;const h=this._zooming,d=this._rotating,m=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,h&&this.fire(new c.k("zoomend",r)),d&&this.fire(new c.k("rotateend",r)),m&&this.fire(new c.k("pitchend",r)),this.fire(new c.k("moveend",r))}flyTo(r,o){var h;if(!r.essential&&z.prefersReducedMotion){const Ge=c.M(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ge,o)}this.stop(),r=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.b9},r);const d=this._getTransformForUpdate(),m=d.zoom,b=d.bearing,k=d.pitch,T=d.padding,P="bearing"in r?this._normalizeBearing(r.bearing,b):b,D="pitch"in r?+r.pitch:k,L="padding"in r?r.padding:d.padding,U=c.P.convert(r.offset);let Z=d.centerPoint.add(U);const H=d.pointLocation(Z),{center:ee,zoom:ie}=d.getConstrained(c.N.convert(r.center||H),(h=r.zoom)!==null&&h!==void 0?h:m);this._normalizeCenter(ee,d);const se=d.zoomScale(ie-m),le=d.project(H),K=d.project(ee).sub(le);let de=r.curve;const ye=Math.max(d.width,d.height),we=ye/se,Ee=K.mag();if("minZoom"in r){const Ge=c.ac(Math.min(r.minZoom,m,ie),d.minZoom,d.maxZoom),vt=ye/d.zoomScale(Ge-m);de=Math.sqrt(vt/Ee*2)}const Re=de*de;function Ze(Ge){const vt=(we*we-ye*ye+(Ge?-1:1)*Re*Re*Ee*Ee)/(2*(Ge?we:ye)*Re*Ee);return Math.log(Math.sqrt(vt*vt+1)-vt)}function Xe(Ge){return(Math.exp(Ge)-Math.exp(-Ge))/2}function Ue(Ge){return(Math.exp(Ge)+Math.exp(-Ge))/2}const je=Ze(!1);let rt=function(Ge){return Ue(je)/Ue(je+de*Ge)},wt=function(Ge){return ye*((Ue(je)*(Xe(vt=je+de*Ge)/Ue(vt))-Xe(je))/Re)/Ee;var vt},$e=(Ze(!0)-je)/de;if(Math.abs(Ee)<1e-6||!isFinite($e)){if(Math.abs(ye-we)<1e-6)return this.easeTo(r,o);const Ge=we<ye?-1:1;$e=Math.abs(Math.log(we/ye))/de,wt=()=>0,rt=vt=>Math.exp(Ge*de*vt)}return r.duration="duration"in r?+r.duration:1e3*$e/("screenSpeed"in r?+r.screenSpeed/de:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0),this._zooming=!0,this._rotating=b!==P,this._pitching=D!==k,this._padding=!d.isPaddingEqual(L),this._prepareEase(o,!1),this.terrain&&this._prepareElevation(ee),this._ease(Ge=>{const vt=Ge*$e,cr=1/rt(vt);d.zoom=Ge===1?ie:m+d.scaleZoom(cr),this._rotating&&(d.bearing=c.y.number(b,P,Ge)),this._pitching&&(d.pitch=c.y.number(k,D,Ge)),this._padding&&(d.interpolatePadding(T,L,Ge),Z=d.centerPoint.add(U)),this.terrain&&!r.freezeElevation&&this._updateElevation(Ge);const Ct=Ge===1?ee:d.unproject(le.add(K.mult(wt(vt))).mult(cr));d.setLocationAtPoint(d.renderWorldCopies?Ct.wrap():Ct,Z),this._applyUpdatedTransform(d),this._fireMoveEvents(o)},()=>{this.terrain&&r.freezeElevation&&this._finalizeElevation(),this._afterEase(o)},r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,o){var h;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,o)}return r||(h=this.handlers)===null||h===void 0||h.stop(!1),this}_ease(r,o,h){h.animate===!1||h.duration===0?(r(1),o()):(this._easeStart=z.now(),this._easeOptions=h,this._onEaseFrame=r,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(r,o){r=c.b3(r,-180,180);const h=Math.abs(r-o);return Math.abs(r-360-o)<h&&(r-=360),Math.abs(r+360-o)<h&&(r+=360),r}_normalizeCenter(r,o){if(!o.renderWorldCopies||o.lngRange)return;const h=r.lng-o.center.lng;r.lng+=h>180?-360:h<-180?360:0}queryTerrainElevation(r){return this.terrain?this.terrain.getElevationForLngLatZoom(c.N.convert(r),this.transform.tileZoom)-this.transform.elevation:null}}const Wa={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Xa{constructor(r=Wa){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=o=>{!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"&&o.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=r}getDefaultPosition(){return"bottom-right"}onAdd(r){return this._map=r,this._compact=this.options.compact,this._container=R.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=R.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=R.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){R.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(r,o){const h=this._map._getUIString(`AttributionControl.${o}`);r.title=h,r.setAttribute("aria-label",h)}_updateAttributions(){if(!this._map.style)return;let r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(d=>typeof d!="string"?"":d)):typeof this.options.customAttribution=="string"&&r.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const o=this._map.style.sourceCaches;for(const d in o){const m=o[d];if(m.used||m.usedForTerrain){const b=m.getSource();b.attribution&&r.indexOf(b.attribution)<0&&r.push(b.attribution)}}r=r.filter(d=>String(d).trim()),r.sort((d,m)=>d.length-m.length),r=r.filter((d,m)=>{for(let b=m+1;b<r.length;b++)if(r[b].indexOf(d)>=0)return!1;return!0});const h=r.join(" | ");h!==this._attribHTML&&(this._attribHTML=h,r.length?(this._innerContainer.innerHTML=h,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Rh{constructor(r={}){this._updateCompact=()=>{const o=this._container.children;if(o.length){const h=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&h.classList.add("maplibregl-compact"):h.classList.remove("maplibregl-compact")}},this.options=r}getDefaultPosition(){return"bottom-left"}onAdd(r){this._map=r,this._compact=this.options&&this.options.compact,this._container=R.create("div","maplibregl-ctrl");const o=R.create("a","maplibregl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){R.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Ft{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const o=++this._id;return this._queue.push({callback:r,id:o,cancelled:!1}),o}remove(r){const o=this._currentlyRunning,h=o?this._queue.concat(o):this._queue;for(const d of h)if(d.id===r)return void(d.cancelled=!0)}run(r=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const h of o)if(!h.cancelled&&(h.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Fh=c.Y([{name:"a_pos3d",type:"Int16",components:3}]);class Hg extends c.E{constructor(r){super(),this.sourceCache=r,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,r.usedForTerrain=!0,r.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(r,o){this.sourceCache.update(r,o),this._renderableTilesKeys=[];const h={};for(const d of r.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o}))h[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.posMatrix=new Float64Array(16),c.aP(d.posMatrix,0,c.X,0,c.X,0,1),this._tiles[d.key]=new Is(d,this.tileSize));for(const d in this._tiles)h[d]||delete this._tiles[d]}freeRtt(r){for(const o in this._tiles){const h=this._tiles[o];(!r||h.tileID.equals(r)||h.tileID.isChildOf(r)||r.isChildOf(h.tileID))&&(h.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(r=>this.getTileByID(r))}getTileByID(r){return this._tiles[r]}getTerrainCoords(r){const o={};for(const h of this._renderableTilesKeys){const d=this._tiles[h].tileID;if(d.canonical.equals(r.canonical)){const m=r.clone();m.posMatrix=new Float64Array(16),c.aP(m.posMatrix,0,c.X,0,c.X,0,1),o[h]=m}else if(d.canonical.isChildOf(r.canonical)){const m=r.clone();m.posMatrix=new Float64Array(16);const b=d.canonical.z-r.canonical.z,k=d.canonical.x-(d.canonical.x>>b<<b),T=d.canonical.y-(d.canonical.y>>b<<b),P=c.X>>b;c.aP(m.posMatrix,0,P,0,P,0,1),c.J(m.posMatrix,m.posMatrix,[-k*P,-T*P,0]),o[h]=m}else if(r.canonical.isChildOf(d.canonical)){const m=r.clone();m.posMatrix=new Float64Array(16);const b=r.canonical.z-d.canonical.z,k=r.canonical.x-(r.canonical.x>>b<<b),T=r.canonical.y-(r.canonical.y>>b<<b),P=c.X>>b;c.aP(m.posMatrix,0,c.X,0,c.X,0,1),c.J(m.posMatrix,m.posMatrix,[k*P,T*P,0]),c.K(m.posMatrix,m.posMatrix,[1/2**b,1/2**b,0]),o[h]=m}}return o}getSourceTile(r,o){const h=this.sourceCache._source;let d=r.overscaledZ-this.deltaZoom;if(d>h.maxzoom&&(d=h.maxzoom),d<h.minzoom)return null;this._sourceTileCache[r.key]||(this._sourceTileCache[r.key]=r.scaledTo(d).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[r.key]);if((!m||!m.dem)&&o)for(;d>=h.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(r.scaledTo(d--).key);return m}tilesAfterTime(r=Date.now()){return Object.values(this._tiles).filter(o=>o.timeAdded>=r)}}class Oh{constructor(r,o,h){this.painter=r,this.sourceCache=new Hg(o),this.options=h,this.exaggeration=typeof h.exaggeration=="number"?h.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(r,o,h,d=c.X){var m;if(!(o>=0&&o<d&&h>=0&&h<d))return 0;const b=this.getTerrainData(r),k=(m=b.tile)===null||m===void 0?void 0:m.dem;if(!k)return 0;const T=function(H,ee,ie){var se=ee[0],le=ee[1];return H[0]=ie[0]*se+ie[4]*le+ie[12],H[1]=ie[1]*se+ie[5]*le+ie[13],H}([],[o/d*c.X,h/d*c.X],b.u_terrain_matrix),P=[T[0]*k.dim,T[1]*k.dim],D=Math.floor(P[0]),L=Math.floor(P[1]),U=P[0]-D,Z=P[1]-L;return k.get(D,L)*(1-U)*(1-Z)+k.get(D+1,L)*U*(1-Z)+k.get(D,L+1)*(1-U)*Z+k.get(D+1,L+1)*U*Z}getElevationForLngLatZoom(r,o){if(!c.bb(o,r.wrap()))return 0;const{tileID:h,mercatorX:d,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(r,o);return this.getElevation(h,d%c.X,m%c.X,c.X)}getElevation(r,o,h,d=c.X){return this.getDEMElevation(r,o,h,d)*this.exaggeration}getTerrainData(r){if(!this._emptyDemTexture){const d=this.painter.context,m=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ht(d,m,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ht(d,new c.R({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.an([])}const o=this.sourceCache.getSourceTile(r,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const d=this.painter.context;o.demTexture=this.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new ht(d,o.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),o.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const h=o&&o+o.tileID.key+r.key;if(h&&!this._demMatrixCache[h]){const d=this.sourceCache.sourceCache._source.maxzoom;let m=r.canonical.z-o.tileID.canonical.z;r.overscaledZ>r.canonical.z&&(r.canonical.z>=d?m=r.canonical.z-d:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const b=r.canonical.x-(r.canonical.x>>m<<m),k=r.canonical.y-(r.canonical.y>>m<<m),T=c.bc(new Float64Array(16),[1/(c.X<<m),1/(c.X<<m),0]);c.J(T,T,[b*c.X,k*c.X,0]),this._demMatrixCache[r.key]={matrix:T,coord:r}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:h?this._demMatrixCache[r.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getFramebuffer(r){const o=this.painter,h=o.width/devicePixelRatio,d=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===h&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ht(o.context,{width:h,height:d,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ht(o.context,{width:h,height:d,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(h,d,!0,!1),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,h,d))),this._fbo.colorAttachment.set(r==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const r=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,b=0;m<this._coordsTextureSize;m++)for(let k=0;k<this._coordsTextureSize;k++,b+=4)o[b+0]=255&k,o[b+1]=255&m,o[b+2]=k>>8<<4|m>>8,o[b+3]=0;const h=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),d=new ht(r,h,r.gl.RGBA,{premultiply:!1});return d.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(r){this.painter.maybeDrawDepthAndCoords(!0);const o=new Uint8Array(4),h=this.painter.context,d=h.gl,m=Math.round(r.x*this.painter.pixelRatio/devicePixelRatio),b=Math.round(r.y*this.painter.pixelRatio/devicePixelRatio),k=Math.round(this.painter.height/devicePixelRatio);h.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(m,k-b-1,1,1,d.RGBA,d.UNSIGNED_BYTE,o),h.bindFramebuffer.set(null);const T=o[0]+(o[2]>>4<<8),P=o[1]+((15&o[2])<<8),D=this.coordsIndex[255-o[3]],L=D&&this.sourceCache.getTileByID(D);if(!L)return null;const U=this._coordsTextureSize,Z=(1<<L.tileID.canonical.z)*U;return new c.Z((L.tileID.canonical.x*U+T)/Z+L.tileID.wrap,(L.tileID.canonical.y*U+P)/Z,this.getElevation(L.tileID,T,P,U))}depthAtPoint(r){const o=new Uint8Array(4),h=this.painter.context,d=h.gl;return h.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),d.readPixels(r.x,this.painter.height/devicePixelRatio-r.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,o),h.bindFramebuffer.set(null),(o[0]/16777216+o[1]/65536+o[2]/256+o[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const r=this.painter.context,o=new c.bd,h=new c.aY,d=this.meshSize,m=c.X/d,b=d*d;for(let L=0;L<=d;L++)for(let U=0;U<=d;U++)o.emplaceBack(U*m,L*m,0);for(let L=0;L<b;L+=d+1)for(let U=0;U<d;U++)h.emplaceBack(U+L,d+U+L+1,d+U+L+2),h.emplaceBack(U+L,d+U+L+2,U+L+1);const k=o.length,T=k+2*(d+1);for(const L of[0,1])for(let U=0;U<=d;U++)for(const Z of[0,1])o.emplaceBack(U*m,L*c.X,Z);for(let L=0;L<2*d;L+=2)h.emplaceBack(T+L,T+L+1,T+L+3),h.emplaceBack(T+L,T+L+3,T+L+2),h.emplaceBack(k+L,k+L+3,k+L+1),h.emplaceBack(k+L,k+L+2,k+L+3);const P=o.length,D=P+2*(d+1);for(const L of[0,1])for(let U=0;U<=d;U++)for(const Z of[0,1])o.emplaceBack(L*c.X,U*m,Z);for(let L=0;L<2*d;L+=2)h.emplaceBack(P+L,P+L+1,P+L+3),h.emplaceBack(P+L,P+L+3,P+L+2),h.emplaceBack(D+L,D+L+3,D+L+1),h.emplaceBack(D+L,D+L+2,D+L+3);return this._mesh=new wu(r.createVertexBuffer(o,Fh.members),r.createIndexBuffer(h),c.a0.simpleSegment(0,0,o.length,h.length)),this._mesh}getMeshFrameDelta(r){return 2*Math.PI*c.be/Math.pow(2,r)/5}getMinTileElevationForLngLatZoom(r,o){var h;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(r,o);return(h=this.getMinMaxElevation(d).minElevation)!==null&&h!==void 0?h:0}getMinMaxElevation(r){const o=this.getTerrainData(r).tile,h={minElevation:null,maxElevation:null};return o&&o.dem&&(h.minElevation=o.dem.min*this.exaggeration,h.maxElevation=o.dem.max*this.exaggeration),h}_getOverscaledTileIDFromLngLatZoom(r,o){const h=c.Z.fromLngLat(r.wrap()),d=(1<<o)*c.X,m=h.x*d,b=h.y*d,k=Math.floor(m/c.X),T=Math.floor(b/c.X);return{tileID:new c.S(o,0,o,k,T),mercatorX:m,mercatorY:b}}}class Gg{constructor(r,o,h){this._context=r,this._size=o,this._tileSize=h,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const r of this._objects)r.texture.destroy(),r.fbo.destroy()}_createObject(r){const o=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),h=new ht(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return h.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),o.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),o.colorAttachment.set(h.texture),{id:r,fbo:o,texture:h,stamp:-1,inUse:!1}}getObjectForId(r){return this._objects[r]}useObject(r){r.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(o=>r.id!==o),this._recentlyUsed.push(r.id)}stampObject(r){r.stamp=++this._stamp}getOrCreateFreeObject(){for(const o of this._recentlyUsed)if(!this._objects[o].inUse)return this._objects[o];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const r=this._createObject(this._objects.length);return this._objects.push(r),r}freeObject(r){r.inUse=!1}freeAllObjects(){for(const r of this._objects)this.freeObject(r)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(r=>!r.inUse)===!1}}const Ka={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class rp{constructor(r,o){this.painter=r,this.terrain=o,this.pool=new Gg(r.context,30,o.sourceCache.tileSize*o.qualityFactor)}destruct(){this.pool.destruct()}getTexture(r){return this.pool.getObjectForId(r.rtt[this._stacks.length-1].id).texture}prepareForRender(r,o){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=r._order.filter(h=>!r._layers[h].isHidden(o)),this._coordsDescendingInv={};for(const h in r.sourceCaches){this._coordsDescendingInv[h]={};const d=r.sourceCaches[h].getVisibleCoordinates();for(const m of d){const b=this.terrain.sourceCache.getTerrainCoords(m);for(const k in b)this._coordsDescendingInv[h][k]||(this._coordsDescendingInv[h][k]=[]),this._coordsDescendingInv[h][k].push(b[k])}}this._coordsDescendingInvStr={};for(const h of r._order){const d=r._layers[h],m=d.source;if(Ka[d.type]&&!this._coordsDescendingInvStr[m]){this._coordsDescendingInvStr[m]={};for(const b in this._coordsDescendingInv[m])this._coordsDescendingInvStr[m][b]=this._coordsDescendingInv[m][b].map(k=>k.key).sort().join()}}for(const h of this._renderableTiles)for(const d in this._coordsDescendingInvStr){const m=this._coordsDescendingInvStr[d][h.tileID.key];m&&m!==h.rttCoords[d]&&(h.rtt=[])}}renderLayer(r){if(r.isHidden(this.painter.transform.zoom))return!1;const o=r.type,h=this.painter,d=this._renderableLayerIds[this._renderableLayerIds.length-1]===r.id;if(Ka[o]&&(this._prevType&&Ka[this._prevType]||this._stacks.push([]),this._prevType=o,this._stacks[this._stacks.length-1].push(r.id),!d))return!0;if(Ka[this._prevType]||Ka[o]&&d){this._prevType=o;const m=this._stacks.length-1,b=this._stacks[m]||[];for(const k of this._renderableTiles){if(this.pool.isFull()&&(Wf(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(k),k.rtt[m]){const P=this.pool.getObjectForId(k.rtt[m].id);if(P.stamp===k.rtt[m].stamp){this.pool.useObject(P);continue}}const T=this.pool.getOrCreateFreeObject();this.pool.useObject(T),this.pool.stampObject(T),k.rtt[m]={id:T.id,stamp:T.stamp},h.context.bindFramebuffer.set(T.fbo.framebuffer),h.context.clear({color:c.aM.transparent,stencil:0}),h.currentStencilSource=void 0;for(let P=0;P<b.length;P++){const D=h.style._layers[b[P]],L=D.source?this._coordsDescendingInv[D.source][k.tileID.key]:[k.tileID];h.context.viewport.set([0,0,T.fbo.width,T.fbo.height]),h._renderTileClippingMasks(D,L),h.renderLayer(h,h.style.sourceCaches[D.source],D,L),D.source&&(k.rttCoords[D.source]=this._coordsDescendingInvStr[D.source][k.tileID.key])}}return Wf(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Ka[o]}return!1}}const Nh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},np=M,Wg={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Wa,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Bh=g=>{g.touchstart=g.dragStart,g.touchmoveWindow=g.dragMove,g.touchend=g.dragEnd},Xg={showCompass:!0,showZoom:!0,visualizePitch:!1};class Kg{constructor(r,o,h=!1){this.mousedown=b=>{this.startMouse(c.e({},b,{ctrlKey:!0,preventDefault:()=>b.preventDefault()}),R.mousePos(this.element,b)),R.addEventListener(window,"mousemove",this.mousemove),R.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=b=>{this.moveMouse(b,R.mousePos(this.element,b))},this.mouseup=b=>{this.mouseRotate.dragEnd(b),this.mousePitch&&this.mousePitch.dragEnd(b),this.offTemp()},this.touchstart=b=>{b.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=R.touchPos(this.element,b.targetTouches)[0],this.startTouch(b,this._startPos),R.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),R.addEventListener(window,"touchend",this.touchend))},this.touchmove=b=>{b.targetTouches.length!==1?this.reset():(this._lastPos=R.touchPos(this.element,b.targetTouches)[0],this.moveTouch(b,this._lastPos))},this.touchend=b=>{b.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const d=r.dragRotate._mouseRotate.getClickTolerance(),m=r.dragRotate._mousePitch.getClickTolerance();this.element=o,this.mouseRotate=Ch({clickTolerance:d,enable:!0}),this.touchRotate=(({enable:b,clickTolerance:k,bearingDegreesPerPixelMoved:T=.8})=>{const P=new Th;return new cs({clickTolerance:k,move:(D,L)=>({bearingDelta:(L.x-D.x)*T}),moveStateManager:P,enable:b,assignEvents:Bh})})({clickTolerance:d,enable:!0}),this.map=r,h&&(this.mousePitch=Mh({clickTolerance:m,enable:!0}),this.touchPitch=(({enable:b,clickTolerance:k,pitchDegreesPerPixelMoved:T=-.5})=>{const P=new Th;return new cs({clickTolerance:k,move:(D,L)=>({pitchDelta:(L.y-D.y)*T}),moveStateManager:P,enable:b,assignEvents:Bh})})({clickTolerance:m,enable:!0})),R.addEventListener(o,"mousedown",this.mousedown),R.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),R.addEventListener(o,"touchcancel",this.reset)}startMouse(r,o){this.mouseRotate.dragStart(r,o),this.mousePitch&&this.mousePitch.dragStart(r,o),R.disableDrag()}startTouch(r,o){this.touchRotate.dragStart(r,o),this.touchPitch&&this.touchPitch.dragStart(r,o),R.disableDrag()}moveMouse(r,o){const h=this.map,{bearingDelta:d}=this.mouseRotate.dragMove(r,o)||{};if(d&&h.setBearing(h.getBearing()+d),this.mousePitch){const{pitchDelta:m}=this.mousePitch.dragMove(r,o)||{};m&&h.setPitch(h.getPitch()+m)}}moveTouch(r,o){const h=this.map,{bearingDelta:d}=this.touchRotate.dragMove(r,o)||{};if(d&&h.setBearing(h.getBearing()+d),this.touchPitch){const{pitchDelta:m}=this.touchPitch.dragMove(r,o)||{};m&&h.setPitch(h.getPitch()+m)}}off(){const r=this.element;R.removeEventListener(r,"mousedown",this.mousedown),R.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),R.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),R.removeEventListener(window,"touchend",this.touchend),R.removeEventListener(r,"touchcancel",this.reset),this.offTemp()}offTemp(){R.enableDrag(),R.removeEventListener(window,"mousemove",this.mousemove),R.removeEventListener(window,"mouseup",this.mouseup),R.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),R.removeEventListener(window,"touchend",this.touchend)}}let Xn;function ur(g,r,o){const h=new c.N(g.lng,g.lat);if(g=new c.N(g.lng,g.lat),r){const d=new c.N(g.lng-360,g.lat),m=new c.N(g.lng+360,g.lat),b=o.locationPoint(g).distSqr(r);o.locationPoint(d).distSqr(r)<b?g=d:o.locationPoint(m).distSqr(r)<b&&(g=m)}for(;Math.abs(g.lng-o.center.lng)>180;){const d=o.locationPoint(g);if(d.x>=0&&d.y>=0&&d.x<=o.width&&d.y<=o.height)break;g.lng>o.center.lng?g.lng-=360:g.lng+=360}return g.lng!==h.lng&&o.locationPoint(g).y>o.height/2-o.getHorizon()?g:h}const Ya={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function zu(g,r,o){const h=g.classList;for(const d in Ya)h.remove(`maplibregl-${o}-anchor-${d}`);h.add(`maplibregl-${o}-anchor-${r}`)}class Du extends c.E{constructor(r){if(super(),this._onKeyPress=o=>{const h=o.code,d=o.charCode||o.keyCode;h!=="Space"&&h!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=o=>{const h=o.originalEvent.target,d=this._element;this._popup&&(h===d||d.contains(h))&&this.togglePopup()},this._update=o=>{var h;if(!this._map)return;const d=this._map.loaded()&&!this._map.isMoving();((o==null?void 0:o.type)==="terrain"||(o==null?void 0:o.type)==="render"&&!d)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?ur(this._lngLat,this._flatPos,this._map.transform):(h=this._lngLat)===null||h===void 0?void 0:h.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(m=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let b="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?b="rotateX(0deg)":this._pitchAlignment==="map"&&(b=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||o&&o.type!=="moveend"||(this._pos=this._pos.round()),R.setTransform(this._element,`${Ya[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${b} ${m}`),z.frameAsync(new AbortController).then(()=>{this._updateOpacity(o&&o.type==="moveend")}).catch(()=>{})},this._onMove=o=>{if(!this._isDragging){const h=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=h}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.k("dragstart"))),this.fire(new c.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.k("dragend")),this._state="inactive"},this._addDragHandler=o=>{this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._subpixelPositioning=r&&r.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment!=="auto"?r.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(r==null?void 0:r.opacity,r==null?void 0:r.opacityWhenCovered),r&&r.element)this._element=r.element,this._offset=c.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=R.create("div");const o=R.createNS("http://www.w3.org/2000/svg","svg"),h=41,d=27;o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height",`${h}px`),o.setAttributeNS(null,"width",`${d}px`),o.setAttributeNS(null,"viewBox",`0 0 ${d} ${h}`);const m=R.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const b=R.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill-rule","nonzero");const k=R.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");const T=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const se of T){const le=R.createNS("http://www.w3.org/2000/svg","ellipse");le.setAttributeNS(null,"opacity","0.04"),le.setAttributeNS(null,"cx","10.5"),le.setAttributeNS(null,"cy","5.80029008"),le.setAttributeNS(null,"rx",se.rx),le.setAttributeNS(null,"ry",se.ry),k.appendChild(le)}const P=R.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"fill",this._color);const D=R.createNS("http://www.w3.org/2000/svg","path");D.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),P.appendChild(D);const L=R.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"opacity","0.25"),L.setAttributeNS(null,"fill","#000000");const U=R.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),L.appendChild(U);const Z=R.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Z.setAttributeNS(null,"fill","#FFFFFF");const H=R.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ee=R.createNS("http://www.w3.org/2000/svg","circle");ee.setAttributeNS(null,"fill","#000000"),ee.setAttributeNS(null,"opacity","0.25"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962");const ie=R.createNS("http://www.w3.org/2000/svg","circle");ie.setAttributeNS(null,"fill","#FFFFFF"),ie.setAttributeNS(null,"cx","5.5"),ie.setAttributeNS(null,"cy","5.5"),ie.setAttributeNS(null,"r","5.4999962"),H.appendChild(ee),H.appendChild(ie),b.appendChild(k),b.appendChild(P),b.appendChild(L),b.appendChild(Z),b.appendChild(H),o.appendChild(b),o.setAttributeNS(null,"height",h*this._scale+"px"),o.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(o),this._offset=c.P.convert(r&&r.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",o=>{o.preventDefault()}),this._element.addEventListener("mousedown",o=>{o.preventDefault()}),zu(this._element,this._anchor,"marker"),r&&r.className)for(const o of r.className.split(" "))this._element.classList.add(o);this._popup=null}addTo(r){return this.remove(),this._map=r,this._element.setAttribute("aria-label",r._getUIString("Marker.Title")),r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),r.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),R.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=c.N.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const d=Math.abs(13.5)/Math.SQRT2;r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(r){return this._subpixelPositioning=r,this}getPopup(){return this._popup}togglePopup(){const r=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:r?(r.isOpen()?r.remove():(r.setLngLat(this._lngLat),r.addTo(this._map)),this):this}_updateOpacity(r=!1){var o,h;if(!(!((o=this._map)===null||o===void 0)&&o.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(r)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const d=this._map,m=d.terrain.depthAtPoint(this._pos),b=d.terrain.getElevationForLngLatZoom(this._lngLat,d.transform.tileZoom);if(d.transform.lngLatToCameraDepth(this._lngLat,b)-m<.006)return void(this._element.style.opacity=this._opacity);const k=-this._offset.y/d.transform._pixelPerMeter,T=Math.sin(d.getPitch()*Math.PI/180)*k,P=d.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),D=d.transform.lngLatToCameraDepth(this._lngLat,b+T)-P>.006;!((h=this._popup)===null||h===void 0)&&h.isOpen()&&D&&this._popup.remove(),this._element.style.opacity=D?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(r){return this._offset=c.P.convert(r),this._update(),this}addClassName(r){this._element.classList.add(r)}removeClassName(r){this._element.classList.remove(r)}toggleClassName(r){return this._element.classList.toggle(r)}setDraggable(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r&&r!=="auto"?r:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(r,o){return r===void 0&&o===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),r!==void 0&&(this._opacity=r),o!==void 0&&(this._opacityWhenCovered=o),this._map&&this._updateOpacity(!0),this}}const ip={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ul=0,cl=!1;const Wi={maxWidth:100,unit:"metric"};function hl(g,r,o){const h=o&&o.maxWidth||100,d=g._container.clientHeight/2,m=g.unproject([0,d]),b=g.unproject([h,d]),k=m.distanceTo(b);if(o&&o.unit==="imperial"){const T=3.2808*k;T>5280?tt(r,h,T/5280,g._getUIString("ScaleControl.Miles")):tt(r,h,T,g._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?tt(r,h,k/1852,g._getUIString("ScaleControl.NauticalMiles")):k>=1e3?tt(r,h,k/1e3,g._getUIString("ScaleControl.Kilometers")):tt(r,h,k,g._getUIString("ScaleControl.Meters"))}function tt(g,r,o,h){const d=function(m){const b=Math.pow(10,`${Math.floor(m)}`.length-1);let k=m/b;return k=k>=10?10:k>=5?5:k>=3?3:k>=2?2:k>=1?1:function(T){const P=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*P)/P}(k),b*k}(o);g.style.width=r*(d/o)+"px",g.innerHTML=`${d}&nbsp;${h}`}const gt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Lu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ru(g){if(g){if(typeof g=="number"){const r=Math.round(Math.abs(g)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,g),"top-left":new c.P(r,r),"top-right":new c.P(-r,r),bottom:new c.P(0,-g),"bottom-left":new c.P(r,-r),"bottom-right":new c.P(-r,-r),left:new c.P(g,0),right:new c.P(-g,0)}}if(g instanceof c.P||Array.isArray(g)){const r=c.P.convert(g);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:c.P.convert(g.center||[0,0]),top:c.P.convert(g.top||[0,0]),"top-left":c.P.convert(g["top-left"]||[0,0]),"top-right":c.P.convert(g["top-right"]||[0,0]),bottom:c.P.convert(g.bottom||[0,0]),"bottom-left":c.P.convert(g["bottom-left"]||[0,0]),"bottom-right":c.P.convert(g["bottom-right"]||[0,0]),left:c.P.convert(g.left||[0,0]),right:c.P.convert(g.right||[0,0])}}return Ru(new c.P(0,0))}const jh=M;y.AJAXError=c.bh,y.Evented=c.E,y.LngLat=c.N,y.MercatorCoordinate=c.Z,y.Point=c.P,y.addProtocol=c.bi,y.config=c.a,y.removeProtocol=c.bj,y.AttributionControl=Xa,y.BoxZoomHandler=Wn,y.CanvasSource=ii,y.CooperativeGesturesHandler=Ga,y.DoubleClickZoomHandler=sa,y.DragPanHandler=Jf,y.DragRotateHandler=ep,y.EdgeInsets=qa,y.FullscreenControl=class extends c.E{constructor(g={}){super(),this._onFullscreenChange=()=>{var r;let o=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((r=o==null?void 0:o.shadowRoot)===null||r===void 0)&&r.fullscreenElement;)o=o.shadowRoot.fullscreenElement;o===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=R.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){R.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const g=this._fullscreenButton=R.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);R.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},y.GeoJSONSource=qo,y.GeolocateControl=class extends c.E{constructor(g){super(),this._onSuccess=r=>{if(this._map){if(this._isOutOfMapMaxBounds(r))return this._setErrorState(),this.fire(new c.k("outofmaxbounds",r)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=r,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(r),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(r),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.k("geolocate",r)),this._finish()}},this._updateCamera=r=>{const o=new c.N(r.coords.longitude,r.coords.latitude),h=r.coords.accuracy,d=this._map.getBearing(),m=c.e({bearing:d},this.options.fitBoundsOptions),b=be.fromLngLat(o,h);this._map.fitBounds(b,m,{geolocateSource:!0})},this._updateMarker=r=>{if(r){const o=new c.N(r.coords.longitude,r.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=r.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=r=>{if(this._map){if(this.options.trackUserLocation)if(r.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(r.code===3&&cl)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.k("error",r)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=R.create("button","maplibregl-ctrl-geolocate",this._container),R.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=r=>{if(this._map){if(r===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=R.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Du({element:this._dotElement}),this._circleElement=R.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Du({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.k("trackuserlocationend")),this.fire(new c.k("userlocationlostfocus")))})}},this.options=c.e({},ip,g)}onAdd(g){return this._map=g,this._container=R.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(r=!1){if(Xn!==void 0&&!r)return Xn;if(window.navigator.permissions===void 0)return Xn=!!window.navigator.geolocation,Xn;try{Xn=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Xn=!!window.navigator.geolocation}return Xn})}().then(r=>this._finishSetupUI(r)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),R.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ul=0,cl=!1}_isOutOfMapMaxBounds(g){const r=this._map.getMaxBounds(),o=g.coords;return r&&(o.longitude<r.getWest()||o.longitude>r.getEast()||o.latitude<r.getSouth()||o.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const g=this._map.getBounds(),r=g.getSouthEast(),o=g.getNorthEast(),h=r.distanceTo(o),d=Math.ceil(this._accuracy/(h/this._map._container.clientHeight)*2);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ul--,cl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.k("trackuserlocationstart")),this.fire(new c.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ul++,ul>1?(g={maximumAge:6e5,timeout:0},cl=!0):(g=this.options.positionOptions,cl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},y.Hash=Su,y.ImageSource=os,y.KeyboardHandler=oi,y.LngLatBounds=be,y.LogoControl=Rh,y.Map=class extends tp{constructor(g){c.bf.mark(c.bg.create);const r=Object.assign(Object.assign({},Wg),g);if(r.minZoom!=null&&r.maxZoom!=null&&r.minZoom>r.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(r.minPitch!=null&&r.maxPitch!=null&&r.minPitch>r.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(r.minPitch!=null&&r.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(r.maxPitch!=null&&r.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Za(r.minZoom,r.maxZoom,r.minPitch,r.maxPitch,r.renderWorldCopies),{bearingSnap:r.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Ft,this._controls=[],this._mapId=c.a4(),this._contextLost=o=>{o.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.k("webglcontextlost",{originalEvent:o}))},this._contextRestored=o=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.k("webglcontextrestored",{originalEvent:o}))},this._onMapScroll=o=>{if(o.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=r.interactive,this._maxTileCacheSize=r.maxTileCacheSize,this._maxTileCacheZoomLevels=r.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=r.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=r.preserveDrawingBuffer===!0,this._antialias=r.antialias===!0,this._trackResize=r.trackResize===!0,this._bearingSnap=r.bearingSnap,this._refreshExpiredTiles=r.refreshExpiredTiles===!0,this._fadeDuration=r.fadeDuration,this._crossSourceCollisions=r.crossSourceCollisions===!0,this._collectResourceTiming=r.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Nh),r.locale),this._clickTolerance=r.clickTolerance,this._overridePixelRatio=r.pixelRatio,this._maxCanvasSize=r.maxCanvasSize,this.transformCameraUpdate=r.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=r.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=te.addThrottleControl(()=>this.isMoving()),this._requestManager=new oe(r.transformRequest),typeof r.container=="string"){if(this._container=document.getElementById(r.container),!this._container)throw new Error(`Container '${r.container}' not found.`)}else{if(!(r.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=r.container}if(r.maxBounds&&this.setMaxBounds(r.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let o=!1;const h=nl(d=>{this._trackResize&&!this._removed&&(this.resize(d),this.redraw())},50);this._resizeObserver=new ResizeObserver(d=>{o?h(d):o=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Lh(this,r),this._hash=r.hash&&new Su(typeof r.hash=="string"&&r.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:r.center,zoom:r.zoom,bearing:r.bearing,pitch:r.pitch}),r.bounds&&(this.resize(),this.fitBounds(r.bounds,c.e({},r.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=r.localIdeographFontFamily,this._validateStyle=r.validateStyle,r.style&&this.setStyle(r.style,{localIdeographFontFamily:r.localIdeographFontFamily}),r.attributionControl&&this.addControl(new Xa(typeof r.attributionControl=="boolean"?void 0:r.attributionControl)),r.maplibreLogo&&this.addControl(new Rh,r.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update(o.dataType==="style"),this.fire(new c.k(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new c.k(`${o.dataType}dataloading`,o))}),this.on("dataabort",o=>{this.fire(new c.k("sourcedataabort",o))})}_getMapId(){return this._mapId}addControl(g,r){if(r===void 0&&(r=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new c.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=g.onAdd(this);this._controls.push(g);const h=this._controlPositions[r];return r.indexOf("bottom")!==-1?h.insertBefore(o,h.firstChild):h.appendChild(o),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new c.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(g);return r>-1&&this._controls.splice(r,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}calculateCameraOptionsFromTo(g,r,o,h){return h==null&&this.terrain&&(h=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(g,r,o,h)}resize(g){var r;const o=this._containerDimensions(),h=o[0],d=o[1],m=this._getClampedPixelRatio(h,d);if(this._resizeCanvas(h,d,m),this.painter.resize(h,d,m),this.painter.overLimit()){const k=this.painter.context.gl;this._maxCanvasSize=[k.drawingBufferWidth,k.drawingBufferHeight];const T=this._getClampedPixelRatio(h,d);this._resizeCanvas(h,d,T),this.painter.resize(h,d,T)}this.transform.resize(h,d),(r=this._requestedCameraState)===null||r===void 0||r.resize(h,d);const b=!this._moving;return b&&(this.stop(),this.fire(new c.k("movestart",g)).fire(new c.k("move",g))),this.fire(new c.k("resize",g)),b&&this.fire(new c.k("moveend",g)),this}_getClampedPixelRatio(g,r){const{0:o,1:h}=this._maxCanvasSize,d=this.getPixelRatio(),m=g*d,b=r*d;return Math.min(m>o?o/m:1,b>h?h/b:1)*d}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(be.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this._update()}project(g){return this.transform.locationPoint(c.N.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.pointLocation(c.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,r,o){if(g==="mouseenter"||g==="mouseover"){let h=!1;return{layers:r,listener:o,delegates:{mousemove:m=>{const b=r.filter(T=>this.getLayer(T)),k=b.length!==0?this.queryRenderedFeatures(m.point,{layers:b}):[];k.length?h||(h=!0,o.call(this,new nn(g,this,m.originalEvent,{features:k}))):h=!1},mouseout:()=>{h=!1}}}}if(g==="mouseleave"||g==="mouseout"){let h=!1;return{layers:r,listener:o,delegates:{mousemove:b=>{const k=r.filter(T=>this.getLayer(T));(k.length!==0?this.queryRenderedFeatures(b.point,{layers:k}):[]).length?h=!0:h&&(h=!1,o.call(this,new nn(g,this,b.originalEvent)))},mouseout:b=>{h&&(h=!1,o.call(this,new nn(g,this,b.originalEvent)))}}}}{const h=d=>{const m=r.filter(k=>this.getLayer(k)),b=m.length!==0?this.queryRenderedFeatures(d.point,{layers:m}):[];b.length&&(d.features=b,o.call(this,d),delete d.features)};return{layers:r,listener:o,delegates:{[g]:h}}}}_saveDelegatedListener(g,r){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(r)}_removeDelegatedListener(g,r,o){if(!this._delegatedListeners||!this._delegatedListeners[g])return;const h=this._delegatedListeners[g];for(let d=0;d<h.length;d++){const m=h[d];if(m.listener===o&&m.layers.length===r.length&&m.layers.every(b=>r.includes(b))){for(const b in m.delegates)this.off(b,m.delegates[b]);return void h.splice(d,1)}}}on(g,r,o){if(o===void 0)return super.on(g,r);const h=this._createDelegatedListener(g,typeof r=="string"?[r]:r,o);this._saveDelegatedListener(g,h);for(const d in h.delegates)this.on(d,h.delegates[d]);return this}once(g,r,o){if(o===void 0)return super.once(g,r);const h=typeof r=="string"?[r]:r,d=this._createDelegatedListener(g,h,o);for(const m in d.delegates){const b=d.delegates[m];d.delegates[m]=(...k)=>{this._removeDelegatedListener(g,h,o),b(...k)}}this._saveDelegatedListener(g,d);for(const m in d.delegates)this.once(m,d.delegates[m]);return this}off(g,r,o){return o===void 0?super.off(g,r):(this._removeDelegatedListener(g,typeof r=="string"?[r]:r,o),this)}queryRenderedFeatures(g,r){if(!this.style)return[];let o;const h=g instanceof c.P||Array.isArray(g),d=h?g:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(h?{}:g)||{},d instanceof c.P||typeof d[0]=="number")o=[c.P.convert(d)];else{const m=c.P.convert(d[0]),b=c.P.convert(d[1]);o=[m,new c.P(b.x,m.y),b,new c.P(m.x,b.y),m]}return this.style.queryRenderedFeatures(o,r,this.transform)}querySourceFeatures(g,r){return this.style.querySourceFeatures(g,r)}setStyle(g,r){return(r=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(g,r))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){const r=this._locale[g];if(r==null)throw new Error(`Missing UI string '${g}'`);return r}_updateStyle(g,r){if(r.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(g,r));const o=this.style&&r.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new au(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,r,o):this.style.loadJSON(g,r,o),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new au(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,r){if(typeof g=="string"){const o=this._requestManager.transformRequest(g,"Style");c.h(o,new AbortController).then(h=>{this._updateDiff(h.data,r)}).catch(h=>{h&&this.fire(new c.j(h))})}else typeof g=="object"&&this._updateDiff(g,r)}_updateDiff(g,r){try{this.style.setState(g,r)&&this._update(!0)}catch(o){c.w(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(g,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(g,r){return this._lazyInitEmptyStyle(),this.style.addSource(g,r),this._update(!0)}isSourceLoaded(g){const r=this.style&&this.style.sourceCaches[g];if(r!==void 0)return r.loaded();this.fire(new c.j(new Error(`There is no source with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){const r=this.style.sourceCaches[g.source];if(!r)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);this.terrain===null&&r.reload();for(const o in this.style._layers){const h=this.style._layers[o];h.type==="hillshade"&&h.source===g.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Oh(this.painter,r,g),this.painter.renderToTexture=new rp(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=o=>{o.dataType==="style"?this.terrain.sourceCache.freeRtt():o.dataType==="source"&&o.tile&&(o.sourceId!==g.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(o.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new c.k("terrain",{terrain:g})),this}getTerrain(){var g,r;return(r=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&r!==void 0?r:null}areTilesLoaded(){const g=this.style&&this.style.sourceCaches;for(const r in g){const o=g[r]._tiles;for(const h in o){const d=o[h];if(d.state!=="loaded"&&d.state!=="errored")return!1}}return!0}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,r,o={}){const{pixelRatio:h=1,sdf:d=!1,stretchX:m,stretchY:b,content:k,textFitWidth:T,textFitHeight:P}=o;if(this._lazyInitEmptyStyle(),!(r instanceof HTMLImageElement||c.b(r))){if(r.width===void 0||r.height===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:D,height:L,data:U}=r,Z=r;return this.style.addImage(g,{data:new c.R({width:D,height:L},new Uint8Array(U)),pixelRatio:h,stretchX:m,stretchY:b,content:k,textFitWidth:T,textFitHeight:P,sdf:d,version:0,userImage:Z}),Z.onAdd&&Z.onAdd(this,g),this}}{const{width:D,height:L,data:U}=z.getImageData(r);this.style.addImage(g,{data:new c.R({width:D,height:L},U),pixelRatio:h,stretchX:m,stretchY:b,content:k,textFitWidth:T,textFitHeight:P,sdf:d,version:0})}}updateImage(g,r){const o=this.style.getImage(g);if(!o)return this.fire(new c.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const h=r instanceof HTMLImageElement||c.b(r)?z.getImageData(r):r,{width:d,height:m,data:b}=h;if(d===void 0||m===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==o.data.width||m!==o.data.height)return this.fire(new c.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const k=!(r instanceof HTMLImageElement||c.b(r));return o.data.replace(b,k),this.style.updateImage(g,o),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new c.j(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g){return te.getImage(this._requestManager.transformRequest(g,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(g,r){return this._lazyInitEmptyStyle(),this.style.addLayer(g,r),this._update(!0)}moveLayer(g,r){return this.style.moveLayer(g,r),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,r,o){return this.style.setLayerZoomRange(g,r,o),this._update(!0)}setFilter(g,r,o={}){return this.style.setFilter(g,r,o),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,r,o,h={}){return this.style.setPaintProperty(g,r,o,h),this._update(!0)}getPaintProperty(g,r){return this.style.getPaintProperty(g,r)}setLayoutProperty(g,r,o,h={}){return this.style.setLayoutProperty(g,r,o,h),this._update(!0)}getLayoutProperty(g,r){return this.style.getLayoutProperty(g,r)}setGlyphs(g,r={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,r),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,r,o={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,r,o,h=>{h||this._update(!0)}),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,r={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,r,o=>{o||this._update(!0)}),this}setLight(g,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,r),this._update(!0)}getLight(){return this.style.getLight()}setSky(g){return this._lazyInitEmptyStyle(),this.style.setSky(g),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(g,r){return this.style.setFeatureState(g,r),this._update()}removeFeatureState(g,r){return this.style.removeFeatureState(g,r),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,r=0;return this._container&&(g=this._container.clientWidth||400,r=this._container.clientHeight||300),[g,r]}_setupContainer(){const g=this._container;g.classList.add("maplibregl-map");const r=this._canvasContainer=R.create("div","maplibregl-canvas-container",g);this._interactive&&r.classList.add("maplibregl-interactive"),this._canvas=R.create("canvas","maplibregl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const o=this._containerDimensions(),h=this._getClampedPixelRatio(o[0],o[1]);this._resizeCanvas(o[0],o[1],h);const d=this._controlContainer=R.create("div","maplibregl-control-container",g),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(b=>{m[b]=R.create("div",`maplibregl-ctrl-${b} `,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,r,o){this._canvas.width=Math.floor(o*g),this._canvas.height=Math.floor(o*r),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${r}px`}_setupPainter(){const g={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let r=null;this._canvas.addEventListener("webglcontextcreationerror",h=>{r={requestedAttributes:g},h&&(r.statusMessage=h.statusMessage,r.type=h.type)},{once:!0});const o=this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g);if(!o){const h="Failed to initialize WebGL";throw r?(r.message=h,new Error(JSON.stringify(r))):new Error(h)}this.painter=new bu(o,this.transform),X.testSupport(o)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){const r=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let o=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const d=this.transform.zoom,m=z.now();this.style.zoomHistory.update(d,m);const b=new c.z(d,{now:m,fadeDuration:r,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),k=b.crossFadingFactor();k===1&&k===this._crossFadingFactor||(o=!0,this._crossFadingFactor=k),this.style.update(b)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,r,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:r,showPadding:this.showPadding}),this.fire(new c.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.bf.mark(c.bg.load),this.fire(new c.k("load"))),this.style&&(this.style.hasTransitions()||o)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const h=this._sourcesDirty||this._styleDirty||this._placementDirty;return h||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.k("idle")),!this._loaded||this._fullyLoaded||h||(this._fullyLoaded=!0,c.bf.mark(c.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),te.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();const r=this.painter.context.gl.getExtension("WEBGL_lose_context");r!=null&&r.loseContext&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),R.remove(this._canvasContainer),R.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),c.bf.clearMetrics(),this._removed=!0,this.fire(new c.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,z.frameAsync(this._frameRequest).then(g=>{c.bf.frame(g),this._frameRequest=null,this._render(g)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return np}getCameraTargetElevation(){return this.transform.elevation}},y.MapMouseEvent=nn,y.MapTouchEvent=na,y.MapWheelEvent=Kf,y.Marker=Du,y.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{const r=this._map.getZoom(),o=r===this._map.getMaxZoom(),h=r===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())},this._rotateCompassArrow=()=>{const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=r},this._setButtonTitle=(r,o)=>{const h=this._map._getUIString(`NavigationControl.${o}`);r.title=h,r.setAttribute("aria-label",h)},this.options=c.e({},Xg,g),this._container=R.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),R.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),R.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=R.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Kg(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){R.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,r){const o=R.create("button",g,this._container);return o.type="button",o.addEventListener("click",r),o}},y.Popup=class extends c.E{constructor(g){super(),this.remove=()=>(this._content&&R.remove(this._content),this._container&&(R.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.k("close"))),this),this._onMouseUp=r=>{this._update(r.point)},this._onMouseMove=r=>{this._update(r.point)},this._onDrag=r=>{this._update(r.point)},this._update=r=>{var o;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=R.create("div","maplibregl-popup",this._map.getContainer()),this._tip=R.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const k of this.options.className.split(" "))this._container.classList.add(k);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?ur(this._lngLat,this._flatPos,this._map.transform):(o=this._lngLat)===null||o===void 0?void 0:o.wrap(),this._trackPointer&&!r)return;const h=this._flatPos=this._pos=this._trackPointer&&r?r:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&r?r:this._map.transform.locationPoint(this._lngLat));let d=this.options.anchor;const m=Ru(this.options.offset);if(!d){const k=this._container.offsetWidth,T=this._container.offsetHeight;let P;P=h.y+m.bottom.y<T?["top"]:h.y>this._map.transform.height-T?["bottom"]:[],h.x<k/2?P.push("left"):h.x>this._map.transform.width-k/2&&P.push("right"),d=P.length===0?"bottom":P.join("-")}let b=h.add(m[d]);this.options.subpixelPositioning||(b=b.round()),R.setTransform(this._container,`${Ya[d]} translate(${b.x}px,${b.y}px)`),zu(this._container,d,"popup")},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(gt),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=c.N.convert(g),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const r=document.createDocumentFragment(),o=document.createElement("body");let h;for(o.innerHTML=g;h=o.firstChild,h;)r.appendChild(h);return this.setDOMContent(r)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=R.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._container&&this._container.classList.add(g),this}removeClassName(g){return this._container&&this._container.classList.remove(g),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}setSubpixelPositioning(g){this.options.subpixelPositioning=g}_createCloseButton(){this.options.closeButton&&(this._closeButton=R.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(Lu);g&&g.focus()}},y.RasterDEMTileSource=_r,y.RasterTileSource=qt,y.ScaleControl=class{constructor(g){this._onMove=()=>{hl(this._map,this._container,this.options)},this.setUnit=r=>{this.options.unit=r,hl(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Wi),g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=R.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){R.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},y.ScrollZoomHandler=Ci,y.Style=au,y.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=g}onAdd(g){return this._map=g,this._container=R.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=R.create("button","maplibregl-ctrl-terrain",this._container),R.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){R.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},y.TwoFingersTouchPitchHandler=ll,y.TwoFingersTouchRotateHandler=Ah,y.TwoFingersTouchZoomHandler=Eh,y.TwoFingersTouchZoomRotateHandler=Dh,y.VectorTileSource=Cs,y.VideoSource=Pa,y.addSourceType=(g,r)=>c._(void 0,void 0,void 0,function*(){if(Ho(g))throw new Error(`A source type called "${g}" already exists.`);((o,h)=>{Zo[o]=h})(g,r)}),y.clearPrewarmedResources=function(){const g=Dr;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(Vr),Dr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},y.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},y.getRTLTextPluginStatus=function(){return $i().getRTLTextPluginStatus()},y.getVersion=function(){return jh},y.getWorkerCount=function(){return tn.workerCount},y.getWorkerUrl=function(){return c.a.WORKER_URL},y.importScriptInWorkers=function(g){return Rt().broadcast("IS",g)},y.prewarm=function(){et().acquire(Vr)},y.setMaxParallelImageRequests=function(g){c.a.MAX_PARALLEL_IMAGE_REQUESTS=g},y.setRTLTextPlugin=function(g,r){return $i().setRTLTextPlugin(g,r)},y.setWorkerCount=function(g){tn.workerCount=g},y.setWorkerUrl=function(g){c.a.WORKER_URL=g}});var v=s;return v})})(wC);var LF=wC.exports;const b_=L2(LF);function S2(e,t){return`${e}${t}/256/{z}/{x}/{y}/2/1_1.png`}async function RF(){const e=await fetch(bf.RAINVIEWER_MAPS);if(!e.ok)throw new Error(`RainViewer API error: ${e.status}`);const t=await e.json(),s=t.radar.past.map(p=>({timestamp:p.time,path:p.path,tileUrl:S2(t.host,p.path)})),l=t.radar.nowcast.map(p=>({timestamp:p.time,path:p.path,tileUrl:S2(t.host,p.path)}));return{generated:t.generated,host:t.host,past:s,nowcast:l}}function FF(e){return[...e.past,...e.nowcast]}function OF(e){const t=new Date(e*1e3),s=new Date,l=t.getTime()-s.getTime(),p=Math.round(l/6e4);return p===0?"Now":p>0?`+${p}m`:`${p}m`}function NF({frames:e,currentIndex:t,isPlaying:s,onPlayPause:l,onFrameChange:p}){const v=e[t],y=v?OF(v.timestamp):"",c=()=>{const I=t>0?t-1:e.length-1;p(I)},M=()=>{const I=t<e.length-1?t+1:0;p(I)};return G.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-lg p-3 mt-3",children:[G.jsxs("div",{className:"flex items-center gap-3",children:[G.jsx(Fd,{variant:"ghost",size:"sm",onClick:c,"aria-label":"Previous frame",children:G.jsx(Dz,{size:20})}),G.jsx(Fd,{variant:"primary",size:"sm",onClick:l,className:"px-4","aria-label":s?"Pause":"Play",children:s?G.jsx(Hz,{size:16}):G.jsx(Gz,{size:16})}),G.jsx(Fd,{variant:"ghost",size:"sm",onClick:M,"aria-label":"Next frame",children:G.jsx(vT,{size:20})}),G.jsx("div",{className:"flex-1 mx-3",children:G.jsx("input",{type:"range",min:0,max:e.length-1,value:t,onChange:I=>p(parseInt(I.target.value,10)),className:`w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-full appearance-none cursor-pointer
              [&::-webkit-slider-thumb]:appearance-none
              [&::-webkit-slider-thumb]:w-4
              [&::-webkit-slider-thumb]:h-4
              [&::-webkit-slider-thumb]:bg-sky-500
              [&::-webkit-slider-thumb]:rounded-full
              [&::-webkit-slider-thumb]:cursor-pointer
              [&::-webkit-slider-thumb]:shadow-md
              [&::-moz-range-thumb]:w-4
              [&::-moz-range-thumb]:h-4
              [&::-moz-range-thumb]:bg-sky-500
              [&::-moz-range-thumb]:rounded-full
              [&::-moz-range-thumb]:cursor-pointer
              [&::-moz-range-thumb]:border-none`})}),G.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 min-w-[60px] text-right",children:y})]}),G.jsxs("div",{className:"flex justify-between mt-2 px-1",children:[G.jsx("span",{className:"text-xs text-slate-500",children:"Past"}),G.jsx("span",{className:"text-xs text-slate-500",children:"Now"}),G.jsx("span",{className:"text-xs text-slate-500",children:"Forecast"})]})]})}function BF(){const e=Pe.useRef(null),t=Pe.useRef(null),[s,l]=Pe.useState(0),[p,v]=Pe.useState(!1),y="radar-layer",c="radar-source",M=Ri(ge=>ge.getActiveLocation()),{data:I,isLoading:j}=Qv({queryKey:vg.radarTimestamps(),queryFn:RF,staleTime:Vl.RADAR_TILES.staleTime,gcTime:Vl.RADAR_TILES.gcTime,refetchInterval:Vl.RADAR_TILES.staleTime}),z=I?FF(I):[],R=z.length,X=z[s];Pe.useEffect(()=>{if(!(!e.current||t.current))return t.current=new b_.Map({container:e.current,style:{version:8,sources:{carto:{type:"raster",tiles:[bf.CARTO_TILES],tileSize:256,attribution:'&copy; <a href="https://carto.com/">CARTO</a>'}},layers:[{id:"carto-tiles",type:"raster",source:"carto",minzoom:0,maxzoom:19}]},center:[(M==null?void 0:M.coordinates.longitude)??ec.defaultCenter.longitude,(M==null?void 0:M.coordinates.latitude)??ec.defaultCenter.latitude],zoom:ec.defaultZoom,minZoom:ec.minZoom,maxZoom:ec.maxZoom}),t.current.addControl(new b_.NavigationControl,"top-right"),M&&new b_.Marker({color:"#0ea5e9"}).setLngLat([M.coordinates.longitude,M.coordinates.latitude]).addTo(t.current),()=>{var ge;(ge=t.current)==null||ge.remove(),t.current=null}},[]),Pe.useEffect(()=>{!t.current||!M||t.current.flyTo({center:[M.coordinates.longitude,M.coordinates.latitude],zoom:ec.defaultZoom})},[M]),Pe.useEffect(()=>{if(!t.current||!X)return;const ge=t.current;ge.getLayer(y)&&ge.removeLayer(y),ge.getSource(c)&&ge.removeSource(c),ge.addSource(c,{type:"raster",tiles:[X.tileUrl],tileSize:256}),ge.addLayer({id:y,type:"raster",source:c,paint:{"raster-opacity":.7}})},[X]),Pe.useEffect(()=>{if(!p||R===0)return;const ge=setInterval(()=>{l(W=>(W+1)%R)},500);return()=>clearInterval(ge)},[p,R]);const me=Pe.useCallback(()=>{v(ge=>!ge)},[]),he=Pe.useCallback(ge=>{l(ge),v(!1)},[]);return G.jsxs("div",{className:"h-full flex flex-col",children:[G.jsx("div",{ref:e,className:"flex-1 rounded-xl overflow-hidden"}),z.length>0&&G.jsx(NF,{frames:z,currentIndex:s,isPlaying:p,onPlayPause:me,onFrameChange:he}),j&&G.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 rounded-xl",children:G.jsx("div",{className:"bg-white dark:bg-slate-800 px-4 py-2 rounded-lg shadow-lg",children:"Loading radar data..."})})]})}function jF(){return G.jsx("div",{className:"h-screen flex flex-col bg-slate-900 pb-20",children:G.jsx("div",{className:"flex-1 p-4 pt-safe-top",children:G.jsx(BF,{})})})}function S_({label:e,value:t,children:s,onClick:l}){const p=G.jsxs("div",{className:"flex items-center justify-between py-3 px-4",children:[G.jsx("span",{className:"text-slate-900 dark:text-slate-100",children:e}),s||G.jsxs("div",{className:"flex items-center gap-2 text-slate-500",children:[t&&G.jsx("span",{children:t}),l&&G.jsx(vT,{size:18})]})]});return l?G.jsx("button",{onClick:l,className:"w-full text-left hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors",children:p}):p}function wl({label:e,value:t,options:s,onChange:l}){return G.jsxs("div",{className:"py-3 px-4",children:[G.jsx("span",{className:"text-slate-900 dark:text-slate-100 block mb-3",children:e}),G.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(p=>G.jsx("button",{onClick:()=>l(p.value),className:`
              px-3 py-1.5 rounded-lg text-sm font-medium transition-colors
              ${t===p.value?"bg-sky-500 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}
            `,children:p.label},p.value))})]})}function UF(){const{units:e,theme:t,alertsEnabled:s,reducedMotion:l,setTemperatureUnit:p,setWindSpeedUnit:v,setPressureUnit:y,setVisibilityUnit:c,setPrecipitationUnit:M,setTimeFormat:I,setTheme:j,setAlertsEnabled:z,setReducedMotion:R,resetToDefaults:X}=Yc();return G.jsx("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 pb-24",children:G.jsxs("div",{className:"pt-safe-top px-4 py-6",children:[G.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mb-6",children:"Settings"}),G.jsxs("div",{className:"space-y-6",children:[G.jsxs("section",{children:[G.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wider text-slate-500 mb-2 px-1",children:"Units"}),G.jsxs(El,{className:"overflow-hidden divide-y divide-slate-100 dark:divide-slate-700",children:[G.jsx(wl,{label:"Temperature",value:e.temperature,options:[{value:"fahrenheit",label:"F"},{value:"celsius",label:"C"}],onChange:p}),G.jsx(wl,{label:"Wind Speed",value:e.windSpeed,options:[{value:"mph",label:"mph"},{value:"kmh",label:"km/h"},{value:"ms",label:"m/s"},{value:"knots",label:"knots"}],onChange:v}),G.jsx(wl,{label:"Pressure",value:e.pressure,options:[{value:"inhg",label:"inHg"},{value:"hpa",label:"hPa"},{value:"mmhg",label:"mmHg"}],onChange:y}),G.jsx(wl,{label:"Visibility",value:e.visibility,options:[{value:"mi",label:"miles"},{value:"km",label:"km"}],onChange:c}),G.jsx(wl,{label:"Precipitation",value:e.precipitation,options:[{value:"in",label:"inches"},{value:"mm",label:"mm"}],onChange:M}),G.jsx(wl,{label:"Time Format",value:e.timeFormat,options:[{value:"12h",label:"12-hour"},{value:"24h",label:"24-hour"}],onChange:I})]})]}),G.jsxs("section",{children:[G.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wider text-slate-500 mb-2 px-1",children:"Appearance"}),G.jsxs(El,{className:"overflow-hidden divide-y divide-slate-100 dark:divide-slate-700",children:[G.jsx(wl,{label:"Theme",value:t,options:[{value:"auto",label:"Auto"},{value:"light",label:"Light"},{value:"dark",label:"Dark"}],onChange:j}),G.jsx(S_,{label:"Reduced Motion",children:G.jsx(F0,{checked:l,onChange:me=>R(me.target.checked)})})]})]}),G.jsxs("section",{children:[G.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wider text-slate-500 mb-2 px-1",children:"Notifications"}),G.jsx(El,{className:"overflow-hidden divide-y divide-slate-100 dark:divide-slate-700",children:G.jsx(S_,{label:"Weather Alerts",children:G.jsx(F0,{checked:s,onChange:me=>z(me.target.checked)})})})]}),G.jsxs("section",{children:[G.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wider text-slate-500 mb-2 px-1",children:"Data"}),G.jsx(El,{className:"overflow-hidden",children:G.jsx(S_,{label:"Reset to Defaults",onClick:X})})]}),G.jsxs("p",{className:"text-xs text-center text-slate-400 dark:text-slate-500 py-4",children:["Darth Sky v0.1.0",G.jsx("br",{}),"Weather data from Open-Meteo",G.jsx("br",{}),"Radar data from RainViewer"]})]})]})})}const VF=new yz({defaultOptions:{queries:{retry:3,refetchOnWindowFocus:!0}}});function $F({children:e}){const t=Yc(s=>s.theme);return Pe.useEffect(()=>{const s=document.documentElement;if(t==="auto"){const l=window.matchMedia("(prefers-color-scheme: dark)"),p=()=>{l.matches?s.classList.add("dark"):s.classList.remove("dark")};return p(),l.addEventListener("change",p),()=>l.removeEventListener("change",p)}else t==="dark"?s.classList.add("dark"):s.classList.remove("dark")},[t]),G.jsx(G.Fragment,{children:e})}function qF(){return G.jsxs(G.Fragment,{children:[G.jsxs(FA,{children:[G.jsx(cm,{path:"/",element:G.jsx(DF,{})}),G.jsx(cm,{path:"/map",element:G.jsx(jF,{})}),G.jsx(cm,{path:"/settings",element:G.jsx(UF,{})})]}),G.jsx(hD,{}),G.jsx(WD,{})]})}function ZF(){return G.jsx(_z,{client:VF,children:G.jsx($F,{children:G.jsx($A,{children:G.jsx(qF,{})})})})}Gk(document.getElementById("root")).render(G.jsx(Pe.StrictMode,{children:G.jsx(ZF,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").catch(()=>{})});
